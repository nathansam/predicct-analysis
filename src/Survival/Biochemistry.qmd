---
title: "Biochemistry"
author:
  - name: "Nathan Constantine-Cooke"
    corresponding: true
    url: https://scholar.google.com/citations?user=2emHWR0AAAAJ&hl=en&oi=ao
    affiliations:
      - ref: CGEM
      - ref: HGU
bibliography: Survival.bib   
---

## Introduction

```{R}
#| message: false
source("Survival/utils.R")

# Setup analysis environment
analysis_setup <- setup_analysis()
paths <- analysis_setup$paths
demo <- analysis_setup$demo

flare.df <- readRDS(paste0(paths$outdir, "flares-IBD.RDS"))
flare.cd.df <- readRDS(paste0(paths$outdir, "flares-IBD-cd.RDS"))
flare.uc.df <- readRDS(paste0(paths$outdir, "flares-IBD-uc.RDS"))

cd.clin.forest <- readRDS(paste0(paths$outdir, "cd-clin-IBD.RDS"))
cd.hard.forest <- readRDS(paste0(paths$outdir, "cd-hard-IBD.RDS"))
uc.clin.forest <- readRDS(paste0(paths$outdir, "uc-clin-IBD.RDS"))
uc.hard.forest <- readRDS(paste0(paths$outdir, "uc-hard-IBD.RDS"))
```

## C-reactive protein

### Crohn's disease

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize CRP
flare.cd.df <- categorize_variable(flare.cd.df, "CReactiveProtein", 
                                   breaks = c(0, 5, 10.0000001, Inf),
                                   labels = c("CRP < 5",
                                              "5 ≤ CRP ≤ 10",
                                              "CRP > 10"))

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "CReactiveProtein",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "CRP",
  plot_base_path = "plots/cd/soft-flare/biochem/crp",
  break_time_by = 200
)

# Extract hazard ratio for continuous CRP variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.clin.forest <- rbind(
  cd.clin.forest,
  get_HR(fit.me, "CReactiveProtein")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "CReactiveProtein",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "CRP",
  plot_base_path = "plots/cd/hard-flare/biochem/crp",
  break_time_by = 500
)

# Extract hazard ratio for continuous CRP variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.hard.forest <- rbind(
  cd.hard.forest,
  get_HR(fit.me, "CReactiveProtein")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

### Ulcerative colitis

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize CRP
flare.uc.df <- categorize_variable(flare.uc.df, "CReactiveProtein", 
                                   breaks = c(0, 5, 10.0000001, Inf),
                                   labels = c("CRP < 5", "5 ≤ CRP ≤ 10", "CRP > 10"))

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "CReactiveProtein",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "CRP",
  plot_base_path = "plots/uc/soft-flare/biochem/crp",
  break_time_by = 200
)

# Extract hazard ratio for continuous CRP variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.clin.forest <- rbind(
  uc.clin.forest,
  get_HR(fit.me, "CReactiveProtein")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "CReactiveProtein",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "CRP",
  plot_base_path = "plots/uc/hard-flare/biochem/crp",
  break_time_by = 500
)

# Extract hazard ratio for continuous CRP variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.hard.forest <- rbind(
  uc.hard.forest,
  get_HR(fit.me, "CReactiveProtein")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

## Haemoglobin

### Crohn's disease

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize Haemoglobin by quantiles
flare.cd.df <- categorize_by_quantiles(flare.cd.df,
                                       "Haemoglobin",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "Haemoglobin",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "Haemoglobin",
  plot_base_path = "plots/cd/soft-flare/biochem/haemoglobin",
  break_time_by = 200
)

# Extract hazard ratio for continuous Haemoglobin variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.clin.forest <- rbind(
  cd.clin.forest,
  get_HR(fit.me, "Haemoglobin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "Haemoglobin",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "Haemoglobin",
  plot_base_path = "plots/cd/hard-flare/biochem/haemoglobin",
  break_time_by = 500
)

# Extract hazard ratio for continuous Haemoglobin variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.hard.forest <- rbind(
  cd.hard.forest,
  get_HR(fit.me, "Haemoglobin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

### Ulcerative colitis

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize Haemoglobin by quantiles
flare.uc.df <- categorize_by_quantiles(flare.uc.df,
                                       "Haemoglobin",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "Haemoglobin",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "Haemoglobin",
  plot_base_path = "plots/uc/soft-flare/biochem/haemoglobin",
  break_time_by = 200
)

# Extract hazard ratio for continuous Haemoglobin variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.clin.forest <- rbind(
  uc.clin.forest,
  get_HR(fit.me, "Haemoglobin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "Haemoglobin",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "Haemoglobin",
  plot_base_path = "plots/uc/hard-flare/biochem/haemoglobin",
  break_time_by = 500
)

# Extract hazard ratio for continuous Haemoglobin variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.hard.forest <- rbind(
  uc.hard.forest,
  get_HR(fit.me, "Haemoglobin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

## White cell count

### Crohn's disease

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize White Cell Count by quantiles
flare.cd.df <- categorize_by_quantiles(flare.cd.df,
                                       "WCC",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "WCC",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "White cell count",
  plot_base_path = "plots/cd/soft-flare/biochem/wcc",
  break_time_by = 200
)

# Extract hazard ratio for continuous WCC variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + WCC + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.clin.forest <- rbind(
  cd.clin.forest,
  get_HR(fit.me, "WCC")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "WCC",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "White cell count",
  plot_base_path = "plots/cd/hard-flare/biochem/wcc",
  break_time_by = 500
)

# Extract hazard ratio for continuous WCC variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + WCC + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.hard.forest <- rbind(
  cd.hard.forest,
  get_HR(fit.me, "WCC")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

### Ulcerative colitis

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize White Cell Count by quantiles
flare.uc.df <- categorize_by_quantiles(flare.uc.df,
                                       "WCC",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "WCC",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "White cell count",
  plot_base_path = "plots/uc/soft-flare/biochem/wcc",
  break_time_by = 200
)

# Extract hazard ratio for continuous WCC variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + WCC + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.clin.forest <- rbind(
  uc.clin.forest,
  get_HR(fit.me, "WCC")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "WCC",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "White cell count",
  plot_base_path = "plots/uc/hard-flare/biochem/wcc",
  break_time_by = 500
)

# Extract hazard ratio for continuous WCC variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + WCC + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.hard.forest <- rbind(
  uc.hard.forest,
  get_HR(fit.me, "WCC")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

## Platelets

There is significant separation between Kaplan-Meier curves for platelets for
both soft and objective flares in CD. However, this significance is lost when
controlling for FC and other variables via Cox regression. No significant
findings are reported for UC. 

### Crohn's disease

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize Platelets by quantiles
flare.cd.df <- categorize_by_quantiles(flare.cd.df,
                                       "Platelets",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "Platelets",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "Platelets",
  plot_base_path = "plots/cd/soft-flare/biochem/Platelets",
  break_time_by = 200
)

# Extract hazard ratio for continuous Platelets variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + Platelets + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.clin.forest <- rbind(
  cd.clin.forest,
  get_HR(fit.me, "Platelets")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "Platelets",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "Platelets",
  plot_base_path = "plots/cd/hard-flare/biochem/Platelets",
  break_time_by = 500
)

# Extract hazard ratio for continuous Platelets variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + Platelets + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.hard.forest <- rbind(
  cd.hard.forest,
  get_HR(fit.me, "Platelets")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

### Ulcerative colitis

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize Platelets by quantiles
flare.uc.df <- categorize_by_quantiles(flare.uc.df,
                                       "Platelets",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "Platelets",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "Platelets",
  plot_base_path = "plots/uc/soft-flare/biochem/Platelets",
  break_time_by = 200
)

# Extract hazard ratio for continuous Platelets variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + Platelets + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.clin.forest <- rbind(
  uc.clin.forest,
  get_HR(fit.me, "Platelets")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "Platelets",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "Platelets",
  plot_base_path = "plots/uc/hard-flare/biochem/Platelets",
  break_time_by = 500
)

# Extract hazard ratio for continuous Platelets variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + Platelets + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.hard.forest <- rbind(
  uc.hard.forest,
  get_HR(fit.me, "Platelets")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

## Albumin

### Crohn's disease

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize Albumin by quantiles
flare.cd.df <- categorize_by_quantiles(flare.cd.df,
                                       "Albumin",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "Albumin",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "Albumin",
  plot_base_path = "plots/cd/soft-flare/biochem/albumin",
  break_time_by = 200
)

# Extract hazard ratio for continuous Albumin variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + Albumin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.clin.forest <- rbind(
  cd.clin.forest,
  get_HR(fit.me, "Albumin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.cd.df,
  var_name = "Albumin",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "Albumin",
  plot_base_path = "plots/cd/hard-flare/biochem/albumin",
  break_time_by = 500
)

# Extract hazard ratio for continuous Albumin variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + Albumin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

cd.hard.forest <- rbind(
  cd.hard.forest,
  get_HR(fit.me, "Albumin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

### Ulcerative colitis

::: {.panel-tabset group="followup"}

#### Patient-reported flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Categorize Albumin by quantiles
flare.uc.df <- categorize_by_quantiles(flare.uc.df,
                                       "Albumin",
                                       reference_data = flare.df)

# Run survival analysis using utility function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "Albumin",
  outcome_time = "softflare_time",
  outcome_event = "softflare",
  legend_title = "Albumin",
  plot_base_path = "plots/uc/soft-flare/biochem/albumin",
  break_time_by = 200
)

# Extract hazard ratio for continuous Albumin variable
fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex + IMD + cat + Albumin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.clin.forest <- rbind(
  uc.clin.forest,
  get_HR(fit.me, "Albumin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

#### Objective flare

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

# Generate survival plot and run Cox model for objective flare using utility
# function
analysis_result <- run_survival_analysis(
  data = flare.uc.df,
  var_name = "Albumin",
  outcome_time = "hardflare_time",
  outcome_event = "hardflare",
  legend_title = "Albumin",
  plot_base_path = "plots/uc/hard-flare/biochem/albumin",
  break_time_by = 500
)

# Extract hazard ratio for continuous Albumin variable
fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex + IMD + cat + Albumin + frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

uc.hard.forest <- rbind(
  uc.hard.forest,
  get_HR(fit.me, "Albumin")
)

# Display plot and model summary
analysis_result$plot
invisible(cox_summary(fit.me))
```

:::

<details class = "appendix">
  <summary> Control for additional covariates </summary>
  
<h3> Crohn's disease </h3>

<h4> Patient-reported flare </h4>

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex +
    IMD +
    cat +
    `IBD Duration` +
    BMI +
    Treatment +
    Age +
    CReactiveProtein +
    frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

invisible(cox_summary(fit.me))
```

<h4> Objective flare </h4>

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex +
    IMD +
    cat +
    `IBD Duration` +
    BMI +
    Treatment +
    Age +
    CReactiveProtein +
    frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.cd.df
)

invisible(cox_summary(fit.me))
```

<h3> Ulcerative colitis </h3>

<h4> Patient-reported flare </h4>

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

fit.me <- coxph(
  Surv(softflare_time, softflare) ~
    Sex +
    IMD +
    cat +
    `IBD Duration` +
    BMI +
    Treatment +
    Age +
    CReactiveProtein +
    frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

invisible(cox_summary(fit.me))
```

<h4> Objective flare </h4>

```{R}
#| results: "hold"
#| output: "asis"
#| fig-height: 6

fit.me <- coxph(
  Surv(hardflare_time, hardflare) ~
    Sex +
    IMD +
    cat +
    `IBD Duration` +
    BMI +
    Treatment +
    Age +
    CReactiveProtein +
    frailty(SiteNo),
  control = coxph.control(outer.max = 20),
  data = flare.uc.df
)

invisible(cox_summary(fit.me))
```

</details>
  
## Reproduction and reproducibility {.appendix}

<details class = "appendix">
  <summary> Session info </summary>

```{R Session info}
#| echo: false
pander::pander(sessionInfo())
```

</details>

Licensed by 
<a href="https://creativecommons.org/licenses/by/4.0/">CC BY</a>
 unless otherwise stated.

```{R}
saveRDS(flare.df, paste0(paths$outdir, "flares-biochem.RDS"))
saveRDS(flare.cd.df, paste0(paths$outdir, "flares-biochem-cd.RDS"))
saveRDS(flare.uc.df, paste0(paths$outdir, "flares-biochem-uc.RDS"))

saveRDS(cd.clin.forest, paste0(paths$outdir, "cd-clin-biochem.RDS"))
saveRDS(cd.hard.forest, paste0(paths$outdir, "cd-hard-biochem.RDS"))
saveRDS(uc.clin.forest, paste0(paths$outdir, "uc-clin-biochem.RDS"))
saveRDS(uc.hard.forest, paste0(paths$outdir, "uc-hard-biochem.RDS"))
```

