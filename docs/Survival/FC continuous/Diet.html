<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="dcterms.date" content="2025-11-05">
<title>PREdiCCt analyses - Diet</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../../images/favicon.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<meta property="og:title" content="PREdiCCt analyses - Diet">
<meta property="og:description" content="">
<meta property="og:site_name" content="PREdiCCt analyses">
<meta name="twitter:title" content="PREdiCCt analyses - Diet">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@IBDNathan">
<meta name="twitter:site" content="@EdinUni_IGC">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="Diet">
<meta name="citation_publication_date" content="2025-11-05">
<meta name="citation_cover_date" content="2025-11-05">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-11-05">
<meta name="citation_language" content="en">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Diet</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../PREdiCCtlogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/nathansam/predicct-analysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/nathansam/predicct-analysis/issues">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/Recruitment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study recruitment</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Baseline Analyses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/Demographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Demographic data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/IBD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inflammatory bowel disease</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/Biochemistry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Biochemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/Diet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Baseline/Tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overall tables</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Time to flare</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/Soft-hard-flares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flare overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/Controlled.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Controlled variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/Demographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Demographic data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/IBD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inflammatory bowel disease</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/Biochemistry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Biochemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../Survival/Diet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diet</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../documents.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study documents</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="99"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li>
<a href="#setting-up-in-r" id="toc-setting-up-in-r" class="nav-link" data-scroll-target="#setting-up-in-r">Setting up in R</a>
  <ul>
<li><a href="#load-the-data" id="toc-load-the-data" class="nav-link" data-scroll-target="#load-the-data">Load the data</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">Data cleaning</a></li>
  <li><a href="#helper-functions" id="toc-helper-functions" class="nav-link" data-scroll-target="#helper-functions">Helper functions</a></li>
  </ul>
</li>
  <li>
<a href="#survival-analysis" id="toc-survival-analysis" class="nav-link" data-scroll-target="#survival-analysis">Survival Analysis</a>
  <ul>
<li>
<a href="#shapes-of-continuous-variables" id="toc-shapes-of-continuous-variables" class="nav-link" data-scroll-target="#shapes-of-continuous-variables">Shapes of continuous variables</a>
  <ul>
<li>
<a href="#crohns-disease" id="toc-crohns-disease" class="nav-link" data-scroll-target="#crohns-disease">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare" id="toc-patient-reported-flare" class="nav-link" data-scroll-target="#patient-reported-flare">Patient reported flare</a></li>
  </ul>
</li>
  <li>
<a href="#crohns-disease-1" id="toc-crohns-disease-1" class="nav-link" data-scroll-target="#crohns-disease-1">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-1" id="toc-patient-reported-flare-1" class="nav-link" data-scroll-target="#patient-reported-flare-1">Patient-reported flare</a></li>
  <li><a href="#objective-flare" id="toc-objective-flare" class="nav-link" data-scroll-target="#objective-flare">Objective flare</a></li>
  </ul>
</li>
  <li>
<a href="#ulcerative-colitis" id="toc-ulcerative-colitis" class="nav-link" data-scroll-target="#ulcerative-colitis">Ulcerative colitis</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-2" id="toc-patient-reported-flare-2" class="nav-link" data-scroll-target="#patient-reported-flare-2">Patient-reported flare</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#total-meat-protein" id="toc-total-meat-protein" class="nav-link" data-scroll-target="#total-meat-protein">Total meat protein</a>
  <ul>
<li>
<a href="#crohns-disease-2" id="toc-crohns-disease-2" class="nav-link" data-scroll-target="#crohns-disease-2">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-3" id="toc-patient-reported-flare-3" class="nav-link" data-scroll-target="#patient-reported-flare-3">Patient reported flare</a></li>
  <li><a href="#objective-flare-1" id="toc-objective-flare-1" class="nav-link" data-scroll-target="#objective-flare-1">Objective flare</a></li>
  </ul>
</li>
  <li>
<a href="#ulcerative-colitis-1" id="toc-ulcerative-colitis-1" class="nav-link" data-scroll-target="#ulcerative-colitis-1">Ulcerative colitis</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-4" id="toc-patient-reported-flare-4" class="nav-link" data-scroll-target="#patient-reported-flare-4">Patient reported flare</a></li>
  <li><a href="#objective-flare-2" id="toc-objective-flare-2" class="nav-link" data-scroll-target="#objective-flare-2">Objective flare</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#dietary-fibre" id="toc-dietary-fibre" class="nav-link" data-scroll-target="#dietary-fibre">Dietary Fibre</a>
  <ul>
<li>
<a href="#crohns-disease-3" id="toc-crohns-disease-3" class="nav-link" data-scroll-target="#crohns-disease-3">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-5" id="toc-patient-reported-flare-5" class="nav-link" data-scroll-target="#patient-reported-flare-5">Patient-reported flare</a></li>
  <li><a href="#objective-flare-3" id="toc-objective-flare-3" class="nav-link" data-scroll-target="#objective-flare-3">Objective Flare</a></li>
  </ul>
</li>
  <li>
<a href="#ulcerative-colitis-2" id="toc-ulcerative-colitis-2" class="nav-link" data-scroll-target="#ulcerative-colitis-2">Ulcerative colitis</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-6" id="toc-patient-reported-flare-6" class="nav-link" data-scroll-target="#patient-reported-flare-6">Patient-reported flare</a></li>
  <li><a href="#objective-flare-4" id="toc-objective-flare-4" class="nav-link" data-scroll-target="#objective-flare-4">Objective Flare</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#polyunsaturated-fatty-acids" id="toc-polyunsaturated-fatty-acids" class="nav-link" data-scroll-target="#polyunsaturated-fatty-acids">Polyunsaturated fatty acids</a>
  <ul>
<li>
<a href="#crohns-disease-4" id="toc-crohns-disease-4" class="nav-link" data-scroll-target="#crohns-disease-4">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-7" id="toc-patient-reported-flare-7" class="nav-link" data-scroll-target="#patient-reported-flare-7">Patient-reported flare</a></li>
  <li><a href="#objective-flare-5" id="toc-objective-flare-5" class="nav-link" data-scroll-target="#objective-flare-5">Objective Flare</a></li>
  </ul>
</li>
  <li>
<a href="#ulcerative-colitis-3" id="toc-ulcerative-colitis-3" class="nav-link" data-scroll-target="#ulcerative-colitis-3">Ulcerative colitis</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-8" id="toc-patient-reported-flare-8" class="nav-link" data-scroll-target="#patient-reported-flare-8">Patient-reported flare</a></li>
  <li><a href="#objective-flare-6" id="toc-objective-flare-6" class="nav-link" data-scroll-target="#objective-flare-6">Objective Flare</a></li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#ultra-processed-food" id="toc-ultra-processed-food" class="nav-link" data-scroll-target="#ultra-processed-food">Ultra-processed food</a>
  <ul>
<li>
<a href="#crohns-disease-5" id="toc-crohns-disease-5" class="nav-link" data-scroll-target="#crohns-disease-5">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-9" id="toc-patient-reported-flare-9" class="nav-link" data-scroll-target="#patient-reported-flare-9">Patient-reported flare</a></li>
  <li><a href="#objective-flare-7" id="toc-objective-flare-7" class="nav-link" data-scroll-target="#objective-flare-7">Objective Flare</a></li>
  </ul>
</li>
  <li>
<a href="#ulcerative-colitis-4" id="toc-ulcerative-colitis-4" class="nav-link" data-scroll-target="#ulcerative-colitis-4">Ulcerative colitis</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-10" id="toc-patient-reported-flare-10" class="nav-link" data-scroll-target="#patient-reported-flare-10">Patient-reported flare</a></li>
  <li><a href="#objective-flare-8" id="toc-objective-flare-8" class="nav-link" data-scroll-target="#objective-flare-8">Objective Flare</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  <li>
<a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a>
  <ul>
<li>
<a href="#risk-difference" id="toc-risk-difference" class="nav-link" data-scroll-target="#risk-difference">Risk difference</a>
  <ul>
<li>
<a href="#crohns-disease-6" id="toc-crohns-disease-6" class="nav-link" data-scroll-target="#crohns-disease-6">Crohn’s disease</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-11" id="toc-patient-reported-flare-11" class="nav-link" data-scroll-target="#patient-reported-flare-11">Patient-reported flare</a></li>
  <li><a href="#objective-flare-9" id="toc-objective-flare-9" class="nav-link" data-scroll-target="#objective-flare-9">Objective Flare</a></li>
  </ul>
</li>
  <li>
<a href="#ulcerative-colitis-5" id="toc-ulcerative-colitis-5" class="nav-link" data-scroll-target="#ulcerative-colitis-5">Ulcerative colitis</a>
  <ul class="collapse">
<li><a href="#patient-reported-flare-12" id="toc-patient-reported-flare-12" class="nav-link" data-scroll-target="#patient-reported-flare-12">Patient-reported flare</a></li>
  <li><a href="#objective-flare-10" id="toc-objective-flare-10" class="nav-link" data-scroll-target="#objective-flare-10">Objective Flare</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul>
</li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/nathansam/predicct-analysis/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Diet</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 5, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="overview" class="level2"><h2 class="anchored" data-anchor-id="overview">Overview</h2>
<p>This report presents a sensitivity analysis examining the association between dietary factors and disease flare risk in inflammatory bowel disease (IBD) patients. Unlike the primary analysis which categorizes fecal calprotectin (FC) into quantiles, this analysis treats FC as a continuous variable in Cox proportional hazards models.</p>
<p>The key methodological differences from the primary analysis are:</p>
<ol type="1">
<li>
<strong>Continuous FC</strong>: FC is included as a continuous predictor rather than categorical</li>
<li>
<strong>Spline modeling</strong>: Natural splines are tested to assess non-linear relationships</li>
<li>
<strong>Hazard ratio curves</strong>: Continuous hazard ratios are plotted across the range of each dietary variable</li>
<li>
<strong>Risk difference estimation</strong>: Population-average risk differences are calculated using bootstrapping</li>
</ol>
<p>Dietary variables examined include total meat protein, dietary fibre, polyunsaturated fatty acids (PUFA), and ultra-processed food (UPF) intake. Analyses are stratified by disease type (Crohn’s disease vs.&nbsp;ulcerative colitis) and flare definition (patient-reported vs.&nbsp;objective).</p>
</section><section id="setting-up-in-r" class="level1"><h1>Setting up in R</h1>
<section id="load-the-data" class="level2"><h2 class="anchored" data-anchor-id="load-the-data">Load the data</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">splines</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"Survival/utils.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setup analysis environment</span></span>
<span><span class="va">analysis_setup</span> <span class="op">&lt;-</span> <span class="fu">setup_analysis</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">paths</span> <span class="op">&lt;-</span> <span class="va">analysis_setup</span><span class="op">$</span><span class="va">paths</span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="va">analysis_setup</span><span class="op">$</span><span class="va">demo</span></span>
<span></span>
<span><span class="va">flare.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">paths</span><span class="op">$</span><span class="va">outdir</span>, <span class="st">"flares-biochem.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flare.cd.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">paths</span><span class="op">$</span><span class="va">outdir</span>, <span class="st">"flares-biochem-cd.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">flare.uc.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">paths</span><span class="op">$</span><span class="va">outdir</span>, <span class="st">"flares-biochem-uc.RDS"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="data-cleaning" class="level2"><h2 class="anchored" data-anchor-id="data-cleaning">Data cleaning</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC has been logged twice - reverse</span></span>
<span><span class="va">flare.df</span> <span class="op">%&lt;&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">FC</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flare.cd.df</span> <span class="op">%&lt;&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">FC</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">flare.uc.df</span> <span class="op">%&lt;&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>FC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">FC</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># So now FC is on the original measurement scale (log transformation reversed)</span></span>
<span></span>
<span><span class="co"># Transform age variable to decades</span></span>
<span><span class="va">flare.df</span> <span class="op">%&lt;&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    age_decade <span class="op">=</span> <span class="va">Age</span> <span class="op">/</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">flare.cd.df</span> <span class="op">%&lt;&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    age_decade <span class="op">=</span> <span class="va">Age</span> <span class="op">/</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">flare.uc.df</span> <span class="op">%&lt;&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    age_decade <span class="op">=</span> <span class="va">Age</span> <span class="op">/</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section><section id="helper-functions" class="level2"><h2 class="anchored" data-anchor-id="helper-functions">Helper functions</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plot_continuous_hr</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">model</span>, <span class="va">variable</span>, <span class="va">splineterm</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="co"># Plotting continuous Hazard Ratio curves</span></span>
<span>  <span class="co"># Data is the same data used to fit the Cox model</span></span>
<span>  <span class="co"># model is a Cox model</span></span>
<span>  <span class="co"># variable is the variable we are plotting</span></span>
<span>  <span class="co"># splineterm is the spline used in the model, if there is one</span></span>
<span>  </span>
<span>  <span class="co"># Range of the variable to plot</span></span>
<span>  <span class="va">variable_range</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">.</span>, probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.9</span>, <span class="fl">0.01</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unname.html">unname</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># If there is a spline</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">splineterm</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="co"># Recreate the spline</span></span>
<span>    <span class="va">spline</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">data</span>, <span class="fu"><a href="https://rdrr.io/r/base/eval.html">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html">parse</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">splineterm</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Get the spline terms for the variable values we are plotting</span></span>
<span>    <span class="va">spline_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">spline</span>, newx <span class="op">=</span> <span class="va">variable_range</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Get the reference values of the variables that were used to fit the Cox model</span></span>
<span>    <span class="va">X_ref</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">means</span></span>
<span>    </span>
<span>    <span class="co"># New values to calculate the HR at </span></span>
<span>    <span class="co"># Take the ref values and vary our variable of interest</span></span>
<span>    </span>
<span>    <span class="co"># Number of values</span></span>
<span>    <span class="va">n_values</span> <span class="op">&lt;-</span> <span class="va">variable_range</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">X_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">X_ref</span>, <span class="va">n_values</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_values</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co"># Fix the column names</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X_ref</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">means</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Now add our new variable values</span></span>
<span>    <span class="va">X_new</span> <span class="op">&lt;-</span> <span class="va">X_ref</span></span>
<span>    <span class="co"># Identify the correct columns</span></span>
<span>    <span class="va">column_pos</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X_new</span><span class="op">)</span>, <span class="va">variable</span><span class="op">)</span></span>
<span>    <span class="co"># Add the values - ordering of columns and model term names should be preserved</span></span>
<span>    <span class="va">X_new</span><span class="op">[</span>,<span class="va">column_pos</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">spline_values</span></span>
<span>    </span>
<span>    <span class="co"># Calculate the linear predictor and se</span></span>
<span>    <span class="co"># Method directly from predict.coxph from the survival package</span></span>
<span>    <span class="va">lp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">X_new</span> <span class="op">-</span> <span class="va">X_ref</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> </span>
<span>    </span>
<span>    <span class="va">lp_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="op">(</span><span class="va">X_new</span> <span class="op">-</span> <span class="va">X_ref</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">X_new</span> <span class="op">-</span> <span class="va">X_ref</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="co"># If there is no spline then it is easier</span></span>
<span>    </span>
<span>    <span class="co"># Get the reference values of the variables that were used to fit the Cox model</span></span>
<span>    <span class="va">X_ref</span> <span class="op">&lt;-</span> <span class="va">model</span><span class="op">$</span><span class="va">means</span></span>
<span>    </span>
<span>    <span class="co"># New values to calculate the HR at </span></span>
<span>    <span class="co"># Take the ref values and vary our variable of interest</span></span>
<span>    </span>
<span>    <span class="co"># Number of values</span></span>
<span>    <span class="va">n_values</span> <span class="op">&lt;-</span> <span class="va">variable_range</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">X_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">X_ref</span>, <span class="va">n_values</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n_values</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="co"># Fix the column names</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X_ref</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">means</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="co"># Now add our new variable values</span></span>
<span>    <span class="va">X_new</span> <span class="op">&lt;-</span> <span class="va">X_ref</span></span>
<span>    </span>
<span>    <span class="co"># Add the values</span></span>
<span>    <span class="va">X_new</span><span class="op">[</span>,<span class="va">variable</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">variable_range</span></span>
<span>    </span>
<span>    <span class="co"># Calculate the linear predictor and se</span></span>
<span>    <span class="co"># Method directly from predict.coxph from the survival package</span></span>
<span>    <span class="va">lp</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">X_new</span> <span class="op">-</span> <span class="va">X_ref</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>    </span>
<span>    <span class="va">lp_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="op">(</span><span class="va">X_new</span> <span class="op">-</span> <span class="va">X_ref</span><span class="op">)</span><span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span><span class="fu"><a href="https://rdrr.io/r/stats/vcov.html">vcov</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">X_new</span> <span class="op">-</span> <span class="va">X_ref</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Store results in a tibble</span></span>
<span>  <span class="va">data_pred</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="op">!</span><span class="fu">sym</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">:=</span> <span class="va">variable_range</span>,</span>
<span>    p <span class="op">=</span> <span class="va">lp</span>,</span>
<span>    se <span class="op">=</span> <span class="va">lp_se</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Plot</span></span>
<span>  <span class="va">data_pred</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span><span class="op">(</span><span class="va">variable</span><span class="op">)</span>,</span>
<span>      y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>,</span>
<span>      ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">p</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span>,</span>
<span>      ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">p</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_line</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_ribbon</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ylab</span><span class="op">(</span><span class="st">"HR"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Function to perform an LRT</span></span>
<span><span class="va">summon_lrt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">model</span>, <span class="va">remove</span> <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">add</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Function that removes a term and performs a</span></span>
<span>  <span class="co"># Likelihood ratio test to determine its significance</span></span>
<span></span>
<span>  <span class="va">new_formula</span> <span class="op">&lt;-</span> <span class="st">"~ ."</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">remove</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">new_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">new_formula</span>, <span class="st">" - "</span>, <span class="va">remove</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">remove</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">add</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">new_formula</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">new_formula</span>, <span class="st">" + "</span>, <span class="va">add</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">add</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/update.html">update</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">new_formula</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="va">model</span>, <span class="va">.</span>, test <span class="op">=</span> <span class="st">"LRT"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">p.value</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">term</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      removed <span class="op">=</span> <span class="va">remove</span>,</span>
<span>      added <span class="op">=</span> <span class="va">add</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test <span class="op">=</span> <span class="st">"LRT"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">test</span>, <span class="va">removed</span>, <span class="va">added</span>, <span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Test"</span>,</span>
<span>                               <span class="st">"Remolved"</span>,</span>
<span>                               <span class="st">"Added"</span>,</span>
<span>                               <span class="st">"Log-likelihood"</span>,</span>
<span>                               <span class="st">"Statistic"</span>,</span>
<span>                               <span class="st">"DF"</span>,</span>
<span>                               <span class="st">"p-vaue"</span><span class="op">)</span>,</span>
<span>                 digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">summon_population_risk_difference</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>,</span>
<span>                                              <span class="va">model</span>,</span>
<span>                                              <span class="va">times</span>,</span>
<span>                                              <span class="va">variable</span>,</span>
<span>                                              <span class="va">values</span>,</span>
<span>                                              <span class="va">ref_value</span> <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Function that calculates (population average) risk difference of a variable</span></span>
<span>  <span class="co"># at given time points with respect to specified value of the variable from a</span></span>
<span>  <span class="co"># Cox model</span></span>
<span></span>
<span>  <span class="co"># If no reference value then use one in the middle</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">ref_value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pos</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">ref_value</span> <span class="op">&lt;-</span> <span class="va">values</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="co"># Identify the time variable - to differentiate between soft and hard flare models</span></span>
<span>  <span class="va">time_variable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/allnames.html">all.vars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html">expand_grid</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">values</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html">map2</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">times</span>,</span>
<span>    .y <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">values</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Set values for time and the variable</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="fu">sym</span><span class="op">(</span><span class="va">time_variable</span><span class="op">)</span> <span class="op">:=</span> <span class="va">x</span>, <span class="op">!</span><span class="op">!</span><span class="fu">sym</span><span class="op">(</span><span class="va">variable</span><span class="op">)</span> <span class="op">:=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Estimate expected for entire population</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span>, newdata <span class="op">=</span> <span class="va">.</span>, type <span class="op">=</span> <span class="st">"expected"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">tibble</span><span class="op">(</span>expected <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Remove NA</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">expected</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Calculate survival and cumulative incidence (1 - survival)</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>          survival <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">expected</span><span class="op">)</span>,</span>
<span>          cum_incidence <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">survival</span></span>
<span>        <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">cum_incidence</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>cum_incidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">cum_incidence</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Note time, value and variable</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">x</span>, value <span class="op">=</span> <span class="va">y</span>, variable <span class="op">=</span> <span class="va">variable</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/list_c.html">list_rbind</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># Calculate risk difference relative to a reference</span></span>
<span>    <span class="op">{</span></span>
<span>      <span class="va">df</span> <span class="op">&lt;-</span> <span class="va">.</span></span>
<span></span>
<span>      <span class="co"># Subtract chosen reference value to set linear predictor to 0 at that value</span></span>
<span>      <span class="va">cum_incidence_ref</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="va">ref_value</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>cum_incidence_ref <span class="op">=</span> <span class="va">cum_incidence</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">cum_incidence_ref</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">df</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span><span class="va">cum_incidence_ref</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rd <span class="op">=</span> <span class="op">(</span><span class="va">cum_incidence</span> <span class="op">-</span> <span class="va">cum_incidence_ref</span><span class="op">)</span><span class="op">*</span><span class="fl">100</span>, .keep <span class="op">=</span> <span class="st">"unused"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">summon_population_risk_difference_boot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>,</span>
<span>                                                   <span class="va">model</span>,</span>
<span>                                                   <span class="va">times</span>,</span>
<span>                                                   <span class="va">variable</span>,</span>
<span>                                                   <span class="va">values</span>,</span>
<span>                                                   <span class="va">ref_value</span> <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                                                   <span class="va">nboot</span> <span class="op">=</span> <span class="fl">99</span>,</span>
<span>                                                   <span class="va">seed</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Function to calculate population risk difference for a given variable at given time points</span></span>
<span>  <span class="co"># relative to a specified reference value</span></span>
<span>  <span class="co"># Confidence intervals calculated using bootstrapping.</span></span>
<span></span>
<span>  <span class="co"># Set seed</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># If no reference value then use one in the middle</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">ref_value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">pos</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">values</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">ref_value</span> <span class="op">&lt;-</span> <span class="va">values</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="va">pos</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span></span>
<span>    .x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="va">nboot</span><span class="op">)</span>,</span>
<span>    .f <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">b</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="co"># Variable used in the model</span></span>
<span>      <span class="va">all_variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/allnames.html">all.vars</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/terms.html">terms</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Bootstrap sample of the data</span></span>
<span>      <span class="va">data_boot</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Remove any NAs as Cox doesn't use these</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu">tidyselect</span><span class="fu">::</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html">all_of</a></span><span class="op">(</span><span class="va">all_variables</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_any</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu">everything</span><span class="op">(</span><span class="op">)</span>, .fns <span class="op">=</span> <span class="va">is.na</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>        <span class="co"># Sample the df</span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span>prop <span class="op">=</span> <span class="fl">1</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Refit cox model of bootstrapped data</span></span>
<span>      <span class="va">model_boot</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html">formula</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">data_boot</span>, model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Calculate risk differences</span></span>
<span>      <span class="fu">summon_population_risk_difference</span><span class="op">(</span></span>
<span>        data <span class="op">=</span> <span class="va">data_boot</span>,</span>
<span>        model <span class="op">=</span> <span class="va">model_boot</span>,</span>
<span>        times <span class="op">=</span> <span class="va">times</span>,</span>
<span>        variable <span class="op">=</span> <span class="va">variable</span>,</span>
<span>        values <span class="op">=</span> <span class="va">values</span>,</span>
<span>        ref_value <span class="op">=</span> <span class="va">ref_value</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># Bootstrapped estimate and confidence intervals</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>      mean_rd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">rd</span><span class="op">)</span>,</span>
<span>      conf.low <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">rd</span>, prob <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>      conf.high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">rd</span>, prob <span class="op">=</span> <span class="fl">0.975</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html">rename</a></span><span class="op">(</span>estimate <span class="op">=</span> <span class="va">mean_rd</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># Note variable, reference level flag</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      variable <span class="op">=</span> <span class="va">variable</span>,</span>
<span>      reference_flag <span class="op">=</span> <span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="va">ref_value</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># Ordering for plotting</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">value</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>ordering <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># Tidy confidence intervals</span></span>
<span>    <span class="co"># Remove confidence intervals for reference level</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      conf.low <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">reference_flag</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA</span>,</span>
<span>        .default <span class="op">=</span> <span class="va">conf.low</span></span>
<span>      <span class="op">)</span>,</span>
<span>      conf.high <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span><span class="va">reference_flag</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">~</span> <span class="cn">NA</span>,</span>
<span>        .default <span class="op">=</span> <span class="va">conf.high</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      conf.interval.tidy <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>        <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">conf.low</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">conf.high</span><span class="op">)</span><span class="op">)</span> <span class="op">~</span> <span class="st">"-"</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.3g"</span>, <span class="va">estimate</span><span class="op">)</span>,</span>
<span>          <span class="st">" ("</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.3g"</span>, <span class="va">conf.low</span><span class="op">)</span>,</span>
<span>          <span class="st">", "</span>,</span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span><span class="op">(</span><span class="st">"%.3g"</span>, <span class="va">conf.high</span><span class="op">)</span>,</span>
<span>          <span class="st">")"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>    <span class="co"># Significance</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      significance <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">reference_flag</span> <span class="op">==</span> <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"Reference level"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">conf.low</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">conf.high</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Significant"</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">conf.low</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/sign.html">sign</a></span><span class="op">(</span><span class="va">conf.high</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Not Significant"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">summon_rd_forest_plot</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">time</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Creating a forest plot of risk difference from the result of</span></span>
<span>  <span class="co"># summon_population_risk_difference_boot</span></span>
<span></span>
<span>  <span class="co"># Mask time</span></span>
<span>  <span class="va">time_point</span> <span class="op">&lt;-</span> <span class="va">time</span></span>
<span></span>
<span>  <span class="va">data_plot</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">time</span> <span class="op">==</span> <span class="va">time_point</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Forest plot</span></span>
<span>  <span class="va">plot</span> <span class="op">&lt;-</span> <span class="va">data_plot</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">estimate</span>,</span>
<span>      y <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">term_tidy</span><span class="op">)</span>,</span>
<span>      xmin <span class="op">=</span> <span class="va">conf.low</span>,</span>
<span>      xmax <span class="op">=</span> <span class="va">conf.high</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_errorbarh</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">xlab</span><span class="op">(</span><span class="st">"Risk Difference (%) and 95% CI"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span></span>
<span>      <span class="co"># Title</span></span>
<span>      plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      plot.subtitle <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>      <span class="co"># Axes</span></span>
<span>      axis.title.y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>  <span class="co"># RD values</span></span>
<span>  <span class="va">rd</span> <span class="op">&lt;-</span> <span class="va">data_plot</span> <span class="op">%&gt;%</span></span>
<span>    <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">geom_text</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      y <span class="op">=</span> <span class="fu">forcats</span><span class="fu">::</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">term_tidy</span><span class="op">)</span>,</span>
<span>      label <span class="op">=</span> <span class="va">conf.interval.tidy</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_void</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>plot <span class="op">=</span> <span class="va">plot</span>, rd <span class="op">=</span> <span class="va">rd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">broom.cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Term"</span>,</span>
<span>                <span class="st">"Estimate"</span>,</span>
<span>                <span class="st">"Std error"</span>,</span>
<span>                <span class="st">"Statistic"</span>,</span>
<span>                <span class="st">"p-value"</span>,</span>
<span>                <span class="st">"Lower"</span>,</span>
<span>                <span class="st">"Upper"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><section id="survival-analysis" class="level1"><h1>Survival Analysis</h1>
<section id="shapes-of-continuous-variables" class="level2"><h2 class="anchored" data-anchor-id="shapes-of-continuous-variables">Shapes of continuous variables</h2>
<p>Using splines for the continuous variables. Testing the splines significance using a likelihood ratio test.</p>
<section id="crohns-disease" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease">Crohn’s disease</h3>
<section id="patient-reported-flare" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare">Patient reported flare</h4>
<p>Before examining dietary exposures, we first assess whether continuous covariates (age, BMI, FC, and diet quality index) exhibit non-linear relationships with flare risk. Natural splines with 2 degrees of freedom are tested using likelihood ratio tests (LRT). Where significant, spline terms are retained in subsequent dietary models to improve model fit and reduce confounding.</p>
</section></section><section id="crohns-disease-1" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease-1">Crohn’s disease</h3>
<section id="patient-reported-flare-1" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-1">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Just the continuous variables</span></span>
<span><span class="va">cox_cd_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Is there any benefit to using spline for:</span></span>
<span></span>
<span><span class="co"># age</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_soft</span>,</span>
<span>           remove <span class="op">=</span> <span class="st">"age_decade"</span>,</span>
<span>           add <span class="op">=</span> <span class="st">"ns(age_decade, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 31%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 4%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">age_decade</td>
<td style="text-align: left;">ns(age_decade, df = 2)</td>
<td style="text-align: right;">-1012.677</td>
<td style="text-align: right;">0.91</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.34</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_soft</span>, remove <span class="op">=</span> <span class="st">"BMI"</span>, add <span class="op">=</span> <span class="st">"ns(BMI, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 24%">
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">ns(BMI, df = 2)</td>
<td style="text-align: right;">-1013.132</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.976</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_soft</span>, remove <span class="op">=</span> <span class="st">"FC"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">FC</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: right;">-1013.113</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.845</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dqi_tot</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_soft</span>,</span>
<span>           remove <span class="op">=</span> <span class="st">"dqi_tot"</span>,</span>
<span>           add <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: left;">ns(dqi_tot, df = 2)</td>
<td style="text-align: right;">-1012.826</td>
<td style="text-align: right;">0.612</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.434</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># None of the continuous variables benefit from a spline term</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Age</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"age_decade"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age (decades)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"BMI"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"FC"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># DQI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dqi_tot"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Diet quality index"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare" class="level4"><h4 class="anchored" data-anchor-id="objective-flare">Objective flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Just the continuous variables</span></span>
<span></span>
<span><span class="va">cox_cd_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Is there any benefit to using spline for:</span></span>
<span></span>
<span><span class="co"># age</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_hard</span>, remove <span class="op">=</span> <span class="st">"age_decade"</span>, add <span class="op">=</span> <span class="st">"ns(age_decade, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 29%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">age_decade</td>
<td style="text-align: left;">ns(age_decade, df = 2)</td>
<td style="text-align: right;">-591.537</td>
<td style="text-align: right;">0.369</td>
<td style="text-align: right;">1.019</td>
<td style="text-align: right;">0.551</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_hard</span>, remove <span class="op">=</span> <span class="st">"BMI"</span>, add <span class="op">=</span> <span class="st">"ns(BMI, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 23%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">ns(BMI, df = 2)</td>
<td style="text-align: right;">-591.833</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.545</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_hard</span>, remove <span class="op">=</span> <span class="st">"FC"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 22%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">FC</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: right;">-591.243</td>
<td style="text-align: right;">0.958</td>
<td style="text-align: right;">1.282</td>
<td style="text-align: right;">0.419</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dqi_tot</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_cd_hard</span>, remove <span class="op">=</span> <span class="st">"dqi_tot"</span>, add <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 27%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: left;">ns(dqi_tot, df = 2)</td>
<td style="text-align: right;">-591.489</td>
<td style="text-align: right;">0.465</td>
<td style="text-align: right;">1.058</td>
<td style="text-align: right;">0.518</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># None of the continuous variables benefit from a spline term</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Age</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"age_decade"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age (decades)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"BMI"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"FC"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># DQI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dqi_tot"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Diet quality index"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ulcerative-colitis" class="level3"><h3 class="anchored" data-anchor-id="ulcerative-colitis">Ulcerative colitis</h3>
<section id="patient-reported-flare-2" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-2">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Just the continuous variables</span></span>
<span></span>
<span><span class="va">cox_uc_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Is there any benefit to using spline for:</span></span>
<span></span>
<span><span class="co"># age</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_soft</span>, remove <span class="op">=</span> <span class="st">"age_decade"</span>, add <span class="op">=</span> <span class="st">"ns(age_decade, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 31%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 4%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">age_decade</td>
<td style="text-align: left;">ns(age_decade, df = 2)</td>
<td style="text-align: right;">-1228.481</td>
<td style="text-align: right;">0.37</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.543</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_soft</span>, remove <span class="op">=</span> <span class="st">"BMI"</span>, add <span class="op">=</span> <span class="st">"ns(BMI, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 24%">
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">ns(BMI, df = 2)</td>
<td style="text-align: right;">-1228.655</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.881</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_soft</span>, remove <span class="op">=</span> <span class="st">"FC"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">FC</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: right;">-1224.712</td>
<td style="text-align: right;">7.909</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.005</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dqi_tot</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_soft</span>, remove <span class="op">=</span> <span class="st">"dqi_tot"</span>, add <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: left;">ns(dqi_tot, df = 2)</td>
<td style="text-align: right;">-1227.125</td>
<td style="text-align: right;">3.083</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.079</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC and dqi_tot can get a spline</span></span>
<span><span class="va">cox_uc_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">dqi_tot</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Test for df = 3</span></span>
<span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_soft</span>, remove <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 3)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: left;">ns(FC, df = 3)</td>
<td style="text-align: right;">-1223.038</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.762</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dqi_tot</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_soft</span>,</span>
<span>  remove <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 2)"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 3)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">ns(dqi_tot, df = 2)</td>
<td style="text-align: left;">ns(dqi_tot, df = 3)</td>
<td style="text-align: right;">-1221.851</td>
<td style="text-align: right;">2.465</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.116</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Age</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"age_decade"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age (decades)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"BMI"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"FC"</span>,</span>
<span>  splineterm <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-9-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># DQI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dqi_tot"</span>,</span>
<span>  splineterm <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 2)"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Diet quality index"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-9-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">#### Objective flare</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Just the continuous variables</span></span>
<span></span>
<span><span class="va">cox_uc_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Is there any benefit to using spline for:</span></span>
<span></span>
<span><span class="co"># age</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_hard</span>, remove <span class="op">=</span> <span class="st">"age_decade"</span>, add <span class="op">=</span> <span class="st">"ns(age_decade, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 14%">
<col style="width: 29%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">age_decade</td>
<td style="text-align: left;">ns(age_decade, df = 2)</td>
<td style="text-align: right;">-679.06</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">0.417</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_hard</span>, remove <span class="op">=</span> <span class="st">"BMI"</span>, add <span class="op">=</span> <span class="st">"ns(BMI, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 24%">
<col style="width: 23%">
<col style="width: 15%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">BMI</td>
<td style="text-align: left;">ns(BMI, df = 2)</td>
<td style="text-align: right;">-679.35</td>
<td style="text-align: right;">0.083</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.773</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_hard</span>, remove <span class="op">=</span> <span class="st">"FC"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">FC</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: right;">-674.362</td>
<td style="text-align: right;">10.059</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.002</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># dqi_tot</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_hard</span>, remove <span class="op">=</span> <span class="st">"dqi_tot"</span>, add <span class="op">=</span> <span class="st">"ns(dqi_tot, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 28%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: left;">ns(dqi_tot, df = 2)</td>
<td style="text-align: right;">-679.074</td>
<td style="text-align: right;">0.635</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.426</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC benefits from a spline</span></span>
<span><span class="va">cox_uc_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_hard</span>, remove <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 3)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: left;">ns(FC, df = 3)</td>
<td style="text-align: right;">-673.943</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.36</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Test for df = 3. df = 2 is sufficient for FC</span></span>
<span><span class="co"># FC</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_uc_hard</span>, remove <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span>, add <span class="op">=</span> <span class="st">"ns(FC, df = 3)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">ns(FC, df = 2)</td>
<td style="text-align: left;">ns(FC, df = 3)</td>
<td style="text-align: right;">-673.943</td>
<td style="text-align: right;">0.838</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.36</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Age</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"age_decade"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Age (decades)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># BMI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"BMI"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># FC</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"FC"</span>,</span>
<span>  splineterm <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># DQI</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span> </span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"dqi_tot"</span></span>
<span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Diet quality index"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="total-meat-protein" class="level2"><h2 class="anchored" data-anchor-id="total-meat-protein">Total meat protein</h2>
<p>This section examines the association between total meat protein intake (grams per day) and time to flare. Cox models are adjusted for sex, Index of Multiple Deprivation (IMD), age, BMI, FC (continuous), and diet quality index, with a frailty term for study site. We first test whether the relationship is non-linear using splines, then present hazard ratios and continuous HR curves.</p>
<section id="crohns-disease-2" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease-2">Crohn’s disease</h3>
<section id="patient-reported-flare-3" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-3">Patient reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_cd_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">Meat_sum</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_meat_cd_soft</span>, remove <span class="op">=</span> <span class="st">"Meat_sum"</span>, add <span class="op">=</span> <span class="st">"ns(Meat_sum, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: left;">ns(Meat_sum, df = 2)</td>
<td style="text-align: right;">-1013.017</td>
<td style="text-align: right;">0.179</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.672</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_cd_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.873</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">13.561</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.341</td>
<td style="text-align: right;">2.617</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.704</td>
<td style="text-align: right;">0.333</td>
<td style="text-align: right;">1.115</td>
<td style="text-align: right;">0.291</td>
<td style="text-align: right;">0.367</td>
<td style="text-align: right;">1.351</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.658</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">1.496</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.954</td>
<td style="text-align: right;">0.284</td>
<td style="text-align: right;">0.027</td>
<td style="text-align: right;">0.869</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">1.666</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">1.032</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">0.561</td>
<td style="text-align: right;">0.927</td>
<td style="text-align: right;">1.150</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.008</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.298</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: right;">0.980</td>
<td style="text-align: right;">1.037</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.267</td>
<td style="text-align: right;">0.061</td>
<td style="text-align: right;">14.821</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.123</td>
<td style="text-align: right;">1.429</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: right;">0.999</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.821</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">1.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.006</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">0.403</td>
<td style="text-align: right;">0.992</td>
<td style="text-align: right;">1.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Meat sum</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span></span>
<span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Total meat protein (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-1" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-1">Objective flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_cd_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">Meat_sum</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_meat_cd_hard</span>, remove <span class="op">=</span> <span class="st">"Meat_sum"</span>, add <span class="op">=</span> <span class="st">"ns(Meat_sum, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 29%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 6%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: left;">ns(Meat_sum, df = 2)</td>
<td style="text-align: right;">-591.46</td>
<td style="text-align: right;">0.327</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.58</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_cd_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.274</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">1.327</td>
<td style="text-align: right;">0.249</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">1.922</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.601</td>
<td style="text-align: right;">0.437</td>
<td style="text-align: right;">1.355</td>
<td style="text-align: right;">0.244</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: right;">1.416</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.759</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">0.459</td>
<td style="text-align: right;">0.498</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">1.684</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.730</td>
<td style="text-align: right;">0.399</td>
<td style="text-align: right;">0.618</td>
<td style="text-align: right;">0.432</td>
<td style="text-align: right;">0.334</td>
<td style="text-align: right;">1.598</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.716</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.342</td>
<td style="text-align: right;">1.497</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">2.850</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">0.776</td>
<td style="text-align: right;">1.019</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.024</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">1.753</td>
<td style="text-align: right;">0.186</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">1.060</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.411</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">19.058</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.209</td>
<td style="text-align: right;">1.647</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: right;">0.997</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">0.513</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">1.006</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.005</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">1.023</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">7.459</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Meat sum</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Total meat protein (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ulcerative-colitis-1" class="level3"><h3 class="anchored" data-anchor-id="ulcerative-colitis-1">Ulcerative colitis</h3>
<section id="patient-reported-flare-4" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-4">Patient reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_uc_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">Meat_sum</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">dqi_tot</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_meat_uc_soft</span>, remove <span class="op">=</span> <span class="st">"Meat_sum"</span>, add <span class="op">=</span> <span class="st">"ns(Meat_sum, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: left;">ns(Meat_sum, df = 2)</td>
<td style="text-align: right;">-1222.919</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.679</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_uc_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.639</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">10.968</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.224</td>
<td style="text-align: right;">2.196</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.323</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">0.711</td>
<td style="text-align: right;">0.399</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">2.538</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.114</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.591</td>
<td style="text-align: right;">2.102</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">1.301</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.390</td>
<td style="text-align: right;">0.714</td>
<td style="text-align: right;">2.369</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.180</td>
<td style="text-align: right;">0.302</td>
<td style="text-align: right;">0.301</td>
<td style="text-align: right;">0.583</td>
<td style="text-align: right;">0.653</td>
<td style="text-align: right;">2.131</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.872</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">7.866</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.959</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.921</td>
<td style="text-align: right;">0.337</td>
<td style="text-align: right;">0.956</td>
<td style="text-align: right;">1.016</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">7.646</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: right;">22.820</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.319</td>
<td style="text-align: right;">17.616</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.856</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">0.275</td>
<td style="text-align: right;">2.658</td>
</tr>
<tr class="even">
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: right;">1.001</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.690</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">1.007</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(dqi_tot, df = 2)1</td>
<td style="text-align: right;">2.971</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">2.431</td>
<td style="text-align: right;">0.119</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">11.679</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(dqi_tot, df = 2)2</td>
<td style="text-align: right;">0.797</td>
<td style="text-align: right;">0.336</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">0.499</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">1.539</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Meat sum</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Total meat protein (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-2" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-2">Objective flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_uc_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">Meat_sum</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_meat_uc_hard</span>, remove <span class="op">=</span> <span class="st">"Meat_sum"</span>, add <span class="op">=</span> <span class="st">"ns(Meat_sum, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 28%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: left;">ns(Meat_sum, df = 2)</td>
<td style="text-align: right;">-671.444</td>
<td style="text-align: right;">0.038</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">0.846</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_meat_uc_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.236</td>
<td style="text-align: right;">0.195</td>
<td style="text-align: right;">1.184</td>
<td style="text-align: right;">0.277</td>
<td style="text-align: right;">0.844</td>
<td style="text-align: right;">1.812</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.535</td>
<td style="text-align: right;">0.493</td>
<td style="text-align: right;">0.755</td>
<td style="text-align: right;">0.385</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">4.035</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.361</td>
<td style="text-align: right;">0.480</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.521</td>
<td style="text-align: right;">0.531</td>
<td style="text-align: right;">3.488</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">2.428</td>
<td style="text-align: right;">0.448</td>
<td style="text-align: right;">3.922</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">1.009</td>
<td style="text-align: right;">5.842</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.582</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">1.046</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.657</td>
<td style="text-align: right;">3.811</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">9.082</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.715</td>
<td style="text-align: right;">0.931</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.972</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">1.715</td>
<td style="text-align: right;">0.190</td>
<td style="text-align: right;">0.931</td>
<td style="text-align: right;">1.014</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">12.562</td>
<td style="text-align: right;">0.584</td>
<td style="text-align: right;">18.782</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.000</td>
<td style="text-align: right;">39.455</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.143</td>
<td style="text-align: right;">3.281</td>
</tr>
<tr class="even">
<td style="text-align: left;">Meat_sum</td>
<td style="text-align: right;">1.010</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">6.062</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">1.017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.011</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">1.516</td>
<td style="text-align: right;">0.218</td>
<td style="text-align: right;">0.993</td>
<td style="text-align: right;">1.030</td>
</tr>
<tr class="even">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.423</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Meat sum</span></span>
<span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Total meat protein (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb55"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"FC"</span>,</span>
<span>  splineterm <span class="op">=</span> <span class="st">"ns(FC, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-23-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="dietary-fibre" class="level2"><h2 class="anchored" data-anchor-id="dietary-fibre">Dietary Fibre</h2>
<p>This section examines the association between dietary fibre intake (grams per day) and time to flare, using the same covariate adjustment strategy as the meat protein analysis.</p>
<section id="crohns-disease-3" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease-3">Crohn’s disease</h3>
<section id="patient-reported-flare-5" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-5">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_cd_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">fibre</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_fibre_cd_soft</span>, remove <span class="op">=</span> <span class="st">"fibre"</span>, add <span class="op">=</span> <span class="st">"ns(fibre, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">fibre</td>
<td style="text-align: left;">ns(fibre, df = 2)</td>
<td style="text-align: right;">-1013.013</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.965</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb57"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_cd_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.897</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">14.013</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.357</td>
<td style="text-align: right;">2.653</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.712</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">1.053</td>
<td style="text-align: right;">0.305</td>
<td style="text-align: right;">0.372</td>
<td style="text-align: right;">1.363</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.910</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">0.758</td>
<td style="text-align: right;">0.500</td>
<td style="text-align: right;">1.657</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.826</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">0.530</td>
<td style="text-align: right;">0.456</td>
<td style="text-align: right;">1.499</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.962</td>
<td style="text-align: right;">0.284</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">0.892</td>
<td style="text-align: right;">0.552</td>
<td style="text-align: right;">1.678</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">1.034</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.371</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.928</td>
<td style="text-align: right;">1.152</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.007</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.268</td>
<td style="text-align: right;">0.605</td>
<td style="text-align: right;">0.980</td>
<td style="text-align: right;">1.036</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.268</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">14.852</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.124</td>
<td style="text-align: right;">1.431</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fibre</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.242</td>
<td style="text-align: right;">0.623</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">1.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.005</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">0.540</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">1.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Dietary fibre"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-3" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-3">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_cd_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">fibre</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_fibre_cd_hard</span>, remove <span class="op">=</span> <span class="st">"fibre"</span>, add <span class="op">=</span> <span class="st">"ns(fibre, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 25%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">fibre</td>
<td style="text-align: left;">ns(fibre, df = 2)</td>
<td style="text-align: right;">-590.177</td>
<td style="text-align: right;">2.044</td>
<td style="text-align: right;">1.014</td>
<td style="text-align: right;">0.155</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_cd_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.310</td>
<td style="text-align: right;">0.212</td>
<td style="text-align: right;">1.625</td>
<td style="text-align: right;">0.202</td>
<td style="text-align: right;">0.865</td>
<td style="text-align: right;">1.983</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.651</td>
<td style="text-align: right;">0.432</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: right;">0.321</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">1.520</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.798</td>
<td style="text-align: right;">0.407</td>
<td style="text-align: right;">0.309</td>
<td style="text-align: right;">0.578</td>
<td style="text-align: right;">0.360</td>
<td style="text-align: right;">1.770</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">0.396</td>
<td style="text-align: right;">0.363</td>
<td style="text-align: right;">0.547</td>
<td style="text-align: right;">0.363</td>
<td style="text-align: right;">1.712</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.514</td>
<td style="text-align: right;">0.474</td>
<td style="text-align: right;">0.367</td>
<td style="text-align: right;">1.592</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.892</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">2.693</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">1.022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.023</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">1.647</td>
<td style="text-align: right;">0.199</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">1.059</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.410</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">18.897</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.208</td>
<td style="text-align: right;">1.647</td>
</tr>
<tr class="odd">
<td style="text-align: left;">fibre</td>
<td style="text-align: right;">1.005</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.278</td>
<td style="text-align: right;">0.598</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">1.025</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">0.010</td>
<td style="text-align: right;">0.164</td>
<td style="text-align: right;">0.686</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">1.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8.196</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Dietary fibre (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ulcerative-colitis-2" class="level3"><h3 class="anchored" data-anchor-id="ulcerative-colitis-2">Ulcerative colitis</h3>
<section id="patient-reported-flare-6" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-6">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_uc_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">fibre</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">dqi_tot</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_fibre_uc_soft</span>, remove <span class="op">=</span> <span class="st">"fibre"</span>, add <span class="op">=</span> <span class="st">"ns(fibre, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">fibre</td>
<td style="text-align: left;">ns(fibre, df = 2)</td>
<td style="text-align: right;">-1223.058</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.827</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb63"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_uc_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.629</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">10.737</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.217</td>
<td style="text-align: right;">2.181</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.302</td>
<td style="text-align: right;">0.330</td>
<td style="text-align: right;">0.641</td>
<td style="text-align: right;">0.423</td>
<td style="text-align: right;">0.682</td>
<td style="text-align: right;">2.484</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.106</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.097</td>
<td style="text-align: right;">0.755</td>
<td style="text-align: right;">0.587</td>
<td style="text-align: right;">2.086</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">1.284</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.674</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.707</td>
<td style="text-align: right;">2.329</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.171</td>
<td style="text-align: right;">0.302</td>
<td style="text-align: right;">0.273</td>
<td style="text-align: right;">0.601</td>
<td style="text-align: right;">0.648</td>
<td style="text-align: right;">2.116</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.871</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">7.889</td>
<td style="text-align: right;">0.005</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.959</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.871</td>
<td style="text-align: right;">0.351</td>
<td style="text-align: right;">0.957</td>
<td style="text-align: right;">1.016</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">7.708</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: right;">23.033</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.348</td>
<td style="text-align: right;">17.749</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">0.760</td>
<td style="text-align: right;">0.267</td>
<td style="text-align: right;">2.620</td>
</tr>
<tr class="even">
<td style="text-align: left;">fibre</td>
<td style="text-align: right;">1.000</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.964</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">1.015</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(dqi_tot, df = 2)1</td>
<td style="text-align: right;">2.840</td>
<td style="text-align: right;">0.710</td>
<td style="text-align: right;">2.161</td>
<td style="text-align: right;">0.142</td>
<td style="text-align: right;">0.706</td>
<td style="text-align: right;">11.421</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(dqi_tot, df = 2)2</td>
<td style="text-align: right;">0.774</td>
<td style="text-align: right;">0.349</td>
<td style="text-align: right;">0.539</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">0.391</td>
<td style="text-align: right;">1.534</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Dietary fibre (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-4" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-4">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_uc_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">fibre</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_fibre_uc_hard</span>, remove <span class="op">=</span> <span class="st">"fibre"</span>, add <span class="op">=</span> <span class="st">"ns(fibre, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 13%">
<col style="width: 26%">
<col style="width: 22%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">fibre</td>
<td style="text-align: left;">ns(fibre, df = 2)</td>
<td style="text-align: right;">-674.129</td>
<td style="text-align: right;">0.424</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.515</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_fibre_uc_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.164</td>
<td style="text-align: right;">0.194</td>
<td style="text-align: right;">0.617</td>
<td style="text-align: right;">0.432</td>
<td style="text-align: right;">0.797</td>
<td style="text-align: right;">1.702</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.380</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.434</td>
<td style="text-align: right;">0.510</td>
<td style="text-align: right;">0.529</td>
<td style="text-align: right;">3.595</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.240</td>
<td style="text-align: right;">0.477</td>
<td style="text-align: right;">0.204</td>
<td style="text-align: right;">0.652</td>
<td style="text-align: right;">0.487</td>
<td style="text-align: right;">3.157</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">2.164</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">3.057</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">5.143</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.469</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">0.745</td>
<td style="text-align: right;">0.388</td>
<td style="text-align: right;">0.613</td>
<td style="text-align: right;">3.519</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">9.879</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.707</td>
<td style="text-align: right;">0.923</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.975</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">1.293</td>
<td style="text-align: right;">0.256</td>
<td style="text-align: right;">0.934</td>
<td style="text-align: right;">1.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">14.266</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: right;">20.638</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.532</td>
<td style="text-align: right;">44.905</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.538</td>
<td style="text-align: right;">0.795</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.435</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">2.554</td>
</tr>
<tr class="even">
<td style="text-align: left;">fibre</td>
<td style="text-align: right;">1.002</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.042</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.984</td>
<td style="text-align: right;">1.020</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.005</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.318</td>
<td style="text-align: right;">0.573</td>
<td style="text-align: right;">0.987</td>
<td style="text-align: right;">1.024</td>
</tr>
<tr class="even">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.921</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb67"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"Dietary fibre (grams)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="polyunsaturated-fatty-acids" class="level2"><h2 class="anchored" data-anchor-id="polyunsaturated-fatty-acids">Polyunsaturated fatty acids</h2>
<p>This section examines the association between PUFA intake (as percentage of total energy) and time to flare. Note that while the study protocol specified n-6 PUFAs, the available FFQ data captures total PUFA (both n-3 and n-6).</p>
<section id="crohns-disease-4" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease-4">Crohn’s disease</h3>
<section id="patient-reported-flare-7" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-7">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_cd_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">PUFA_percEng</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? Close to 0.05, lets add one</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_pufa_cd_soft</span>,</span>
<span>  remove <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 32%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 2)</td>
<td style="text-align: right;">-1011.464</td>
<td style="text-align: right;">3.29</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.07</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb69"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_cd_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">PUFA_percEng</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># df = 2 is sufficient</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_pufa_cd_soft</span>,</span>
<span>  remove <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 3)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 5%">
<col style="width: 27%">
<col style="width: 27%">
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 3%">
<col style="width: 7%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 2)</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 3)</td>
<td style="text-align: right;">-1011.482</td>
<td style="text-align: right;">0.036</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.85</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_cd_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 34%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 10%">
<col style="width: 7%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.916</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">14.588</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.373</td>
<td style="text-align: right;">2.676</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.697</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">1.185</td>
<td style="text-align: right;">0.276</td>
<td style="text-align: right;">0.364</td>
<td style="text-align: right;">1.335</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.919</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.782</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">1.674</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.840</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.330</td>
<td style="text-align: right;">0.566</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">1.525</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.973</td>
<td style="text-align: right;">0.285</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.924</td>
<td style="text-align: right;">0.557</td>
<td style="text-align: right;">1.701</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">1.028</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.923</td>
<td style="text-align: right;">1.145</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.010</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.535</td>
<td style="text-align: right;">0.464</td>
<td style="text-align: right;">0.983</td>
<td style="text-align: right;">1.039</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.263</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">14.160</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.118</td>
<td style="text-align: right;">1.426</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(PUFA_percEng, df = 2)1</td>
<td style="text-align: right;">0.417</td>
<td style="text-align: right;">0.858</td>
<td style="text-align: right;">1.041</td>
<td style="text-align: right;">0.308</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">2.240</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(PUFA_percEng, df = 2)2</td>
<td style="text-align: right;">3.814</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">2.963</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.831</td>
<td style="text-align: right;">17.507</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.005</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">0.501</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">1.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb71"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Significance - need to use LRT</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_pufa_cd_soft</span>, remove <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 35%">
<col style="width: 8%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 2)</td>
<td style="text-align: left;">NA</td>
<td style="text-align: right;">-1013.132</td>
<td style="text-align: right;">3.338</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.188</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb72"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  splineterm <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"PUFA"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-5" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-5">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb73"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_cd_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">PUFA_percEng</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_pufa_cd_hard</span>,</span>
<span>  remove <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 30%">
<col style="width: 18%">
<col style="width: 12%">
<col style="width: 7%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 2)</td>
<td style="text-align: right;">-590.441</td>
<td style="text-align: right;">0.698</td>
<td style="text-align: right;">0.891</td>
<td style="text-align: right;">0.362</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb74"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_cd_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.298</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">1.544</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: right;">0.860</td>
<td style="text-align: right;">1.957</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.657</td>
<td style="text-align: right;">0.431</td>
<td style="text-align: right;">0.952</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">0.282</td>
<td style="text-align: right;">1.528</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.822</td>
<td style="text-align: right;">0.409</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.631</td>
<td style="text-align: right;">0.369</td>
<td style="text-align: right;">1.830</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">0.398</td>
<td style="text-align: right;">0.279</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.372</td>
<td style="text-align: right;">1.767</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.778</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">0.450</td>
<td style="text-align: right;">0.502</td>
<td style="text-align: right;">0.374</td>
<td style="text-align: right;">1.619</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.895</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">2.530</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">0.780</td>
<td style="text-align: right;">1.026</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.024</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">1.837</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">1.061</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.396</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">17.689</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.195</td>
<td style="text-align: right;">1.632</td>
</tr>
<tr class="odd">
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: right;">1.068</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.390</td>
<td style="text-align: right;">0.919</td>
<td style="text-align: right;">1.240</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.006</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.401</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">1.024</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">8.580</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb75"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"PUFA"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ulcerative-colitis-3" class="level3"><h3 class="anchored" data-anchor-id="ulcerative-colitis-3">Ulcerative colitis</h3>
<section id="patient-reported-flare-8" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-8">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb76"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_uc_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">PUFA_percEng</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">dqi_tot</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_pufa_uc_soft</span>,</span>
<span>  remove <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 32%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 2)</td>
<td style="text-align: right;">-1222.426</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.638</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb77"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_uc_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.628</td>
<td style="text-align: right;">0.148</td>
<td style="text-align: right;">10.807</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.218</td>
<td style="text-align: right;">2.178</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.340</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.783</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">0.701</td>
<td style="text-align: right;">2.561</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.112</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.743</td>
<td style="text-align: right;">0.590</td>
<td style="text-align: right;">2.096</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">1.301</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.748</td>
<td style="text-align: right;">0.387</td>
<td style="text-align: right;">0.717</td>
<td style="text-align: right;">2.360</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.185</td>
<td style="text-align: right;">0.301</td>
<td style="text-align: right;">0.316</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">0.657</td>
<td style="text-align: right;">2.137</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.877</td>
<td style="text-align: right;">0.050</td>
<td style="text-align: right;">6.954</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">0.967</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.653</td>
<td style="text-align: right;">0.419</td>
<td style="text-align: right;">0.958</td>
<td style="text-align: right;">1.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">8.000</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">23.648</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.460</td>
<td style="text-align: right;">18.497</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.839</td>
<td style="text-align: right;">0.577</td>
<td style="text-align: right;">0.092</td>
<td style="text-align: right;">0.761</td>
<td style="text-align: right;">0.271</td>
<td style="text-align: right;">2.600</td>
</tr>
<tr class="even">
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: right;">1.058</td>
<td style="text-align: right;">0.053</td>
<td style="text-align: right;">1.126</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.953</td>
<td style="text-align: right;">1.175</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(dqi_tot, df = 2)1</td>
<td style="text-align: right;">2.779</td>
<td style="text-align: right;">0.692</td>
<td style="text-align: right;">2.184</td>
<td style="text-align: right;">0.139</td>
<td style="text-align: right;">0.716</td>
<td style="text-align: right;">10.779</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(dqi_tot, df = 2)2</td>
<td style="text-align: right;">0.782</td>
<td style="text-align: right;">0.331</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.459</td>
<td style="text-align: right;">0.409</td>
<td style="text-align: right;">1.497</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.914</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb78"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"PUFA"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-6" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-6">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb79"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_uc_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">PUFA_percEng</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_pufa_uc_hard</span>,</span>
<span>  remove <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  add <span class="op">=</span> <span class="st">"ns(PUFA_percEng, df = 2)"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 16%">
<col style="width: 32%">
<col style="width: 19%">
<col style="width: 12%">
<col style="width: 3%">
<col style="width: 8%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: left;">ns(PUFA_percEng, df = 2)</td>
<td style="text-align: right;">-673.44</td>
<td style="text-align: right;">1.585</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.208</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb80"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_pufa_uc_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.161</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.600</td>
<td style="text-align: right;">0.439</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">1.695</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.369</td>
<td style="text-align: right;">0.489</td>
<td style="text-align: right;">0.412</td>
<td style="text-align: right;">0.521</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">3.569</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.241</td>
<td style="text-align: right;">0.476</td>
<td style="text-align: right;">0.205</td>
<td style="text-align: right;">0.651</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: right;">3.157</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">2.155</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">3.018</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.906</td>
<td style="text-align: right;">5.122</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.471</td>
<td style="text-align: right;">0.446</td>
<td style="text-align: right;">0.750</td>
<td style="text-align: right;">0.387</td>
<td style="text-align: right;">0.614</td>
<td style="text-align: right;">3.524</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.804</td>
<td style="text-align: right;">0.068</td>
<td style="text-align: right;">10.233</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.703</td>
<td style="text-align: right;">0.919</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.974</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">1.393</td>
<td style="text-align: right;">0.238</td>
<td style="text-align: right;">0.933</td>
<td style="text-align: right;">1.017</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">14.159</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: right;">20.538</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.500</td>
<td style="text-align: right;">44.548</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.452</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">2.599</td>
</tr>
<tr class="even">
<td style="text-align: left;">PUFA_percEng</td>
<td style="text-align: right;">0.961</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.614</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">1.121</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.006</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.440</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.989</td>
<td style="text-align: right;">1.023</td>
</tr>
<tr class="even">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.921</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb81"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section><section id="ultra-processed-food" class="level2"><h2 class="anchored" data-anchor-id="ultra-processed-food">Ultra-processed food</h2>
<p>This section examines the association between ultra-processed food consumption (percentage of daily energy intake from UPF) and time to flare. UPF is defined according to the NOVA classification system as foods that have undergone substantial industrial processing.</p>
<section id="crohns-disease-5" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease-5">Crohn’s disease</h3>
<section id="patient-reported-flare-9" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-9">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb82"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_cd_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">UPF_perc</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No </span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_upf_cd_soft</span>, remove <span class="op">=</span> <span class="st">"UPF_perc"</span>, add <span class="op">=</span> <span class="st">"ns(UPF_perc, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: left;">ns(UPF_perc, df = 2)</td>
<td style="text-align: right;">-1012.525</td>
<td style="text-align: right;">0.861</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.354</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb83"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_cd_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.903</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">14.097</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.360</td>
<td style="text-align: right;">2.663</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.703</td>
<td style="text-align: right;">0.332</td>
<td style="text-align: right;">1.126</td>
<td style="text-align: right;">0.289</td>
<td style="text-align: right;">0.367</td>
<td style="text-align: right;">1.347</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.903</td>
<td style="text-align: right;">0.306</td>
<td style="text-align: right;">0.112</td>
<td style="text-align: right;">0.738</td>
<td style="text-align: right;">0.496</td>
<td style="text-align: right;">1.644</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.824</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.405</td>
<td style="text-align: right;">0.525</td>
<td style="text-align: right;">0.454</td>
<td style="text-align: right;">1.495</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.956</td>
<td style="text-align: right;">0.284</td>
<td style="text-align: right;">0.026</td>
<td style="text-align: right;">0.873</td>
<td style="text-align: right;">0.548</td>
<td style="text-align: right;">1.666</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">1.038</td>
<td style="text-align: right;">0.055</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.503</td>
<td style="text-align: right;">0.931</td>
<td style="text-align: right;">1.157</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.006</td>
<td style="text-align: right;">0.014</td>
<td style="text-align: right;">0.191</td>
<td style="text-align: right;">0.662</td>
<td style="text-align: right;">0.978</td>
<td style="text-align: right;">1.035</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.270</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">15.053</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.125</td>
<td style="text-align: right;">1.433</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">0.353</td>
<td style="text-align: right;">0.553</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">1.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.007</td>
<td style="text-align: right;">0.007</td>
<td style="text-align: right;">1.017</td>
<td style="text-align: right;">0.313</td>
<td style="text-align: right;">0.993</td>
<td style="text-align: right;">1.022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.915</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb84"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_cd_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"UPF (%)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-7" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-7">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb85"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_cd_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="va">FC</span> <span class="op">+</span></span>
<span>    <span class="va">UPF_perc</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_upf_cd_hard</span>, remove <span class="op">=</span> <span class="st">"UPF_perc"</span>, add <span class="op">=</span> <span class="st">"ns(UPF_perc, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 6%">
<col style="width: 12%">
<col style="width: 28%">
<col style="width: 20%">
<col style="width: 13%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: left;">ns(UPF_perc, df = 2)</td>
<td style="text-align: right;">-591.249</td>
<td style="text-align: right;">0.634</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: right;">0.471</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb86"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_cd_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.247</td>
<td style="text-align: right;">0.210</td>
<td style="text-align: right;">1.102</td>
<td style="text-align: right;">0.294</td>
<td style="text-align: right;">0.826</td>
<td style="text-align: right;">1.884</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">0.651</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">1.006</td>
<td style="text-align: right;">0.316</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">1.507</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">0.404</td>
<td style="text-align: right;">0.359</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.356</td>
<td style="text-align: right;">1.732</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">0.770</td>
<td style="text-align: right;">0.392</td>
<td style="text-align: right;">0.444</td>
<td style="text-align: right;">0.505</td>
<td style="text-align: right;">0.357</td>
<td style="text-align: right;">1.660</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">0.746</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0.629</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">0.361</td>
<td style="text-align: right;">1.539</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.881</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">3.287</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.767</td>
<td style="text-align: right;">1.010</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">1.027</td>
<td style="text-align: right;">0.018</td>
<td style="text-align: right;">2.181</td>
<td style="text-align: right;">0.140</td>
<td style="text-align: right;">0.991</td>
<td style="text-align: right;">1.063</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: right;">1.394</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">17.515</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.193</td>
<td style="text-align: right;">1.629</td>
</tr>
<tr class="odd">
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">1.305</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.973</td>
<td style="text-align: right;">1.007</td>
</tr>
<tr class="even">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.003</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.099</td>
<td style="text-align: right;">0.753</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">1.022</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">7.059</td>
<td style="text-align: right;">0.206</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb87"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_cd_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"UPF (%)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ulcerative-colitis-4" class="level3"><h3 class="anchored" data-anchor-id="ulcerative-colitis-4">Ulcerative colitis</h3>
<section id="patient-reported-flare-10" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-10">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb88"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_uc_soft</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">softflare_time</span>, <span class="va">softflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">UPF_perc</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">dqi_tot</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_upf_uc_soft</span>, remove <span class="op">=</span> <span class="st">"UPF_perc"</span>, add <span class="op">=</span> <span class="st">"ns(UPF_perc, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: left;">ns(UPF_perc, df = 2)</td>
<td style="text-align: right;">-1218.611</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.98</td>
</tr></tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb89"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_uc_soft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 29%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 8%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.649</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">11.284</td>
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">1.232</td>
<td style="text-align: right;">2.208</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.305</td>
<td style="text-align: right;">0.329</td>
<td style="text-align: right;">0.655</td>
<td style="text-align: right;">0.418</td>
<td style="text-align: right;">0.685</td>
<td style="text-align: right;">2.486</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.062</td>
<td style="text-align: right;">0.323</td>
<td style="text-align: right;">0.035</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.564</td>
<td style="text-align: right;">2.002</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">1.276</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.645</td>
<td style="text-align: right;">0.422</td>
<td style="text-align: right;">0.704</td>
<td style="text-align: right;">2.315</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.114</td>
<td style="text-align: right;">0.302</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">0.721</td>
<td style="text-align: right;">0.617</td>
<td style="text-align: right;">2.011</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.871</td>
<td style="text-align: right;">0.049</td>
<td style="text-align: right;">8.120</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.791</td>
<td style="text-align: right;">0.958</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.988</td>
<td style="text-align: right;">0.015</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: right;">0.449</td>
<td style="text-align: right;">0.959</td>
<td style="text-align: right;">1.019</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">8.988</td>
<td style="text-align: right;">0.428</td>
<td style="text-align: right;">26.291</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">3.883</td>
<td style="text-align: right;">20.807</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.817</td>
<td style="text-align: right;">0.580</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">0.728</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">2.545</td>
</tr>
<tr class="even">
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: right;">0.982</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">8.922</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.970</td>
<td style="text-align: right;">0.994</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(dqi_tot, df = 2)1</td>
<td style="text-align: right;">1.999</td>
<td style="text-align: right;">0.703</td>
<td style="text-align: right;">0.971</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">7.930</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(dqi_tot, df = 2)2</td>
<td style="text-align: right;">0.671</td>
<td style="text-align: right;">0.334</td>
<td style="text-align: right;">1.430</td>
<td style="text-align: right;">0.232</td>
<td style="text-align: right;">0.348</td>
<td style="text-align: right;">1.291</td>
</tr>
<tr class="odd">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.912</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb90"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_uc_soft</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"UPF (%)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-8" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-8">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb91"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_uc_hard</span> <span class="op">&lt;-</span> <span class="fu">coxph</span><span class="op">(</span></span>
<span>  <span class="fu">Surv</span><span class="op">(</span><span class="va">hardflare_time</span>, <span class="va">hardflare</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="va">Sex</span> <span class="op">+</span></span>
<span>    <span class="va">IMD</span> <span class="op">+</span></span>
<span>    <span class="va">age_decade</span> <span class="op">+</span></span>
<span>    <span class="va">BMI</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/splines/ns.html">ns</a></span><span class="op">(</span><span class="va">FC</span>, df <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">UPF_perc</span> <span class="op">+</span></span>
<span>    <span class="va">dqi_tot</span> <span class="op">+</span></span>
<span>    <span class="fu">frailty</span><span class="op">(</span><span class="va">SiteNo</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Do we need a spline? No</span></span>
<span><span class="fu">summon_lrt</span><span class="op">(</span><span class="va">cox_upf_uc_hard</span>, remove <span class="op">=</span> <span class="st">"UPF_perc"</span>, add <span class="op">=</span> <span class="st">"ns(UPF_perc, df = 2)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 7%">
<col style="width: 12%">
<col style="width: 30%">
<col style="width: 21%">
<col style="width: 14%">
<col style="width: 4%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Test</th>
<th style="text-align: left;">Remolved</th>
<th style="text-align: left;">Added</th>
<th style="text-align: right;">Log-likelihood</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">DF</th>
<th style="text-align: right;">p-vaue</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">LRT</td>
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: left;">ns(UPF_perc, df = 2)</td>
<td style="text-align: right;">-673.452</td>
<td style="text-align: right;">0.326</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.568</td>
</tr></tbody>
</table>
</div>
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb92"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cox_upf_uc_hard</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span>exp <span class="op">=</span> <span class="cn">TRUE</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>  <span class="op">%&gt;%</span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span>col.names <span class="op">=</span> <span class="va">broom.cols</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 24%">
<col style="width: 13%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 9%">
<col style="width: 10%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std error</th>
<th style="text-align: right;">Statistic</th>
<th style="text-align: right;">p-value</th>
<th style="text-align: right;">Lower</th>
<th style="text-align: right;">Upper</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">SexFemale</td>
<td style="text-align: right;">1.151</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">0.527</td>
<td style="text-align: right;">0.468</td>
<td style="text-align: right;">0.788</td>
<td style="text-align: right;">1.680</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD2</td>
<td style="text-align: right;">1.344</td>
<td style="text-align: right;">0.488</td>
<td style="text-align: right;">0.367</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">0.516</td>
<td style="text-align: right;">3.501</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD3</td>
<td style="text-align: right;">1.199</td>
<td style="text-align: right;">0.478</td>
<td style="text-align: right;">0.144</td>
<td style="text-align: right;">0.705</td>
<td style="text-align: right;">0.470</td>
<td style="text-align: right;">3.056</td>
</tr>
<tr class="even">
<td style="text-align: left;">IMD4</td>
<td style="text-align: right;">2.140</td>
<td style="text-align: right;">0.442</td>
<td style="text-align: right;">2.968</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.901</td>
<td style="text-align: right;">5.086</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IMD5</td>
<td style="text-align: right;">1.418</td>
<td style="text-align: right;">0.447</td>
<td style="text-align: right;">0.610</td>
<td style="text-align: right;">0.435</td>
<td style="text-align: right;">0.590</td>
<td style="text-align: right;">3.403</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_decade</td>
<td style="text-align: right;">0.808</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">10.036</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.707</td>
<td style="text-align: right;">0.922</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BMI</td>
<td style="text-align: right;">0.976</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">1.258</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">0.935</td>
<td style="text-align: right;">1.018</td>
</tr>
<tr class="even">
<td style="text-align: left;">ns(FC, df = 2)1</td>
<td style="text-align: right;">14.861</td>
<td style="text-align: right;">0.585</td>
<td style="text-align: right;">21.281</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">4.722</td>
<td style="text-align: right;">46.775</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ns(FC, df = 2)2</td>
<td style="text-align: right;">0.542</td>
<td style="text-align: right;">0.792</td>
<td style="text-align: right;">0.599</td>
<td style="text-align: right;">0.439</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">2.559</td>
</tr>
<tr class="even">
<td style="text-align: left;">UPF_perc</td>
<td style="text-align: right;">0.990</td>
<td style="text-align: right;">0.008</td>
<td style="text-align: right;">1.495</td>
<td style="text-align: right;">0.221</td>
<td style="text-align: right;">0.974</td>
<td style="text-align: right;">1.006</td>
</tr>
<tr class="odd">
<td style="text-align: left;">dqi_tot</td>
<td style="text-align: right;">1.004</td>
<td style="text-align: right;">0.009</td>
<td style="text-align: right;">0.183</td>
<td style="text-align: right;">0.668</td>
<td style="text-align: right;">0.986</td>
<td style="text-align: right;">1.022</td>
</tr>
<tr class="even">
<td style="text-align: left;">frailty(SiteNo)</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.921</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb93"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">plot_continuous_hr</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_uc_hard</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">xlab</span><span class="op">(</span><span class="st">"UPF (%)"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section></section></section><section id="results" class="level1"><h1>Results</h1>
<section id="risk-difference" class="level2"><h2 class="anchored" data-anchor-id="risk-difference">Risk difference</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb94"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># How many bootstraps</span></span>
<span><span class="va">nboot</span> <span class="op">&lt;-</span> <span class="fl">199</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Risk differences quantify the absolute change in cumulative incidence of flare at a specific time point (1 year) associated with different levels of each dietary exposure. These are population-averaged estimates obtained by:</p>
<ol type="1">
<li>Predicting individual-level survival for each participant at specified dietary exposure values</li>
<li>Averaging across the population to obtain mean cumulative incidence</li>
<li>Calculating differences relative to a reference value (median)</li>
<li>Bootstrapping to obtain 95% confidence intervals</li>
</ol>
<p>Results are presented as forest plots with corresponding risk difference values and confidence intervals.</p>
<section id="crohns-disease-6" class="level3"><h3 class="anchored" data-anchor-id="crohns-disease-6">Crohn’s disease</h3>
<section id="patient-reported-flare-11" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-11">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb95"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Values for calculation risk difference</span></span>
<span><span class="va">rd_values_meat_cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span></span>
<span>  <span class="va">flare.cd.df</span><span class="op">$</span><span class="va">Meat_sum</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rd_values_fibre_cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span></span>
<span>  <span class="va">flare.cd.df</span><span class="op">$</span><span class="va">fibre</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rd_values_pufa_cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span></span>
<span>  <span class="va">flare.cd.df</span><span class="op">$</span><span class="va">PUFA_percEng</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rd_values_upf_cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span></span>
<span>  <span class="va">flare.cd.df</span><span class="op">$</span><span class="va">UPF_perc</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate risk difference for these values</span></span>
<span><span class="va">data_rd_cd_soft_meat</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_cd_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_meat_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Total meat protein: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_cd_soft_fibre</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_cd_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_fibre_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Dietary fibre: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_cd_soft_pufa</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_cd_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_pufa_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"PUFA: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_cd_soft_upf</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_cd_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_upf_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"UPF (%): "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Creating combined forest plot</span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_cd_soft_meat_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_soft_meat</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_cd_soft_fibre_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_soft_fibre</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_cd_soft_pufa_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_soft_pufa</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_cd_soft_upf_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_soft_upf</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb96"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Final plots using patchwork</span></span>
<span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_cd_soft_meat_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_soft_meat_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_cd_soft_fibre_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_soft_fibre_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_cd_soft_pufa_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_soft_pufa_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_cd_soft_upf_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_soft_upf_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    axes <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"1-year risk difference"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Crohn's, patient reported flare."</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">30</span>, <span class="fl">60</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-9" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-9">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb97"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate risk difference for these values</span></span>
<span><span class="va">data_rd_cd_hard_meat</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_cd_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_meat_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Total meat protein: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_cd_hard_fibre</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_cd_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_fibre_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Dietary fibre: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_cd_hard_pufa</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_cd_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_pufa_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"PUFA: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_cd_hard_upf</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.cd.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_cd_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_upf_cd</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"UPF (%): "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Creating combined forest plot</span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_cd_hard_meat_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_hard_meat</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_cd_hard_fibre_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_hard_fibre</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_cd_hard_pufa_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_hard_pufa</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_cd_hard_upf_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_cd_hard_upf</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb98"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Final plots using patchwork</span></span>
<span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_cd_hard_meat_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_hard_meat_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_cd_hard_fibre_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_hard_fibre_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_cd_hard_pufa_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_hard_pufa_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_cd_hard_upf_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_cd_hard_upf_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    axes <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"1-year risk difference"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Crohn's, objective flare."</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section></section><section id="ulcerative-colitis-5" class="level3"><h3 class="anchored" data-anchor-id="ulcerative-colitis-5">Ulcerative colitis</h3>
<section id="patient-reported-flare-12" class="level4"><h4 class="anchored" data-anchor-id="patient-reported-flare-12">Patient-reported flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb99"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Values for calculation risk difference</span></span>
<span><span class="va">rd_values_meat_uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">flare.uc.df</span><span class="op">$</span><span class="va">Meat_sum</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rd_values_fibre_uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">flare.uc.df</span><span class="op">$</span><span class="va">fibre</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rd_values_pufa_uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">flare.uc.df</span><span class="op">$</span><span class="va">PUFA_percEng</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rd_values_upf_uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">flare.uc.df</span><span class="op">$</span><span class="va">UPF_perc</span>,</span>
<span>  probs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate risk difference for these values</span></span>
<span><span class="va">data_rd_uc_soft_meat</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_uc_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_meat_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Total meat protein: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_uc_soft_fibre</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_uc_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_fibre_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Dietary fibre: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_uc_soft_pufa</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_uc_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_pufa_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"PUFA: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_uc_soft_upf</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_uc_soft</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_upf_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"UPF (%): "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Creating combined forest plot</span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_uc_soft_meat_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_soft_meat</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_uc_soft_fibre_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_soft_fibre</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_uc_soft_pufa_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_soft_pufa</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_uc_soft_upf_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_soft_upf</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb100"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Final plots using patchwork</span></span>
<span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_uc_soft_meat_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_soft_meat_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_uc_soft_fibre_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_soft_fibre_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_uc_soft_pufa_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_soft_pufa_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_uc_soft_upf_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_soft_upf_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    axes <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"1-year risk difference"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Ulcerative colitis, patient reported flare."</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="objective-flare-10" class="level4"><h4 class="anchored" data-anchor-id="objective-flare-10">Objective Flare</h4>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb101"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Calculate risk difference for these values</span></span>
<span><span class="va">data_rd_uc_hard_meat</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_meat_uc_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"Meat_sum"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_meat_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Total meat protein: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_uc_hard_fibre</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_fibre_uc_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"fibre"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_fibre_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Dietary fibre: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_uc_hard_pufa</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_pufa_uc_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"PUFA_percEng"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_pufa_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"PUFA: "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">data_rd_uc_hard_upf</span> <span class="op">&lt;-</span> <span class="fu">summon_population_risk_difference_boot</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">flare.uc.df</span>,</span>
<span>  model <span class="op">=</span> <span class="va">cox_upf_uc_hard</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">365</span><span class="op">)</span>,</span>
<span>  variable <span class="op">=</span> <span class="st">"UPF_perc"</span>,</span>
<span>  values <span class="op">=</span> <span class="va">rd_values_upf_uc</span>,</span>
<span>  ref_value <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nboot <span class="op">=</span> <span class="va">nboot</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    term_tidy <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"UPF (%): "</span>, <span class="va">value</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Creating combined forest plot</span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_uc_hard_meat_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_hard_meat</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_uc_hard_fibre_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_hard_fibre</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_uc_hard_pufa_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_hard_pufa</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">plot_rd_uc_hard_upf_1y</span> <span class="op">&lt;-</span> <span class="fu">summon_rd_forest_plot</span><span class="op">(</span><span class="va">data_rd_uc_hard_upf</span>,</span>
<span>  time <span class="op">=</span> <span class="fl">365</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb102"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Final plots using patchwork</span></span>
<span></span>
<span><span class="co"># 1-year risk difference</span></span>
<span><span class="va">plot_rd_uc_hard_meat_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_hard_meat_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_uc_hard_fibre_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_hard_fibre_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_uc_hard_pufa_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_hard_pufa_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="va">plot_rd_uc_hard_upf_1y</span><span class="op">$</span><span class="va">plot</span> <span class="op">+</span> <span class="va">plot_rd_uc_hard_upf_1y</span><span class="op">$</span><span class="va">rd</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span></span>
<span>    ncol <span class="op">=</span> <span class="fl">2</span>,</span>
<span>    guides <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    axes <span class="op">=</span> <span class="st">"collect"</span>,</span>
<span>    width <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">patchwork</span><span class="fu">::</span><span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"1-year risk difference"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Ulcerative colitis, objective flare."</span></span>
<span>  <span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="Diet_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<!-- -->

</section></section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb103" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Diet"</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="an">Author:</span><span class="co"> </span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Alexander Rudge"</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="co">    corresponding: true</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">      - ref: CGEM</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="an">toc-expand:</span><span class="co"> true</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview</span></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>This report presents a sensitivity analysis examining the association between dietary factors and disease flare risk in inflammatory bowel disease (IBD) patients. Unlike the primary analysis which categorizes fecal calprotectin (FC) into quantiles, this analysis treats FC as a continuous variable in Cox proportional hazards models.</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>The key methodological differences from the primary analysis are:</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>**Continuous FC**: FC is included as a continuous predictor rather than categorical</span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>**Spline modeling**: Natural splines are tested to assess non-linear relationships</span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>**Hazard ratio curves**: Continuous hazard ratios are plotted across the range of each dietary variable</span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>**Risk difference estimation**: Population-average risk differences are calculated using bootstrapping</span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>Dietary variables examined include total meat protein, dietary fibre, polyunsaturated fatty acids (PUFA), and ultra-processed food (UPF) intake. Analyses are stratified by disease type (Crohn's disease vs. ulcerative colitis) and flare definition (patient-reported vs. objective).</span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setting up in R</span></span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Load the data</span></span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splines)</span>
<span id="cb103-38"><a href="#cb103-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb103-39"><a href="#cb103-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"Survival/utils.R"</span>)</span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup analysis environment</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a>analysis_setup <span class="ot">&lt;-</span> <span class="fu">setup_analysis</span>()</span>
<span id="cb103-44"><a href="#cb103-44" aria-hidden="true" tabindex="-1"></a>paths <span class="ot">&lt;-</span> analysis_setup<span class="sc">$</span>paths</span>
<span id="cb103-45"><a href="#cb103-45" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> analysis_setup<span class="sc">$</span>demo</span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a>flare.df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(paths<span class="sc">$</span>outdir, <span class="st">"flares-biochem.RDS"</span>))</span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a>flare.cd.df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(paths<span class="sc">$</span>outdir, <span class="st">"flares-biochem-cd.RDS"</span>))</span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a>flare.uc.df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(paths<span class="sc">$</span>outdir, <span class="st">"flares-biochem-uc.RDS"</span>))</span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data cleaning</span></span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a><span class="co"># FC has been logged twice - reverse</span></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a>flare.df <span class="sc">%&lt;&gt;%</span></span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">FC =</span> <span class="fu">exp</span>(FC))</span>
<span id="cb103-60"><a href="#cb103-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-61"><a href="#cb103-61" aria-hidden="true" tabindex="-1"></a>flare.cd.df <span class="sc">%&lt;&gt;%</span></span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">FC =</span> <span class="fu">exp</span>(FC))</span>
<span id="cb103-63"><a href="#cb103-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-64"><a href="#cb103-64" aria-hidden="true" tabindex="-1"></a>flare.uc.df <span class="sc">%&lt;&gt;%</span></span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">FC =</span> <span class="fu">exp</span>(FC))</span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a><span class="co"># So now FC is on the original measurement scale (log transformation reversed)</span></span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform age variable to decades</span></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a>flare.df <span class="sc">%&lt;&gt;%</span></span>
<span id="cb103-70"><a href="#cb103-70" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-71"><a href="#cb103-71" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_decade =</span> Age <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a>flare.cd.df <span class="sc">%&lt;&gt;%</span></span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_decade =</span> Age <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb103-77"><a href="#cb103-77" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-78"><a href="#cb103-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-79"><a href="#cb103-79" aria-hidden="true" tabindex="-1"></a>flare.uc.df <span class="sc">%&lt;&gt;%</span></span>
<span id="cb103-80"><a href="#cb103-80" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-81"><a href="#cb103-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_decade =</span> Age <span class="sc">/</span> <span class="dv">10</span></span>
<span id="cb103-82"><a href="#cb103-82" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-83"><a href="#cb103-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-84"><a href="#cb103-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-85"><a href="#cb103-85" aria-hidden="true" tabindex="-1"></a><span class="fu">## Helper functions</span></span>
<span id="cb103-86"><a href="#cb103-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-89"><a href="#cb103-89" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-90"><a href="#cb103-90" aria-hidden="true" tabindex="-1"></a>plot_continuous_hr <span class="ot">&lt;-</span> <span class="cf">function</span>(data, model, variable, <span class="at">splineterm =</span> <span class="cn">NULL</span>){</span>
<span id="cb103-91"><a href="#cb103-91" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-92"><a href="#cb103-92" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting continuous Hazard Ratio curves</span></span>
<span id="cb103-93"><a href="#cb103-93" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data is the same data used to fit the Cox model</span></span>
<span id="cb103-94"><a href="#cb103-94" aria-hidden="true" tabindex="-1"></a>  <span class="co"># model is a Cox model</span></span>
<span id="cb103-95"><a href="#cb103-95" aria-hidden="true" tabindex="-1"></a>  <span class="co"># variable is the variable we are plotting</span></span>
<span id="cb103-96"><a href="#cb103-96" aria-hidden="true" tabindex="-1"></a>  <span class="co"># splineterm is the spline used in the model, if there is one</span></span>
<span id="cb103-97"><a href="#cb103-97" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-98"><a href="#cb103-98" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Range of the variable to plot</span></span>
<span id="cb103-99"><a href="#cb103-99" aria-hidden="true" tabindex="-1"></a>  variable_range <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb103-100"><a href="#cb103-100" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">pull</span>(variable) <span class="sc">%&gt;%</span></span>
<span id="cb103-101"><a href="#cb103-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">quantile</span>(., <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fl">0.9</span>, <span class="fl">0.01</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-102"><a href="#cb103-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unname</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-103"><a href="#cb103-103" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unique</span>()</span>
<span id="cb103-104"><a href="#cb103-104" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-105"><a href="#cb103-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If there is a spline</span></span>
<span id="cb103-106"><a href="#cb103-106" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(splineterm)){</span>
<span id="cb103-107"><a href="#cb103-107" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-108"><a href="#cb103-108" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recreate the spline</span></span>
<span id="cb103-109"><a href="#cb103-109" aria-hidden="true" tabindex="-1"></a>    spline <span class="ot">&lt;-</span> <span class="fu">with</span>(data, <span class="fu">eval</span>(<span class="fu">parse</span>(<span class="at">text =</span> splineterm)))</span>
<span id="cb103-110"><a href="#cb103-110" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-111"><a href="#cb103-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the spline terms for the variable values we are plotting</span></span>
<span id="cb103-112"><a href="#cb103-112" aria-hidden="true" tabindex="-1"></a>    spline_values <span class="ot">&lt;-</span> <span class="fu">predict</span>(spline, <span class="at">newx =</span> variable_range)</span>
<span id="cb103-113"><a href="#cb103-113" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-114"><a href="#cb103-114" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the reference values of the variables that were used to fit the Cox model</span></span>
<span id="cb103-115"><a href="#cb103-115" aria-hidden="true" tabindex="-1"></a>    X_ref <span class="ot">&lt;-</span> model<span class="sc">$</span>means</span>
<span id="cb103-116"><a href="#cb103-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-117"><a href="#cb103-117" aria-hidden="true" tabindex="-1"></a>    <span class="co"># New values to calculate the HR at </span></span>
<span id="cb103-118"><a href="#cb103-118" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take the ref values and vary our variable of interest</span></span>
<span id="cb103-119"><a href="#cb103-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-120"><a href="#cb103-120" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Number of values</span></span>
<span id="cb103-121"><a href="#cb103-121" aria-hidden="true" tabindex="-1"></a>    n_values <span class="ot">&lt;-</span> variable_range <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb103-122"><a href="#cb103-122" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-123"><a href="#cb103-123" aria-hidden="true" tabindex="-1"></a>    X_ref <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(X_ref, n_values), <span class="at">nrow =</span> n_values, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-124"><a href="#cb103-124" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix the column names</span></span>
<span id="cb103-125"><a href="#cb103-125" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(X_ref) <span class="ot">&lt;-</span> <span class="fu">names</span>(model<span class="sc">$</span>means)</span>
<span id="cb103-126"><a href="#cb103-126" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-127"><a href="#cb103-127" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Now add our new variable values</span></span>
<span id="cb103-128"><a href="#cb103-128" aria-hidden="true" tabindex="-1"></a>    X_new <span class="ot">&lt;-</span> X_ref</span>
<span id="cb103-129"><a href="#cb103-129" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identify the correct columns</span></span>
<span id="cb103-130"><a href="#cb103-130" aria-hidden="true" tabindex="-1"></a>    column_pos <span class="ot">&lt;-</span> stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="fu">colnames</span>(X_new), variable)</span>
<span id="cb103-131"><a href="#cb103-131" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the values - ordering of columns and model term names should be preserved</span></span>
<span id="cb103-132"><a href="#cb103-132" aria-hidden="true" tabindex="-1"></a>    X_new[,column_pos] <span class="ot">&lt;-</span> spline_values</span>
<span id="cb103-133"><a href="#cb103-133" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-134"><a href="#cb103-134" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the linear predictor and se</span></span>
<span id="cb103-135"><a href="#cb103-135" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Method directly from predict.coxph from the survival package</span></span>
<span id="cb103-136"><a href="#cb103-136" aria-hidden="true" tabindex="-1"></a>    lp <span class="ot">&lt;-</span> (X_new <span class="sc">-</span> X_ref)<span class="sc">%*%</span><span class="fu">coef</span>(model) </span>
<span id="cb103-137"><a href="#cb103-137" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-138"><a href="#cb103-138" aria-hidden="true" tabindex="-1"></a>    lp_se <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((X_new <span class="sc">-</span> X_ref)<span class="sc">%*%</span><span class="fu">vcov</span>(model)<span class="sc">*</span>(X_new <span class="sc">-</span> X_ref)) <span class="sc">%&gt;%</span></span>
<span id="cb103-139"><a href="#cb103-139" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-140"><a href="#cb103-140" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb103-141"><a href="#cb103-141" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-142"><a href="#cb103-142" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb103-143"><a href="#cb103-143" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If there is no spline then it is easier</span></span>
<span id="cb103-144"><a href="#cb103-144" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-145"><a href="#cb103-145" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the reference values of the variables that were used to fit the Cox model</span></span>
<span id="cb103-146"><a href="#cb103-146" aria-hidden="true" tabindex="-1"></a>    X_ref <span class="ot">&lt;-</span> model<span class="sc">$</span>means</span>
<span id="cb103-147"><a href="#cb103-147" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-148"><a href="#cb103-148" aria-hidden="true" tabindex="-1"></a>    <span class="co"># New values to calculate the HR at </span></span>
<span id="cb103-149"><a href="#cb103-149" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Take the ref values and vary our variable of interest</span></span>
<span id="cb103-150"><a href="#cb103-150" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-151"><a href="#cb103-151" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Number of values</span></span>
<span id="cb103-152"><a href="#cb103-152" aria-hidden="true" tabindex="-1"></a>    n_values <span class="ot">&lt;-</span> variable_range <span class="sc">%&gt;%</span> <span class="fu">length</span>()</span>
<span id="cb103-153"><a href="#cb103-153" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-154"><a href="#cb103-154" aria-hidden="true" tabindex="-1"></a>    X_ref <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(X_ref, n_values), <span class="at">nrow =</span> n_values, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-155"><a href="#cb103-155" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fix the column names</span></span>
<span id="cb103-156"><a href="#cb103-156" aria-hidden="true" tabindex="-1"></a>    <span class="fu">colnames</span>(X_ref) <span class="ot">&lt;-</span> <span class="fu">names</span>(model<span class="sc">$</span>means)</span>
<span id="cb103-157"><a href="#cb103-157" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-158"><a href="#cb103-158" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Now add our new variable values</span></span>
<span id="cb103-159"><a href="#cb103-159" aria-hidden="true" tabindex="-1"></a>    X_new <span class="ot">&lt;-</span> X_ref</span>
<span id="cb103-160"><a href="#cb103-160" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-161"><a href="#cb103-161" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Add the values</span></span>
<span id="cb103-162"><a href="#cb103-162" aria-hidden="true" tabindex="-1"></a>    X_new[,variable] <span class="ot">&lt;-</span> variable_range</span>
<span id="cb103-163"><a href="#cb103-163" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-164"><a href="#cb103-164" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the linear predictor and se</span></span>
<span id="cb103-165"><a href="#cb103-165" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Method directly from predict.coxph from the survival package</span></span>
<span id="cb103-166"><a href="#cb103-166" aria-hidden="true" tabindex="-1"></a>    lp <span class="ot">&lt;-</span> (X_new <span class="sc">-</span> X_ref)<span class="sc">%*%</span><span class="fu">coef</span>(model) <span class="sc">%&gt;%</span> <span class="fu">as.numeric</span>() </span>
<span id="cb103-167"><a href="#cb103-167" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-168"><a href="#cb103-168" aria-hidden="true" tabindex="-1"></a>    lp_se <span class="ot">&lt;-</span> <span class="fu">rowSums</span>((X_new <span class="sc">-</span> X_ref)<span class="sc">%*%</span><span class="fu">vcov</span>(model)<span class="sc">*</span>(X_new <span class="sc">-</span> X_ref)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-169"><a href="#cb103-169" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.numeric</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-170"><a href="#cb103-170" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sqrt</span>()</span>
<span id="cb103-171"><a href="#cb103-171" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb103-172"><a href="#cb103-172" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-173"><a href="#cb103-173" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-174"><a href="#cb103-174" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Store results in a tibble</span></span>
<span id="cb103-175"><a href="#cb103-175" aria-hidden="true" tabindex="-1"></a>  data_pred <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb103-176"><a href="#cb103-176" aria-hidden="true" tabindex="-1"></a>    <span class="sc">!!</span><span class="fu">sym</span>(variable) <span class="sc">:</span><span class="er">=</span> variable_range,</span>
<span id="cb103-177"><a href="#cb103-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> lp,</span>
<span id="cb103-178"><a href="#cb103-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">se =</span> lp_se</span>
<span id="cb103-179"><a href="#cb103-179" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb103-180"><a href="#cb103-180" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-181"><a href="#cb103-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb103-182"><a href="#cb103-182" aria-hidden="true" tabindex="-1"></a>  data_pred <span class="sc">%&gt;%</span></span>
<span id="cb103-183"><a href="#cb103-183" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb103-184"><a href="#cb103-184" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="sc">!!</span>rlang<span class="sc">::</span><span class="fu">sym</span>(variable),</span>
<span id="cb103-185"><a href="#cb103-185" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">exp</span>(p),</span>
<span id="cb103-186"><a href="#cb103-186" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin =</span> <span class="fu">exp</span>(p <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se),</span>
<span id="cb103-187"><a href="#cb103-187" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymax =</span> <span class="fu">exp</span>(p <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se)</span>
<span id="cb103-188"><a href="#cb103-188" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb103-189"><a href="#cb103-189" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb103-190"><a href="#cb103-190" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb103-191"><a href="#cb103-191" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb103-192"><a href="#cb103-192" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"HR"</span>) <span class="sc">+</span> </span>
<span id="cb103-193"><a href="#cb103-193" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb103-194"><a href="#cb103-194" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-195"><a href="#cb103-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-196"><a href="#cb103-196" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to perform an LRT</span></span>
<span id="cb103-197"><a href="#cb103-197" aria-hidden="true" tabindex="-1"></a>summon_lrt <span class="ot">&lt;-</span> <span class="cf">function</span>(model, <span class="at">remove =</span> <span class="cn">NULL</span>, <span class="at">add =</span> <span class="cn">NULL</span>) {</span>
<span id="cb103-198"><a href="#cb103-198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function that removes a term and performs a</span></span>
<span id="cb103-199"><a href="#cb103-199" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Likelihood ratio test to determine its significance</span></span>
<span id="cb103-200"><a href="#cb103-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-201"><a href="#cb103-201" aria-hidden="true" tabindex="-1"></a>  new_formula <span class="ot">&lt;-</span> <span class="st">"~ ."</span></span>
<span id="cb103-202"><a href="#cb103-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-203"><a href="#cb103-203" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(remove)) {</span>
<span id="cb103-204"><a href="#cb103-204" aria-hidden="true" tabindex="-1"></a>    new_formula <span class="ot">&lt;-</span> <span class="fu">paste0</span>(new_formula, <span class="st">" - "</span>, remove)</span>
<span id="cb103-205"><a href="#cb103-205" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb103-206"><a href="#cb103-206" aria-hidden="true" tabindex="-1"></a>    remove <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb103-207"><a href="#cb103-207" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-208"><a href="#cb103-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-209"><a href="#cb103-209" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.null</span>(add)) {</span>
<span id="cb103-210"><a href="#cb103-210" aria-hidden="true" tabindex="-1"></a>    new_formula <span class="ot">&lt;-</span> <span class="fu">paste0</span>(new_formula, <span class="st">" + "</span>, add)</span>
<span id="cb103-211"><a href="#cb103-211" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb103-212"><a href="#cb103-212" aria-hidden="true" tabindex="-1"></a>    add <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb103-213"><a href="#cb103-213" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-214"><a href="#cb103-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-215"><a href="#cb103-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">update</span>(model, new_formula) <span class="sc">%&gt;%</span></span>
<span id="cb103-216"><a href="#cb103-216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">anova</span>(model, ., <span class="at">test =</span> <span class="st">"LRT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-217"><a href="#cb103-217" aria-hidden="true" tabindex="-1"></a>    broom<span class="sc">::</span><span class="fu">tidy</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-218"><a href="#cb103-218" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(p.value)) <span class="sc">%&gt;%</span></span>
<span id="cb103-219"><a href="#cb103-219" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>term) <span class="sc">%&gt;%</span></span>
<span id="cb103-220"><a href="#cb103-220" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-221"><a href="#cb103-221" aria-hidden="true" tabindex="-1"></a>      <span class="at">removed =</span> remove,</span>
<span id="cb103-222"><a href="#cb103-222" aria-hidden="true" tabindex="-1"></a>      <span class="at">added =</span> add</span>
<span id="cb103-223"><a href="#cb103-223" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb103-224"><a href="#cb103-224" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">test =</span> <span class="st">"LRT"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-225"><a href="#cb103-225" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(test, removed, added, tidyselect<span class="sc">::</span><span class="fu">everything</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb103-226"><a href="#cb103-226" aria-hidden="true" tabindex="-1"></a>    knitr<span class="sc">::</span><span class="fu">kable</span>(<span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Test"</span>,</span>
<span id="cb103-227"><a href="#cb103-227" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Remolved"</span>,</span>
<span id="cb103-228"><a href="#cb103-228" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Added"</span>,</span>
<span id="cb103-229"><a href="#cb103-229" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Log-likelihood"</span>,</span>
<span id="cb103-230"><a href="#cb103-230" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Statistic"</span>,</span>
<span id="cb103-231"><a href="#cb103-231" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"DF"</span>,</span>
<span id="cb103-232"><a href="#cb103-232" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"p-vaue"</span>),</span>
<span id="cb103-233"><a href="#cb103-233" aria-hidden="true" tabindex="-1"></a>                 <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb103-234"><a href="#cb103-234" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-235"><a href="#cb103-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-236"><a href="#cb103-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-237"><a href="#cb103-237" aria-hidden="true" tabindex="-1"></a>summon_population_risk_difference <span class="ot">&lt;-</span> <span class="cf">function</span>(data,</span>
<span id="cb103-238"><a href="#cb103-238" aria-hidden="true" tabindex="-1"></a>                                              model,</span>
<span id="cb103-239"><a href="#cb103-239" aria-hidden="true" tabindex="-1"></a>                                              times,</span>
<span id="cb103-240"><a href="#cb103-240" aria-hidden="true" tabindex="-1"></a>                                              variable,</span>
<span id="cb103-241"><a href="#cb103-241" aria-hidden="true" tabindex="-1"></a>                                              values,</span>
<span id="cb103-242"><a href="#cb103-242" aria-hidden="true" tabindex="-1"></a>                                              <span class="at">ref_value =</span> <span class="cn">NULL</span>) {</span>
<span id="cb103-243"><a href="#cb103-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function that calculates (population average) risk difference of a variable</span></span>
<span id="cb103-244"><a href="#cb103-244" aria-hidden="true" tabindex="-1"></a>  <span class="co"># at given time points with respect to specified value of the variable from a</span></span>
<span id="cb103-245"><a href="#cb103-245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Cox model</span></span>
<span id="cb103-246"><a href="#cb103-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-247"><a href="#cb103-247" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If no reference value then use one in the middle</span></span>
<span id="cb103-248"><a href="#cb103-248" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ref_value)) {</span>
<span id="cb103-249"><a href="#cb103-249" aria-hidden="true" tabindex="-1"></a>    pos <span class="ot">&lt;-</span> (<span class="fu">length</span>(values) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">ceiling</span>()</span>
<span id="cb103-250"><a href="#cb103-250" aria-hidden="true" tabindex="-1"></a>    ref_value <span class="ot">&lt;-</span> values <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">pluck</span>(pos)</span>
<span id="cb103-251"><a href="#cb103-251" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-252"><a href="#cb103-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-253"><a href="#cb103-253" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify the time variable - to differentiate between soft and hard flare models</span></span>
<span id="cb103-254"><a href="#cb103-254" aria-hidden="true" tabindex="-1"></a>  time_variable <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(<span class="fu">terms</span>(model))[<span class="dv">1</span>]</span>
<span id="cb103-255"><a href="#cb103-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-256"><a href="#cb103-256" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">expand_grid</span>(times, values)</span>
<span id="cb103-257"><a href="#cb103-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-258"><a href="#cb103-258" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map2</span>(</span>
<span id="cb103-259"><a href="#cb103-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> df<span class="sc">$</span>times,</span>
<span id="cb103-260"><a href="#cb103-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">.y =</span> df<span class="sc">$</span>values,</span>
<span id="cb103-261"><a href="#cb103-261" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb103-262"><a href="#cb103-262" aria-hidden="true" tabindex="-1"></a>      data <span class="sc">%&gt;%</span></span>
<span id="cb103-263"><a href="#cb103-263" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Set values for time and the variable</span></span>
<span id="cb103-264"><a href="#cb103-264" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="sc">!!</span><span class="fu">sym</span>(time_variable) <span class="sc">:</span><span class="er">=</span> x, <span class="sc">!!</span><span class="fu">sym</span>(variable) <span class="sc">:</span><span class="er">=</span> y) <span class="sc">%&gt;%</span></span>
<span id="cb103-265"><a href="#cb103-265" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Estimate expected for entire population</span></span>
<span id="cb103-266"><a href="#cb103-266" aria-hidden="true" tabindex="-1"></a>        <span class="fu">predict</span>(model, <span class="at">newdata =</span> ., <span class="at">type =</span> <span class="st">"expected"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-267"><a href="#cb103-267" aria-hidden="true" tabindex="-1"></a>        <span class="fu">tibble</span>(<span class="at">expected =</span> .) <span class="sc">%&gt;%</span></span>
<span id="cb103-268"><a href="#cb103-268" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove NA</span></span>
<span id="cb103-269"><a href="#cb103-269" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(expected)) <span class="sc">%&gt;%</span></span>
<span id="cb103-270"><a href="#cb103-270" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Calculate survival and cumulative incidence (1 - survival)</span></span>
<span id="cb103-271"><a href="#cb103-271" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-272"><a href="#cb103-272" aria-hidden="true" tabindex="-1"></a>          <span class="at">survival =</span> <span class="fu">exp</span>(<span class="sc">-</span>expected),</span>
<span id="cb103-273"><a href="#cb103-273" aria-hidden="true" tabindex="-1"></a>          <span class="at">cum_incidence =</span> <span class="dv">1</span> <span class="sc">-</span> survival</span>
<span id="cb103-274"><a href="#cb103-274" aria-hidden="true" tabindex="-1"></a>        ) <span class="sc">%&gt;%</span></span>
<span id="cb103-275"><a href="#cb103-275" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(cum_incidence) <span class="sc">%&gt;%</span></span>
<span id="cb103-276"><a href="#cb103-276" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">cum_incidence =</span> <span class="fu">mean</span>(cum_incidence)) <span class="sc">%&gt;%</span></span>
<span id="cb103-277"><a href="#cb103-277" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note time, value and variable</span></span>
<span id="cb103-278"><a href="#cb103-278" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time =</span> x, <span class="at">value =</span> y, <span class="at">variable =</span> variable)</span>
<span id="cb103-279"><a href="#cb103-279" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb103-280"><a href="#cb103-280" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb103-281"><a href="#cb103-281" aria-hidden="true" tabindex="-1"></a>    purrr<span class="sc">::</span><span class="fu">list_rbind</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-282"><a href="#cb103-282" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate risk difference relative to a reference</span></span>
<span id="cb103-283"><a href="#cb103-283" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb103-284"><a href="#cb103-284" aria-hidden="true" tabindex="-1"></a>      df <span class="ot">&lt;-</span> .</span>
<span id="cb103-285"><a href="#cb103-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-286"><a href="#cb103-286" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Subtract chosen reference value to set linear predictor to 0 at that value</span></span>
<span id="cb103-287"><a href="#cb103-287" aria-hidden="true" tabindex="-1"></a>      cum_incidence_ref <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span></span>
<span id="cb103-288"><a href="#cb103-288" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(value <span class="sc">==</span> ref_value) <span class="sc">%&gt;%</span></span>
<span id="cb103-289"><a href="#cb103-289" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">cum_incidence_ref =</span> cum_incidence) <span class="sc">%&gt;%</span></span>
<span id="cb103-290"><a href="#cb103-290" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(time, cum_incidence_ref)</span>
<span id="cb103-291"><a href="#cb103-291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-292"><a href="#cb103-292" aria-hidden="true" tabindex="-1"></a>      df <span class="sc">%&gt;%</span></span>
<span id="cb103-293"><a href="#cb103-293" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">left_join</span>(cum_incidence_ref, <span class="at">by =</span> <span class="st">"time"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb103-294"><a href="#cb103-294" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">rd =</span> (cum_incidence <span class="sc">-</span> cum_incidence_ref)<span class="sc">*</span><span class="dv">100</span>, <span class="at">.keep =</span> <span class="st">"unused"</span>)</span>
<span id="cb103-295"><a href="#cb103-295" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb103-296"><a href="#cb103-296" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-297"><a href="#cb103-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-298"><a href="#cb103-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-299"><a href="#cb103-299" aria-hidden="true" tabindex="-1"></a>summon_population_risk_difference_boot <span class="ot">&lt;-</span> <span class="cf">function</span>(data,</span>
<span id="cb103-300"><a href="#cb103-300" aria-hidden="true" tabindex="-1"></a>                                                   model,</span>
<span id="cb103-301"><a href="#cb103-301" aria-hidden="true" tabindex="-1"></a>                                                   times,</span>
<span id="cb103-302"><a href="#cb103-302" aria-hidden="true" tabindex="-1"></a>                                                   variable,</span>
<span id="cb103-303"><a href="#cb103-303" aria-hidden="true" tabindex="-1"></a>                                                   values,</span>
<span id="cb103-304"><a href="#cb103-304" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">ref_value =</span> <span class="cn">NULL</span>,</span>
<span id="cb103-305"><a href="#cb103-305" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">nboot =</span> <span class="dv">99</span>,</span>
<span id="cb103-306"><a href="#cb103-306" aria-hidden="true" tabindex="-1"></a>                                                   <span class="at">seed =</span> <span class="dv">1</span>) {</span>
<span id="cb103-307"><a href="#cb103-307" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Function to calculate population risk difference for a given variable at given time points</span></span>
<span id="cb103-308"><a href="#cb103-308" aria-hidden="true" tabindex="-1"></a>  <span class="co"># relative to a specified reference value</span></span>
<span id="cb103-309"><a href="#cb103-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Confidence intervals calculated using bootstrapping.</span></span>
<span id="cb103-310"><a href="#cb103-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-311"><a href="#cb103-311" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Set seed</span></span>
<span id="cb103-312"><a href="#cb103-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb103-313"><a href="#cb103-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-314"><a href="#cb103-314" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If no reference value then use one in the middle</span></span>
<span id="cb103-315"><a href="#cb103-315" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.null</span>(ref_value)) {</span>
<span id="cb103-316"><a href="#cb103-316" aria-hidden="true" tabindex="-1"></a>    pos <span class="ot">&lt;-</span> (<span class="fu">length</span>(values) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">ceiling</span>()</span>
<span id="cb103-317"><a href="#cb103-317" aria-hidden="true" tabindex="-1"></a>    ref_value <span class="ot">&lt;-</span> values <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">pluck</span>(pos)</span>
<span id="cb103-318"><a href="#cb103-318" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-319"><a href="#cb103-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-320"><a href="#cb103-320" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_dfr</span>(</span>
<span id="cb103-321"><a href="#cb103-321" aria-hidden="true" tabindex="-1"></a>    <span class="at">.x =</span> <span class="fu">seq_len</span>(nboot),</span>
<span id="cb103-322"><a href="#cb103-322" aria-hidden="true" tabindex="-1"></a>    <span class="at">.f =</span> <span class="cf">function</span>(b) {</span>
<span id="cb103-323"><a href="#cb103-323" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Variable used in the model</span></span>
<span id="cb103-324"><a href="#cb103-324" aria-hidden="true" tabindex="-1"></a>      all_variables <span class="ot">&lt;-</span> <span class="fu">all.vars</span>(<span class="fu">terms</span>(model))</span>
<span id="cb103-325"><a href="#cb103-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-326"><a href="#cb103-326" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Bootstrap sample of the data</span></span>
<span id="cb103-327"><a href="#cb103-327" aria-hidden="true" tabindex="-1"></a>      data_boot <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb103-328"><a href="#cb103-328" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Remove any NAs as Cox doesn't use these</span></span>
<span id="cb103-329"><a href="#cb103-329" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">select</span>(tidyselect<span class="sc">::</span><span class="fu">all_of</span>(all_variables)) <span class="sc">%&gt;%</span></span>
<span id="cb103-330"><a href="#cb103-330" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>dplyr<span class="sc">::</span><span class="fu">if_any</span>(<span class="at">.cols =</span> <span class="fu">everything</span>(), <span class="at">.fns =</span> is.na)) <span class="sc">%&gt;%</span></span>
<span id="cb103-331"><a href="#cb103-331" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Sample the df</span></span>
<span id="cb103-332"><a href="#cb103-332" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">slice_sample</span>(<span class="at">prop =</span> <span class="dv">1</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-333"><a href="#cb103-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-334"><a href="#cb103-334" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Refit cox model of bootstrapped data</span></span>
<span id="cb103-335"><a href="#cb103-335" aria-hidden="true" tabindex="-1"></a>      model_boot <span class="ot">&lt;-</span> <span class="fu">coxph</span>(<span class="fu">formula</span>(model), <span class="at">data =</span> data_boot, <span class="at">model =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-336"><a href="#cb103-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-337"><a href="#cb103-337" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Calculate risk differences</span></span>
<span id="cb103-338"><a href="#cb103-338" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summon_population_risk_difference</span>(</span>
<span id="cb103-339"><a href="#cb103-339" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> data_boot,</span>
<span id="cb103-340"><a href="#cb103-340" aria-hidden="true" tabindex="-1"></a>        <span class="at">model =</span> model_boot,</span>
<span id="cb103-341"><a href="#cb103-341" aria-hidden="true" tabindex="-1"></a>        <span class="at">times =</span> times,</span>
<span id="cb103-342"><a href="#cb103-342" aria-hidden="true" tabindex="-1"></a>        <span class="at">variable =</span> variable,</span>
<span id="cb103-343"><a href="#cb103-343" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> values,</span>
<span id="cb103-344"><a href="#cb103-344" aria-hidden="true" tabindex="-1"></a>        <span class="at">ref_value =</span> ref_value</span>
<span id="cb103-345"><a href="#cb103-345" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb103-346"><a href="#cb103-346" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb103-347"><a href="#cb103-347" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb103-348"><a href="#cb103-348" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(time, value) <span class="sc">%&gt;%</span></span>
<span id="cb103-349"><a href="#cb103-349" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Bootstrapped estimate and confidence intervals</span></span>
<span id="cb103-350"><a href="#cb103-350" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(</span>
<span id="cb103-351"><a href="#cb103-351" aria-hidden="true" tabindex="-1"></a>      <span class="at">mean_rd =</span> <span class="fu">mean</span>(rd),</span>
<span id="cb103-352"><a href="#cb103-352" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.low =</span> <span class="fu">quantile</span>(rd, <span class="at">prob =</span> <span class="fl">0.025</span>),</span>
<span id="cb103-353"><a href="#cb103-353" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.high =</span> <span class="fu">quantile</span>(rd, <span class="at">prob =</span> <span class="fl">0.975</span>)</span>
<span id="cb103-354"><a href="#cb103-354" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb103-355"><a href="#cb103-355" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb103-356"><a href="#cb103-356" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">estimate =</span> mean_rd) <span class="sc">%&gt;%</span></span>
<span id="cb103-357"><a href="#cb103-357" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Note variable, reference level flag</span></span>
<span id="cb103-358"><a href="#cb103-358" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-359"><a href="#cb103-359" aria-hidden="true" tabindex="-1"></a>      <span class="at">variable =</span> variable,</span>
<span id="cb103-360"><a href="#cb103-360" aria-hidden="true" tabindex="-1"></a>      <span class="at">reference_flag =</span> (value <span class="sc">==</span> ref_value)</span>
<span id="cb103-361"><a href="#cb103-361" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb103-362"><a href="#cb103-362" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Ordering for plotting</span></span>
<span id="cb103-363"><a href="#cb103-363" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">arrange</span>(time, value) <span class="sc">%&gt;%</span></span>
<span id="cb103-364"><a href="#cb103-364" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(time) <span class="sc">%&gt;%</span></span>
<span id="cb103-365"><a href="#cb103-365" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">ordering =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb103-366"><a href="#cb103-366" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Tidy confidence intervals</span></span>
<span id="cb103-367"><a href="#cb103-367" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove confidence intervals for reference level</span></span>
<span id="cb103-368"><a href="#cb103-368" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-369"><a href="#cb103-369" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.low =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(reference_flag <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb103-370"><a href="#cb103-370" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> conf.low</span>
<span id="cb103-371"><a href="#cb103-371" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb103-372"><a href="#cb103-372" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.high =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(reference_flag <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA</span>,</span>
<span id="cb103-373"><a href="#cb103-373" aria-hidden="true" tabindex="-1"></a>        <span class="at">.default =</span> conf.high</span>
<span id="cb103-374"><a href="#cb103-374" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb103-375"><a href="#cb103-375" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb103-376"><a href="#cb103-376" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-377"><a href="#cb103-377" aria-hidden="true" tabindex="-1"></a>      <span class="at">conf.interval.tidy =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb103-378"><a href="#cb103-378" aria-hidden="true" tabindex="-1"></a>        (<span class="fu">is.na</span>(conf.low) <span class="sc">&amp;</span> <span class="fu">is.na</span>(conf.high)) <span class="sc">~</span> <span class="st">"-"</span>,</span>
<span id="cb103-379"><a href="#cb103-379" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fu">paste0</span>(</span>
<span id="cb103-380"><a href="#cb103-380" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sprintf</span>(<span class="st">"%.3g"</span>, estimate),</span>
<span id="cb103-381"><a href="#cb103-381" aria-hidden="true" tabindex="-1"></a>          <span class="st">" ("</span>,</span>
<span id="cb103-382"><a href="#cb103-382" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sprintf</span>(<span class="st">"%.3g"</span>, conf.low),</span>
<span id="cb103-383"><a href="#cb103-383" aria-hidden="true" tabindex="-1"></a>          <span class="st">", "</span>,</span>
<span id="cb103-384"><a href="#cb103-384" aria-hidden="true" tabindex="-1"></a>          <span class="fu">sprintf</span>(<span class="st">"%.3g"</span>, conf.high),</span>
<span id="cb103-385"><a href="#cb103-385" aria-hidden="true" tabindex="-1"></a>          <span class="st">")"</span></span>
<span id="cb103-386"><a href="#cb103-386" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb103-387"><a href="#cb103-387" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb103-388"><a href="#cb103-388" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb103-389"><a href="#cb103-389" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Significance</span></span>
<span id="cb103-390"><a href="#cb103-390" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb103-391"><a href="#cb103-391" aria-hidden="true" tabindex="-1"></a>      <span class="at">significance =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb103-392"><a href="#cb103-392" aria-hidden="true" tabindex="-1"></a>        reference_flag <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Reference level"</span>,</span>
<span id="cb103-393"><a href="#cb103-393" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sign</span>(conf.low) <span class="sc">==</span> <span class="fu">sign</span>(conf.high) <span class="sc">~</span> <span class="st">"Significant"</span>,</span>
<span id="cb103-394"><a href="#cb103-394" aria-hidden="true" tabindex="-1"></a>        <span class="fu">sign</span>(conf.low) <span class="sc">!=</span> <span class="fu">sign</span>(conf.high) <span class="sc">~</span> <span class="st">"Not Significant"</span></span>
<span id="cb103-395"><a href="#cb103-395" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb103-396"><a href="#cb103-396" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb103-397"><a href="#cb103-397" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-398"><a href="#cb103-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-399"><a href="#cb103-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-400"><a href="#cb103-400" aria-hidden="true" tabindex="-1"></a>summon_rd_forest_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(data, time) {</span>
<span id="cb103-401"><a href="#cb103-401" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creating a forest plot of risk difference from the result of</span></span>
<span id="cb103-402"><a href="#cb103-402" aria-hidden="true" tabindex="-1"></a>  <span class="co"># summon_population_risk_difference_boot</span></span>
<span id="cb103-403"><a href="#cb103-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-404"><a href="#cb103-404" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Mask time</span></span>
<span id="cb103-405"><a href="#cb103-405" aria-hidden="true" tabindex="-1"></a>  time_point <span class="ot">&lt;-</span> time</span>
<span id="cb103-406"><a href="#cb103-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-407"><a href="#cb103-407" aria-hidden="true" tabindex="-1"></a>  data_plot <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb103-408"><a href="#cb103-408" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(time <span class="sc">==</span> time_point)</span>
<span id="cb103-409"><a href="#cb103-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-410"><a href="#cb103-410" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Forest plot</span></span>
<span id="cb103-411"><a href="#cb103-411" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> data_plot <span class="sc">%&gt;%</span></span>
<span id="cb103-412"><a href="#cb103-412" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(</span>
<span id="cb103-413"><a href="#cb103-413" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> estimate,</span>
<span id="cb103-414"><a href="#cb103-414" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(term_tidy),</span>
<span id="cb103-415"><a href="#cb103-415" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin =</span> conf.low,</span>
<span id="cb103-416"><a href="#cb103-416" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmax =</span> conf.high</span>
<span id="cb103-417"><a href="#cb103-417" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb103-418"><a href="#cb103-418" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb103-419"><a href="#cb103-419" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_errorbarh</span>() <span class="sc">+</span></span>
<span id="cb103-420"><a href="#cb103-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>) <span class="sc">+</span></span>
<span id="cb103-421"><a href="#cb103-421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb103-422"><a href="#cb103-422" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Risk Difference (%) and 95% CI"</span>) <span class="sc">+</span></span>
<span id="cb103-423"><a href="#cb103-423" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb103-424"><a href="#cb103-424" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Title</span></span>
<span id="cb103-425"><a href="#cb103-425" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb103-426"><a href="#cb103-426" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb103-427"><a href="#cb103-427" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Axes</span></span>
<span id="cb103-428"><a href="#cb103-428" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.y =</span> <span class="fu">element_blank</span>()</span>
<span id="cb103-429"><a href="#cb103-429" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb103-430"><a href="#cb103-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-431"><a href="#cb103-431" aria-hidden="true" tabindex="-1"></a>  <span class="co"># RD values</span></span>
<span id="cb103-432"><a href="#cb103-432" aria-hidden="true" tabindex="-1"></a>  rd <span class="ot">&lt;-</span> data_plot <span class="sc">%&gt;%</span></span>
<span id="cb103-433"><a href="#cb103-433" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb103-434"><a href="#cb103-434" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(</span>
<span id="cb103-435"><a href="#cb103-435" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> <span class="dv">0</span>,</span>
<span id="cb103-436"><a href="#cb103-436" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> forcats<span class="sc">::</span><span class="fu">as_factor</span>(term_tidy),</span>
<span id="cb103-437"><a href="#cb103-437" aria-hidden="true" tabindex="-1"></a>      <span class="at">label =</span> conf.interval.tidy</span>
<span id="cb103-438"><a href="#cb103-438" aria-hidden="true" tabindex="-1"></a>    )) <span class="sc">+</span></span>
<span id="cb103-439"><a href="#cb103-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb103-440"><a href="#cb103-440" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb103-441"><a href="#cb103-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-442"><a href="#cb103-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">plot =</span> plot, <span class="at">rd =</span> rd))</span>
<span id="cb103-443"><a href="#cb103-443" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-444"><a href="#cb103-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-445"><a href="#cb103-445" aria-hidden="true" tabindex="-1"></a>broom.cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Term"</span>,</span>
<span id="cb103-446"><a href="#cb103-446" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Estimate"</span>,</span>
<span id="cb103-447"><a href="#cb103-447" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Std error"</span>,</span>
<span id="cb103-448"><a href="#cb103-448" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Statistic"</span>,</span>
<span id="cb103-449"><a href="#cb103-449" aria-hidden="true" tabindex="-1"></a>                <span class="st">"p-value"</span>,</span>
<span id="cb103-450"><a href="#cb103-450" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Lower"</span>,</span>
<span id="cb103-451"><a href="#cb103-451" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Upper"</span>)</span>
<span id="cb103-452"><a href="#cb103-452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-453"><a href="#cb103-453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-454"><a href="#cb103-454" aria-hidden="true" tabindex="-1"></a><span class="fu"># Survival Analysis</span></span>
<span id="cb103-455"><a href="#cb103-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-456"><a href="#cb103-456" aria-hidden="true" tabindex="-1"></a><span class="fu">## Shapes of continuous variables</span></span>
<span id="cb103-457"><a href="#cb103-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-458"><a href="#cb103-458" aria-hidden="true" tabindex="-1"></a>Using splines for the continuous variables. Testing the splines significance using a likelihood ratio test.</span>
<span id="cb103-459"><a href="#cb103-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-460"><a href="#cb103-460" aria-hidden="true" tabindex="-1"></a><span class="fu">### Crohn's disease</span></span>
<span id="cb103-461"><a href="#cb103-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-462"><a href="#cb103-462" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Patient reported flare</span></span>
<span id="cb103-463"><a href="#cb103-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-464"><a href="#cb103-464" aria-hidden="true" tabindex="-1"></a>Before examining dietary exposures, we first assess whether continuous covariates (age, BMI, FC, and diet quality index) exhibit non-linear relationships with flare risk. Natural splines with 2 degrees of freedom are tested using likelihood ratio tests (LRT). Where significant, spline terms are retained in subsequent dietary models to improve model fit and reduce confounding.</span>
<span id="cb103-465"><a href="#cb103-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-466"><a href="#cb103-466" aria-hidden="true" tabindex="-1"></a><span class="fu">### Crohn's disease</span></span>
<span id="cb103-467"><a href="#cb103-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-468"><a href="#cb103-468" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Patient-reported flare</span></span>
<span id="cb103-469"><a href="#cb103-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-472"><a href="#cb103-472" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-473"><a href="#cb103-473" aria-hidden="true" tabindex="-1"></a><span class="co"># Just the continuous variables</span></span>
<span id="cb103-474"><a href="#cb103-474" aria-hidden="true" tabindex="-1"></a>cox_cd_soft <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb103-475"><a href="#cb103-475" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(softflare_time, softflare) <span class="sc">~</span></span>
<span id="cb103-476"><a href="#cb103-476" aria-hidden="true" tabindex="-1"></a>    Sex <span class="sc">+</span></span>
<span id="cb103-477"><a href="#cb103-477" aria-hidden="true" tabindex="-1"></a>    IMD <span class="sc">+</span></span>
<span id="cb103-478"><a href="#cb103-478" aria-hidden="true" tabindex="-1"></a>    age_decade <span class="sc">+</span></span>
<span id="cb103-479"><a href="#cb103-479" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">+</span></span>
<span id="cb103-480"><a href="#cb103-480" aria-hidden="true" tabindex="-1"></a>    FC <span class="sc">+</span></span>
<span id="cb103-481"><a href="#cb103-481" aria-hidden="true" tabindex="-1"></a>    dqi_tot <span class="sc">+</span></span>
<span id="cb103-482"><a href="#cb103-482" aria-hidden="true" tabindex="-1"></a>    <span class="fu">frailty</span>(SiteNo),</span>
<span id="cb103-483"><a href="#cb103-483" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df</span>
<span id="cb103-484"><a href="#cb103-484" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-485"><a href="#cb103-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-486"><a href="#cb103-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Is there any benefit to using spline for:</span></span>
<span id="cb103-487"><a href="#cb103-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-488"><a href="#cb103-488" aria-hidden="true" tabindex="-1"></a><span class="co"># age</span></span>
<span id="cb103-489"><a href="#cb103-489" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_soft,</span>
<span id="cb103-490"><a href="#cb103-490" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="st">"age_decade"</span>,</span>
<span id="cb103-491"><a href="#cb103-491" aria-hidden="true" tabindex="-1"></a>           <span class="at">add =</span> <span class="st">"ns(age_decade, df = 2)"</span>)</span>
<span id="cb103-492"><a href="#cb103-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-493"><a href="#cb103-493" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb103-494"><a href="#cb103-494" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_soft, <span class="at">remove =</span> <span class="st">"BMI"</span>, <span class="at">add =</span> <span class="st">"ns(BMI, df = 2)"</span>)</span>
<span id="cb103-495"><a href="#cb103-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-496"><a href="#cb103-496" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-497"><a href="#cb103-497" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_soft, <span class="at">remove =</span> <span class="st">"FC"</span>, <span class="at">add =</span> <span class="st">"ns(FC, df = 2)"</span>)</span>
<span id="cb103-498"><a href="#cb103-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-499"><a href="#cb103-499" aria-hidden="true" tabindex="-1"></a><span class="co"># dqi_tot</span></span>
<span id="cb103-500"><a href="#cb103-500" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_soft,</span>
<span id="cb103-501"><a href="#cb103-501" aria-hidden="true" tabindex="-1"></a>           <span class="at">remove =</span> <span class="st">"dqi_tot"</span>,</span>
<span id="cb103-502"><a href="#cb103-502" aria-hidden="true" tabindex="-1"></a>           <span class="at">add =</span> <span class="st">"ns(dqi_tot, df = 2)"</span>)</span>
<span id="cb103-503"><a href="#cb103-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-504"><a href="#cb103-504" aria-hidden="true" tabindex="-1"></a><span class="co"># None of the continuous variables benefit from a spline term</span></span>
<span id="cb103-505"><a href="#cb103-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-506"><a href="#cb103-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-509"><a href="#cb103-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-510"><a href="#cb103-510" aria-hidden="true" tabindex="-1"></a><span class="co"># Age</span></span>
<span id="cb103-511"><a href="#cb103-511" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-512"><a href="#cb103-512" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-513"><a href="#cb103-513" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_soft,</span>
<span id="cb103-514"><a href="#cb103-514" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"age_decade"</span></span>
<span id="cb103-515"><a href="#cb103-515" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb103-516"><a href="#cb103-516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (decades)"</span>)</span>
<span id="cb103-517"><a href="#cb103-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-518"><a href="#cb103-518" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb103-519"><a href="#cb103-519" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-520"><a href="#cb103-520" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-521"><a href="#cb103-521" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_soft,</span>
<span id="cb103-522"><a href="#cb103-522" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"BMI"</span></span>
<span id="cb103-523"><a href="#cb103-523" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-524"><a href="#cb103-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-525"><a href="#cb103-525" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-526"><a href="#cb103-526" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-527"><a href="#cb103-527" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-528"><a href="#cb103-528" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_soft,</span>
<span id="cb103-529"><a href="#cb103-529" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"FC"</span></span>
<span id="cb103-530"><a href="#cb103-530" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-531"><a href="#cb103-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-532"><a href="#cb103-532" aria-hidden="true" tabindex="-1"></a><span class="co"># DQI</span></span>
<span id="cb103-533"><a href="#cb103-533" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-534"><a href="#cb103-534" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-535"><a href="#cb103-535" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_soft,</span>
<span id="cb103-536"><a href="#cb103-536" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"dqi_tot"</span></span>
<span id="cb103-537"><a href="#cb103-537" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb103-538"><a href="#cb103-538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Diet quality index"</span>)</span>
<span id="cb103-539"><a href="#cb103-539" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-540"><a href="#cb103-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-541"><a href="#cb103-541" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Objective flare</span></span>
<span id="cb103-542"><a href="#cb103-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-545"><a href="#cb103-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-546"><a href="#cb103-546" aria-hidden="true" tabindex="-1"></a><span class="co"># Just the continuous variables</span></span>
<span id="cb103-547"><a href="#cb103-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-548"><a href="#cb103-548" aria-hidden="true" tabindex="-1"></a>cox_cd_hard <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb103-549"><a href="#cb103-549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(hardflare_time, hardflare) <span class="sc">~</span></span>
<span id="cb103-550"><a href="#cb103-550" aria-hidden="true" tabindex="-1"></a>    Sex <span class="sc">+</span></span>
<span id="cb103-551"><a href="#cb103-551" aria-hidden="true" tabindex="-1"></a>    IMD <span class="sc">+</span></span>
<span id="cb103-552"><a href="#cb103-552" aria-hidden="true" tabindex="-1"></a>    age_decade <span class="sc">+</span></span>
<span id="cb103-553"><a href="#cb103-553" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">+</span></span>
<span id="cb103-554"><a href="#cb103-554" aria-hidden="true" tabindex="-1"></a>    FC <span class="sc">+</span></span>
<span id="cb103-555"><a href="#cb103-555" aria-hidden="true" tabindex="-1"></a>    dqi_tot <span class="sc">+</span></span>
<span id="cb103-556"><a href="#cb103-556" aria-hidden="true" tabindex="-1"></a>    <span class="fu">frailty</span>(SiteNo),</span>
<span id="cb103-557"><a href="#cb103-557" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df</span>
<span id="cb103-558"><a href="#cb103-558" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-559"><a href="#cb103-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-560"><a href="#cb103-560" aria-hidden="true" tabindex="-1"></a><span class="co"># Is there any benefit to using spline for:</span></span>
<span id="cb103-561"><a href="#cb103-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-562"><a href="#cb103-562" aria-hidden="true" tabindex="-1"></a><span class="co"># age</span></span>
<span id="cb103-563"><a href="#cb103-563" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_hard, <span class="at">remove =</span> <span class="st">"age_decade"</span>, <span class="at">add =</span> <span class="st">"ns(age_decade, df = 2)"</span>)</span>
<span id="cb103-564"><a href="#cb103-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-565"><a href="#cb103-565" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb103-566"><a href="#cb103-566" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_hard, <span class="at">remove =</span> <span class="st">"BMI"</span>, <span class="at">add =</span> <span class="st">"ns(BMI, df = 2)"</span>)</span>
<span id="cb103-567"><a href="#cb103-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-568"><a href="#cb103-568" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-569"><a href="#cb103-569" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_hard, <span class="at">remove =</span> <span class="st">"FC"</span>, <span class="at">add =</span> <span class="st">"ns(FC, df = 2)"</span>)</span>
<span id="cb103-570"><a href="#cb103-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-571"><a href="#cb103-571" aria-hidden="true" tabindex="-1"></a><span class="co"># dqi_tot</span></span>
<span id="cb103-572"><a href="#cb103-572" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_cd_hard, <span class="at">remove =</span> <span class="st">"dqi_tot"</span>, <span class="at">add =</span> <span class="st">"ns(dqi_tot, df = 2)"</span>)</span>
<span id="cb103-573"><a href="#cb103-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-574"><a href="#cb103-574" aria-hidden="true" tabindex="-1"></a><span class="co"># None of the continuous variables benefit from a spline term</span></span>
<span id="cb103-575"><a href="#cb103-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-576"><a href="#cb103-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-579"><a href="#cb103-579" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-580"><a href="#cb103-580" aria-hidden="true" tabindex="-1"></a><span class="co"># Age</span></span>
<span id="cb103-581"><a href="#cb103-581" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-582"><a href="#cb103-582" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-583"><a href="#cb103-583" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_hard,</span>
<span id="cb103-584"><a href="#cb103-584" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"age_decade"</span></span>
<span id="cb103-585"><a href="#cb103-585" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb103-586"><a href="#cb103-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (decades)"</span>)</span>
<span id="cb103-587"><a href="#cb103-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-588"><a href="#cb103-588" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb103-589"><a href="#cb103-589" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-590"><a href="#cb103-590" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-591"><a href="#cb103-591" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_hard,</span>
<span id="cb103-592"><a href="#cb103-592" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"BMI"</span></span>
<span id="cb103-593"><a href="#cb103-593" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-594"><a href="#cb103-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-595"><a href="#cb103-595" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-596"><a href="#cb103-596" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-597"><a href="#cb103-597" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-598"><a href="#cb103-598" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_hard,</span>
<span id="cb103-599"><a href="#cb103-599" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"FC"</span></span>
<span id="cb103-600"><a href="#cb103-600" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-601"><a href="#cb103-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-602"><a href="#cb103-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-603"><a href="#cb103-603" aria-hidden="true" tabindex="-1"></a><span class="co"># DQI</span></span>
<span id="cb103-604"><a href="#cb103-604" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-605"><a href="#cb103-605" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.cd.df,</span>
<span id="cb103-606"><a href="#cb103-606" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_cd_hard,</span>
<span id="cb103-607"><a href="#cb103-607" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"dqi_tot"</span></span>
<span id="cb103-608"><a href="#cb103-608" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb103-609"><a href="#cb103-609" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Diet quality index"</span>)</span>
<span id="cb103-610"><a href="#cb103-610" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-611"><a href="#cb103-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-612"><a href="#cb103-612" aria-hidden="true" tabindex="-1"></a><span class="fu">### Ulcerative colitis</span></span>
<span id="cb103-613"><a href="#cb103-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-614"><a href="#cb103-614" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Patient-reported flare</span></span>
<span id="cb103-615"><a href="#cb103-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-618"><a href="#cb103-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-619"><a href="#cb103-619" aria-hidden="true" tabindex="-1"></a><span class="co"># Just the continuous variables</span></span>
<span id="cb103-620"><a href="#cb103-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-621"><a href="#cb103-621" aria-hidden="true" tabindex="-1"></a>cox_uc_soft <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb103-622"><a href="#cb103-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(softflare_time, softflare) <span class="sc">~</span></span>
<span id="cb103-623"><a href="#cb103-623" aria-hidden="true" tabindex="-1"></a>    Sex <span class="sc">+</span></span>
<span id="cb103-624"><a href="#cb103-624" aria-hidden="true" tabindex="-1"></a>    IMD <span class="sc">+</span></span>
<span id="cb103-625"><a href="#cb103-625" aria-hidden="true" tabindex="-1"></a>    age_decade <span class="sc">+</span></span>
<span id="cb103-626"><a href="#cb103-626" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">+</span></span>
<span id="cb103-627"><a href="#cb103-627" aria-hidden="true" tabindex="-1"></a>    FC <span class="sc">+</span></span>
<span id="cb103-628"><a href="#cb103-628" aria-hidden="true" tabindex="-1"></a>    dqi_tot <span class="sc">+</span></span>
<span id="cb103-629"><a href="#cb103-629" aria-hidden="true" tabindex="-1"></a>    <span class="fu">frailty</span>(SiteNo),</span>
<span id="cb103-630"><a href="#cb103-630" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.uc.df</span>
<span id="cb103-631"><a href="#cb103-631" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-632"><a href="#cb103-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-633"><a href="#cb103-633" aria-hidden="true" tabindex="-1"></a><span class="co"># Is there any benefit to using spline for:</span></span>
<span id="cb103-634"><a href="#cb103-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-635"><a href="#cb103-635" aria-hidden="true" tabindex="-1"></a><span class="co"># age</span></span>
<span id="cb103-636"><a href="#cb103-636" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_uc_soft, <span class="at">remove =</span> <span class="st">"age_decade"</span>, <span class="at">add =</span> <span class="st">"ns(age_decade, df = 2)"</span>)</span>
<span id="cb103-637"><a href="#cb103-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-638"><a href="#cb103-638" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb103-639"><a href="#cb103-639" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_uc_soft, <span class="at">remove =</span> <span class="st">"BMI"</span>, <span class="at">add =</span> <span class="st">"ns(BMI, df = 2)"</span>)</span>
<span id="cb103-640"><a href="#cb103-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-641"><a href="#cb103-641" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-642"><a href="#cb103-642" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_uc_soft, <span class="at">remove =</span> <span class="st">"FC"</span>, <span class="at">add =</span> <span class="st">"ns(FC, df = 2)"</span>)</span>
<span id="cb103-643"><a href="#cb103-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-644"><a href="#cb103-644" aria-hidden="true" tabindex="-1"></a><span class="co"># dqi_tot</span></span>
<span id="cb103-645"><a href="#cb103-645" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_uc_soft, <span class="at">remove =</span> <span class="st">"dqi_tot"</span>, <span class="at">add =</span> <span class="st">"ns(dqi_tot, df = 2)"</span>)</span>
<span id="cb103-646"><a href="#cb103-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-647"><a href="#cb103-647" aria-hidden="true" tabindex="-1"></a><span class="co"># FC and dqi_tot can get a spline</span></span>
<span id="cb103-648"><a href="#cb103-648" aria-hidden="true" tabindex="-1"></a>cox_uc_soft <span class="ot">&lt;-</span> <span class="fu">coxph</span>(</span>
<span id="cb103-649"><a href="#cb103-649" aria-hidden="true" tabindex="-1"></a>  <span class="fu">Surv</span>(softflare_time, softflare) <span class="sc">~</span></span>
<span id="cb103-650"><a href="#cb103-650" aria-hidden="true" tabindex="-1"></a>    Sex <span class="sc">+</span></span>
<span id="cb103-651"><a href="#cb103-651" aria-hidden="true" tabindex="-1"></a>    IMD <span class="sc">+</span></span>
<span id="cb103-652"><a href="#cb103-652" aria-hidden="true" tabindex="-1"></a>    age_decade <span class="sc">+</span></span>
<span id="cb103-653"><a href="#cb103-653" aria-hidden="true" tabindex="-1"></a>    BMI <span class="sc">+</span></span>
<span id="cb103-654"><a href="#cb103-654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ns</span>(FC, <span class="at">df =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb103-655"><a href="#cb103-655" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ns</span>(dqi_tot, <span class="at">df =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb103-656"><a href="#cb103-656" aria-hidden="true" tabindex="-1"></a>    <span class="fu">frailty</span>(SiteNo),</span>
<span id="cb103-657"><a href="#cb103-657" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.uc.df</span>
<span id="cb103-658"><a href="#cb103-658" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-659"><a href="#cb103-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-660"><a href="#cb103-660" aria-hidden="true" tabindex="-1"></a><span class="co"># Test for df = 3</span></span>
<span id="cb103-661"><a href="#cb103-661" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-662"><a href="#cb103-662" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_uc_soft, <span class="at">remove =</span> <span class="st">"ns(FC, df = 2)"</span>, <span class="at">add =</span> <span class="st">"ns(FC, df = 3)"</span>)</span>
<span id="cb103-663"><a href="#cb103-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-664"><a href="#cb103-664" aria-hidden="true" tabindex="-1"></a><span class="co"># dqi_tot</span></span>
<span id="cb103-665"><a href="#cb103-665" aria-hidden="true" tabindex="-1"></a><span class="fu">summon_lrt</span>(cox_uc_soft,</span>
<span id="cb103-666"><a href="#cb103-666" aria-hidden="true" tabindex="-1"></a>  <span class="at">remove =</span> <span class="st">"ns(dqi_tot, df = 2)"</span>,</span>
<span id="cb103-667"><a href="#cb103-667" aria-hidden="true" tabindex="-1"></a>  <span class="at">add =</span> <span class="st">"ns(dqi_tot, df = 3)"</span></span>
<span id="cb103-668"><a href="#cb103-668" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-669"><a href="#cb103-669" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-670"><a href="#cb103-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-673"><a href="#cb103-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-674"><a href="#cb103-674" aria-hidden="true" tabindex="-1"></a><span class="co"># Age</span></span>
<span id="cb103-675"><a href="#cb103-675" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-676"><a href="#cb103-676" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.uc.df,</span>
<span id="cb103-677"><a href="#cb103-677" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_uc_soft,</span>
<span id="cb103-678"><a href="#cb103-678" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"age_decade"</span></span>
<span id="cb103-679"><a href="#cb103-679" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb103-680"><a href="#cb103-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Age (decades)"</span>)</span>
<span id="cb103-681"><a href="#cb103-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-682"><a href="#cb103-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-683"><a href="#cb103-683" aria-hidden="true" tabindex="-1"></a><span class="co"># BMI</span></span>
<span id="cb103-684"><a href="#cb103-684" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-685"><a href="#cb103-685" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.uc.df,</span>
<span id="cb103-686"><a href="#cb103-686" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_uc_soft,</span>
<span id="cb103-687"><a href="#cb103-687" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"BMI"</span></span>
<span id="cb103-688"><a href="#cb103-688" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-689"><a href="#cb103-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-690"><a href="#cb103-690" aria-hidden="true" tabindex="-1"></a><span class="co"># FC</span></span>
<span id="cb103-691"><a href="#cb103-691" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-692"><a href="#cb103-692" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.uc.df,</span>
<span id="cb103-693"><a href="#cb103-693" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_uc_soft,</span>
<span id="cb103-694"><a href="#cb103-694" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"FC"</span>,</span>
<span id="cb103-695"><a href="#cb103-695" aria-hidden="true" tabindex="-1"></a>  <span class="at">splineterm =</span> <span class="st">"ns(FC, df = 2)"</span></span>
<span id="cb103-696"><a href="#cb103-696" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-697"><a href="#cb103-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-698"><a href="#cb103-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-699"><a href="#cb103-699" aria-hidden="true" tabindex="-1"></a><span class="co"># DQI</span></span>
<span id="cb103-700"><a href="#cb103-700" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_continuous_hr</span>(</span>
<span id="cb103-701"><a href="#cb103-701" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> flare.uc.df,</span>
<span id="cb103-702"><a href="#cb103-702" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> cox_uc_soft,</span>
<span id="cb103-703"><a href="#cb103-703" aria-hidden="true" tabindex="-1"></a>  <span class="at">variable =</span> <span class="st">"dqi_tot"</span>,</span>
<span id="cb103-704"><a href="#cb103-704" aria-hidden="true" tabindex="-1"></a>  <span class="at">splineterm =</span> <span class="st">"ns(dqi_tot, df = 2)"</span></span>
<span id="cb103-705"><a href="#cb103-705" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb103-706"><a href="#cb103-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Diet quality index"</span>)</span>
<span id="cb103-707"><a href="#cb103-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-708"><a href="#cb103-708" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective flare</span></span>
<span id="cb103-709"><a href="#cb103-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-712"><a href="#cb103-712" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-713"><a href="#cb103-713" aria-hidden="true" tabindex="-1"></a><span class="at"># Just the continuous variables</span></span>
<span id="cb103-714"><a href="#cb103-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-715"><a href="#cb103-715" aria-hidden="true" tabindex="-1"></a><span class="at">cox_uc_hard &lt;- coxph(</span></span>
<span id="cb103-716"><a href="#cb103-716" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-717"><a href="#cb103-717" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-718"><a href="#cb103-718" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-719"><a href="#cb103-719" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-720"><a href="#cb103-720" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-721"><a href="#cb103-721" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-722"><a href="#cb103-722" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-723"><a href="#cb103-723" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-724"><a href="#cb103-724" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-725"><a href="#cb103-725" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-726"><a href="#cb103-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-727"><a href="#cb103-727" aria-hidden="true" tabindex="-1"></a><span class="at"># Is there any benefit to using spline for:</span></span>
<span id="cb103-728"><a href="#cb103-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-729"><a href="#cb103-729" aria-hidden="true" tabindex="-1"></a><span class="at"># age</span></span>
<span id="cb103-730"><a href="#cb103-730" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_uc_hard, remove = "age_decade", add = "ns(age_decade, df = 2)")</span></span>
<span id="cb103-731"><a href="#cb103-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-732"><a href="#cb103-732" aria-hidden="true" tabindex="-1"></a><span class="at"># BMI</span></span>
<span id="cb103-733"><a href="#cb103-733" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_uc_hard, remove = "BMI", add = "ns(BMI, df = 2)")</span></span>
<span id="cb103-734"><a href="#cb103-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-735"><a href="#cb103-735" aria-hidden="true" tabindex="-1"></a><span class="at"># FC</span></span>
<span id="cb103-736"><a href="#cb103-736" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_uc_hard, remove = "FC", add = "ns(FC, df = 2)")</span></span>
<span id="cb103-737"><a href="#cb103-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-738"><a href="#cb103-738" aria-hidden="true" tabindex="-1"></a><span class="at"># dqi_tot</span></span>
<span id="cb103-739"><a href="#cb103-739" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_uc_hard, remove = "dqi_tot", add = "ns(dqi_tot, df = 2)")</span></span>
<span id="cb103-740"><a href="#cb103-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-741"><a href="#cb103-741" aria-hidden="true" tabindex="-1"></a><span class="at"># FC benefits from a spline</span></span>
<span id="cb103-742"><a href="#cb103-742" aria-hidden="true" tabindex="-1"></a><span class="at">cox_uc_hard &lt;- coxph(</span></span>
<span id="cb103-743"><a href="#cb103-743" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-744"><a href="#cb103-744" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-745"><a href="#cb103-745" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-746"><a href="#cb103-746" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-747"><a href="#cb103-747" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-748"><a href="#cb103-748" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-749"><a href="#cb103-749" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-750"><a href="#cb103-750" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-751"><a href="#cb103-751" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-752"><a href="#cb103-752" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-753"><a href="#cb103-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-754"><a href="#cb103-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-755"><a href="#cb103-755" aria-hidden="true" tabindex="-1"></a><span class="at"># FC</span></span>
<span id="cb103-756"><a href="#cb103-756" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_uc_hard, remove = "ns(FC, df = 2)", add = "ns(FC, df = 3)")</span></span>
<span id="cb103-757"><a href="#cb103-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-758"><a href="#cb103-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-759"><a href="#cb103-759" aria-hidden="true" tabindex="-1"></a><span class="at"># Test for df = 3. df = 2 is sufficient for FC</span></span>
<span id="cb103-760"><a href="#cb103-760" aria-hidden="true" tabindex="-1"></a><span class="at"># FC</span></span>
<span id="cb103-761"><a href="#cb103-761" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_uc_hard, remove = "ns(FC, df = 2)", add = "ns(FC, df = 3)")</span></span>
<span id="cb103-762"><a href="#cb103-762" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-763"><a href="#cb103-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-766"><a href="#cb103-766" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-767"><a href="#cb103-767" aria-hidden="true" tabindex="-1"></a><span class="at"># Age</span></span>
<span id="cb103-768"><a href="#cb103-768" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-769"><a href="#cb103-769" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-770"><a href="#cb103-770" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_uc_hard,</span></span>
<span id="cb103-771"><a href="#cb103-771" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "age_decade"</span></span>
<span id="cb103-772"><a href="#cb103-772" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-773"><a href="#cb103-773" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Age (decades)")</span></span>
<span id="cb103-774"><a href="#cb103-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-775"><a href="#cb103-775" aria-hidden="true" tabindex="-1"></a><span class="at"># BMI</span></span>
<span id="cb103-776"><a href="#cb103-776" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-777"><a href="#cb103-777" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-778"><a href="#cb103-778" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_uc_hard,</span></span>
<span id="cb103-779"><a href="#cb103-779" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "BMI"</span></span>
<span id="cb103-780"><a href="#cb103-780" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-781"><a href="#cb103-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-782"><a href="#cb103-782" aria-hidden="true" tabindex="-1"></a><span class="at"># FC</span></span>
<span id="cb103-783"><a href="#cb103-783" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-784"><a href="#cb103-784" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-785"><a href="#cb103-785" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_uc_hard,</span></span>
<span id="cb103-786"><a href="#cb103-786" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "FC",</span></span>
<span id="cb103-787"><a href="#cb103-787" aria-hidden="true" tabindex="-1"></a><span class="at">  splineterm = "ns(FC, df = 2)"</span></span>
<span id="cb103-788"><a href="#cb103-788" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-789"><a href="#cb103-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-790"><a href="#cb103-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-791"><a href="#cb103-791" aria-hidden="true" tabindex="-1"></a><span class="at"># DQI</span></span>
<span id="cb103-792"><a href="#cb103-792" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr( </span></span>
<span id="cb103-793"><a href="#cb103-793" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-794"><a href="#cb103-794" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_uc_hard,</span></span>
<span id="cb103-795"><a href="#cb103-795" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "dqi_tot"</span></span>
<span id="cb103-796"><a href="#cb103-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-797"><a href="#cb103-797" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-798"><a href="#cb103-798" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Diet quality index")</span></span>
<span id="cb103-799"><a href="#cb103-799" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-800"><a href="#cb103-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-801"><a href="#cb103-801" aria-hidden="true" tabindex="-1"></a><span class="do">## Total meat protein</span></span>
<span id="cb103-802"><a href="#cb103-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-803"><a href="#cb103-803" aria-hidden="true" tabindex="-1"></a>This section examines the association between total meat protein <span class="fu">intake</span> (grams per day) and time to flare. Cox models are adjusted <span class="cf">for</span> sex, Index of Multiple <span class="fu">Deprivation</span> (IMD), age, BMI, <span class="fu">FC</span> (continuous), and diet quality index, with a frailty term <span class="cf">for</span> study site. We first test whether the relationship is non<span class="sc">-</span>linear using splines, then present hazard ratios and continuous HR curves.</span>
<span id="cb103-804"><a href="#cb103-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-805"><a href="#cb103-805" aria-hidden="true" tabindex="-1"></a><span class="do">### Crohn's disease</span></span>
<span id="cb103-806"><a href="#cb103-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-807"><a href="#cb103-807" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient reported flare</span></span>
<span id="cb103-808"><a href="#cb103-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-811"><a href="#cb103-811" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-812"><a href="#cb103-812" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_cd_soft &lt;- coxph(</span></span>
<span id="cb103-813"><a href="#cb103-813" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-814"><a href="#cb103-814" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-815"><a href="#cb103-815" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-816"><a href="#cb103-816" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-817"><a href="#cb103-817" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-818"><a href="#cb103-818" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-819"><a href="#cb103-819" aria-hidden="true" tabindex="-1"></a><span class="at">    Meat_sum +</span></span>
<span id="cb103-820"><a href="#cb103-820" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-821"><a href="#cb103-821" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-822"><a href="#cb103-822" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-823"><a href="#cb103-823" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-824"><a href="#cb103-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-825"><a href="#cb103-825" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-826"><a href="#cb103-826" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_meat_cd_soft, remove = "Meat_sum", add = "ns(Meat_sum, df = 2)")</span></span>
<span id="cb103-827"><a href="#cb103-827" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-828"><a href="#cb103-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-831"><a href="#cb103-831" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-832"><a href="#cb103-832" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_cd_soft %&gt;%</span></span>
<span id="cb103-833"><a href="#cb103-833" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-834"><a href="#cb103-834" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-835"><a href="#cb103-835" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-836"><a href="#cb103-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-839"><a href="#cb103-839" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-840"><a href="#cb103-840" aria-hidden="true" tabindex="-1"></a><span class="at"># Meat sum</span></span>
<span id="cb103-841"><a href="#cb103-841" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-842"><a href="#cb103-842" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-843"><a href="#cb103-843" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_cd_soft,</span></span>
<span id="cb103-844"><a href="#cb103-844" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum"</span></span>
<span id="cb103-845"><a href="#cb103-845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-846"><a href="#cb103-846" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-847"><a href="#cb103-847" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Total meat protein (grams)")</span></span>
<span id="cb103-848"><a href="#cb103-848" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-849"><a href="#cb103-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-850"><a href="#cb103-850" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective flare</span></span>
<span id="cb103-851"><a href="#cb103-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-854"><a href="#cb103-854" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-855"><a href="#cb103-855" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_cd_hard &lt;- coxph(</span></span>
<span id="cb103-856"><a href="#cb103-856" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-857"><a href="#cb103-857" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-858"><a href="#cb103-858" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-859"><a href="#cb103-859" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-860"><a href="#cb103-860" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-861"><a href="#cb103-861" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-862"><a href="#cb103-862" aria-hidden="true" tabindex="-1"></a><span class="at">    Meat_sum +</span></span>
<span id="cb103-863"><a href="#cb103-863" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-864"><a href="#cb103-864" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-865"><a href="#cb103-865" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-866"><a href="#cb103-866" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-867"><a href="#cb103-867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-868"><a href="#cb103-868" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-869"><a href="#cb103-869" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_meat_cd_hard, remove = "Meat_sum", add = "ns(Meat_sum, df = 2)")</span></span>
<span id="cb103-870"><a href="#cb103-870" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-871"><a href="#cb103-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-872"><a href="#cb103-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-875"><a href="#cb103-875" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-876"><a href="#cb103-876" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_cd_hard %&gt;%</span></span>
<span id="cb103-877"><a href="#cb103-877" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-878"><a href="#cb103-878" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-879"><a href="#cb103-879" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-880"><a href="#cb103-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-883"><a href="#cb103-883" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-884"><a href="#cb103-884" aria-hidden="true" tabindex="-1"></a><span class="at"># Meat sum</span></span>
<span id="cb103-885"><a href="#cb103-885" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-886"><a href="#cb103-886" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-887"><a href="#cb103-887" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_cd_hard,</span></span>
<span id="cb103-888"><a href="#cb103-888" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum"</span></span>
<span id="cb103-889"><a href="#cb103-889" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-890"><a href="#cb103-890" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Total meat protein (grams)")</span></span>
<span id="cb103-891"><a href="#cb103-891" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-892"><a href="#cb103-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-893"><a href="#cb103-893" aria-hidden="true" tabindex="-1"></a><span class="do">### Ulcerative colitis</span></span>
<span id="cb103-894"><a href="#cb103-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-895"><a href="#cb103-895" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient reported flare</span></span>
<span id="cb103-896"><a href="#cb103-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-899"><a href="#cb103-899" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-900"><a href="#cb103-900" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_uc_soft &lt;- coxph(</span></span>
<span id="cb103-901"><a href="#cb103-901" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-902"><a href="#cb103-902" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-903"><a href="#cb103-903" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-904"><a href="#cb103-904" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-905"><a href="#cb103-905" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-906"><a href="#cb103-906" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-907"><a href="#cb103-907" aria-hidden="true" tabindex="-1"></a><span class="at">    Meat_sum +</span></span>
<span id="cb103-908"><a href="#cb103-908" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(dqi_tot, df = 2) +</span></span>
<span id="cb103-909"><a href="#cb103-909" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-910"><a href="#cb103-910" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-911"><a href="#cb103-911" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-912"><a href="#cb103-912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-913"><a href="#cb103-913" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-914"><a href="#cb103-914" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_meat_uc_soft, remove = "Meat_sum", add = "ns(Meat_sum, df = 2)")</span></span>
<span id="cb103-915"><a href="#cb103-915" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-916"><a href="#cb103-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-919"><a href="#cb103-919" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-920"><a href="#cb103-920" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_uc_soft %&gt;%</span></span>
<span id="cb103-921"><a href="#cb103-921" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-922"><a href="#cb103-922" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-923"><a href="#cb103-923" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-924"><a href="#cb103-924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-927"><a href="#cb103-927" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-928"><a href="#cb103-928" aria-hidden="true" tabindex="-1"></a><span class="at"># Meat sum</span></span>
<span id="cb103-929"><a href="#cb103-929" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-930"><a href="#cb103-930" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-931"><a href="#cb103-931" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_uc_soft,</span></span>
<span id="cb103-932"><a href="#cb103-932" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum"</span></span>
<span id="cb103-933"><a href="#cb103-933" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-934"><a href="#cb103-934" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Total meat protein (grams)")</span></span>
<span id="cb103-935"><a href="#cb103-935" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-936"><a href="#cb103-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-937"><a href="#cb103-937" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective flare</span></span>
<span id="cb103-938"><a href="#cb103-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-941"><a href="#cb103-941" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-942"><a href="#cb103-942" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_uc_hard &lt;- coxph(</span></span>
<span id="cb103-943"><a href="#cb103-943" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-944"><a href="#cb103-944" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-945"><a href="#cb103-945" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-946"><a href="#cb103-946" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-947"><a href="#cb103-947" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-948"><a href="#cb103-948" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-949"><a href="#cb103-949" aria-hidden="true" tabindex="-1"></a><span class="at">    Meat_sum +</span></span>
<span id="cb103-950"><a href="#cb103-950" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-951"><a href="#cb103-951" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-952"><a href="#cb103-952" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-953"><a href="#cb103-953" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-954"><a href="#cb103-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-955"><a href="#cb103-955" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-956"><a href="#cb103-956" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_meat_uc_hard, remove = "Meat_sum", add = "ns(Meat_sum, df = 2)")</span></span>
<span id="cb103-957"><a href="#cb103-957" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-958"><a href="#cb103-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-961"><a href="#cb103-961" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-962"><a href="#cb103-962" aria-hidden="true" tabindex="-1"></a><span class="at">cox_meat_uc_hard %&gt;%</span></span>
<span id="cb103-963"><a href="#cb103-963" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-964"><a href="#cb103-964" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-965"><a href="#cb103-965" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-966"><a href="#cb103-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-969"><a href="#cb103-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-970"><a href="#cb103-970" aria-hidden="true" tabindex="-1"></a><span class="at"># Meat sum</span></span>
<span id="cb103-971"><a href="#cb103-971" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-972"><a href="#cb103-972" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-973"><a href="#cb103-973" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_uc_hard,</span></span>
<span id="cb103-974"><a href="#cb103-974" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum"</span></span>
<span id="cb103-975"><a href="#cb103-975" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-976"><a href="#cb103-976" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Total meat protein (grams)")</span></span>
<span id="cb103-977"><a href="#cb103-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-978"><a href="#cb103-978" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-979"><a href="#cb103-979" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-980"><a href="#cb103-980" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_uc_hard,</span></span>
<span id="cb103-981"><a href="#cb103-981" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "FC",</span></span>
<span id="cb103-982"><a href="#cb103-982" aria-hidden="true" tabindex="-1"></a><span class="at">  splineterm = "ns(FC, df = 2)"</span></span>
<span id="cb103-983"><a href="#cb103-983" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-984"><a href="#cb103-984" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-985"><a href="#cb103-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-986"><a href="#cb103-986" aria-hidden="true" tabindex="-1"></a><span class="do">## Dietary Fibre</span></span>
<span id="cb103-987"><a href="#cb103-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-988"><a href="#cb103-988" aria-hidden="true" tabindex="-1"></a>This section examines the association between dietary fibre <span class="fu">intake</span> (grams per day) and time to flare, using the same covariate adjustment strategy as the meat protein analysis.</span>
<span id="cb103-989"><a href="#cb103-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-990"><a href="#cb103-990" aria-hidden="true" tabindex="-1"></a><span class="do">### Crohn's disease</span></span>
<span id="cb103-991"><a href="#cb103-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-992"><a href="#cb103-992" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-993"><a href="#cb103-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-996"><a href="#cb103-996" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-997"><a href="#cb103-997" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_cd_soft &lt;- coxph(</span></span>
<span id="cb103-998"><a href="#cb103-998" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-999"><a href="#cb103-999" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1000"><a href="#cb103-1000" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1001"><a href="#cb103-1001" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1002"><a href="#cb103-1002" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1003"><a href="#cb103-1003" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1004"><a href="#cb103-1004" aria-hidden="true" tabindex="-1"></a><span class="at">    fibre +</span></span>
<span id="cb103-1005"><a href="#cb103-1005" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1006"><a href="#cb103-1006" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1007"><a href="#cb103-1007" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1008"><a href="#cb103-1008" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1009"><a href="#cb103-1009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1010"><a href="#cb103-1010" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1011"><a href="#cb103-1011" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_fibre_cd_soft, remove = "fibre", add = "ns(fibre, df = 2)")</span></span>
<span id="cb103-1012"><a href="#cb103-1012" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1013"><a href="#cb103-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1016"><a href="#cb103-1016" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1017"><a href="#cb103-1017" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_cd_soft %&gt;%</span></span>
<span id="cb103-1018"><a href="#cb103-1018" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1019"><a href="#cb103-1019" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1020"><a href="#cb103-1020" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1021"><a href="#cb103-1021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1024"><a href="#cb103-1024" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1025"><a href="#cb103-1025" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1026"><a href="#cb103-1026" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1027"><a href="#cb103-1027" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_cd_soft,</span></span>
<span id="cb103-1028"><a href="#cb103-1028" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre"</span></span>
<span id="cb103-1029"><a href="#cb103-1029" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1030"><a href="#cb103-1030" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Dietary fibre")</span></span>
<span id="cb103-1031"><a href="#cb103-1031" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1032"><a href="#cb103-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1033"><a href="#cb103-1033" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1034"><a href="#cb103-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1037"><a href="#cb103-1037" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1038"><a href="#cb103-1038" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_cd_hard &lt;- coxph(</span></span>
<span id="cb103-1039"><a href="#cb103-1039" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-1040"><a href="#cb103-1040" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1041"><a href="#cb103-1041" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1042"><a href="#cb103-1042" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1043"><a href="#cb103-1043" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1044"><a href="#cb103-1044" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1045"><a href="#cb103-1045" aria-hidden="true" tabindex="-1"></a><span class="at">    fibre +</span></span>
<span id="cb103-1046"><a href="#cb103-1046" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1047"><a href="#cb103-1047" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1048"><a href="#cb103-1048" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1049"><a href="#cb103-1049" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1050"><a href="#cb103-1050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1051"><a href="#cb103-1051" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_fibre_cd_hard, remove = "fibre", add = "ns(fibre, df = 2)")</span></span>
<span id="cb103-1052"><a href="#cb103-1052" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1053"><a href="#cb103-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1056"><a href="#cb103-1056" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1057"><a href="#cb103-1057" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_cd_hard %&gt;%</span></span>
<span id="cb103-1058"><a href="#cb103-1058" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1059"><a href="#cb103-1059" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1060"><a href="#cb103-1060" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1061"><a href="#cb103-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1064"><a href="#cb103-1064" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1065"><a href="#cb103-1065" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1066"><a href="#cb103-1066" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1067"><a href="#cb103-1067" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_cd_hard,</span></span>
<span id="cb103-1068"><a href="#cb103-1068" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre"</span></span>
<span id="cb103-1069"><a href="#cb103-1069" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1070"><a href="#cb103-1070" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Dietary fibre (grams)")</span></span>
<span id="cb103-1071"><a href="#cb103-1071" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1072"><a href="#cb103-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1073"><a href="#cb103-1073" aria-hidden="true" tabindex="-1"></a><span class="do">### Ulcerative colitis</span></span>
<span id="cb103-1074"><a href="#cb103-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1075"><a href="#cb103-1075" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1076"><a href="#cb103-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1079"><a href="#cb103-1079" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1080"><a href="#cb103-1080" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_uc_soft &lt;- coxph(</span></span>
<span id="cb103-1081"><a href="#cb103-1081" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-1082"><a href="#cb103-1082" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1083"><a href="#cb103-1083" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1084"><a href="#cb103-1084" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1085"><a href="#cb103-1085" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1086"><a href="#cb103-1086" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-1087"><a href="#cb103-1087" aria-hidden="true" tabindex="-1"></a><span class="at">    fibre +</span></span>
<span id="cb103-1088"><a href="#cb103-1088" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(dqi_tot, df = 2) +</span></span>
<span id="cb103-1089"><a href="#cb103-1089" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1090"><a href="#cb103-1090" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-1091"><a href="#cb103-1091" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1092"><a href="#cb103-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1093"><a href="#cb103-1093" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_fibre_uc_soft, remove = "fibre", add = "ns(fibre, df = 2)")</span></span>
<span id="cb103-1094"><a href="#cb103-1094" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1095"><a href="#cb103-1095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1098"><a href="#cb103-1098" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1099"><a href="#cb103-1099" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_uc_soft %&gt;%</span></span>
<span id="cb103-1100"><a href="#cb103-1100" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1101"><a href="#cb103-1101" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1102"><a href="#cb103-1102" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1103"><a href="#cb103-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1106"><a href="#cb103-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1107"><a href="#cb103-1107" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1108"><a href="#cb103-1108" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1109"><a href="#cb103-1109" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_uc_soft,</span></span>
<span id="cb103-1110"><a href="#cb103-1110" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre"</span></span>
<span id="cb103-1111"><a href="#cb103-1111" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1112"><a href="#cb103-1112" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Dietary fibre (grams)")</span></span>
<span id="cb103-1113"><a href="#cb103-1113" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1114"><a href="#cb103-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1115"><a href="#cb103-1115" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1116"><a href="#cb103-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1119"><a href="#cb103-1119" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1120"><a href="#cb103-1120" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_uc_hard &lt;- coxph(</span></span>
<span id="cb103-1121"><a href="#cb103-1121" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-1122"><a href="#cb103-1122" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1123"><a href="#cb103-1123" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1124"><a href="#cb103-1124" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1125"><a href="#cb103-1125" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1126"><a href="#cb103-1126" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-1127"><a href="#cb103-1127" aria-hidden="true" tabindex="-1"></a><span class="at">    fibre +</span></span>
<span id="cb103-1128"><a href="#cb103-1128" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1129"><a href="#cb103-1129" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1130"><a href="#cb103-1130" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-1131"><a href="#cb103-1131" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1132"><a href="#cb103-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1133"><a href="#cb103-1133" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_fibre_uc_hard, remove = "fibre", add = "ns(fibre, df = 2)")</span></span>
<span id="cb103-1134"><a href="#cb103-1134" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1135"><a href="#cb103-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1138"><a href="#cb103-1138" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1139"><a href="#cb103-1139" aria-hidden="true" tabindex="-1"></a><span class="at">cox_fibre_uc_hard %&gt;%</span></span>
<span id="cb103-1140"><a href="#cb103-1140" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1141"><a href="#cb103-1141" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1142"><a href="#cb103-1142" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1143"><a href="#cb103-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1146"><a href="#cb103-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1147"><a href="#cb103-1147" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1148"><a href="#cb103-1148" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1149"><a href="#cb103-1149" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_uc_hard,</span></span>
<span id="cb103-1150"><a href="#cb103-1150" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre"</span></span>
<span id="cb103-1151"><a href="#cb103-1151" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1152"><a href="#cb103-1152" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("Dietary fibre (grams)")</span></span>
<span id="cb103-1153"><a href="#cb103-1153" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1154"><a href="#cb103-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1155"><a href="#cb103-1155" aria-hidden="true" tabindex="-1"></a><span class="do">## Polyunsaturated fatty acids</span></span>
<span id="cb103-1156"><a href="#cb103-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1157"><a href="#cb103-1157" aria-hidden="true" tabindex="-1"></a>This section examines the association between PUFA <span class="fu">intake</span> (as percentage of total energy) and time to flare. Note that <span class="cf">while</span> the study protocol specified n<span class="dv">-6</span> PUFAs, the available FFQ data captures total <span class="fu">PUFA</span> (both n<span class="dv">-3</span> and n<span class="dv">-6</span>).</span>
<span id="cb103-1158"><a href="#cb103-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1159"><a href="#cb103-1159" aria-hidden="true" tabindex="-1"></a><span class="do">### Crohn's disease</span></span>
<span id="cb103-1160"><a href="#cb103-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1161"><a href="#cb103-1161" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1162"><a href="#cb103-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1165"><a href="#cb103-1165" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1166"><a href="#cb103-1166" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_cd_soft &lt;- coxph(</span></span>
<span id="cb103-1167"><a href="#cb103-1167" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-1168"><a href="#cb103-1168" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1169"><a href="#cb103-1169" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1170"><a href="#cb103-1170" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1171"><a href="#cb103-1171" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1172"><a href="#cb103-1172" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1173"><a href="#cb103-1173" aria-hidden="true" tabindex="-1"></a><span class="at">    PUFA_percEng +</span></span>
<span id="cb103-1174"><a href="#cb103-1174" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1175"><a href="#cb103-1175" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1176"><a href="#cb103-1176" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1177"><a href="#cb103-1177" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1178"><a href="#cb103-1178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1179"><a href="#cb103-1179" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? Close to 0.05, lets add one</span></span>
<span id="cb103-1180"><a href="#cb103-1180" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_pufa_cd_soft,</span></span>
<span id="cb103-1181"><a href="#cb103-1181" aria-hidden="true" tabindex="-1"></a><span class="at">  remove = "PUFA_percEng",</span></span>
<span id="cb103-1182"><a href="#cb103-1182" aria-hidden="true" tabindex="-1"></a><span class="at">  add = "ns(PUFA_percEng, df = 2)"</span></span>
<span id="cb103-1183"><a href="#cb103-1183" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1184"><a href="#cb103-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1185"><a href="#cb103-1185" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_cd_soft &lt;- coxph(</span></span>
<span id="cb103-1186"><a href="#cb103-1186" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-1187"><a href="#cb103-1187" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1188"><a href="#cb103-1188" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1189"><a href="#cb103-1189" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1190"><a href="#cb103-1190" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1191"><a href="#cb103-1191" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1192"><a href="#cb103-1192" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(PUFA_percEng, df = 2) +</span></span>
<span id="cb103-1193"><a href="#cb103-1193" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1194"><a href="#cb103-1194" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1195"><a href="#cb103-1195" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1196"><a href="#cb103-1196" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1197"><a href="#cb103-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1198"><a href="#cb103-1198" aria-hidden="true" tabindex="-1"></a><span class="at"># df = 2 is sufficient</span></span>
<span id="cb103-1199"><a href="#cb103-1199" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_pufa_cd_soft,</span></span>
<span id="cb103-1200"><a href="#cb103-1200" aria-hidden="true" tabindex="-1"></a><span class="at">  remove = "ns(PUFA_percEng, df = 2)",</span></span>
<span id="cb103-1201"><a href="#cb103-1201" aria-hidden="true" tabindex="-1"></a><span class="at">  add = "ns(PUFA_percEng, df = 3)"</span></span>
<span id="cb103-1202"><a href="#cb103-1202" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1203"><a href="#cb103-1203" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1204"><a href="#cb103-1204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1205"><a href="#cb103-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1208"><a href="#cb103-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1209"><a href="#cb103-1209" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_cd_soft %&gt;%</span></span>
<span id="cb103-1210"><a href="#cb103-1210" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1211"><a href="#cb103-1211" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1212"><a href="#cb103-1212" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1213"><a href="#cb103-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1216"><a href="#cb103-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1217"><a href="#cb103-1217" aria-hidden="true" tabindex="-1"></a><span class="at"># Significance - need to use LRT</span></span>
<span id="cb103-1218"><a href="#cb103-1218" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_pufa_cd_soft, remove = "ns(PUFA_percEng, df = 2)")</span></span>
<span id="cb103-1219"><a href="#cb103-1219" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1220"><a href="#cb103-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1223"><a href="#cb103-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1224"><a href="#cb103-1224" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1225"><a href="#cb103-1225" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1226"><a href="#cb103-1226" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_cd_soft,</span></span>
<span id="cb103-1227"><a href="#cb103-1227" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng",</span></span>
<span id="cb103-1228"><a href="#cb103-1228" aria-hidden="true" tabindex="-1"></a><span class="at">  splineterm = "ns(PUFA_percEng, df = 2)"</span></span>
<span id="cb103-1229"><a href="#cb103-1229" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1230"><a href="#cb103-1230" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("PUFA")</span></span>
<span id="cb103-1231"><a href="#cb103-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1232"><a href="#cb103-1232" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1233"><a href="#cb103-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1234"><a href="#cb103-1234" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1235"><a href="#cb103-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1238"><a href="#cb103-1238" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1239"><a href="#cb103-1239" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_cd_hard &lt;- coxph(</span></span>
<span id="cb103-1240"><a href="#cb103-1240" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-1241"><a href="#cb103-1241" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1242"><a href="#cb103-1242" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1243"><a href="#cb103-1243" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1244"><a href="#cb103-1244" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1245"><a href="#cb103-1245" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1246"><a href="#cb103-1246" aria-hidden="true" tabindex="-1"></a><span class="at">    PUFA_percEng +</span></span>
<span id="cb103-1247"><a href="#cb103-1247" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1248"><a href="#cb103-1248" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1249"><a href="#cb103-1249" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1250"><a href="#cb103-1250" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1251"><a href="#cb103-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1252"><a href="#cb103-1252" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1253"><a href="#cb103-1253" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_pufa_cd_hard,</span></span>
<span id="cb103-1254"><a href="#cb103-1254" aria-hidden="true" tabindex="-1"></a><span class="at">  remove = "PUFA_percEng",</span></span>
<span id="cb103-1255"><a href="#cb103-1255" aria-hidden="true" tabindex="-1"></a><span class="at">  add = "ns(PUFA_percEng, df = 2)"</span></span>
<span id="cb103-1256"><a href="#cb103-1256" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1257"><a href="#cb103-1257" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1258"><a href="#cb103-1258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1261"><a href="#cb103-1261" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1262"><a href="#cb103-1262" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_cd_hard %&gt;%</span></span>
<span id="cb103-1263"><a href="#cb103-1263" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1264"><a href="#cb103-1264" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1265"><a href="#cb103-1265" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1266"><a href="#cb103-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1269"><a href="#cb103-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1270"><a href="#cb103-1270" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1271"><a href="#cb103-1271" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1272"><a href="#cb103-1272" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_cd_hard,</span></span>
<span id="cb103-1273"><a href="#cb103-1273" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng"</span></span>
<span id="cb103-1274"><a href="#cb103-1274" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1275"><a href="#cb103-1275" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("PUFA")</span></span>
<span id="cb103-1276"><a href="#cb103-1276" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1277"><a href="#cb103-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1278"><a href="#cb103-1278" aria-hidden="true" tabindex="-1"></a><span class="do">### Ulcerative colitis</span></span>
<span id="cb103-1279"><a href="#cb103-1279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1280"><a href="#cb103-1280" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1281"><a href="#cb103-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1284"><a href="#cb103-1284" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1285"><a href="#cb103-1285" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_uc_soft &lt;- coxph(</span></span>
<span id="cb103-1286"><a href="#cb103-1286" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-1287"><a href="#cb103-1287" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1288"><a href="#cb103-1288" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1289"><a href="#cb103-1289" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1290"><a href="#cb103-1290" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1291"><a href="#cb103-1291" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-1292"><a href="#cb103-1292" aria-hidden="true" tabindex="-1"></a><span class="at">    PUFA_percEng +</span></span>
<span id="cb103-1293"><a href="#cb103-1293" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(dqi_tot, df = 2) +</span></span>
<span id="cb103-1294"><a href="#cb103-1294" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1295"><a href="#cb103-1295" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-1296"><a href="#cb103-1296" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1297"><a href="#cb103-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1298"><a href="#cb103-1298" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1299"><a href="#cb103-1299" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_pufa_uc_soft,</span></span>
<span id="cb103-1300"><a href="#cb103-1300" aria-hidden="true" tabindex="-1"></a><span class="at">  remove = "PUFA_percEng",</span></span>
<span id="cb103-1301"><a href="#cb103-1301" aria-hidden="true" tabindex="-1"></a><span class="at">  add = "ns(PUFA_percEng, df = 2)"</span></span>
<span id="cb103-1302"><a href="#cb103-1302" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1303"><a href="#cb103-1303" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1304"><a href="#cb103-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1307"><a href="#cb103-1307" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1308"><a href="#cb103-1308" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_uc_soft %&gt;%</span></span>
<span id="cb103-1309"><a href="#cb103-1309" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1310"><a href="#cb103-1310" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1311"><a href="#cb103-1311" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1312"><a href="#cb103-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1315"><a href="#cb103-1315" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1316"><a href="#cb103-1316" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1317"><a href="#cb103-1317" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1318"><a href="#cb103-1318" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_uc_soft,</span></span>
<span id="cb103-1319"><a href="#cb103-1319" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng"</span></span>
<span id="cb103-1320"><a href="#cb103-1320" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1321"><a href="#cb103-1321" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("PUFA")</span></span>
<span id="cb103-1322"><a href="#cb103-1322" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1323"><a href="#cb103-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1324"><a href="#cb103-1324" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1325"><a href="#cb103-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1328"><a href="#cb103-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1329"><a href="#cb103-1329" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_uc_hard &lt;- coxph(</span></span>
<span id="cb103-1330"><a href="#cb103-1330" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-1331"><a href="#cb103-1331" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1332"><a href="#cb103-1332" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1333"><a href="#cb103-1333" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1334"><a href="#cb103-1334" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1335"><a href="#cb103-1335" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-1336"><a href="#cb103-1336" aria-hidden="true" tabindex="-1"></a><span class="at">    PUFA_percEng +</span></span>
<span id="cb103-1337"><a href="#cb103-1337" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1338"><a href="#cb103-1338" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1339"><a href="#cb103-1339" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-1340"><a href="#cb103-1340" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1341"><a href="#cb103-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1342"><a href="#cb103-1342" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1343"><a href="#cb103-1343" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_pufa_uc_hard,</span></span>
<span id="cb103-1344"><a href="#cb103-1344" aria-hidden="true" tabindex="-1"></a><span class="at">  remove = "PUFA_percEng",</span></span>
<span id="cb103-1345"><a href="#cb103-1345" aria-hidden="true" tabindex="-1"></a><span class="at">  add = "ns(PUFA_percEng, df = 2)"</span></span>
<span id="cb103-1346"><a href="#cb103-1346" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1347"><a href="#cb103-1347" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1348"><a href="#cb103-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1351"><a href="#cb103-1351" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1352"><a href="#cb103-1352" aria-hidden="true" tabindex="-1"></a><span class="at">cox_pufa_uc_hard %&gt;%</span></span>
<span id="cb103-1353"><a href="#cb103-1353" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE)  %&gt;%</span></span>
<span id="cb103-1354"><a href="#cb103-1354" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1355"><a href="#cb103-1355" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1356"><a href="#cb103-1356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1359"><a href="#cb103-1359" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1360"><a href="#cb103-1360" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1361"><a href="#cb103-1361" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1362"><a href="#cb103-1362" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_uc_hard,</span></span>
<span id="cb103-1363"><a href="#cb103-1363" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng"</span></span>
<span id="cb103-1364"><a href="#cb103-1364" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1365"><a href="#cb103-1365" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1366"><a href="#cb103-1366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1367"><a href="#cb103-1367" aria-hidden="true" tabindex="-1"></a><span class="do">## Ultra-processed food</span></span>
<span id="cb103-1368"><a href="#cb103-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1369"><a href="#cb103-1369" aria-hidden="true" tabindex="-1"></a>This section examines the association between ultra<span class="sc">-</span>processed food <span class="fu">consumption</span> (percentage of daily energy intake from UPF) and time to flare. UPF is defined according to the NOVA classification system as foods that have undergone substantial industrial processing.</span>
<span id="cb103-1370"><a href="#cb103-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1371"><a href="#cb103-1371" aria-hidden="true" tabindex="-1"></a><span class="do">### Crohn's disease</span></span>
<span id="cb103-1372"><a href="#cb103-1372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1373"><a href="#cb103-1373" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1374"><a href="#cb103-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1377"><a href="#cb103-1377" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1378"><a href="#cb103-1378" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_cd_soft &lt;- coxph(</span></span>
<span id="cb103-1379"><a href="#cb103-1379" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-1380"><a href="#cb103-1380" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1381"><a href="#cb103-1381" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1382"><a href="#cb103-1382" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1383"><a href="#cb103-1383" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1384"><a href="#cb103-1384" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1385"><a href="#cb103-1385" aria-hidden="true" tabindex="-1"></a><span class="at">    UPF_perc +</span></span>
<span id="cb103-1386"><a href="#cb103-1386" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1387"><a href="#cb103-1387" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1388"><a href="#cb103-1388" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1389"><a href="#cb103-1389" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1390"><a href="#cb103-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1391"><a href="#cb103-1391" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No </span></span>
<span id="cb103-1392"><a href="#cb103-1392" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_upf_cd_soft, remove = "UPF_perc", add = "ns(UPF_perc, df = 2)")</span></span>
<span id="cb103-1393"><a href="#cb103-1393" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1394"><a href="#cb103-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1397"><a href="#cb103-1397" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1398"><a href="#cb103-1398" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_cd_soft %&gt;%</span></span>
<span id="cb103-1399"><a href="#cb103-1399" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1400"><a href="#cb103-1400" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1401"><a href="#cb103-1401" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1402"><a href="#cb103-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1405"><a href="#cb103-1405" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1406"><a href="#cb103-1406" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1407"><a href="#cb103-1407" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1408"><a href="#cb103-1408" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_cd_soft,</span></span>
<span id="cb103-1409"><a href="#cb103-1409" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc"</span></span>
<span id="cb103-1410"><a href="#cb103-1410" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1411"><a href="#cb103-1411" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("UPF (%)")</span></span>
<span id="cb103-1412"><a href="#cb103-1412" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1413"><a href="#cb103-1413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1414"><a href="#cb103-1414" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1415"><a href="#cb103-1415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1418"><a href="#cb103-1418" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1419"><a href="#cb103-1419" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_cd_hard &lt;- coxph(</span></span>
<span id="cb103-1420"><a href="#cb103-1420" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-1421"><a href="#cb103-1421" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1422"><a href="#cb103-1422" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1423"><a href="#cb103-1423" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1424"><a href="#cb103-1424" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1425"><a href="#cb103-1425" aria-hidden="true" tabindex="-1"></a><span class="at">    FC +</span></span>
<span id="cb103-1426"><a href="#cb103-1426" aria-hidden="true" tabindex="-1"></a><span class="at">    UPF_perc +</span></span>
<span id="cb103-1427"><a href="#cb103-1427" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1428"><a href="#cb103-1428" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1429"><a href="#cb103-1429" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df</span></span>
<span id="cb103-1430"><a href="#cb103-1430" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1431"><a href="#cb103-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1432"><a href="#cb103-1432" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1433"><a href="#cb103-1433" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_upf_cd_hard, remove = "UPF_perc", add = "ns(UPF_perc, df = 2)")</span></span>
<span id="cb103-1434"><a href="#cb103-1434" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1435"><a href="#cb103-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1438"><a href="#cb103-1438" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1439"><a href="#cb103-1439" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_cd_hard %&gt;%</span></span>
<span id="cb103-1440"><a href="#cb103-1440" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1441"><a href="#cb103-1441" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1442"><a href="#cb103-1442" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1443"><a href="#cb103-1443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1446"><a href="#cb103-1446" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1447"><a href="#cb103-1447" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1448"><a href="#cb103-1448" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1449"><a href="#cb103-1449" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_cd_hard,</span></span>
<span id="cb103-1450"><a href="#cb103-1450" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc"</span></span>
<span id="cb103-1451"><a href="#cb103-1451" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1452"><a href="#cb103-1452" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("UPF (%)")</span></span>
<span id="cb103-1453"><a href="#cb103-1453" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1454"><a href="#cb103-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1455"><a href="#cb103-1455" aria-hidden="true" tabindex="-1"></a><span class="do">### Ulcerative colitis</span></span>
<span id="cb103-1456"><a href="#cb103-1456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1457"><a href="#cb103-1457" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1458"><a href="#cb103-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1461"><a href="#cb103-1461" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1462"><a href="#cb103-1462" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_uc_soft &lt;- coxph(</span></span>
<span id="cb103-1463"><a href="#cb103-1463" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(softflare_time, softflare) ~</span></span>
<span id="cb103-1464"><a href="#cb103-1464" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1465"><a href="#cb103-1465" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1466"><a href="#cb103-1466" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1467"><a href="#cb103-1467" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1468"><a href="#cb103-1468" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-1469"><a href="#cb103-1469" aria-hidden="true" tabindex="-1"></a><span class="at">    UPF_perc +</span></span>
<span id="cb103-1470"><a href="#cb103-1470" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(dqi_tot, df = 2) +</span></span>
<span id="cb103-1471"><a href="#cb103-1471" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1472"><a href="#cb103-1472" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-1473"><a href="#cb103-1473" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1474"><a href="#cb103-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1475"><a href="#cb103-1475" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1476"><a href="#cb103-1476" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_upf_uc_soft, remove = "UPF_perc", add = "ns(UPF_perc, df = 2)")</span></span>
<span id="cb103-1477"><a href="#cb103-1477" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1478"><a href="#cb103-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1481"><a href="#cb103-1481" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1482"><a href="#cb103-1482" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_uc_soft %&gt;%</span></span>
<span id="cb103-1483"><a href="#cb103-1483" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE) %&gt;%</span></span>
<span id="cb103-1484"><a href="#cb103-1484" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1485"><a href="#cb103-1485" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1486"><a href="#cb103-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1489"><a href="#cb103-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1490"><a href="#cb103-1490" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1491"><a href="#cb103-1491" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1492"><a href="#cb103-1492" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_uc_soft,</span></span>
<span id="cb103-1493"><a href="#cb103-1493" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc"</span></span>
<span id="cb103-1494"><a href="#cb103-1494" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1495"><a href="#cb103-1495" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("UPF (%)")</span></span>
<span id="cb103-1496"><a href="#cb103-1496" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1497"><a href="#cb103-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1498"><a href="#cb103-1498" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1499"><a href="#cb103-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1502"><a href="#cb103-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1503"><a href="#cb103-1503" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_uc_hard &lt;- coxph(</span></span>
<span id="cb103-1504"><a href="#cb103-1504" aria-hidden="true" tabindex="-1"></a><span class="at">  Surv(hardflare_time, hardflare) ~</span></span>
<span id="cb103-1505"><a href="#cb103-1505" aria-hidden="true" tabindex="-1"></a><span class="at">    Sex +</span></span>
<span id="cb103-1506"><a href="#cb103-1506" aria-hidden="true" tabindex="-1"></a><span class="at">    IMD +</span></span>
<span id="cb103-1507"><a href="#cb103-1507" aria-hidden="true" tabindex="-1"></a><span class="at">    age_decade +</span></span>
<span id="cb103-1508"><a href="#cb103-1508" aria-hidden="true" tabindex="-1"></a><span class="at">    BMI +</span></span>
<span id="cb103-1509"><a href="#cb103-1509" aria-hidden="true" tabindex="-1"></a><span class="at">    ns(FC, df = 2) +</span></span>
<span id="cb103-1510"><a href="#cb103-1510" aria-hidden="true" tabindex="-1"></a><span class="at">    UPF_perc +</span></span>
<span id="cb103-1511"><a href="#cb103-1511" aria-hidden="true" tabindex="-1"></a><span class="at">    dqi_tot +</span></span>
<span id="cb103-1512"><a href="#cb103-1512" aria-hidden="true" tabindex="-1"></a><span class="at">    frailty(SiteNo),</span></span>
<span id="cb103-1513"><a href="#cb103-1513" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df</span></span>
<span id="cb103-1514"><a href="#cb103-1514" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1515"><a href="#cb103-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1516"><a href="#cb103-1516" aria-hidden="true" tabindex="-1"></a><span class="at"># Do we need a spline? No</span></span>
<span id="cb103-1517"><a href="#cb103-1517" aria-hidden="true" tabindex="-1"></a><span class="at">summon_lrt(cox_upf_uc_hard, remove = "UPF_perc", add = "ns(UPF_perc, df = 2)")</span></span>
<span id="cb103-1518"><a href="#cb103-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1519"><a href="#cb103-1519" aria-hidden="true" tabindex="-1"></a><span class="at">cox_upf_uc_hard %&gt;%</span></span>
<span id="cb103-1520"><a href="#cb103-1520" aria-hidden="true" tabindex="-1"></a><span class="at">  broom::tidy(exp = TRUE, conf.int = TRUE)  %&gt;%</span></span>
<span id="cb103-1521"><a href="#cb103-1521" aria-hidden="true" tabindex="-1"></a><span class="at">  knitr::kable(col.names = broom.cols, digits = 3)</span></span>
<span id="cb103-1522"><a href="#cb103-1522" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1523"><a href="#cb103-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1526"><a href="#cb103-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1527"><a href="#cb103-1527" aria-hidden="true" tabindex="-1"></a><span class="at">plot_continuous_hr(</span></span>
<span id="cb103-1528"><a href="#cb103-1528" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1529"><a href="#cb103-1529" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_uc_hard,</span></span>
<span id="cb103-1530"><a href="#cb103-1530" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc"</span></span>
<span id="cb103-1531"><a href="#cb103-1531" aria-hidden="true" tabindex="-1"></a><span class="at">) +</span></span>
<span id="cb103-1532"><a href="#cb103-1532" aria-hidden="true" tabindex="-1"></a><span class="at">  xlab("UPF (%)")</span></span>
<span id="cb103-1533"><a href="#cb103-1533" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1534"><a href="#cb103-1534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1535"><a href="#cb103-1535" aria-hidden="true" tabindex="-1"></a><span class="co"># Results</span></span>
<span id="cb103-1536"><a href="#cb103-1536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1537"><a href="#cb103-1537" aria-hidden="true" tabindex="-1"></a><span class="do">## Risk difference</span></span>
<span id="cb103-1538"><a href="#cb103-1538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1541"><a href="#cb103-1541" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1542"><a href="#cb103-1542" aria-hidden="true" tabindex="-1"></a><span class="at"># How many bootstraps</span></span>
<span id="cb103-1543"><a href="#cb103-1543" aria-hidden="true" tabindex="-1"></a><span class="at">nboot &lt;- 199</span></span>
<span id="cb103-1544"><a href="#cb103-1544" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1545"><a href="#cb103-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1546"><a href="#cb103-1546" aria-hidden="true" tabindex="-1"></a>Risk differences quantify the absolute change <span class="cf">in</span> cumulative incidence of flare at a specific time <span class="fu">point</span> (<span class="dv">1</span> year) associated with different levels of each dietary exposure. These are population<span class="sc">-</span>averaged estimates obtained by<span class="sc">:</span></span>
<span id="cb103-1547"><a href="#cb103-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1548"><a href="#cb103-1548" aria-hidden="true" tabindex="-1"></a><span class="fl">1.</span> Predicting individual<span class="sc">-</span>level survival <span class="cf">for</span> each participant at specified dietary exposure values</span>
<span id="cb103-1549"><a href="#cb103-1549" aria-hidden="true" tabindex="-1"></a><span class="fl">2.</span> Averaging across the population to obtain mean cumulative incidence</span>
<span id="cb103-1550"><a href="#cb103-1550" aria-hidden="true" tabindex="-1"></a><span class="fl">3.</span> Calculating differences relative to a reference <span class="fu">value</span> (median)</span>
<span id="cb103-1551"><a href="#cb103-1551" aria-hidden="true" tabindex="-1"></a><span class="fl">4.</span> Bootstrapping to obtain <span class="dv">95</span>% confidence intervals</span>
<span id="cb103-1552"><a href="#cb103-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1553"><a href="#cb103-1553" aria-hidden="true" tabindex="-1"></a>Results are presented as forest plots with corresponding risk difference values and confidence intervals.</span>
<span id="cb103-1554"><a href="#cb103-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1555"><a href="#cb103-1555" aria-hidden="true" tabindex="-1"></a><span class="do">### Crohn's disease</span></span>
<span id="cb103-1556"><a href="#cb103-1556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1557"><a href="#cb103-1557" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1558"><a href="#cb103-1558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1561"><a href="#cb103-1561" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1562"><a href="#cb103-1562" aria-hidden="true" tabindex="-1"></a><span class="at">#| message: false</span></span>
<span id="cb103-1563"><a href="#cb103-1563" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-1564"><a href="#cb103-1564" aria-hidden="true" tabindex="-1"></a><span class="at"># Values for calculation risk difference</span></span>
<span id="cb103-1565"><a href="#cb103-1565" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_meat_cd &lt;- quantile(</span></span>
<span id="cb103-1566"><a href="#cb103-1566" aria-hidden="true" tabindex="-1"></a><span class="at">  flare.cd.df$Meat_sum,</span></span>
<span id="cb103-1567"><a href="#cb103-1567" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1568"><a href="#cb103-1568" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1569"><a href="#cb103-1569" aria-hidden="true" tabindex="-1"></a><span class="at">  ) %&gt;%</span></span>
<span id="cb103-1570"><a href="#cb103-1570" aria-hidden="true" tabindex="-1"></a><span class="at">  round()</span></span>
<span id="cb103-1571"><a href="#cb103-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1572"><a href="#cb103-1572" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_fibre_cd &lt;- quantile(</span></span>
<span id="cb103-1573"><a href="#cb103-1573" aria-hidden="true" tabindex="-1"></a><span class="at">  flare.cd.df$fibre,</span></span>
<span id="cb103-1574"><a href="#cb103-1574" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1575"><a href="#cb103-1575" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1576"><a href="#cb103-1576" aria-hidden="true" tabindex="-1"></a><span class="at">  ) %&gt;%</span></span>
<span id="cb103-1577"><a href="#cb103-1577" aria-hidden="true" tabindex="-1"></a><span class="at">  round()</span></span>
<span id="cb103-1578"><a href="#cb103-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1579"><a href="#cb103-1579" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_pufa_cd &lt;- quantile(</span></span>
<span id="cb103-1580"><a href="#cb103-1580" aria-hidden="true" tabindex="-1"></a><span class="at">  flare.cd.df$PUFA_percEng,</span></span>
<span id="cb103-1581"><a href="#cb103-1581" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1582"><a href="#cb103-1582" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1583"><a href="#cb103-1583" aria-hidden="true" tabindex="-1"></a><span class="at">  ) %&gt;%</span></span>
<span id="cb103-1584"><a href="#cb103-1584" aria-hidden="true" tabindex="-1"></a><span class="at">  round(digits = 1)</span></span>
<span id="cb103-1585"><a href="#cb103-1585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1586"><a href="#cb103-1586" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_upf_cd &lt;- quantile(</span></span>
<span id="cb103-1587"><a href="#cb103-1587" aria-hidden="true" tabindex="-1"></a><span class="at">  flare.cd.df$UPF_perc,</span></span>
<span id="cb103-1588"><a href="#cb103-1588" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1589"><a href="#cb103-1589" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1590"><a href="#cb103-1590" aria-hidden="true" tabindex="-1"></a><span class="at">  ) %&gt;%</span></span>
<span id="cb103-1591"><a href="#cb103-1591" aria-hidden="true" tabindex="-1"></a><span class="at">  round()</span></span>
<span id="cb103-1592"><a href="#cb103-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1593"><a href="#cb103-1593" aria-hidden="true" tabindex="-1"></a><span class="at"># Calculate risk difference for these values</span></span>
<span id="cb103-1594"><a href="#cb103-1594" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_soft_meat &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1595"><a href="#cb103-1595" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1596"><a href="#cb103-1596" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_cd_soft,</span></span>
<span id="cb103-1597"><a href="#cb103-1597" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1598"><a href="#cb103-1598" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum",</span></span>
<span id="cb103-1599"><a href="#cb103-1599" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_meat_cd,</span></span>
<span id="cb103-1600"><a href="#cb103-1600" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1601"><a href="#cb103-1601" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1602"><a href="#cb103-1602" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1603"><a href="#cb103-1603" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1604"><a href="#cb103-1604" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Total meat protein: ", value)</span></span>
<span id="cb103-1605"><a href="#cb103-1605" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1606"><a href="#cb103-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1607"><a href="#cb103-1607" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_soft_fibre &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1608"><a href="#cb103-1608" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1609"><a href="#cb103-1609" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_cd_soft,</span></span>
<span id="cb103-1610"><a href="#cb103-1610" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1611"><a href="#cb103-1611" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre",</span></span>
<span id="cb103-1612"><a href="#cb103-1612" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_fibre_cd,</span></span>
<span id="cb103-1613"><a href="#cb103-1613" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1614"><a href="#cb103-1614" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1615"><a href="#cb103-1615" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1616"><a href="#cb103-1616" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1617"><a href="#cb103-1617" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Dietary fibre: ", value)</span></span>
<span id="cb103-1618"><a href="#cb103-1618" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1619"><a href="#cb103-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1620"><a href="#cb103-1620" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_soft_pufa &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1621"><a href="#cb103-1621" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1622"><a href="#cb103-1622" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_cd_soft,</span></span>
<span id="cb103-1623"><a href="#cb103-1623" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1624"><a href="#cb103-1624" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng",</span></span>
<span id="cb103-1625"><a href="#cb103-1625" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_pufa_cd,</span></span>
<span id="cb103-1626"><a href="#cb103-1626" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1627"><a href="#cb103-1627" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1628"><a href="#cb103-1628" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1629"><a href="#cb103-1629" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1630"><a href="#cb103-1630" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("PUFA: ", value)</span></span>
<span id="cb103-1631"><a href="#cb103-1631" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1632"><a href="#cb103-1632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1633"><a href="#cb103-1633" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_soft_upf &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1634"><a href="#cb103-1634" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1635"><a href="#cb103-1635" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_cd_soft,</span></span>
<span id="cb103-1636"><a href="#cb103-1636" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1637"><a href="#cb103-1637" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc",</span></span>
<span id="cb103-1638"><a href="#cb103-1638" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_upf_cd,</span></span>
<span id="cb103-1639"><a href="#cb103-1639" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1640"><a href="#cb103-1640" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1641"><a href="#cb103-1641" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1642"><a href="#cb103-1642" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1643"><a href="#cb103-1643" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("UPF (%): ", value)</span></span>
<span id="cb103-1644"><a href="#cb103-1644" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1645"><a href="#cb103-1645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1646"><a href="#cb103-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1647"><a href="#cb103-1647" aria-hidden="true" tabindex="-1"></a><span class="at"># Creating combined forest plot</span></span>
<span id="cb103-1648"><a href="#cb103-1648" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1649"><a href="#cb103-1649" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_soft_meat_1y &lt;- summon_rd_forest_plot(data_rd_cd_soft_meat,</span></span>
<span id="cb103-1650"><a href="#cb103-1650" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1651"><a href="#cb103-1651" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1652"><a href="#cb103-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1653"><a href="#cb103-1653" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_soft_fibre_1y &lt;- summon_rd_forest_plot(data_rd_cd_soft_fibre,</span></span>
<span id="cb103-1654"><a href="#cb103-1654" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1655"><a href="#cb103-1655" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1656"><a href="#cb103-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1657"><a href="#cb103-1657" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_soft_pufa_1y &lt;- summon_rd_forest_plot(data_rd_cd_soft_pufa,</span></span>
<span id="cb103-1658"><a href="#cb103-1658" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1659"><a href="#cb103-1659" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1660"><a href="#cb103-1660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1661"><a href="#cb103-1661" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_soft_upf_1y &lt;- summon_rd_forest_plot(data_rd_cd_soft_upf,</span></span>
<span id="cb103-1662"><a href="#cb103-1662" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1663"><a href="#cb103-1663" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1664"><a href="#cb103-1664" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1665"><a href="#cb103-1665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1668"><a href="#cb103-1668" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-1669"><a href="#cb103-1669" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-1670"><a href="#cb103-1670" aria-hidden="true" tabindex="-1"></a><span class="at"># Final plots using patchwork</span></span>
<span id="cb103-1671"><a href="#cb103-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1672"><a href="#cb103-1672" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1673"><a href="#cb103-1673" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_soft_meat_1y$plot + plot_rd_cd_soft_meat_1y$rd +</span></span>
<span id="cb103-1674"><a href="#cb103-1674" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_cd_soft_fibre_1y$plot + plot_rd_cd_soft_fibre_1y$rd +</span></span>
<span id="cb103-1675"><a href="#cb103-1675" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_cd_soft_pufa_1y$plot + plot_rd_cd_soft_pufa_1y$rd +</span></span>
<span id="cb103-1676"><a href="#cb103-1676" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_cd_soft_upf_1y$plot + plot_rd_cd_soft_upf_1y$rd +</span></span>
<span id="cb103-1677"><a href="#cb103-1677" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_layout(</span></span>
<span id="cb103-1678"><a href="#cb103-1678" aria-hidden="true" tabindex="-1"></a><span class="at">    ncol = 2,</span></span>
<span id="cb103-1679"><a href="#cb103-1679" aria-hidden="true" tabindex="-1"></a><span class="at">    guides = "collect",</span></span>
<span id="cb103-1680"><a href="#cb103-1680" aria-hidden="true" tabindex="-1"></a><span class="at">    axes = "collect",</span></span>
<span id="cb103-1681"><a href="#cb103-1681" aria-hidden="true" tabindex="-1"></a><span class="at">    width = c(2, 1)</span></span>
<span id="cb103-1682"><a href="#cb103-1682" aria-hidden="true" tabindex="-1"></a><span class="at">  ) +</span></span>
<span id="cb103-1683"><a href="#cb103-1683" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_annotation(</span></span>
<span id="cb103-1684"><a href="#cb103-1684" aria-hidden="true" tabindex="-1"></a><span class="at">    title = "1-year risk difference",</span></span>
<span id="cb103-1685"><a href="#cb103-1685" aria-hidden="true" tabindex="-1"></a><span class="at">    subtitle = "Crohn's, patient reported flare."</span></span>
<span id="cb103-1686"><a href="#cb103-1686" aria-hidden="true" tabindex="-1"></a><span class="at">  ) &amp;</span></span>
<span id="cb103-1687"><a href="#cb103-1687" aria-hidden="true" tabindex="-1"></a><span class="at">  coord_cartesian(xlim = c(-30, 60))</span></span>
<span id="cb103-1688"><a href="#cb103-1688" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1689"><a href="#cb103-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1690"><a href="#cb103-1690" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1691"><a href="#cb103-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1694"><a href="#cb103-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1695"><a href="#cb103-1695" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-1696"><a href="#cb103-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1697"><a href="#cb103-1697" aria-hidden="true" tabindex="-1"></a><span class="at"># Calculate risk difference for these values</span></span>
<span id="cb103-1698"><a href="#cb103-1698" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_hard_meat &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1699"><a href="#cb103-1699" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1700"><a href="#cb103-1700" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_cd_hard,</span></span>
<span id="cb103-1701"><a href="#cb103-1701" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1702"><a href="#cb103-1702" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum",</span></span>
<span id="cb103-1703"><a href="#cb103-1703" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_meat_cd,</span></span>
<span id="cb103-1704"><a href="#cb103-1704" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1705"><a href="#cb103-1705" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1706"><a href="#cb103-1706" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1707"><a href="#cb103-1707" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1708"><a href="#cb103-1708" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Total meat protein: ", value)</span></span>
<span id="cb103-1709"><a href="#cb103-1709" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1710"><a href="#cb103-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1711"><a href="#cb103-1711" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_hard_fibre &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1712"><a href="#cb103-1712" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1713"><a href="#cb103-1713" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_cd_hard,</span></span>
<span id="cb103-1714"><a href="#cb103-1714" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1715"><a href="#cb103-1715" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre",</span></span>
<span id="cb103-1716"><a href="#cb103-1716" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_fibre_cd,</span></span>
<span id="cb103-1717"><a href="#cb103-1717" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1718"><a href="#cb103-1718" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1719"><a href="#cb103-1719" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1720"><a href="#cb103-1720" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1721"><a href="#cb103-1721" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Dietary fibre: ", value)</span></span>
<span id="cb103-1722"><a href="#cb103-1722" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1723"><a href="#cb103-1723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1724"><a href="#cb103-1724" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_hard_pufa &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1725"><a href="#cb103-1725" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1726"><a href="#cb103-1726" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_cd_hard,</span></span>
<span id="cb103-1727"><a href="#cb103-1727" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1728"><a href="#cb103-1728" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng",</span></span>
<span id="cb103-1729"><a href="#cb103-1729" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_pufa_cd,</span></span>
<span id="cb103-1730"><a href="#cb103-1730" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1731"><a href="#cb103-1731" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1732"><a href="#cb103-1732" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1733"><a href="#cb103-1733" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1734"><a href="#cb103-1734" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("PUFA: ", value)</span></span>
<span id="cb103-1735"><a href="#cb103-1735" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1736"><a href="#cb103-1736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1737"><a href="#cb103-1737" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_cd_hard_upf &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1738"><a href="#cb103-1738" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.cd.df,</span></span>
<span id="cb103-1739"><a href="#cb103-1739" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_cd_hard,</span></span>
<span id="cb103-1740"><a href="#cb103-1740" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1741"><a href="#cb103-1741" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc",</span></span>
<span id="cb103-1742"><a href="#cb103-1742" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_upf_cd,</span></span>
<span id="cb103-1743"><a href="#cb103-1743" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1744"><a href="#cb103-1744" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1745"><a href="#cb103-1745" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1746"><a href="#cb103-1746" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1747"><a href="#cb103-1747" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("UPF (%): ", value)</span></span>
<span id="cb103-1748"><a href="#cb103-1748" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1749"><a href="#cb103-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1750"><a href="#cb103-1750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1751"><a href="#cb103-1751" aria-hidden="true" tabindex="-1"></a><span class="at"># Creating combined forest plot</span></span>
<span id="cb103-1752"><a href="#cb103-1752" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1753"><a href="#cb103-1753" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_hard_meat_1y &lt;- summon_rd_forest_plot(data_rd_cd_hard_meat,</span></span>
<span id="cb103-1754"><a href="#cb103-1754" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1755"><a href="#cb103-1755" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1756"><a href="#cb103-1756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1757"><a href="#cb103-1757" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_hard_fibre_1y &lt;- summon_rd_forest_plot(data_rd_cd_hard_fibre,</span></span>
<span id="cb103-1758"><a href="#cb103-1758" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1759"><a href="#cb103-1759" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1760"><a href="#cb103-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1761"><a href="#cb103-1761" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_hard_pufa_1y &lt;- summon_rd_forest_plot(data_rd_cd_hard_pufa,</span></span>
<span id="cb103-1762"><a href="#cb103-1762" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1763"><a href="#cb103-1763" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1764"><a href="#cb103-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1765"><a href="#cb103-1765" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_hard_upf_1y &lt;- summon_rd_forest_plot(data_rd_cd_hard_upf,</span></span>
<span id="cb103-1766"><a href="#cb103-1766" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1767"><a href="#cb103-1767" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1768"><a href="#cb103-1768" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1769"><a href="#cb103-1769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1772"><a href="#cb103-1772" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-1773"><a href="#cb103-1773" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-1774"><a href="#cb103-1774" aria-hidden="true" tabindex="-1"></a><span class="at"># Final plots using patchwork</span></span>
<span id="cb103-1775"><a href="#cb103-1775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1776"><a href="#cb103-1776" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1777"><a href="#cb103-1777" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_cd_hard_meat_1y$plot + plot_rd_cd_hard_meat_1y$rd +</span></span>
<span id="cb103-1778"><a href="#cb103-1778" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_cd_hard_fibre_1y$plot + plot_rd_cd_hard_fibre_1y$rd +</span></span>
<span id="cb103-1779"><a href="#cb103-1779" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_cd_hard_pufa_1y$plot + plot_rd_cd_hard_pufa_1y$rd +</span></span>
<span id="cb103-1780"><a href="#cb103-1780" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_cd_hard_upf_1y$plot + plot_rd_cd_hard_upf_1y$rd +</span></span>
<span id="cb103-1781"><a href="#cb103-1781" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_layout(</span></span>
<span id="cb103-1782"><a href="#cb103-1782" aria-hidden="true" tabindex="-1"></a><span class="at">    ncol = 2,</span></span>
<span id="cb103-1783"><a href="#cb103-1783" aria-hidden="true" tabindex="-1"></a><span class="at">    guides = "collect",</span></span>
<span id="cb103-1784"><a href="#cb103-1784" aria-hidden="true" tabindex="-1"></a><span class="at">    axes = "collect",</span></span>
<span id="cb103-1785"><a href="#cb103-1785" aria-hidden="true" tabindex="-1"></a><span class="at">    width = c(2, 1)</span></span>
<span id="cb103-1786"><a href="#cb103-1786" aria-hidden="true" tabindex="-1"></a><span class="at">  ) +</span></span>
<span id="cb103-1787"><a href="#cb103-1787" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_annotation(</span></span>
<span id="cb103-1788"><a href="#cb103-1788" aria-hidden="true" tabindex="-1"></a><span class="at">    title = "1-year risk difference",</span></span>
<span id="cb103-1789"><a href="#cb103-1789" aria-hidden="true" tabindex="-1"></a><span class="at">    subtitle = "Crohn's, objective flare."</span></span>
<span id="cb103-1790"><a href="#cb103-1790" aria-hidden="true" tabindex="-1"></a><span class="at">  ) &amp;</span></span>
<span id="cb103-1791"><a href="#cb103-1791" aria-hidden="true" tabindex="-1"></a><span class="at">  coord_cartesian(xlim = c(-10, 20))</span></span>
<span id="cb103-1792"><a href="#cb103-1792" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1793"><a href="#cb103-1793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1794"><a href="#cb103-1794" aria-hidden="true" tabindex="-1"></a><span class="do">### Ulcerative colitis</span></span>
<span id="cb103-1795"><a href="#cb103-1795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1796"><a href="#cb103-1796" aria-hidden="true" tabindex="-1"></a><span class="do">#### Patient-reported flare</span></span>
<span id="cb103-1797"><a href="#cb103-1797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1800"><a href="#cb103-1800" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1801"><a href="#cb103-1801" aria-hidden="true" tabindex="-1"></a><span class="at">#| message: false</span></span>
<span id="cb103-1802"><a href="#cb103-1802" aria-hidden="true" tabindex="-1"></a><span class="at"># Values for calculation risk difference</span></span>
<span id="cb103-1803"><a href="#cb103-1803" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_meat_uc &lt;- quantile(flare.uc.df$Meat_sum,</span></span>
<span id="cb103-1804"><a href="#cb103-1804" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1805"><a href="#cb103-1805" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1806"><a href="#cb103-1806" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1807"><a href="#cb103-1807" aria-hidden="true" tabindex="-1"></a><span class="at">  round()</span></span>
<span id="cb103-1808"><a href="#cb103-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1809"><a href="#cb103-1809" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_fibre_uc &lt;- quantile(flare.uc.df$fibre,</span></span>
<span id="cb103-1810"><a href="#cb103-1810" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1811"><a href="#cb103-1811" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1812"><a href="#cb103-1812" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1813"><a href="#cb103-1813" aria-hidden="true" tabindex="-1"></a><span class="at">  round()</span></span>
<span id="cb103-1814"><a href="#cb103-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1815"><a href="#cb103-1815" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_pufa_uc &lt;- quantile(flare.uc.df$PUFA_percEng,</span></span>
<span id="cb103-1816"><a href="#cb103-1816" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1817"><a href="#cb103-1817" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1818"><a href="#cb103-1818" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1819"><a href="#cb103-1819" aria-hidden="true" tabindex="-1"></a><span class="at">  round(digits = 1)</span></span>
<span id="cb103-1820"><a href="#cb103-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1821"><a href="#cb103-1821" aria-hidden="true" tabindex="-1"></a><span class="at">rd_values_upf_uc &lt;- quantile(flare.uc.df$UPF_perc,</span></span>
<span id="cb103-1822"><a href="#cb103-1822" aria-hidden="true" tabindex="-1"></a><span class="at">  probs = c(0, 0.25, 0.5, 0.75, 0.95),</span></span>
<span id="cb103-1823"><a href="#cb103-1823" aria-hidden="true" tabindex="-1"></a><span class="at">  na.rm = TRUE</span></span>
<span id="cb103-1824"><a href="#cb103-1824" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1825"><a href="#cb103-1825" aria-hidden="true" tabindex="-1"></a><span class="at">  round()</span></span>
<span id="cb103-1826"><a href="#cb103-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1827"><a href="#cb103-1827" aria-hidden="true" tabindex="-1"></a><span class="at"># Calculate risk difference for these values</span></span>
<span id="cb103-1828"><a href="#cb103-1828" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_soft_meat &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1829"><a href="#cb103-1829" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1830"><a href="#cb103-1830" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_uc_soft,</span></span>
<span id="cb103-1831"><a href="#cb103-1831" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1832"><a href="#cb103-1832" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum",</span></span>
<span id="cb103-1833"><a href="#cb103-1833" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_meat_uc,</span></span>
<span id="cb103-1834"><a href="#cb103-1834" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1835"><a href="#cb103-1835" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1836"><a href="#cb103-1836" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1837"><a href="#cb103-1837" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1838"><a href="#cb103-1838" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Total meat protein: ", value)</span></span>
<span id="cb103-1839"><a href="#cb103-1839" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1840"><a href="#cb103-1840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1841"><a href="#cb103-1841" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_soft_fibre &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1842"><a href="#cb103-1842" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1843"><a href="#cb103-1843" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_uc_soft,</span></span>
<span id="cb103-1844"><a href="#cb103-1844" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1845"><a href="#cb103-1845" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre",</span></span>
<span id="cb103-1846"><a href="#cb103-1846" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_fibre_uc,</span></span>
<span id="cb103-1847"><a href="#cb103-1847" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1848"><a href="#cb103-1848" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1849"><a href="#cb103-1849" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1850"><a href="#cb103-1850" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1851"><a href="#cb103-1851" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Dietary fibre: ", value)</span></span>
<span id="cb103-1852"><a href="#cb103-1852" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1853"><a href="#cb103-1853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1854"><a href="#cb103-1854" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_soft_pufa &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1855"><a href="#cb103-1855" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1856"><a href="#cb103-1856" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_uc_soft,</span></span>
<span id="cb103-1857"><a href="#cb103-1857" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1858"><a href="#cb103-1858" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng",</span></span>
<span id="cb103-1859"><a href="#cb103-1859" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_pufa_uc,</span></span>
<span id="cb103-1860"><a href="#cb103-1860" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1861"><a href="#cb103-1861" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1862"><a href="#cb103-1862" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1863"><a href="#cb103-1863" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1864"><a href="#cb103-1864" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("PUFA: ", value)</span></span>
<span id="cb103-1865"><a href="#cb103-1865" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1866"><a href="#cb103-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1867"><a href="#cb103-1867" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_soft_upf &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1868"><a href="#cb103-1868" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1869"><a href="#cb103-1869" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_uc_soft,</span></span>
<span id="cb103-1870"><a href="#cb103-1870" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1871"><a href="#cb103-1871" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc",</span></span>
<span id="cb103-1872"><a href="#cb103-1872" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_upf_uc,</span></span>
<span id="cb103-1873"><a href="#cb103-1873" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1874"><a href="#cb103-1874" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1875"><a href="#cb103-1875" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1876"><a href="#cb103-1876" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1877"><a href="#cb103-1877" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("UPF (%): ", value)</span></span>
<span id="cb103-1878"><a href="#cb103-1878" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1879"><a href="#cb103-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1880"><a href="#cb103-1880" aria-hidden="true" tabindex="-1"></a><span class="at"># Creating combined forest plot</span></span>
<span id="cb103-1881"><a href="#cb103-1881" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1882"><a href="#cb103-1882" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_soft_meat_1y &lt;- summon_rd_forest_plot(data_rd_uc_soft_meat,</span></span>
<span id="cb103-1883"><a href="#cb103-1883" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1884"><a href="#cb103-1884" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1885"><a href="#cb103-1885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1886"><a href="#cb103-1886" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_soft_fibre_1y &lt;- summon_rd_forest_plot(data_rd_uc_soft_fibre,</span></span>
<span id="cb103-1887"><a href="#cb103-1887" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1888"><a href="#cb103-1888" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1889"><a href="#cb103-1889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1890"><a href="#cb103-1890" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_soft_pufa_1y &lt;- summon_rd_forest_plot(data_rd_uc_soft_pufa,</span></span>
<span id="cb103-1891"><a href="#cb103-1891" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1892"><a href="#cb103-1892" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1893"><a href="#cb103-1893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1894"><a href="#cb103-1894" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_soft_upf_1y &lt;- summon_rd_forest_plot(data_rd_uc_soft_upf,</span></span>
<span id="cb103-1895"><a href="#cb103-1895" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1896"><a href="#cb103-1896" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1897"><a href="#cb103-1897" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1898"><a href="#cb103-1898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1901"><a href="#cb103-1901" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1902"><a href="#cb103-1902" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-1903"><a href="#cb103-1903" aria-hidden="true" tabindex="-1"></a><span class="at"># Final plots using patchwork</span></span>
<span id="cb103-1904"><a href="#cb103-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1905"><a href="#cb103-1905" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1906"><a href="#cb103-1906" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_soft_meat_1y$plot + plot_rd_uc_soft_meat_1y$rd +</span></span>
<span id="cb103-1907"><a href="#cb103-1907" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_uc_soft_fibre_1y$plot + plot_rd_uc_soft_fibre_1y$rd +</span></span>
<span id="cb103-1908"><a href="#cb103-1908" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_uc_soft_pufa_1y$plot + plot_rd_uc_soft_pufa_1y$rd +</span></span>
<span id="cb103-1909"><a href="#cb103-1909" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_uc_soft_upf_1y$plot + plot_rd_uc_soft_upf_1y$rd +</span></span>
<span id="cb103-1910"><a href="#cb103-1910" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_layout(</span></span>
<span id="cb103-1911"><a href="#cb103-1911" aria-hidden="true" tabindex="-1"></a><span class="at">    ncol = 2,</span></span>
<span id="cb103-1912"><a href="#cb103-1912" aria-hidden="true" tabindex="-1"></a><span class="at">    guides = "collect",</span></span>
<span id="cb103-1913"><a href="#cb103-1913" aria-hidden="true" tabindex="-1"></a><span class="at">    axes = "collect",</span></span>
<span id="cb103-1914"><a href="#cb103-1914" aria-hidden="true" tabindex="-1"></a><span class="at">    width = c(2, 1)</span></span>
<span id="cb103-1915"><a href="#cb103-1915" aria-hidden="true" tabindex="-1"></a><span class="at">  ) +</span></span>
<span id="cb103-1916"><a href="#cb103-1916" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_annotation(</span></span>
<span id="cb103-1917"><a href="#cb103-1917" aria-hidden="true" tabindex="-1"></a><span class="at">    title = "1-year risk difference",</span></span>
<span id="cb103-1918"><a href="#cb103-1918" aria-hidden="true" tabindex="-1"></a><span class="at">    subtitle = "Ulcerative colitis, patient reported flare."</span></span>
<span id="cb103-1919"><a href="#cb103-1919" aria-hidden="true" tabindex="-1"></a><span class="at">  ) &amp;</span></span>
<span id="cb103-1920"><a href="#cb103-1920" aria-hidden="true" tabindex="-1"></a><span class="at">  coord_cartesian(xlim = c(-20, 40))</span></span>
<span id="cb103-1921"><a href="#cb103-1921" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-1922"><a href="#cb103-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1923"><a href="#cb103-1923" aria-hidden="true" tabindex="-1"></a><span class="do">#### Objective Flare</span></span>
<span id="cb103-1924"><a href="#cb103-1924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1927"><a href="#cb103-1927" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb103-1928"><a href="#cb103-1928" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-1929"><a href="#cb103-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1930"><a href="#cb103-1930" aria-hidden="true" tabindex="-1"></a><span class="at"># Calculate risk difference for these values</span></span>
<span id="cb103-1931"><a href="#cb103-1931" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_hard_meat &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1932"><a href="#cb103-1932" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1933"><a href="#cb103-1933" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_meat_uc_hard,</span></span>
<span id="cb103-1934"><a href="#cb103-1934" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1935"><a href="#cb103-1935" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "Meat_sum",</span></span>
<span id="cb103-1936"><a href="#cb103-1936" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_meat_uc,</span></span>
<span id="cb103-1937"><a href="#cb103-1937" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1938"><a href="#cb103-1938" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1939"><a href="#cb103-1939" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1940"><a href="#cb103-1940" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1941"><a href="#cb103-1941" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Total meat protein: ", value)</span></span>
<span id="cb103-1942"><a href="#cb103-1942" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1943"><a href="#cb103-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1944"><a href="#cb103-1944" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_hard_fibre &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1945"><a href="#cb103-1945" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1946"><a href="#cb103-1946" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_fibre_uc_hard,</span></span>
<span id="cb103-1947"><a href="#cb103-1947" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1948"><a href="#cb103-1948" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "fibre",</span></span>
<span id="cb103-1949"><a href="#cb103-1949" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_fibre_uc,</span></span>
<span id="cb103-1950"><a href="#cb103-1950" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1951"><a href="#cb103-1951" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1952"><a href="#cb103-1952" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1953"><a href="#cb103-1953" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1954"><a href="#cb103-1954" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("Dietary fibre: ", value)</span></span>
<span id="cb103-1955"><a href="#cb103-1955" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1956"><a href="#cb103-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1957"><a href="#cb103-1957" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_hard_pufa &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1958"><a href="#cb103-1958" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1959"><a href="#cb103-1959" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_pufa_uc_hard,</span></span>
<span id="cb103-1960"><a href="#cb103-1960" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1961"><a href="#cb103-1961" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "PUFA_percEng",</span></span>
<span id="cb103-1962"><a href="#cb103-1962" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_pufa_uc,</span></span>
<span id="cb103-1963"><a href="#cb103-1963" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1964"><a href="#cb103-1964" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1965"><a href="#cb103-1965" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1966"><a href="#cb103-1966" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1967"><a href="#cb103-1967" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("PUFA: ", value)</span></span>
<span id="cb103-1968"><a href="#cb103-1968" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1969"><a href="#cb103-1969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1970"><a href="#cb103-1970" aria-hidden="true" tabindex="-1"></a><span class="at">data_rd_uc_hard_upf &lt;- summon_population_risk_difference_boot(</span></span>
<span id="cb103-1971"><a href="#cb103-1971" aria-hidden="true" tabindex="-1"></a><span class="at">  data = flare.uc.df,</span></span>
<span id="cb103-1972"><a href="#cb103-1972" aria-hidden="true" tabindex="-1"></a><span class="at">  model = cox_upf_uc_hard,</span></span>
<span id="cb103-1973"><a href="#cb103-1973" aria-hidden="true" tabindex="-1"></a><span class="at">  times = c(365),</span></span>
<span id="cb103-1974"><a href="#cb103-1974" aria-hidden="true" tabindex="-1"></a><span class="at">  variable = "UPF_perc",</span></span>
<span id="cb103-1975"><a href="#cb103-1975" aria-hidden="true" tabindex="-1"></a><span class="at">  values = rd_values_upf_uc,</span></span>
<span id="cb103-1976"><a href="#cb103-1976" aria-hidden="true" tabindex="-1"></a><span class="at">  ref_value = NULL,</span></span>
<span id="cb103-1977"><a href="#cb103-1977" aria-hidden="true" tabindex="-1"></a><span class="at">  nboot = nboot</span></span>
<span id="cb103-1978"><a href="#cb103-1978" aria-hidden="true" tabindex="-1"></a><span class="at">) %&gt;%</span></span>
<span id="cb103-1979"><a href="#cb103-1979" aria-hidden="true" tabindex="-1"></a><span class="at">  dplyr::mutate(</span></span>
<span id="cb103-1980"><a href="#cb103-1980" aria-hidden="true" tabindex="-1"></a><span class="at">    term_tidy = paste0("UPF (%): ", value)</span></span>
<span id="cb103-1981"><a href="#cb103-1981" aria-hidden="true" tabindex="-1"></a><span class="at">  )</span></span>
<span id="cb103-1982"><a href="#cb103-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1983"><a href="#cb103-1983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1984"><a href="#cb103-1984" aria-hidden="true" tabindex="-1"></a><span class="at"># Creating combined forest plot</span></span>
<span id="cb103-1985"><a href="#cb103-1985" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-1986"><a href="#cb103-1986" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_hard_meat_1y &lt;- summon_rd_forest_plot(data_rd_uc_hard_meat,</span></span>
<span id="cb103-1987"><a href="#cb103-1987" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1988"><a href="#cb103-1988" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1989"><a href="#cb103-1989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1990"><a href="#cb103-1990" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_hard_fibre_1y &lt;- summon_rd_forest_plot(data_rd_uc_hard_fibre,</span></span>
<span id="cb103-1991"><a href="#cb103-1991" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1992"><a href="#cb103-1992" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1993"><a href="#cb103-1993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1994"><a href="#cb103-1994" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_hard_pufa_1y &lt;- summon_rd_forest_plot(data_rd_uc_hard_pufa,</span></span>
<span id="cb103-1995"><a href="#cb103-1995" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-1996"><a href="#cb103-1996" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-1997"><a href="#cb103-1997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-1998"><a href="#cb103-1998" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_hard_upf_1y &lt;- summon_rd_forest_plot(data_rd_uc_hard_upf,</span></span>
<span id="cb103-1999"><a href="#cb103-1999" aria-hidden="true" tabindex="-1"></a><span class="at">  time = 365</span></span>
<span id="cb103-2000"><a href="#cb103-2000" aria-hidden="true" tabindex="-1"></a><span class="at">)</span></span>
<span id="cb103-2001"><a href="#cb103-2001" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
<span id="cb103-2002"><a href="#cb103-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-2005"><a href="#cb103-2005" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-2006"><a href="#cb103-2006" aria-hidden="true" tabindex="-1"></a><span class="at">#| warning: false</span></span>
<span id="cb103-2007"><a href="#cb103-2007" aria-hidden="true" tabindex="-1"></a><span class="at"># Final plots using patchwork</span></span>
<span id="cb103-2008"><a href="#cb103-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-2009"><a href="#cb103-2009" aria-hidden="true" tabindex="-1"></a><span class="at"># 1-year risk difference</span></span>
<span id="cb103-2010"><a href="#cb103-2010" aria-hidden="true" tabindex="-1"></a><span class="at">plot_rd_uc_hard_meat_1y$plot + plot_rd_uc_hard_meat_1y$rd +</span></span>
<span id="cb103-2011"><a href="#cb103-2011" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_uc_hard_fibre_1y$plot + plot_rd_uc_hard_fibre_1y$rd +</span></span>
<span id="cb103-2012"><a href="#cb103-2012" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_uc_hard_pufa_1y$plot + plot_rd_uc_hard_pufa_1y$rd +</span></span>
<span id="cb103-2013"><a href="#cb103-2013" aria-hidden="true" tabindex="-1"></a><span class="at">  plot_rd_uc_hard_upf_1y$plot + plot_rd_uc_hard_upf_1y$rd +</span></span>
<span id="cb103-2014"><a href="#cb103-2014" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_layout(</span></span>
<span id="cb103-2015"><a href="#cb103-2015" aria-hidden="true" tabindex="-1"></a><span class="at">    ncol = 2,</span></span>
<span id="cb103-2016"><a href="#cb103-2016" aria-hidden="true" tabindex="-1"></a><span class="at">    guides = "collect",</span></span>
<span id="cb103-2017"><a href="#cb103-2017" aria-hidden="true" tabindex="-1"></a><span class="at">    axes = "collect",</span></span>
<span id="cb103-2018"><a href="#cb103-2018" aria-hidden="true" tabindex="-1"></a><span class="at">    width = c(2, 1)</span></span>
<span id="cb103-2019"><a href="#cb103-2019" aria-hidden="true" tabindex="-1"></a><span class="at">  ) +</span></span>
<span id="cb103-2020"><a href="#cb103-2020" aria-hidden="true" tabindex="-1"></a><span class="at">  patchwork::plot_annotation(</span></span>
<span id="cb103-2021"><a href="#cb103-2021" aria-hidden="true" tabindex="-1"></a><span class="at">    title = "1-year risk difference",</span></span>
<span id="cb103-2022"><a href="#cb103-2022" aria-hidden="true" tabindex="-1"></a><span class="at">    subtitle = "Ulcerative colitis, objective flare."</span></span>
<span id="cb103-2023"><a href="#cb103-2023" aria-hidden="true" tabindex="-1"></a><span class="at">  ) &amp;</span></span>
<span id="cb103-2024"><a href="#cb103-2024" aria-hidden="true" tabindex="-1"></a><span class="at">  coord_cartesian(xlim = c(-10, 20))</span></span>
<span id="cb103-2025"><a href="#cb103-2025" aria-hidden="true" tabindex="-1"></a><span class="st">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, The Authors</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/nathansam/predicct-analysis/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/nathansam/predicct-analysis" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/IBDNathan">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>