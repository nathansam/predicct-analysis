[
  {
    "objectID": "documents.html",
    "href": "documents.html",
    "title": "Study documents",
    "section": "",
    "text": "This page provides key study documents, the study protocol and statistical analysis plans (SAPs), for the PREdiCCt study. These files can either be viewed in the web browser (on computers) or downloaded as PDFs (on both computers and mobile devices).\nAll documents were initially devised prior to the start of the study, with amendments made during recruitment.",
    "crumbs": [
      "Study documents"
    ]
  },
  {
    "objectID": "documents.html#introduction",
    "href": "documents.html#introduction",
    "title": "Study documents",
    "section": "",
    "text": "This page provides key study documents, the study protocol and statistical analysis plans (SAPs), for the PREdiCCt study. These files can either be viewed in the web browser (on computers) or downloaded as PDFs (on both computers and mobile devices).\nAll documents were initially devised prior to the start of the study, with amendments made during recruitment.",
    "crumbs": [
      "Study documents"
    ]
  },
  {
    "objectID": "documents.html#study-protocol",
    "href": "documents.html#study-protocol",
    "title": "Study documents",
    "section": "Study protocol",
    "text": "Study protocol\nThe study protocol is a detailed plan outlining how research will be conducted, providing study objectives, design, methodology, and overall organisation.\nDownload PDF file.",
    "crumbs": [
      "Study documents"
    ]
  },
  {
    "objectID": "documents.html#statistical-analysis-plans-saps",
    "href": "documents.html#statistical-analysis-plans-saps",
    "title": "Study documents",
    "section": "Statistical analysis plans (SAPs)",
    "text": "Statistical analysis plans (SAPs)\nA SAP outlines the statistical methods which will be used in a study. For PREdiCCt, two SAPs were written: one covering baseline analyses and another covering longitudinal analyses.\nWhere possible, we have tried to closely follow the SAPs. However, due to unexpected developments, the actual analyses performed sometimes differed.\n\nBaseline analyses\nThe baseline analysis is largely concerned with descriptive analyses of the cohort and exploring associations between baseline characteristics and faecal calprotectin at recruitment. The baseline section of this website is governed by this SAP.\nDownload PDF file.\n\n\nLongitudinal analyses\nThe longitudinal analysis consists of survival analyses modelling the time to patient-reported or hard flare. The time to flare section of this website is governed by this SAP.\nDownload PDF file.",
    "crumbs": [
      "Study documents"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html",
    "href": "Survival/Biochemistry.html",
    "title": "Biochemistry",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-IBD.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-IBD-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-IBD-uc.RDS\"))\n\ncd.clin.forest &lt;- readRDS(paste0(paths$outdir, \"cd-clin-IBD.RDS\"))\ncd.hard.forest &lt;- readRDS(paste0(paths$outdir, \"cd-hard-IBD.RDS\"))\nuc.clin.forest &lt;- readRDS(paste0(paths$outdir, \"uc-clin-IBD.RDS\"))\nuc.hard.forest &lt;- readRDS(paste0(paths$outdir, \"uc-hard-IBD.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#introduction",
    "href": "Survival/Biochemistry.html#introduction",
    "title": "Biochemistry",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-IBD.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-IBD-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-IBD-uc.RDS\"))\n\ncd.clin.forest &lt;- readRDS(paste0(paths$outdir, \"cd-clin-IBD.RDS\"))\ncd.hard.forest &lt;- readRDS(paste0(paths$outdir, \"cd-hard-IBD.RDS\"))\nuc.clin.forest &lt;- readRDS(paste0(paths$outdir, \"uc-clin-IBD.RDS\"))\nuc.hard.forest &lt;- readRDS(paste0(paths$outdir, \"uc-hard-IBD.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#c-reactive-protein",
    "href": "Survival/Biochemistry.html#c-reactive-protein",
    "title": "Biochemistry",
    "section": "C-reactive protein",
    "text": "C-reactive protein\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize CRP\nflare.cd.df &lt;- categorize_variable(flare.cd.df, \"CReactiveProtein\", \n                                   breaks = c(0, 5, 10.0000001, Inf),\n                                   labels = c(\"CRP &lt; 5\", \"5 ≤ CRP ≤ 10\", \"CRP &gt; 10\"))\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"CReactiveProtein\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"CRP\",\n  plot_base_path = \"plots/cd/soft-flare/biochem/crp\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous CRP variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"CReactiveProtein\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.5114\n1.9050\n3.3108\n0.0000\n\n\nIMD2\n1.2280\n0.7064\n2.1346\n0.4666\n\n\nIMD3\n1.0639\n0.6055\n1.8696\n0.8294\n\n\nIMD4\n1.2974\n0.7536\n2.2335\n0.3476\n\n\nIMD5\n1.1735\n0.6914\n1.9917\n0.5535\n\n\ncatFC 50-250\n1.5652\n1.1720\n2.0903\n0.0024\n\n\ncatFC &gt; 250\n2.4876\n1.8060\n3.4265\n0.0000\n\n\nCReactiveProtein\n1.0017\n0.9894\n1.0141\n0.7891\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1347\n0.9918\n0.7104\n\n\nIMD\n1.5655\n3.9514\n0.8093\n\n\ncat\n3.5876\n1.9800\n0.1637\n\n\nCReactiveProtein\n2.2628\n0.9912\n0.1310\n\n\nGLOBAL\n6.8886\n14.0404\n0.9400\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"CReactiveProtein\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"CRP\",\n  plot_base_path = \"plots/cd/hard-flare/biochem/crp\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous CRP variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"CReactiveProtein\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5403\n1.1285\n2.1022\n0.0065\n\n\nIMD2\n1.1741\n0.5904\n2.3348\n0.6472\n\n\nIMD3\n1.1512\n0.5724\n2.3152\n0.6929\n\n\nIMD4\n1.2896\n0.6580\n2.5274\n0.4587\n\n\nIMD5\n1.2097\n0.6295\n2.3247\n0.5678\n\n\ncatFC 50-250\n2.0009\n1.3908\n2.8786\n0.0002\n\n\ncatFC &gt; 250\n3.0710\n2.0784\n4.5375\n0.0000\n\n\nCReactiveProtein\n1.0088\n0.9995\n1.0181\n0.0635\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n3.3489\n0.9880\n0.0661\n\n\nIMD\n2.8908\n3.9532\n0.5689\n\n\ncat\n6.8059\n1.9875\n0.0329\n\n\nCReactiveProtein\n2.7995\n0.9941\n0.0935\n\n\nGLOBAL\n15.7224\n14.4155\n0.3594\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize CRP\nflare.uc.df &lt;- categorize_variable(flare.uc.df, \"CReactiveProtein\", \n                                   breaks = c(0, 5, 10.0000001, Inf),\n                                   labels = c(\"CRP &lt; 5\", \"5 ≤ CRP ≤ 10\", \"CRP &gt; 10\"))\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"CReactiveProtein\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"CRP\",\n  plot_base_path = \"plots/uc/soft-flare/biochem/crp\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous CRP variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, \"CReactiveProtein\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6446\n1.2924\n2.0926\n0.0001\n\n\nIMD2\n1.2409\n0.7406\n2.0790\n0.4124\n\n\nIMD3\n1.0484\n0.6261\n1.7557\n0.8573\n\n\nIMD4\n1.4396\n0.8833\n2.3463\n0.1437\n\n\nIMD5\n1.1606\n0.7198\n1.8712\n0.5412\n\n\ncatFC 50-250\n1.5937\n1.2038\n2.1098\n0.0011\n\n\ncatFC &gt; 250\n2.2826\n1.6943\n3.0753\n0.0000\n\n\nCReactiveProtein\n1.0018\n0.9860\n1.0179\n0.8258\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.0669\n0.9902\n0.1487\n\n\nIMD\n2.5721\n3.9299\n0.6209\n\n\ncat\n4.4034\n1.9631\n0.1072\n\n\nCReactiveProtein\n4.3050\n0.9837\n0.0371\n\n\nGLOBAL\n12.9174\n19.3120\n0.8555\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"CReactiveProtein\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"CRP\",\n  plot_base_path = \"plots/uc/hard-flare/biochem/crp\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous CRP variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"CReactiveProtein\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2811\n0.9631\n1.7040\n0.0888\n\n\nIMD2\n1.6713\n0.8545\n3.2688\n0.1335\n\n\nIMD3\n1.3587\n0.6949\n2.6563\n0.3702\n\n\nIMD4\n1.9141\n1.0067\n3.6396\n0.0477\n\n\nIMD5\n1.5133\n0.8053\n2.8437\n0.1981\n\n\ncatFC 50-250\n2.0323\n1.4449\n2.8585\n0.0000\n\n\ncatFC &gt; 250\n3.0334\n2.1208\n4.3386\n0.0000\n\n\nCReactiveProtein\n0.9953\n0.9739\n1.0170\n0.6666\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.4924\n0.9867\n0.4775\n\n\nIMD\n0.8766\n3.9347\n0.9236\n\n\ncat\n3.9346\n1.9653\n0.1359\n\n\nCReactiveProtein\n0.0770\n0.9850\n0.7758\n\n\nGLOBAL\n5.4018\n21.3499\n0.9998\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#haemoglobin",
    "href": "Survival/Biochemistry.html#haemoglobin",
    "title": "Biochemistry",
    "section": "Haemoglobin",
    "text": "Haemoglobin\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize Haemoglobin by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"Haemoglobin\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Haemoglobin\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Haemoglobin\",\n  plot_base_path = \"plots/cd/soft-flare/biochem/haemoglobin\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous Haemoglobin variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"Haemoglobin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0755\n1.5455\n2.7872\n0.0000\n\n\nIMD2\n1.1381\n0.6728\n1.9251\n0.6296\n\n\nIMD3\n1.0670\n0.6274\n1.8145\n0.8109\n\n\nIMD4\n1.1227\n0.6698\n1.8817\n0.6605\n\n\nIMD5\n1.0728\n0.6506\n1.7690\n0.7830\n\n\ncatFC 50-250\n1.5963\n1.2125\n2.1017\n0.0009\n\n\ncatFC &gt; 250\n2.5652\n1.8900\n3.4818\n0.0000\n\n\nHaemoglobin\n0.9925\n0.9829\n1.0023\n0.1330\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3008\n0.9904\n0.5794\n\n\nIMD\n4.2401\n3.9529\n0.3678\n\n\ncat\n4.1442\n1.9827\n0.1241\n\n\nHaemoglobin\n1.2177\n0.9929\n0.2677\n\n\nGLOBAL\n9.2130\n13.9190\n0.8127\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Haemoglobin\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Haemoglobin\",\n  plot_base_path = \"plots/cd/hard-flare/biochem/haemoglobin\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous Haemoglobin variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"Haemoglobin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3499\n0.9565\n1.9051\n0.0878\n\n\nIMD2\n1.0105\n0.5316\n1.9207\n0.9745\n\n\nIMD3\n1.1379\n0.5964\n2.1711\n0.6951\n\n\nIMD4\n1.0484\n0.5581\n1.9694\n0.8832\n\n\nIMD5\n0.9917\n0.5397\n1.8221\n0.9785\n\n\ncatFC 50-250\n2.0550\n1.4486\n2.9154\n0.0001\n\n\ncatFC &gt; 250\n3.5176\n2.4149\n5.1238\n0.0000\n\n\nHaemoglobin\n0.9956\n0.9841\n1.0072\n0.4523\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.8560\n0.9871\n0.0894\n\n\nIMD\n3.7488\n3.9454\n0.4328\n\n\ncat\n9.7005\n1.9849\n0.0077\n\n\nHaemoglobin\n6.8981\n0.9911\n0.0085\n\n\nGLOBAL\n20.8165\n18.9811\n0.3459\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize Haemoglobin by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"Haemoglobin\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Haemoglobin\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Haemoglobin\",\n  plot_base_path = \"plots/uc/soft-flare/biochem/haemoglobin\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous Haemoglobin variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, \"Haemoglobin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3056\n0.9811\n1.7374\n0.0674\n\n\nIMD2\n1.2309\n0.7538\n2.0100\n0.4064\n\n\nIMD3\n0.8915\n0.5417\n1.4672\n0.6515\n\n\nIMD4\n1.1646\n0.7272\n1.8651\n0.5261\n\n\nIMD5\n1.1289\n0.7162\n1.7792\n0.6016\n\n\ncatFC 50-250\n1.6837\n1.2762\n2.2213\n0.0002\n\n\ncatFC &gt; 250\n2.1975\n1.6335\n2.9564\n0.0000\n\n\nHaemoglobin\n0.9857\n0.9748\n0.9967\n0.0112\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.9971\n0.9836\n0.3127\n\n\nIMD\n3.7353\n3.9192\n0.4308\n\n\ncat\n5.1028\n1.9606\n0.0752\n\n\nHaemoglobin\n0.0154\n0.9753\n0.8949\n\n\nGLOBAL\n10.3959\n22.0376\n0.9826\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Haemoglobin\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Haemoglobin\",\n  plot_base_path = \"plots/uc/hard-flare/biochem/haemoglobin\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous Haemoglobin variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"Haemoglobin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2574\n0.8991\n1.7585\n0.1808\n\n\nIMD2\n1.3618\n0.7341\n2.5262\n0.3274\n\n\nIMD3\n1.0655\n0.5713\n1.9873\n0.8418\n\n\nIMD4\n1.4946\n0.8265\n2.7028\n0.1837\n\n\nIMD5\n1.2655\n0.7096\n2.2568\n0.4250\n\n\ncatFC 50-250\n1.9287\n1.3727\n2.7100\n0.0002\n\n\ncatFC &gt; 250\n2.9167\n2.0447\n4.1607\n0.0000\n\n\nHaemoglobin\n0.9932\n0.9804\n1.0062\n0.3018\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0292\n0.9843\n0.8597\n\n\nIMD\n1.7907\n3.9323\n0.7653\n\n\ncat\n5.0265\n1.9652\n0.0785\n\n\nHaemoglobin\n0.8658\n0.9821\n0.3459\n\n\nGLOBAL\n7.2975\n21.3166\n0.9979\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#white-cell-count",
    "href": "Survival/Biochemistry.html#white-cell-count",
    "title": "Biochemistry",
    "section": "White cell count",
    "text": "White cell count\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize White Cell Count by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"WCC\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"WCC\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White cell count\",\n  plot_base_path = \"plots/cd/soft-flare/biochem/wcc\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous WCC variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"WCC\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.3006\n1.7747\n2.9823\n0.0000\n\n\nIMD2\n1.1384\n0.6732\n1.9253\n0.6287\n\n\nIMD3\n1.0421\n0.6124\n1.7731\n0.8792\n\n\nIMD4\n1.1244\n0.6710\n1.8841\n0.6561\n\n\nIMD5\n1.0864\n0.6591\n1.7906\n0.7452\n\n\ncatFC 50-250\n1.5984\n1.2140\n2.1045\n0.0008\n\n\ncatFC &gt; 250\n2.6410\n1.9506\n3.5758\n0.0000\n\n\nWCC\n1.0101\n0.9727\n1.0490\n0.6023\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3188\n0.9923\n0.5691\n\n\nIMD\n4.2450\n3.9543\n0.3674\n\n\ncat\n4.1388\n1.9840\n0.1246\n\n\nWCC\n0.5574\n0.9899\n0.4513\n\n\nGLOBAL\n8.7191\n13.4184\n0.8182\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"WCC\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White cell count\",\n  plot_base_path = \"plots/cd/hard-flare/biochem/wcc\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous WCC variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"WCC\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4211\n1.0561\n1.9123\n0.0203\n\n\nIMD2\n1.0084\n0.5306\n1.9167\n0.9795\n\n\nIMD3\n1.1067\n0.5800\n2.1115\n0.7585\n\n\nIMD4\n1.0548\n0.5616\n1.9811\n0.8682\n\n\nIMD5\n1.0054\n0.5472\n1.8474\n0.9861\n\n\ncatFC 50-250\n2.0582\n1.4509\n2.9199\n0.0001\n\n\ncatFC &gt; 250\n3.5382\n2.4336\n5.1442\n0.0000\n\n\nWCC\n1.0336\n0.9885\n1.0809\n0.1468\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.7970\n0.9858\n0.0926\n\n\nIMD\n3.6523\n3.9454\n0.4468\n\n\ncat\n9.7104\n1.9851\n0.0077\n\n\nWCC\n2.9462\n0.9726\n0.0829\n\n\nGLOBAL\n19.9546\n18.6478\n0.3752\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize White Cell Count by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"WCC\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"WCC\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White cell count\",\n  plot_base_path = \"plots/uc/soft-flare/biochem/wcc\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous WCC variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, \"WCC\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6030\n1.2625\n2.0353\n0.0001\n\n\nIMD2\n1.2114\n0.7424\n1.9766\n0.4427\n\n\nIMD3\n0.9092\n0.5532\n1.4945\n0.7075\n\n\nIMD4\n1.1339\n0.7087\n1.8142\n0.6002\n\n\nIMD5\n1.1158\n0.7084\n1.7576\n0.6364\n\n\ncatFC 50-250\n1.6685\n1.2628\n2.2047\n0.0003\n\n\ncatFC &gt; 250\n2.1548\n1.5941\n2.9127\n0.0000\n\n\nWCC\n1.0834\n1.0230\n1.1475\n0.0062\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.0472\n0.9870\n0.3020\n\n\nIMD\n3.5238\n3.9210\n0.4621\n\n\ncat\n4.8428\n1.9607\n0.0857\n\n\nWCC\n0.3476\n0.9723\n0.5439\n\n\nGLOBAL\n9.5136\n22.3170\n0.9916\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"WCC\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White cell count\",\n  plot_base_path = \"plots/uc/hard-flare/biochem/wcc\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous WCC variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"WCC\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3848\n1.0406\n1.8428\n0.0256\n\n\nIMD2\n1.3707\n0.7387\n2.5434\n0.3174\n\n\nIMD3\n1.0676\n0.5725\n1.9910\n0.8370\n\n\nIMD4\n1.4771\n0.8170\n2.6706\n0.1967\n\n\nIMD5\n1.2764\n0.7159\n2.2756\n0.4082\n\n\ncatFC 50-250\n1.9211\n1.3662\n2.7012\n0.0002\n\n\ncatFC &gt; 250\n2.8875\n2.0164\n4.1351\n0.0000\n\n\nWCC\n1.0417\n0.9716\n1.1169\n0.2504\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0397\n0.9850\n0.8373\n\n\nIMD\n1.7908\n3.9311\n0.7652\n\n\ncat\n5.0693\n1.9653\n0.0768\n\n\nWCC\n0.4463\n0.9791\n0.4955\n\n\nGLOBAL\n6.8088\n21.7201\n0.9990\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#platelets",
    "href": "Survival/Biochemistry.html#platelets",
    "title": "Biochemistry",
    "section": "Platelets",
    "text": "Platelets\nThere is significant separation between Kaplan-Meier curves for platelets for both soft and hard flares in CD. However, this significance is lost when controlling for FC and other variables via Cox regression. No significant findings are reported for UC.\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize Platelets by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"Platelets\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Platelets\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Platelets\",\n  plot_base_path = \"plots/cd/soft-flare/biochem/Platelets\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous Platelets variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Platelets + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"Platelets\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.2495\n1.7228\n2.9373\n0.0000\n\n\nIMD2\n1.1311\n0.6683\n1.9143\n0.6464\n\n\nIMD3\n1.0335\n0.6075\n1.7583\n0.9033\n\n\nIMD4\n1.1078\n0.6607\n1.8576\n0.6978\n\n\nIMD5\n1.0735\n0.6509\n1.7704\n0.7811\n\n\ncatFC 50-250\n1.5936\n1.2107\n2.0977\n0.0009\n\n\ncatFC &gt; 250\n2.5785\n1.8953\n3.5082\n0.0000\n\n\nPlatelets\n1.0007\n0.9991\n1.0023\n0.3859\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3063\n0.9934\n0.5772\n\n\nIMD\n4.2714\n3.9552\n0.3642\n\n\ncat\n4.1818\n1.9843\n0.1220\n\n\nPlatelets\n1.0975\n0.9900\n0.2917\n\n\nGLOBAL\n9.0260\n13.2643\n0.7876\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Platelets\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Platelets\",\n  plot_base_path = \"plots/cd/hard-flare/biochem/Platelets\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous Platelets variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Platelets + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"Platelets\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3809\n1.0170\n1.8750\n0.0386\n\n\nIMD2\n1.0000\n0.5261\n1.9011\n0.9999\n\n\nIMD3\n1.1066\n0.5807\n2.1088\n0.7582\n\n\nIMD4\n1.0363\n0.5519\n1.9458\n0.9116\n\n\nIMD5\n0.9874\n0.5375\n1.8140\n0.9674\n\n\ncatFC 50-250\n2.0369\n1.4350\n2.8913\n0.0001\n\n\ncatFC &gt; 250\n3.4517\n2.3653\n5.0372\n0.0000\n\n\nPlatelets\n1.0010\n0.9993\n1.0028\n0.2474\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.7745\n0.9876\n0.0942\n\n\nIMD\n3.7163\n3.9455\n0.4375\n\n\ncat\n9.5984\n1.9852\n0.0081\n\n\nPlatelets\n0.8911\n0.9906\n0.3420\n\n\nGLOBAL\n17.5943\n18.4237\n0.5113\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize Platelets by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"Platelets\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Platelets\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Platelets\",\n  plot_base_path = \"plots/uc/soft-flare/biochem/Platelets\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous Platelets variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Platelets + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, \"Platelets\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6359\n1.2815\n2.0883\n0.0001\n\n\nIMD2\n1.2115\n0.7423\n1.9773\n0.4427\n\n\nIMD3\n0.9195\n0.5589\n1.5125\n0.7409\n\n\nIMD4\n1.1625\n0.7274\n1.8577\n0.5291\n\n\nIMD5\n1.1133\n0.7074\n1.7520\n0.6428\n\n\ncatFC 50-250\n1.7042\n1.2898\n2.2517\n0.0002\n\n\ncatFC &gt; 250\n2.3417\n1.7414\n3.1489\n0.0000\n\n\nPlatelets\n0.9996\n0.9978\n1.0014\n0.6470\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.9266\n0.9866\n0.3313\n\n\nIMD\n3.6484\n3.9255\n0.4443\n\n\ncat\n5.1798\n1.9617\n0.0724\n\n\nPlatelets\n1.2273\n0.9820\n0.2627\n\n\nGLOBAL\n10.6943\n21.6429\n0.9755\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Platelets\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Platelets\",\n  plot_base_path = \"plots/uc/hard-flare/biochem/Platelets\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous Platelets variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Platelets + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"Platelets\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3852\n1.0354\n1.8533\n0.0282\n\n\nIMD2\n1.3635\n0.7344\n2.5316\n0.3260\n\n\nIMD3\n1.0820\n0.5795\n2.0204\n0.8045\n\n\nIMD4\n1.4818\n0.8202\n2.6771\n0.1926\n\n\nIMD5\n1.2584\n0.7059\n2.2433\n0.4359\n\n\ncatFC 50-250\n1.9349\n1.3751\n2.7228\n0.0002\n\n\ncatFC &gt; 250\n3.0046\n2.1079\n4.2827\n0.0000\n\n\nPlatelets\n1.0001\n0.9980\n1.0022\n0.9407\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0330\n0.9835\n0.8508\n\n\nIMD\n1.8166\n3.9337\n0.7607\n\n\ncat\n4.9938\n1.9649\n0.0798\n\n\nPlatelets\n0.2339\n0.9849\n0.6224\n\n\nGLOBAL\n6.6236\n21.4912\n0.9991\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#albumin",
    "href": "Survival/Biochemistry.html#albumin",
    "title": "Biochemistry",
    "section": "Albumin",
    "text": "Albumin\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize Albumin by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"Albumin\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Albumin\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Albumin\",\n  plot_base_path = \"plots/cd/soft-flare/biochem/albumin\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous Albumin variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"Albumin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.2704\n1.7358\n2.9697\n0.0000\n\n\nIMD2\n1.1975\n0.7005\n2.0474\n0.5100\n\n\nIMD3\n1.1051\n0.6436\n1.8976\n0.7170\n\n\nIMD4\n1.1570\n0.6824\n1.9617\n0.5882\n\n\nIMD5\n1.1152\n0.6683\n1.8609\n0.6765\n\n\ncatFC 50-250\n1.6516\n1.2460\n2.1892\n0.0005\n\n\ncatFC &gt; 250\n2.4799\n1.8009\n3.4147\n0.0000\n\n\nAlbumin\n0.9835\n0.9596\n1.0081\n0.1877\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.5738\n0.9985\n0.4481\n\n\nIMD\n3.8357\n3.9888\n0.4270\n\n\ncat\n6.5059\n1.9965\n0.0385\n\n\nAlbumin\n0.1594\n0.9803\n0.6816\n\n\nGLOBAL\n10.7187\n8.8662\n0.2846\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Albumin\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Albumin\",\n  plot_base_path = \"plots/cd/hard-flare/biochem/albumin\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous Albumin variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"Albumin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4446\n1.0621\n1.9646\n0.0191\n\n\nIMD2\n0.9964\n0.5236\n1.8963\n0.9913\n\n\nIMD3\n1.0062\n0.5244\n1.9306\n0.9852\n\n\nIMD4\n0.9927\n0.5269\n1.8700\n0.9818\n\n\nIMD5\n0.9065\n0.4904\n1.6756\n0.7541\n\n\ncatFC 50-250\n2.1095\n1.4746\n3.0179\n0.0000\n\n\ncatFC &gt; 250\n3.2938\n2.2145\n4.8992\n0.0000\n\n\nAlbumin\n1.0071\n0.9709\n1.0446\n0.7043\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.5520\n0.9880\n0.1084\n\n\nIMD\n6.0553\n3.9539\n0.1906\n\n\ncat\n8.7501\n1.9867\n0.0124\n\n\nAlbumin\n2.6129\n0.9046\n0.0928\n\n\nGLOBAL\n19.4962\n16.0639\n0.2473\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize Albumin by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"Albumin\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Albumin\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Albumin\",\n  plot_base_path = \"plots/uc/soft-flare/biochem/albumin\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for continuous Albumin variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, \"Albumin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5516\n1.2175\n1.9773\n0.0004\n\n\nIMD2\n1.1036\n0.6697\n1.8185\n0.6990\n\n\nIMD3\n0.9271\n0.5653\n1.5205\n0.7644\n\n\nIMD4\n1.1778\n0.7403\n1.8739\n0.4897\n\n\nIMD5\n1.0943\n0.6955\n1.7218\n0.6966\n\n\ncatFC 50-250\n1.7423\n1.3140\n2.3103\n0.0001\n\n\ncatFC &gt; 250\n2.1971\n1.6288\n2.9637\n0.0000\n\n\nAlbumin\n0.9775\n0.9514\n1.0043\n0.0996\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.9351\n0.9883\n0.3296\n\n\nIMD\n5.0458\n3.9409\n0.2754\n\n\ncat\n4.4764\n1.9667\n0.1036\n\n\nAlbumin\n0.0124\n0.8768\n0.8787\n\n\nGLOBAL\n10.2249\n18.1402\n0.9279\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Albumin\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Albumin\",\n  plot_base_path = \"plots/uc/hard-flare/biochem/albumin\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for continuous Albumin variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"Albumin\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3243\n0.9879\n1.7754\n0.0603\n\n\nIMD2\n1.2614\n0.6707\n2.3723\n0.4711\n\n\nIMD3\n1.0544\n0.5654\n1.9662\n0.8678\n\n\nIMD4\n1.4427\n0.7995\n2.6033\n0.2236\n\n\nIMD5\n1.2662\n0.7108\n2.2558\n0.4230\n\n\ncatFC 50-250\n1.9480\n1.3707\n2.7685\n0.0002\n\n\ncatFC &gt; 250\n2.8956\n2.0192\n4.1525\n0.0000\n\n\nAlbumin\n0.9866\n0.9573\n1.0168\n0.3798\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1590\n0.9858\n0.6843\n\n\nIMD\n1.5380\n3.9411\n0.8130\n\n\ncat\n4.2686\n1.9686\n0.1152\n\n\nAlbumin\n0.3438\n0.9039\n0.5165\n\n\nGLOBAL\n6.1498\n19.9849\n0.9987\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#reproduction-and-reproducibility",
    "href": "Survival/Biochemistry.html#reproduction-and-reproducibility",
    "title": "Biochemistry",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.\n\nCodesaveRDS(flare.df, paste0(paths$outdir, \"flares-biochem.RDS\"))\nsaveRDS(flare.cd.df, paste0(paths$outdir, \"flares-biochem-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(paths$outdir, \"flares-biochem-uc.RDS\"))\n\nsaveRDS(cd.clin.forest, paste0(paths$outdir, \"cd-clin-biochem.RDS\"))\nsaveRDS(cd.hard.forest, paste0(paths$outdir, \"cd-hard-biochem.RDS\"))\nsaveRDS(uc.clin.forest, paste0(paths$outdir, \"uc-clin-biochem.RDS\"))\nsaveRDS(uc.hard.forest, paste0(paths$outdir, \"uc-hard-biochem.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Demographics.html",
    "href": "Survival/Demographics.html",
    "title": "Demographic data",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\nlibrary(forestplot)\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-controlled.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-controlled-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-controlled-uc.RDS\"))\n\ncd.clin.forest &lt;- readRDS(paste0(paths$outdir, \"cd-clin-controlled.RDS\"))\ncd.hard.forest &lt;- readRDS(paste0(paths$outdir, \"cd-hard-controlled.RDS\"))\nuc.clin.forest &lt;- readRDS(paste0(paths$outdir, \"uc-clin-controlled.RDS\"))\nuc.hard.forest &lt;- readRDS(paste0(paths$outdir, \"uc-hard-controlled.RDS\"))\n\n\nThis page describes associations between demographic data and time-to-flare. Sex and IMD are not covered here as they are covered in the controlled variables section\nThe page describing demographic variables in a descriptive manner can be found here.",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#introduction",
    "href": "Survival/Demographics.html#introduction",
    "title": "Demographic data",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\nlibrary(forestplot)\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-controlled.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-controlled-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-controlled-uc.RDS\"))\n\ncd.clin.forest &lt;- readRDS(paste0(paths$outdir, \"cd-clin-controlled.RDS\"))\ncd.hard.forest &lt;- readRDS(paste0(paths$outdir, \"cd-hard-controlled.RDS\"))\nuc.clin.forest &lt;- readRDS(paste0(paths$outdir, \"uc-clin-controlled.RDS\"))\nuc.hard.forest &lt;- readRDS(paste0(paths$outdir, \"uc-hard-controlled.RDS\"))\n\n\nThis page describes associations between demographic data and time-to-flare. Sex and IMD are not covered here as they are covered in the controlled variables section\nThe page describing demographic variables in a descriptive manner can be found here.",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#age",
    "href": "Survival/Demographics.html#age",
    "title": "Demographic data",
    "section": "Age",
    "text": "Age\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize age\nflare.cd.df &lt;- categorize_variable(flare.cd.df, \"Age\", \n                                   breaks = c(0, 18, 30, 45, 65, Inf),\n                                   labels = c(\"Under 18\", \"18-29\", \"30-44\", \"45-64\", \"65+\"))\n\n# Generate survival plot and run Cox model\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Age\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Age\",\n  plot_base_path = \"plots/cd/soft-flare/demographics/age\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for Age (continuous variable)\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~ Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(cd.clin.forest, get_HR(fit.me, \"Age\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9948\n1.5719\n2.5314\n0.0000\n\n\nIMD2\n0.9308\n0.5932\n1.4607\n0.7552\n\n\nIMD3\n0.8884\n0.5615\n1.4056\n0.6131\n\n\nIMD4\n0.9315\n0.5990\n1.4484\n0.7527\n\n\nIMD5\n0.9621\n0.6277\n1.4748\n0.8594\n\n\ncatFC 50-250\n1.5738\n1.2191\n2.0316\n0.0005\n\n\ncatFC &gt; 250\n2.4166\n1.8207\n3.2075\n0.0000\n\n\nAge\n1.0049\n0.9977\n1.0121\n0.1862\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2901\n0.9920\n0.5868\n\n\nIMD\n5.8012\n3.9466\n0.2090\n\n\ncat\n2.3892\n1.9800\n0.2989\n\n\nAge\n2.7170\n0.9659\n0.0948\n\n\nGLOBAL\n12.3923\n15.5406\n0.6865\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Age\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Age\",\n  plot_base_path = \"plots/cd/hard-flare/demographics/age\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for Age (continuous variable)\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~ Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(cd.hard.forest, get_HR(fit.me, \"Age\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4100\n1.0742\n1.8506\n0.0133\n\n\nIMD2\n0.9220\n0.5371\n1.5828\n0.7684\n\n\nIMD3\n0.9333\n0.5377\n1.6200\n0.8061\n\n\nIMD4\n0.9037\n0.5282\n1.5462\n0.7117\n\n\nIMD5\n0.9530\n0.5672\n1.6014\n0.8559\n\n\ncatFC 50-250\n2.0702\n1.5083\n2.8414\n0.0000\n\n\ncatFC &gt; 250\n3.3191\n2.3583\n4.6712\n0.0000\n\n\nAge\n0.9865\n0.9779\n0.9953\n0.0026\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2070\n0.9856\n0.6432\n\n\nIMD\n4.3372\n3.9449\n0.3546\n\n\ncat\n8.6873\n1.9855\n0.0128\n\n\nAge\n3.3245\n0.9503\n0.0635\n\n\nGLOBAL\n16.4294\n18.2438\n0.5790\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize age\nflare.uc.df &lt;- categorize_variable(flare.uc.df, \"Age\", \n                                   breaks = c(0, 18, 30, 45, 65, Inf),\n                                   labels = c(\"Under 18\", \"18-29\", \"30-44\", \"45-64\", \"65+\"))\n\n# Generate survival plot and run Cox model\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Age\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Age\",\n  plot_base_path = \"plots/uc/soft-flare/demographics/age\",\n  break_time_by = 200\n)\n\n# Extract hazard ratio for Age (continuous variable)\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~ Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(uc.clin.forest, get_HR(fit.me, \"Age\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5135\n1.2220\n1.8747\n0.0001\n\n\nIMD2\n1.2074\n0.7621\n1.9129\n0.4220\n\n\nIMD3\n1.0923\n0.6966\n1.7126\n0.7006\n\n\nIMD4\n1.4407\n0.9378\n2.2131\n0.0955\n\n\nIMD5\n1.2134\n0.7953\n1.8512\n0.3695\n\n\ncatFC 50-250\n1.5856\n1.2399\n2.0277\n0.0002\n\n\ncatFC &gt; 250\n2.1185\n1.6228\n2.7658\n0.0000\n\n\nAge\n0.9928\n0.9857\n0.9998\n0.0449\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.2765\n0.9891\n0.2555\n\n\nIMD\n3.9850\n3.9439\n0.3998\n\n\ncat\n5.7478\n1.9712\n0.0549\n\n\nAge\n0.2636\n0.9656\n0.5931\n\n\nGLOBAL\n11.8199\n19.6624\n0.9132\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Generate survival plot and run Cox model for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Age\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Age\",\n  plot_base_path = \"plots/uc/hard-flare/demographics/age\",\n  break_time_by = 500\n)\n\n# Extract hazard ratio for Age (continuous variable)\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~ Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(uc.hard.forest, get_HR(fit.me, \"Age\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2937\n0.9958\n1.6807\n0.0538\n\n\nIMD2\n1.3555\n0.7565\n2.4289\n0.3067\n\n\nIMD3\n1.3777\n0.7842\n2.4203\n0.2650\n\n\nIMD4\n1.7536\n1.0168\n3.0242\n0.0434\n\n\nIMD5\n1.3509\n0.7875\n2.3173\n0.2747\n\n\ncatFC 50-250\n2.0872\n1.5288\n2.8495\n0.0000\n\n\ncatFC &gt; 250\n3.1867\n2.3015\n4.4124\n0.0000\n\n\nAge\n0.9882\n0.9794\n0.9971\n0.0094\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1150\n0.9847\n0.7285\n\n\nIMD\n2.7089\n3.9421\n0.5986\n\n\ncat\n4.0990\n1.9687\n0.1255\n\n\nAge\n0.3529\n0.9656\n0.5381\n\n\nGLOBAL\n7.4819\n23.1362\n0.9991\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#bmi",
    "href": "Survival/Demographics.html#bmi",
    "title": "Demographic data",
    "section": "BMI",
    "text": "BMI\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(softflare_time, softflare) ~ BMIcat,\n  legend_title = \"BMI\",\n  legend_labs = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\"),\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to clinical flare\",\n  break_time_by = 200,\n  plot_path = \"plots/cd/soft-flare/demographics/bmi\"\n)\n\nprint(p, newpage = FALSE)\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, c(\"BMI\"))\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.1473\n1.6736\n2.7550\n0.0000\n\n\nIMD2\n0.8998\n0.5671\n1.4279\n0.6542\n\n\nIMD3\n0.8895\n0.5555\n1.4243\n0.6258\n\n\nIMD4\n0.9343\n0.5951\n1.4667\n0.7676\n\n\nIMD5\n0.9772\n0.6332\n1.5081\n0.9171\n\n\ncatFC 50-250\n1.5540\n1.1972\n2.0170\n0.0009\n\n\ncatFC &gt; 250\n2.2569\n1.6787\n3.0342\n0.0000\n\n\nBMI\n1.0122\n0.9911\n1.0337\n0.2594\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1734\n0.9925\n0.6740\n\n\nIMD\n6.5777\n3.9477\n0.1556\n\n\ncat\n1.5900\n1.9797\n0.4468\n\n\nBMI\n2.3144\n0.9900\n0.1265\n\n\nGLOBAL\n10.2401\n14.8159\n0.7941\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(hardflare_time, hardflare) ~ BMIcat,\n  legend_title = \"BMI\",\n  legend_labs = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\"),\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/cd/hard-flare/demographics/bmi\"\n)\n\nprint(p, newpage = FALSE)\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, c(\"BMI\"))\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5011\n1.1295\n1.9950\n0.0051\n\n\nIMD2\n0.9513\n0.5451\n1.6599\n0.8604\n\n\nIMD3\n0.9658\n0.5454\n1.7103\n0.9050\n\n\nIMD4\n0.8451\n0.4830\n1.4788\n0.5556\n\n\nIMD5\n0.9334\n0.5478\n1.5906\n0.8001\n\n\ncatFC 50-250\n2.0103\n1.4508\n2.7857\n0.0000\n\n\ncatFC &gt; 250\n3.1451\n2.1945\n4.5074\n0.0000\n\n\nBMI\n1.0200\n0.9949\n1.0456\n0.1187\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.8263\n0.9880\n0.3591\n\n\nIMD\n3.6654\n3.9453\n0.4448\n\n\ncat\n7.2453\n1.9854\n0.0263\n\n\nBMI\n3.8299\n0.9886\n0.0495\n\n\nGLOBAL\n15.1563\n17.4781\n0.6169\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(softflare_time, softflare) ~ BMIcat,\n  legend_title = \"BMI\",\n  legend_labs = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\"),\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to clinical flare\",\n  break_time_by = 200,\n  plot_path = \"plots/uc/soft-flare/demographics/bmi\"\n)\n\nprint(p, newpage = FALSE)\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, c(\"BMI\"))\n)\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5667\n1.2601\n1.9478\n0.0001\n\n\nIMD2\n1.2357\n0.7747\n1.9711\n0.3743\n\n\nIMD3\n1.0037\n0.6340\n1.5890\n0.9873\n\n\nIMD4\n1.4156\n0.9159\n2.1878\n0.1177\n\n\nIMD5\n1.1137\n0.7241\n1.7128\n0.6240\n\n\ncatFC 50-250\n1.6181\n1.2586\n2.0803\n0.0002\n\n\ncatFC &gt; 250\n2.1566\n1.6473\n2.8235\n0.0000\n\n\nBMI\n0.9686\n0.9481\n0.9896\n0.0035\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.3437\n0.9904\n0.2438\n\n\nIMD\n3.8474\n3.9456\n0.4189\n\n\ncat\n4.7128\n1.9726\n0.0925\n\n\nBMI\n0.4838\n0.9851\n0.4807\n\n\nGLOBAL\n10.4559\n17.3504\n0.8958\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(hardflare_time, hardflare) ~ BMIcat,\n  legend_title = \"BMI\",\n  legend_labs = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\"),\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/uc/hard-flare/demographics/bmi\"\n)\n\nprint(p, newpage = FALSE)\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"BMI\")\n  )\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3542\n1.0359\n1.7703\n0.0265\n\n\nIMD2\n1.4226\n0.7804\n2.5931\n0.2499\n\n\nIMD3\n1.3567\n0.7598\n2.4225\n0.3024\n\n\nIMD4\n1.7491\n0.9986\n3.0636\n0.0506\n\n\nIMD5\n1.2764\n0.7316\n2.2270\n0.3902\n\n\ncatFC 50-250\n2.0568\n1.4948\n2.8299\n0.0000\n\n\ncatFC &gt; 250\n3.2137\n2.3058\n4.4790\n0.0000\n\n\nBMI\n0.9808\n0.9558\n1.0065\n0.1415\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1486\n0.9850\n0.6938\n\n\nIMD\n2.5015\n3.9358\n0.6345\n\n\ncat\n3.5648\n1.9672\n0.1640\n\n\nBMI\n0.1512\n0.9853\n0.6915\n\n\nGLOBAL\n6.9035\n22.4944\n0.9993\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(paths$outdir, \"flares-demographics.RDS\"))\nsaveRDS(flare.cd.df, paste0(paths$outdir, \"flares-demographics-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(paths$outdir, \"flares-demographics-uc.RDS\"))\n\nsaveRDS(cd.clin.forest, paste0(paths$outdir, \"cd-clin-demographics.RDS\"))\nsaveRDS(cd.hard.forest, paste0(paths$outdir, \"cd-hard-demographics.RDS\"))\nsaveRDS(uc.clin.forest, paste0(paths$outdir, \"uc-clin-demographics.RDS\"))\nsaveRDS(uc.hard.forest, paste0(paths$outdir, \"uc-hard-demographics.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#reproduction-and-reproducibility",
    "href": "Survival/Demographics.html#reproduction-and-reproducibility",
    "title": "Demographic data",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: grid, stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0), readxl(v.1.4.3), forestplot(v.3.1.6), abind(v.1.4-5) and checkmate(v.2.3.2)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html",
    "href": "Survival/Soft-hard-flares.html",
    "title": "Flare overview",
    "section": "",
    "text": "Codelibrary(patchwork)\nsource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\ndemo$FC &lt;- log(demo$FC)\n\n\nworthwhile to first consider how questionnaires were completed for each month.\nAs should be expected, there is a small degree of attrition of responses over time (Figure 1). However, there is a large increase at the end of followup (M24) as additional communications were sent which encouraged the completion of the final questionnaire.\n\nCodemonthly &lt;- read_xlsx(paste0(paths$data.path, \"Followup/monthlyQ.xlsx\"))\n\n# Create plots using utility function\np1 &lt;- create_monthly_response_plot(\n  monthly, \n  fill_color = \"#F17300\", \n  border_color = \"#904200\", \n  y_label = \"Monthly questionnaire responses\"\n)\n\nmonthly.fc &lt;- monthly %&gt;%\n  filter(ParticipantNo %in% subset(demo, !is.na(cat))$ParticipantNo)\n\np2 &lt;- create_monthly_response_plot(\n  monthly.fc, \n  fill_color = \"#A8201A\", \n  border_color = \"#6F0802\", \n  y_label = \"Monthly questionnaire responses\"\n)\n\nmonthly.ffq &lt;- monthly %&gt;%\n  filter(ParticipantNo %in% subset(demo, (!is.na(cat)) & (!is.na(fibre)))$ParticipantNo)\n\np3 &lt;- create_monthly_response_plot(\n  monthly.ffq, \n  fill_color = \"#0F8B8D\", \n  border_color = \"#005354\", \n  y_label = \"Monthly questionnaire responses\",\n  x_label = \"Month of follow-up\"\n)\n\np &lt;- p1 / p2 / p3 +\n  plot_annotation(tag_levels = \"A\") &\n  theme(plot.tag = element_text(face = \"bold\", size = 18))\n\nggsave(\"plots/response-rate.pdf\", p, width = 7, height = 15)\nggsave(\"plots/response-rate.png\", p, width = 7, height = 15)\np\n\n\n\n\n\n\nFigure 1: Number of responses for each month of follow-up for (A) the whole cohort, (B) the FC cohort, and (C) the FFQ cohort.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#introduction",
    "href": "Survival/Soft-hard-flares.html#introduction",
    "title": "Flare overview",
    "section": "",
    "text": "Codelibrary(patchwork)\nsource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\ndemo$FC &lt;- log(demo$FC)\n\n\nworthwhile to first consider how questionnaires were completed for each month.\nAs should be expected, there is a small degree of attrition of responses over time (Figure 1). However, there is a large increase at the end of followup (M24) as additional communications were sent which encouraged the completion of the final questionnaire.\n\nCodemonthly &lt;- read_xlsx(paste0(paths$data.path, \"Followup/monthlyQ.xlsx\"))\n\n# Create plots using utility function\np1 &lt;- create_monthly_response_plot(\n  monthly, \n  fill_color = \"#F17300\", \n  border_color = \"#904200\", \n  y_label = \"Monthly questionnaire responses\"\n)\n\nmonthly.fc &lt;- monthly %&gt;%\n  filter(ParticipantNo %in% subset(demo, !is.na(cat))$ParticipantNo)\n\np2 &lt;- create_monthly_response_plot(\n  monthly.fc, \n  fill_color = \"#A8201A\", \n  border_color = \"#6F0802\", \n  y_label = \"Monthly questionnaire responses\"\n)\n\nmonthly.ffq &lt;- monthly %&gt;%\n  filter(ParticipantNo %in% subset(demo, (!is.na(cat)) & (!is.na(fibre)))$ParticipantNo)\n\np3 &lt;- create_monthly_response_plot(\n  monthly.ffq, \n  fill_color = \"#0F8B8D\", \n  border_color = \"#005354\", \n  y_label = \"Monthly questionnaire responses\",\n  x_label = \"Month of follow-up\"\n)\n\np &lt;- p1 / p2 / p3 +\n  plot_annotation(tag_levels = \"A\") &\n  theme(plot.tag = element_text(face = \"bold\", size = 18))\n\nggsave(\"plots/response-rate.pdf\", p, width = 7, height = 15)\nggsave(\"plots/response-rate.png\", p, width = 7, height = 15)\np\n\n\n\n\n\n\nFigure 1: Number of responses for each month of follow-up for (A) the whole cohort, (B) the FC cohort, and (C) the FFQ cohort.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#primary-outcome-first-patient-reported-flare",
    "href": "Survival/Soft-hard-flares.html#primary-outcome-first-patient-reported-flare",
    "title": "Flare overview",
    "section": "Primary outcome: First patient-reported flare",
    "text": "Primary outcome: First patient-reported flare\n\nCodeflares &lt;- read_xlsx(\n  paste0(paths$all.flare.path, \"all-flares.xlsx\"),\n  na = \".\",\n  sheet = 1\n) %&gt;%\n  select(ParticipantNo, softflare, softflare_time, hardflare, hardflare_time)\n\nflare.df &lt;- merge(demo, flares, by = \"ParticipantNo\")\n\n\nFor patient-reported flares, a flare is primarily defined by a subject reporting their disease as uncontrolled. The time of the flare is given by the date the subject reported their symptoms worsening.\nIf a date for when the symptoms worsened is given, but the subject did not answer if their disease was uncontrolled, it is assumed their disease is not controlled (in other words, it is assumed a patient-reported flare occurred).\nIf a subject reported their disease as being uncontrolled, but did not give a date for the worsening of their symptoms, then the earliest date given for either an IBD outpatient appointment, emergency hospital admission, call with their IBD care team, or surgery in the questionnaire response was used. If none of these dates were provided then the date of the questionnaire response was used instead.\nIf a hard flare occurs prior to a patient-reported flare then the patient-reported flare is assumed to occur on the same date as the hard flare.\nA complete description of the steps taken to calculate patient-reported flares is outlined in the below drop-down section.\n\nSteps for calculating patient-reported flares\n\nIf date of flare is before date of entry to study, then delete flare date and recode diseasecontrolled as 1.\nIf flare date is after the questionnaire date (I.E in the future), reset flare date to questionnaire date.\nIf questionnaire completed after date of withdrawal, remove.\nIf date of flare is &gt;2 years after entry, censor patient-reported flare at 2 years.\nTime is earliest of flare time or end of follow up, from entry date.\nAll data censored at 2 years.\nIncluding the hard flares (hard flare data are much more straightforward, flare=diseaseflareyn and flare date=firstflarestartdate from EOS data)\n\nIf both datasets say no flare, patient-reported flare is no and follow up time from hard flare &lt;= 2 years, patient-reported flare time is longest of questionnaire and hard flare times\nIf both datasets say no flare, patient-reported flare is no and follow up time from hard flare &gt; 2 years, patient-reported time is 2 years\nIf no flare in questionnaires, but hard flare reported before 2 years of follow up, take hard flare data\nIf no flare in questionnaires, but hard flare reported after 2 years, patient-reported flare is no and patient-reported flare time is 2 years\nIf flare in questionnaire and no hard flare, patient-reported flare from questionnaire data\nIf flare in questionnaire and also hard flare, take the earliest time\nIf questionnaire data is missing and no hard flare, patient-reported flare is no and time is earliest of hard flare follow up and 2 years\nIf questionnaire data is missing and hard flare reported within 2 years, patient-reported flare data are taken from hard flare data\nIf questionnaire data is missing and hard flare reported after 2 years then patient-reported flare is no and time is 2 years\nOtherwise if questionnaire data is not missing and hardflare is, then patient-reported flare is taken from questionnaire data\n\n\n\nAll times are taken from the earliest reported flare.\n\nCodeflare_data &lt;- flare.df %&gt;% drop_na(cat)\np &lt;- create_km_flare_plot(\n  data = flare_data,\n  formula = Surv(softflare_time, softflare) ~ diagnosis2,\n  legend_title = \"IBD type\",\n  legend_labs = c(\"Crohn's disease\", \"UC/IBDU\"),\n  palette = c(\"#4F6D7A\", \"#02C3BD\"),\n  xlab = \"Time from study recruitment (days)\",\n  save_path = paste0(paths$outdir, \"flare-soft\")\n)\nprint(p, newpage = FALSE)\n\n\n\n\n\n\nFigure 2: Kaplan-Meier curves for patient-reported flares stratified by IBD type.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#secondary-outcome-first-hard-flare",
    "href": "Survival/Soft-hard-flares.html#secondary-outcome-first-hard-flare",
    "title": "Flare overview",
    "section": "Secondary outcome: first hard flare",
    "text": "Secondary outcome: first hard flare\nDisease flares been reported by clinical care teams instead of being reported by subjects themselves.\n\nCodeflare.df.cutoff &lt;- flare.df %&gt;%\n  mutate(\n    hardflare = if_else(hardflare_time &gt; 730.5, 0, hardflare),\n    hardflare_time = if_else(hardflare_time &gt; 730.5, 730.5, hardflare_time)\n  )\n\np &lt;- create_km_flare_plot(\n  data = flare.df.cutoff,\n  formula = Surv(hardflare_time, hardflare) ~ diagnosis2,\n  legend_title = \"IBD type\",\n  legend_labs = c(\"Crohn's disease\", \"UC/IBDU\"),\n  palette = c(\"#4F6D7A\", \"#02C3BD\"),\n  xlab = \"Time from study recruitment (days)\"\n)\nprint(p, newpage = FALSE)\n\n\n\n\n\n\nFigure 3: Kaplan-Meier curves of hard flares stratified by IBD type across the first two years.\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ 1, data = flare.df)\np &lt;- ggsurvplot(fit,\n  data = flare.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  palette = c(\"#4F6D7A\", \"#02C3BD\"),\n  xlab = \"Time from study recrutiment (days)\",\n  break.time.by = 400\n)\n\nWarning in .pvalue(fit, data = data, method = method, pval = pval, pval.coord = pval.coord, : There are no survival curves to be compared. \n This is a null model.\n\nCodefit %&gt;%\n  tbl_survfit(\n    times = max(flare.df$hardflare_time, na.rm = TRUE),\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**Survival across full follow-up (95% CI)**\"\n  )\n\n\nTable 1: Hard flare survival rates across the full follow-up.\n\n\n\n\n\n\n\nCharacteristic\nSurvival across full follow-up (95% CI)\n\n\nOverall\n70% (67%, 74%)\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- create_km_flare_plot(\n  data = flare.df,\n  formula = Surv(hardflare_time, hardflare) ~ diagnosis2,\n  legend_title = \"IBD type\",\n  legend_labs = c(\"Crohn's disease\", \"UC/IBDU\"),\n  palette = c(\"#4F6D7A\", \"#02C3BD\"),\n  xlab = \"Time from study recruitment (days)\",\n  save_path = paste0(paths$outdir, \"flare-hard\")\n)\nprint(p, newpage = FALSE)\n\n\n\n\n\n\nFigure 4: Kaplan-Meier curves of hard flares stratified by IBD type across the full follow-up.\n\n\n\n\n\nCodefit %&gt;%\n  tbl_survfit(\n    times = max(flare.df$hardflare_time, na.rm = TRUE),\n    label = \"IBD type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**Survival across full follow-up (95% CI)**\"\n  )\n\n\n\n\n\n\nCharacteristic\nSurvival across full follow-up (95% CI)\n\n\nIBD type\n70% (67%, 74%)",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#comparison-of-hard-and-patient-reported-flares",
    "href": "Survival/Soft-hard-flares.html#comparison-of-hard-and-patient-reported-flares",
    "title": "Flare overview",
    "section": "Comparison of hard and patient-reported flares",
    "text": "Comparison of hard and patient-reported flares\n\nCodeflare.comb &lt;- rbind(\n  data.frame(\n    ParticipantNo = flares$ParticipantNo,\n    Cens = flares$hardflare,\n    time = flares$hardflare_time,\n    type = \"Hard flare\"\n  ),\n  data.frame(\n    ParticipantNo = flares$ParticipantNo,\n    Cens = flares$softflare,\n    time = flares$softflare_time,\n    type = \"Patient-reported flare\"\n  )\n)\n\nflare.comb &lt;- flare.comb %&gt;%\n  drop_na(Cens, time)\n\n\nflare.comb$type &lt;- factor(flare.comb$type,\n  levels = c(\"Hard flare\", \"Patient-reported flare\")\n)\n\n\np &lt;- create_km_flare_plot(\n  data = flare.comb,\n  formula = Surv(time, Cens) ~ type,\n  legend_title = \"Flare type\",\n  legend_labs = c(\"Hard flare\", \"Patient-reported flare\"),\n  palette = c(\"#DD6E42\", \"#EE1B65\"),\n  xlab = \"Time from study recruitment (days)\",\n  show_pval = FALSE,\n  xlim = c(0, 2200),\n  save_path = paste0(paths$outdir, \"flare-comparison\")\n)\n\nScale for x is already present.\nAdding another scale for x, which will replace the existing scale.\n\nCode# Additional save for plots directory\ncairo_pdf(\"plots/flare-comparison.pdf\", width = 7, height = 7)\nprint(p, newpage = FALSE)\ninvisible(dev.off())\n\nprint(p, newpage = FALSE)\n\n\n\n\n\n\nFigure 5: Survival curves for patient-reported and hard flares.\n\n\n\n\n\nCodefit %&gt;%\n  tbl_survfit(\n    times = 365 * 1,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**1-year survival (95% CI)**\"\n  )\nfit %&gt;%\n  tbl_survfit(\n    times = 365 * 2,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**2-year survival (95% CI)**\"\n  )\nfit %&gt;%\n  tbl_survfit(\n    times = 365 * 3,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**3-year survival (95% CI)**\"\n  )\nfit %&gt;%\n  tbl_survfit(\n    times = 365.25 * 4,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**4-year survival (95% CI)**\"\n  )\n\n\nTable 2: Survival rates after two years of follow-up.\n\n\n\n\n\n\n\nCharacteristic\n1-year survival (95% CI)\n\n\nFlare type\n92% (91%, 93%)\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n2-year survival (95% CI)\n\n\nFlare type\n86% (85%, 88%)\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n3-year survival (95% CI)\n\n\nFlare type\n81% (80%, 83%)\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n4-year survival (95% CI)\n\n\nFlare type\n77% (75%, 79%)\n\n\n\n\n\n\n\n\n\n\nCodeflare.comb.cd &lt;- flare.comb %&gt;%\n  merge(demo[, c(\"ParticipantNo\", \"diagnosis2\")], by = \"ParticipantNo\") %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  select(-diagnosis2)\n\nfit.cd &lt;- survfit(Surv(time, Cens) ~ type, data = flare.comb.cd)\n\nfit.cd %&gt;%\n  tbl_survfit(\n    times = 365 * 2,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**2-year survival (95% CI)**\"\n  )\n\n\nTable 3: Survival rates after two years of follow-up for Crohn’s disease only.\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n2-year survival (95% CI)\n\n\n\nFlare type\n\n\n\n    Hard flare\n88% (86%, 89%)\n\n\n    Patient-reported flare\n72% (69%, 74%)\n\n\n\n\n\n\n\n\n\n\n\nCodeflare.comb.uc &lt;- flare.comb %&gt;%\n  merge(demo[, c(\"ParticipantNo\", \"diagnosis2\")], by = \"ParticipantNo\") %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  select(-diagnosis2)\n\nfit.uc &lt;- survfit(Surv(time, Cens) ~ type, data = flare.comb.uc)\n\nfit.uc %&gt;%\n  tbl_survfit(\n    times = 365 * 2,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**2-year survival (95% CI)**\"\n  )\n\n\nTable 4: Survival rates after two years of follow-up for ulcerative colitis/IBDU only.\n\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n2-year survival (95% CI)\n\n\n\nFlare type\n\n\n\n    Hard flare\n85% (83%, 87%)\n\n\n    Patient-reported flare\n67% (64%, 70%)\n\n\n\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(paths$outdir, \"flares-overview.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#reproduction-and-reproducibility",
    "href": "Survival/Soft-hard-flares.html#reproduction-and-reproducibility",
    "title": "Flare overview",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0), readxl(v.1.4.3) and patchwork(v.1.2.0)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), systemfonts(v.1.1.0), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), ragg(v.1.3.2), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), textshaping(v.0.4.0), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), sass(v.0.4.9), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Baseline/Tables.html",
    "href": "Baseline/Tables.html",
    "title": "Overall tables",
    "section": "",
    "text": "Codeset.seed(123)\n\n############## \n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-diet.RDS\"))\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\n\nOn this page, you will find key demographic/phenotypic tables for the cohorts. You will also find statistical tests exploring if participant characteristics differ across cohorts.\nIn addition to the FC cohort (PREdiCCt subjects with a baseline FC available), there is also the FFQ cohort which consists of subjects with analysed FFQs available. All subjects in the FFQ cohort also have a baseline FC available and are therefore also in the FC cohort.",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#introduction",
    "href": "Baseline/Tables.html#introduction",
    "title": "Overall tables",
    "section": "",
    "text": "Codeset.seed(123)\n\n############## \n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-diet.RDS\"))\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\n\nOn this page, you will find key demographic/phenotypic tables for the cohorts. You will also find statistical tests exploring if participant characteristics differ across cohorts.\nIn addition to the FC cohort (PREdiCCt subjects with a baseline FC available), there is also the FFQ cohort which consists of subjects with analysed FFQs available. All subjects in the FFQ cohort also have a baseline FC available and are therefore also in the FC cohort.",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-baseline-data-by-cohort",
    "href": "Baseline/Tables.html#table-of-baseline-data-by-cohort",
    "title": "Overall tables",
    "section": "Table of baseline data by cohort",
    "text": "Table of baseline data by cohort\n\nCodemy.render.cont &lt;- function(x) {\n  with(\n    stats.apply.rounding(stats.default(x),\n      digits = 3,\n      round.integers = FALSE\n    ),\n    c(\"\", \"Median (IQR)\" = sprintf(\"%s (%s - %s)\", MEDIAN, Q1, Q3))\n  )\n}\n\ndemo$control_8 &lt;- as.numeric(demo$control_8)\n\n\ncomp &lt;- demo\ncomp$cohort &lt;- \"All\"\n\ntemp &lt;- demo %&gt;%\n  drop_na(cat)\ntemp$cohort &lt;- \"FC\"\n\ncomp &lt;- rbind(comp, temp)\n\ntemp &lt;- subset(demo, ParticipantNo %in% FFQ$participantno)\ntemp$cohort &lt;- \"FFQ\"\n\ncomp &lt;- rbind(comp, temp)\n\ncomp$cohort &lt;- factor(comp$cohort,\n  levels = c(\"All\", \"FC\", \"FFQ\"),\n  labels = c(\"Full cohort\", \"FC cohort\", \"FFQ cohort\")\n)\n\ntable1(\n  ~ Age +\n    Sex +\n    Ethnicity +\n    BMIcat +\n    diagnosis +\n    `IBD Duration` +\n    as.numeric(IMD) +\n    Smoke +\n    ECigs +\n    control_8 +\n    vas_control +\n    FC +\n    CReactiveProtein +\n    Haemoglobin +\n    WCC +\n    Albumin +\n    Meat_sum +\n    fibre +\n    PUFA_percEng +\n    NOVAScore_cat +\n    Biologic | cohort,\n  data = comp,\n  render.continuous = my.render.cont,\n  overall = FALSE\n)\n\n\n\n\n\n\n\n\n\n\n\n\nFull cohort(N=2629)\nFC cohort(N=2144)\nFFQ cohort(N=1091)\n\n\n\nAge\n\n\n\n\n\nMedian (IQR)\n44.0 (32.0 - 56.0)\n44.0 (32.0 - 57.0)\n47.0 (35.0 - 58.0)\n\n\nSex\n\n\n\n\n\nMale\n1207 (45.9%)\n966 (45.1%)\n476 (43.6%)\n\n\nFemale\n1422 (54.1%)\n1178 (54.9%)\n615 (56.4%)\n\n\nEthnicity\n\n\n\n\n\nWhite\n1862 (70.8%)\n1657 (77.3%)\n1039 (95.2%)\n\n\nNon-white\n71 (2.7%)\n57 (2.7%)\n24 (2.2%)\n\n\nMissing\n696 (26.5%)\n430 (20.1%)\n28 (2.6%)\n\n\nBMIcat\n\n\n\n\n\nUnderweight\n49 (1.9%)\n38 (1.8%)\n20 (1.8%)\n\n\nNormal\n1004 (38.2%)\n840 (39.2%)\n460 (42.2%)\n\n\nOverweight\n923 (35.1%)\n751 (35.0%)\n398 (36.5%)\n\n\nObese\n552 (21.0%)\n431 (20.1%)\n191 (17.5%)\n\n\nMissing\n101 (3.8%)\n84 (3.9%)\n22 (2.0%)\n\n\ndiagnosis\n\n\n\n\n\nCD\n1370 (52.1%)\n1118 (52.1%)\n530 (48.6%)\n\n\nUC\n1174 (44.7%)\n950 (44.3%)\n523 (47.9%)\n\n\nIBDU\n85 (3.2%)\n76 (3.5%)\n38 (3.5%)\n\n\nIBD Duration\n\n\n\n\n\nMedian (IQR)\n10.0 (4.73 - 18.6)\n9.80 (4.60 - 18.6)\n10.3 (4.92 - 20.1)\n\n\nMissing\n151 (5.7%)\n120 (5.6%)\n53 (4.9%)\n\n\nas.numeric(IMD)\n\n\n\n\n\nMedian (IQR)\n4.00 (2.00 - 5.00)\n4.00 (2.00 - 5.00)\n4.00 (3.00 - 5.00)\n\n\nMissing\n30 (1.1%)\n22 (1.0%)\n9 (0.8%)\n\n\nSmoke\n\n\n\n\n\nCurrent\n122 (4.6%)\n109 (5.1%)\n63 (5.8%)\n\n\nPrevious\n721 (27.4%)\n627 (29.2%)\n399 (36.6%)\n\n\nNever\n1071 (40.7%)\n965 (45.0%)\n597 (54.7%)\n\n\nMissing\n715 (27.2%)\n443 (20.7%)\n32 (2.9%)\n\n\nECigs\n\n\n\n\n\nCurrent\n80 (3.0%)\n70 (3.3%)\n38 (3.5%)\n\n\nPrevious\n61 (2.3%)\n53 (2.5%)\n27 (2.5%)\n\n\nNever\n1770 (67.3%)\n1575 (73.5%)\n994 (91.1%)\n\n\nMissing\n718 (27.3%)\n446 (20.8%)\n32 (2.9%)\n\n\ncontrol_8\n\n\n\n\n\nMedian (IQR)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n\n\nMissing\n718 (27.3%)\n447 (20.8%)\n38 (3.5%)\n\n\nvas_control\n\n\n\n\n\n&lt;85\n628 (23.9%)\n569 (26.5%)\n320 (29.3%)\n\n\n85+\n1275 (48.5%)\n1121 (52.3%)\n730 (66.9%)\n\n\nMissing\n726 (27.6%)\n454 (21.2%)\n41 (3.8%)\n\n\nFC\n\n\n\n\n\nMedian (IQR)\n49.0 (20.0 - 161)\n49.0 (20.0 - 161)\n49.0 (20.0 - 161)\n\n\nMissing\n485 (18.4%)\n0 (0%)\n79 (7.2%)\n\n\nCReactiveProtein\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n\n\nMissing\n637 (24.2%)\n506 (23.6%)\n280 (25.7%)\n\n\nHaemoglobin\n\n\n\n\n\nMedian (IQR)\n139 (130 - 147)\n138 (129 - 147)\n139 (130 - 146)\n\n\nMissing\n469 (17.8%)\n363 (16.9%)\n195 (17.9%)\n\n\nWCC\n\n\n\n\n\nMedian (IQR)\n6.20 (5.10 - 7.60)\n6.20 (5.10 - 7.60)\n6.20 (5.10 - 7.46)\n\n\nMissing\n470 (17.9%)\n364 (17.0%)\n196 (18.0%)\n\n\nAlbumin\n\n\n\n\n\nMedian (IQR)\n41.0 (39.0 - 45.0)\n41.0 (39.0 - 45.0)\n41.0 (38.0 - 44.0)\n\n\nMissing\n572 (21.8%)\n448 (20.9%)\n250 (22.9%)\n\n\nMeat_sum\n\n\n\n\n\nMedian (IQR)\n35.8 (24.9 - 50.6)\n36.0 (25.3 - 50.5)\n35.8 (24.9 - 50.6)\n\n\nMissing\n1539 (58.5%)\n1132 (52.8%)\n1 (0.1%)\n\n\nfibre\n\n\n\n\n\nMedian (IQR)\n22.9 (17.0 - 29.4)\n22.8 (16.9 - 29.3)\n22.9 (17.0 - 29.4)\n\n\nMissing\n1539 (58.5%)\n1132 (52.8%)\n1 (0.1%)\n\n\nPUFA_percEng\n\n\n\n\n\nMedian (IQR)\n5.17 (4.54 - 5.92)\n5.17 (4.53 - 5.89)\n5.17 (4.54 - 5.92)\n\n\nMissing\n1539 (58.5%)\n1132 (52.8%)\n1 (0.1%)\n\n\nNOVAScore_cat\n\n\n\n\n\nUnprocessed\n273 (10.4%)\n252 (11.8%)\n273 (25.0%)\n\n\nProcessed culinary\n273 (10.4%)\n257 (12.0%)\n273 (25.0%)\n\n\nProcessed food\n274 (10.4%)\n255 (11.9%)\n274 (25.1%)\n\n\nUltra-processed\n271 (10.3%)\n248 (11.6%)\n271 (24.8%)\n\n\nMissing\n1538 (58.5%)\n1132 (52.8%)\n0 (0%)\n\n\nBiologic\n\n\n\n\n\nCurrent\n920 (35.0%)\n774 (36.1%)\n310 (28.4%)\n\n\nPreviously\n160 (6.1%)\n133 (6.2%)\n66 (6.0%)\n\n\nNever prescribed\n1549 (58.9%)\n1237 (57.7%)\n715 (65.5%)\n\n\n\n\n\n\n\nAssociations with cohort membership\nOnly age, biologic use, and albumin were found to be significantly different across cohorts.\nAge\nThere is a significant difference in age across cohorts with subjects in the FFQ sub-cohort being more likely to be older than the full or FC cohorts.\n\nCodepander(summary(aov(Age ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n4786\n2393\n10.08\n4.256e-05\n\n\nResiduals\n5861\n1391260\n237.4\nNA\nNA\n\n\n\n\n\nSex\n\nCodepander(chisq.test(comp$Sex, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Sex and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.639\n2\n0.4406\n\n\n\n\nBody mass index\n\nCodepander(summary(aov(BMI ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n111.4\n55.7\n1.95\n0.1424\n\n\nResiduals\n5654\n161505\n28.56\nNA\nNA\n\n\n\n\n\nEthnicity\n\nCodepander(chisq.test(comp$Ethnicity, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Ethnicity and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n4.482\n2\n0.1063\n\n\n\n\nIndex of multiple deprivation\n\nCodepander(chisq.test(comp$IMD, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$IMD and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n10.73\n8\n0.2172\n\n\n\n\nSmoking status\n\nCodepander(chisq.test(comp$Smoke, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Smoke and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.5422\n4\n0.9693\n\n\n\n\nIBD type\n\nCodepander(chisq.test(comp$diagnosis2, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$diagnosis2 and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n4.474\n2\n0.1068\n\n\n\n\nDisease duration\n\nCodepander(summary(aov(`IBD Duration` ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n356.2\n178.1\n1.492\n0.225\n\n\nResiduals\n5537\n660933\n119.4\nNA\nNA\n\n\n\n\n\nIBD Control-8\n\nCodepander(summary(aov(control_8 ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n19.77\n9.884\n1.018\n0.3613\n\n\nResiduals\n4658\n45211\n9.706\nNA\nNA\n\n\n\n\n\nIBD visual analogue score\n\nCodepander(chisq.test(comp$vas_control, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$vas_control and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n3.158\n2\n0.2062\n\n\n\n\nFaecal calprotectin\nFC has been treated as a continuous variable for this test. FC has not been discretised.\n\nCodepander(summary(aov(FC ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n10042\n5021\n0.04235\n0.9585\n\n\nResiduals\n5297\n6.28e+08\n118564\nNA\nNA\n\n\n\n\n\nC-reactive protein\n\nCodepander(summary(aov(CReactiveProtein ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n12.36\n6.178\n0.05603\n0.9455\n\n\nResiduals\n4438\n489297\n110.3\nNA\nNA\n\n\n\n\n\nHaemoglobin\n\nCodepander(summary(aov(Haemoglobin ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n84.22\n42.11\n0.2276\n0.7965\n\n\nResiduals\n4834\n894479\n185\nNA\nNA\n\n\n\n\n\nWhite cell count\n\nCodepander(summary(aov(WCC ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n81.86\n40.93\n1.06\n0.3464\n\n\nResiduals\n4831\n186499\n38.6\nNA\nNA\n\n\n\n\n\nPlatelets\n\nCodepander(summary(aov(Platelets ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n12234\n6117\n1.25\n0.2866\n\n\nResiduals\n4830\n23635277\n4893\nNA\nNA\n\n\n\n\n\nAlbumin\nThere is a significant difference in albumin across the cohorts. However, this difference appears to be negligible.\n\nCodepander(summary(aov(Albumin ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n320.6\n160.3\n6.931\n0.0009876\n\n\nResiduals\n4591\n106189\n23.13\nNA\nNA\n\n\n\n\n\nDietary data\nDietary data have not been compared across cohorts.\nBiologic usage\nThere is a significant difference in biologic usage across the cohorts with subjects in the FFQ sub-cohort being less likely to have been prescribed a biologic than the full cohort or the FC sub-cohort.\n\nCodepander(chisq.test(comp$Biologic, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Biologic and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n21.41\n4\n0.0002626 * * *",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-baseline-data-by-fc-groups",
    "href": "Baseline/Tables.html#table-of-baseline-data-by-fc-groups",
    "title": "Overall tables",
    "section": "Table of baseline data by FC groups",
    "text": "Table of baseline data by FC groups\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  table1(\n    x = ~ Age +\n    Sex +\n    Ethnicity +\n    BMIcat +\n    diagnosis +\n    `IBD Duration` +\n    Smoke +\n    ECigs +\n    as.numeric(IMD) +\n    control_8 +\n    vas_control +\n    FC +\n    CReactiveProtein +\n    Haemoglobin +\n    WCC +\n    Platelets +\n    Albumin +\n    Meat_sum +\n    fibre +\n    PUFA_percEng +\n    NOVAScore_cat +\n    Biologic | cat,\n    render.continuous = my.render.cont\n  )\n\n\nTable 1: Baseline data by FC.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFC &lt; 50(N=1077)\nFC 50-250(N=683)\nFC &gt; 250(N=384)\nOverall(N=2144)\n\n\n\nAge\n\n\n\n\n\n\nMedian (IQR)\n44.0 (33.0 - 56.0)\n46.0 (33.0 - 59.5)\n42.5 (30.0 - 55.0)\n44.0 (32.0 - 57.0)\n\n\nSex\n\n\n\n\n\n\nMale\n442 (41.0%)\n333 (48.8%)\n191 (49.7%)\n966 (45.1%)\n\n\nFemale\n635 (59.0%)\n350 (51.2%)\n193 (50.3%)\n1178 (54.9%)\n\n\nEthnicity\n\n\n\n\n\n\nWhite\n834 (77.4%)\n540 (79.1%)\n283 (73.7%)\n1657 (77.3%)\n\n\nNon-white\n33 (3.1%)\n13 (1.9%)\n11 (2.9%)\n57 (2.7%)\n\n\nMissing\n210 (19.5%)\n130 (19.0%)\n90 (23.4%)\n430 (20.1%)\n\n\nBMIcat\n\n\n\n\n\n\nUnderweight\n19 (1.8%)\n12 (1.8%)\n7 (1.8%)\n38 (1.8%)\n\n\nNormal\n446 (41.4%)\n244 (35.7%)\n150 (39.1%)\n840 (39.2%)\n\n\nOverweight\n371 (34.4%)\n246 (36.0%)\n134 (34.9%)\n751 (35.0%)\n\n\nObese\n201 (18.7%)\n155 (22.7%)\n75 (19.5%)\n431 (20.1%)\n\n\nMissing\n40 (3.7%)\n26 (3.8%)\n18 (4.7%)\n84 (3.9%)\n\n\ndiagnosis\n\n\n\n\n\n\nCD\n533 (49.5%)\n381 (55.8%)\n204 (53.1%)\n1118 (52.1%)\n\n\nUC\n504 (46.8%)\n283 (41.4%)\n163 (42.4%)\n950 (44.3%)\n\n\nIBDU\n40 (3.7%)\n19 (2.8%)\n17 (4.4%)\n76 (3.5%)\n\n\nIBD Duration\n\n\n\n\n\n\nMedian (IQR)\n10.1 (4.62 - 19.4)\n9.66 (4.76 - 18.4)\n9.07 (4.42 - 16.5)\n9.80 (4.60 - 18.6)\n\n\nMissing\n60 (5.6%)\n38 (5.6%)\n22 (5.7%)\n120 (5.6%)\n\n\nSmoke\n\n\n\n\n\n\nCurrent\n64 (5.9%)\n36 (5.3%)\n9 (2.3%)\n109 (5.1%)\n\n\nPrevious\n309 (28.7%)\n213 (31.2%)\n105 (27.3%)\n627 (29.2%)\n\n\nNever\n487 (45.2%)\n300 (43.9%)\n178 (46.4%)\n965 (45.0%)\n\n\nMissing\n217 (20.1%)\n134 (19.6%)\n92 (24.0%)\n443 (20.7%)\n\n\nECigs\n\n\n\n\n\n\nCurrent\n28 (2.6%)\n33 (4.8%)\n9 (2.3%)\n70 (3.3%)\n\n\nPrevious\n31 (2.9%)\n16 (2.3%)\n6 (1.6%)\n53 (2.5%)\n\n\nNever\n799 (74.2%)\n500 (73.2%)\n276 (71.9%)\n1575 (73.5%)\n\n\nMissing\n219 (20.3%)\n134 (19.6%)\n93 (24.2%)\n446 (20.8%)\n\n\nas.numeric(IMD)\n\n\n\n\n\n\nMedian (IQR)\n4.00 (3.00 - 5.00)\n4.00 (2.00 - 5.00)\n4.00 (2.00 - 5.00)\n4.00 (2.00 - 5.00)\n\n\nMissing\n15 (1.4%)\n4 (0.6%)\n3 (0.8%)\n22 (1.0%)\n\n\ncontrol_8\n\n\n\n\n\n\nMedian (IQR)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n13.0 (9.00 - 15.0)\n13.0 (11.0 - 15.0)\n\n\nMissing\n218 (20.2%)\n136 (19.9%)\n93 (24.2%)\n447 (20.8%)\n\n\nvas_control\n\n\n\n\n\n\n&lt;85\n250 (23.2%)\n201 (29.4%)\n118 (30.7%)\n569 (26.5%)\n\n\n85+\n607 (56.4%)\n342 (50.1%)\n172 (44.8%)\n1121 (52.3%)\n\n\nMissing\n220 (20.4%)\n140 (20.5%)\n94 (24.5%)\n454 (21.2%)\n\n\nFC\n\n\n\n\n\n\nMedian (IQR)\n20.0 (20.0 - 29.0)\n104 (71.0 - 157)\n498 (347 - 780)\n49.0 (20.0 - 161)\n\n\nCReactiveProtein\n\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n4.00 (1.00 - 6.00)\n2.00 (1.00 - 5.00)\n\n\nMissing\n256 (23.8%)\n167 (24.5%)\n83 (21.6%)\n506 (23.6%)\n\n\nHaemoglobin\n\n\n\n\n\n\nMedian (IQR)\n139 (130 - 147)\n139 (130 - 148)\n137 (127 - 146)\n138 (129 - 147)\n\n\nMissing\n184 (17.1%)\n120 (17.6%)\n59 (15.4%)\n363 (16.9%)\n\n\nWCC\n\n\n\n\n\n\nMedian (IQR)\n6.10 (4.99 - 7.40)\n6.30 (5.30 - 7.69)\n6.60 (5.31 - 8.10)\n6.20 (5.10 - 7.60)\n\n\nMissing\n184 (17.1%)\n120 (17.6%)\n60 (15.6%)\n364 (17.0%)\n\n\nPlatelets\n\n\n\n\n\n\nMedian (IQR)\n257 (223 - 299)\n264 (225 - 304)\n277 (231 - 322)\n262 (224 - 305)\n\n\nMissing\n184 (17.1%)\n120 (17.6%)\n60 (15.6%)\n364 (17.0%)\n\n\nAlbumin\n\n\n\n\n\n\nMedian (IQR)\n42.0 (39.0 - 46.0)\n41.0 (38.0 - 44.0)\n40.0 (38.0 - 43.0)\n41.0 (39.0 - 45.0)\n\n\nMissing\n226 (21.0%)\n146 (21.4%)\n76 (19.8%)\n448 (20.9%)\n\n\nMeat_sum\n\n\n\n\n\n\nMedian (IQR)\n34.8 (24.6 - 48.1)\n37.5 (26.0 - 53.2)\n35.5 (25.2 - 51.4)\n36.0 (25.3 - 50.5)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nfibre\n\n\n\n\n\n\nMedian (IQR)\n23.5 (17.0 - 29.4)\n23.0 (16.9 - 29.5)\n21.7 (16.8 - 27.9)\n22.8 (16.9 - 29.3)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nPUFA_percEng\n\n\n\n\n\n\nMedian (IQR)\n5.15 (4.57 - 5.96)\n5.14 (4.37 - 5.82)\n5.33 (4.57 - 5.93)\n5.17 (4.53 - 5.89)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nNOVAScore_cat\n\n\n\n\n\n\nUnprocessed\n121 (11.2%)\n75 (11.0%)\n56 (14.6%)\n252 (11.8%)\n\n\nProcessed culinary\n138 (12.8%)\n74 (10.8%)\n45 (11.7%)\n257 (12.0%)\n\n\nProcessed food\n136 (12.6%)\n84 (12.3%)\n35 (9.1%)\n255 (11.9%)\n\n\nUltra-processed\n112 (10.4%)\n93 (13.6%)\n43 (11.2%)\n248 (11.6%)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nBiologic\n\n\n\n\n\n\nCurrent\n406 (37.7%)\n220 (32.2%)\n148 (38.5%)\n774 (36.1%)\n\n\nPreviously\n48 (4.5%)\n55 (8.1%)\n30 (7.8%)\n133 (6.2%)\n\n\nNever prescribed\n623 (57.8%)\n408 (59.7%)\n206 (53.6%)\n1237 (57.7%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-baseline-data-by-ibd-type",
    "href": "Baseline/Tables.html#table-of-baseline-data-by-ibd-type",
    "title": "Overall tables",
    "section": "Table of baseline data by IBD type",
    "text": "Table of baseline data by IBD type\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  table1::table1(\n    x = ~ Age +\n    Sex +\n    Ethnicity +\n    BMIcat +\n    diagnosis +\n    `IBD Duration` +\n    Smoke + \n    ECigs +\n    as.numeric(IMD) +\n    control_8 +\n    vas_control +\n    FC +\n    CReactiveProtein +\n    Haemoglobin +\n    WCC +\n    Platelets +  \n    Albumin +\n    Meat_sum +\n    fibre +\n    PUFA_percEng +\n    NOVAScore_cat +\n    Biologic |\n      diagnosis2,\n    render.continuous = my.render.cont\n  )\n\n\nTable 2: Baseline data by IBD type.\n\n\n\n\n\n\n\n\n\n\n\n\n\nCD(N=1118)\nUC/IBDU(N=1026)\nOverall(N=2144)\n\n\n\nAge\n\n\n\n\n\nMedian (IQR)\n41.5 (31.0 - 54.0)\n48.0 (36.0 - 59.0)\n44.0 (32.0 - 57.0)\n\n\nSex\n\n\n\n\n\nMale\n478 (42.8%)\n488 (47.6%)\n966 (45.1%)\n\n\nFemale\n640 (57.2%)\n538 (52.4%)\n1178 (54.9%)\n\n\nEthnicity\n\n\n\n\n\nWhite\n849 (75.9%)\n808 (78.8%)\n1657 (77.3%)\n\n\nNon-white\n31 (2.8%)\n26 (2.5%)\n57 (2.7%)\n\n\nMissing\n238 (21.3%)\n192 (18.7%)\n430 (20.1%)\n\n\nBMIcat\n\n\n\n\n\nUnderweight\n20 (1.8%)\n18 (1.8%)\n38 (1.8%)\n\n\nNormal\n451 (40.3%)\n389 (37.9%)\n840 (39.2%)\n\n\nOverweight\n379 (33.9%)\n372 (36.3%)\n751 (35.0%)\n\n\nObese\n215 (19.2%)\n216 (21.1%)\n431 (20.1%)\n\n\nMissing\n53 (4.7%)\n31 (3.0%)\n84 (3.9%)\n\n\ndiagnosis\n\n\n\n\n\nCD\n1118 (100%)\n0 (0%)\n1118 (52.1%)\n\n\nUC\n0 (0%)\n950 (92.6%)\n950 (44.3%)\n\n\nIBDU\n0 (0%)\n76 (7.4%)\n76 (3.5%)\n\n\nIBD Duration\n\n\n\n\n\nMedian (IQR)\n10.3 (5.04 - 20.2)\n9.28 (4.27 - 16.8)\n9.80 (4.60 - 18.6)\n\n\nMissing\n64 (5.7%)\n56 (5.5%)\n120 (5.6%)\n\n\nSmoke\n\n\n\n\n\nCurrent\n63 (5.6%)\n46 (4.5%)\n109 (5.1%)\n\n\nPrevious\n302 (27.0%)\n325 (31.7%)\n627 (29.2%)\n\n\nNever\n508 (45.4%)\n457 (44.5%)\n965 (45.0%)\n\n\nMissing\n245 (21.9%)\n198 (19.3%)\n443 (20.7%)\n\n\nECigs\n\n\n\n\n\nCurrent\n39 (3.5%)\n31 (3.0%)\n70 (3.3%)\n\n\nPrevious\n33 (3.0%)\n20 (1.9%)\n53 (2.5%)\n\n\nNever\n799 (71.5%)\n776 (75.6%)\n1575 (73.5%)\n\n\nMissing\n247 (22.1%)\n199 (19.4%)\n446 (20.8%)\n\n\nas.numeric(IMD)\n\n\n\n\n\nMedian (IQR)\n4.00 (2.00 - 5.00)\n4.00 (3.00 - 5.00)\n4.00 (2.00 - 5.00)\n\n\nMissing\n11 (1.0%)\n11 (1.1%)\n22 (1.0%)\n\n\ncontrol_8\n\n\n\n\n\nMedian (IQR)\n13.0 (10.0 - 15.0)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n\n\nMissing\n248 (22.2%)\n199 (19.4%)\n447 (20.8%)\n\n\nvas_control\n\n\n\n\n\n&lt;85\n318 (28.4%)\n251 (24.5%)\n569 (26.5%)\n\n\n85+\n547 (48.9%)\n574 (55.9%)\n1121 (52.3%)\n\n\nMissing\n253 (22.6%)\n201 (19.6%)\n454 (21.2%)\n\n\nFC\n\n\n\n\n\nMedian (IQR)\n54.0 (20.0 - 167)\n43.0 (20.0 - 155)\n49.0 (20.0 - 161)\n\n\nCReactiveProtein\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n\n\nMissing\n255 (22.8%)\n251 (24.5%)\n506 (23.6%)\n\n\nHaemoglobin\n\n\n\n\n\nMedian (IQR)\n137 (128 - 146)\n139 (132 - 148)\n138 (129 - 147)\n\n\nMissing\n164 (14.7%)\n199 (19.4%)\n363 (16.9%)\n\n\nWCC\n\n\n\n\n\nMedian (IQR)\n6.30 (5.20 - 7.60)\n6.20 (5.00 - 7.60)\n6.20 (5.10 - 7.60)\n\n\nMissing\n163 (14.6%)\n201 (19.6%)\n364 (17.0%)\n\n\nPlatelets\n\n\n\n\n\nMedian (IQR)\n265 (227 - 309)\n258 (222 - 303)\n262 (224 - 305)\n\n\nMissing\n164 (14.7%)\n200 (19.5%)\n364 (17.0%)\n\n\nAlbumin\n\n\n\n\n\nMedian (IQR)\n41.0 (38.0 - 44.0)\n42.0 (39.0 - 45.0)\n41.0 (39.0 - 45.0)\n\n\nMissing\n209 (18.7%)\n239 (23.3%)\n448 (20.9%)\n\n\nMeat_sum\n\n\n\n\n\nMedian (IQR)\n35.8 (25.3 - 49.9)\n36.1 (25.1 - 50.9)\n36.0 (25.3 - 50.5)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nfibre\n\n\n\n\n\nMedian (IQR)\n22.1 (16.4 - 28.4)\n23.4 (17.8 - 29.9)\n22.8 (16.9 - 29.3)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nPUFA_percEng\n\n\n\n\n\nMedian (IQR)\n5.19 (4.53 - 5.97)\n5.15 (4.53 - 5.88)\n5.17 (4.53 - 5.89)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nNOVAScore_cat\n\n\n\n\n\nUnprocessed\n126 (11.3%)\n126 (12.3%)\n252 (11.8%)\n\n\nProcessed culinary\n128 (11.4%)\n129 (12.6%)\n257 (12.0%)\n\n\nProcessed food\n122 (10.9%)\n133 (13.0%)\n255 (11.9%)\n\n\nUltra-processed\n121 (10.8%)\n127 (12.4%)\n248 (11.6%)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nBiologic\n\n\n\n\n\nCurrent\n522 (46.7%)\n252 (24.6%)\n774 (36.1%)\n\n\nPreviously\n96 (8.6%)\n37 (3.6%)\n133 (6.2%)\n\n\nNever prescribed\n500 (44.7%)\n737 (71.8%)\n1237 (57.7%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-crohns-disease-variables",
    "href": "Baseline/Tables.html#table-of-crohns-disease-variables",
    "title": "Overall tables",
    "section": "Table of Crohn’s disease variables",
    "text": "Table of Crohn’s disease variables\n\nCodedemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  table1(\n    x = ~ `IBD Duration` + \n      Location +\n      L4 +\n      HBI +\n      PRO2 +\n      Behaviour +\n      Perianal +\n      Surgery +\n      Smoke +\n      ECigs |\n      cat,\n    render.continuous = my.render.cont\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\nFC &lt; 50(N=533)\nFC 50-250(N=381)\nFC &gt; 250(N=204)\nOverall(N=1118)\n\n\n\nIBD Duration\n\n\n\n\n\n\nMedian (IQR)\n10.2 (4.89 - 20.9)\n10.6 (5.02 - 20.2)\n10.1 (5.37 - 17.9)\n10.3 (5.04 - 20.2)\n\n\nMissing\n33 (6.2%)\n21 (5.5%)\n10 (4.9%)\n64 (5.7%)\n\n\nLocation\n\n\n\n\n\n\nL1\n138 (25.9%)\n99 (26.0%)\n46 (22.5%)\n283 (25.3%)\n\n\nL2\n128 (24.0%)\n90 (23.6%)\n60 (29.4%)\n278 (24.9%)\n\n\nL3\n176 (33.0%)\n136 (35.7%)\n73 (35.8%)\n385 (34.4%)\n\n\nL4 only\n3 (0.6%)\n4 (1.0%)\n3 (1.5%)\n10 (0.9%)\n\n\nMissing\n88 (16.5%)\n52 (13.6%)\n22 (10.8%)\n162 (14.5%)\n\n\nL4\n\n\n\n\n\n\nNot present\n398 (74.7%)\n293 (76.9%)\n151 (74.0%)\n842 (75.3%)\n\n\nPresent\n47 (8.8%)\n36 (9.4%)\n31 (15.2%)\n114 (10.2%)\n\n\nMissing\n88 (16.5%)\n52 (13.6%)\n22 (10.8%)\n162 (14.5%)\n\n\nHBI\n\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 3.00)\n2.00 (1.00 - 4.00)\n\n\nMissing\n331 (62.1%)\n227 (59.6%)\n116 (56.9%)\n674 (60.3%)\n\n\nPRO2\n\n\n\n\n\n\nMedian (IQR)\n0 (0 - 2.00)\n0 (0 - 2.00)\n0 (0 - 1.00)\n0 (0 - 2.00)\n\n\nMissing\n242 (45.4%)\n135 (35.4%)\n69 (33.8%)\n446 (39.9%)\n\n\nBehaviour\n\n\n\n\n\n\nB1\n279 (52.3%)\n211 (55.4%)\n127 (62.3%)\n617 (55.2%)\n\n\nB2\n96 (18.0%)\n73 (19.2%)\n37 (18.1%)\n206 (18.4%)\n\n\nB3\n51 (9.6%)\n31 (8.1%)\n11 (5.4%)\n93 (8.3%)\n\n\nMissing\n107 (20.1%)\n66 (17.3%)\n29 (14.2%)\n202 (18.1%)\n\n\nPerianal\n\n\n\n\n\n\nNo\n283 (53.1%)\n224 (58.8%)\n112 (54.9%)\n619 (55.4%)\n\n\nYes\n149 (28.0%)\n106 (27.8%)\n66 (32.4%)\n321 (28.7%)\n\n\nMissing\n101 (18.9%)\n51 (13.4%)\n26 (12.7%)\n178 (15.9%)\n\n\nSurgery\n\n\n\n\n\n\nNo\n262 (49.2%)\n181 (47.5%)\n118 (57.8%)\n561 (50.2%)\n\n\nYes\n251 (47.1%)\n193 (50.7%)\n78 (38.2%)\n522 (46.7%)\n\n\nMissing\n20 (3.8%)\n7 (1.8%)\n8 (3.9%)\n35 (3.1%)\n\n\nSmoke\n\n\n\n\n\n\nCurrent\n32 (6.0%)\n26 (6.8%)\n5 (2.5%)\n63 (5.6%)\n\n\nPrevious\n153 (28.7%)\n108 (28.3%)\n41 (20.1%)\n302 (27.0%)\n\n\nNever\n234 (43.9%)\n169 (44.4%)\n105 (51.5%)\n508 (45.4%)\n\n\nMissing\n114 (21.4%)\n78 (20.5%)\n53 (26.0%)\n245 (21.9%)\n\n\nECigs\n\n\n\n\n\n\nCurrent\n19 (3.6%)\n18 (4.7%)\n2 (1.0%)\n39 (3.5%)\n\n\nPrevious\n16 (3.0%)\n13 (3.4%)\n4 (2.0%)\n33 (3.0%)\n\n\nNever\n382 (71.7%)\n272 (71.4%)\n145 (71.1%)\n799 (71.5%)\n\n\nMissing\n116 (21.8%)\n78 (20.5%)\n53 (26.0%)\n247 (22.1%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-crohns-disease-variables-by-cohort",
    "href": "Baseline/Tables.html#table-of-crohns-disease-variables-by-cohort",
    "title": "Overall tables",
    "section": "Table of Crohn’s disease variables by cohort",
    "text": "Table of Crohn’s disease variables by cohort\n\nCodecomp &lt;- demo.cd\ncomp$cohort &lt;- \"All\"\n\ntemp &lt;- demo.cd %&gt;%\n  drop_na(cat)\ntemp$cohort &lt;- \"FC\"\n\ncomp &lt;- rbind(comp, temp)\n\ntemp &lt;- subset(demo.cd, ParticipantNo %in% FFQ$participantno)\ntemp$cohort &lt;- \"FFQ\"\n\ncomp &lt;- rbind(comp, temp)\n\ncomp$cohort &lt;- factor(comp$cohort,\n  levels = c(\"All\", \"FC\", \"FFQ\"),\n  labels = c(\"Full cohort\", \"FC cohort\", \"FFQ cohort\")\n)\n\ntable1(\n  ~ Location +\n    L4 +\n    HBI +\n    PRO2 +\n    Behaviour +\n    Perianal +\n    Surgery +\n    Smoke +\n    ECigs |\n    cohort,\n  data = comp,\n  render.continuous = my.render.cont,\n  overall = FALSE\n)\n\n\n\n\n\n\n\n\n\n\n\n\nFull cohort(N=1370)\nFC cohort(N=1118)\nFFQ cohort(N=530)\n\n\n\nLocation\n\n\n\n\n\nL1\n362 (26.4%)\n283 (25.3%)\n149 (28.1%)\n\n\nL2\n333 (24.3%)\n278 (24.9%)\n141 (26.6%)\n\n\nL3\n454 (33.1%)\n385 (34.4%)\n160 (30.2%)\n\n\nL4 only\n14 (1.0%)\n10 (0.9%)\n6 (1.1%)\n\n\nMissing\n207 (15.1%)\n162 (14.5%)\n74 (14.0%)\n\n\nL4\n\n\n\n\n\nNot present\n1031 (75.3%)\n842 (75.3%)\n412 (77.7%)\n\n\nPresent\n132 (9.6%)\n114 (10.2%)\n44 (8.3%)\n\n\nMissing\n207 (15.1%)\n162 (14.5%)\n74 (14.0%)\n\n\nHBI\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 3.00)\n\n\nMissing\n833 (60.8%)\n674 (60.3%)\n287 (54.2%)\n\n\nPRO2\n\n\n\n\n\nMedian (IQR)\n0 (0 - 2.00)\n0 (0 - 2.00)\n1.00 (0 - 2.00)\n\n\nMissing\n555 (40.5%)\n446 (39.9%)\n179 (33.8%)\n\n\nBehaviour\n\n\n\n\n\nB1\n749 (54.7%)\n617 (55.2%)\n285 (53.8%)\n\n\nB2\n252 (18.4%)\n206 (18.4%)\n105 (19.8%)\n\n\nB3\n121 (8.8%)\n93 (8.3%)\n54 (10.2%)\n\n\nMissing\n248 (18.1%)\n202 (18.1%)\n86 (16.2%)\n\n\nPerianal\n\n\n\n\n\nNo\n746 (54.5%)\n619 (55.4%)\n299 (56.4%)\n\n\nYes\n397 (29.0%)\n321 (28.7%)\n151 (28.5%)\n\n\nMissing\n227 (16.6%)\n178 (15.9%)\n80 (15.1%)\n\n\nSurgery\n\n\n\n\n\nNo\n684 (49.9%)\n561 (50.2%)\n249 (47.0%)\n\n\nYes\n634 (46.3%)\n522 (46.7%)\n273 (51.5%)\n\n\nMissing\n52 (3.8%)\n35 (3.1%)\n8 (1.5%)\n\n\nSmoke\n\n\n\n\n\nCurrent\n73 (5.3%)\n63 (5.6%)\n32 (6.0%)\n\n\nPrevious\n343 (25.0%)\n302 (27.0%)\n186 (35.1%)\n\n\nNever\n562 (41.0%)\n508 (45.4%)\n299 (56.4%)\n\n\nMissing\n392 (28.6%)\n245 (21.9%)\n13 (2.5%)\n\n\nECigs\n\n\n\n\n\nCurrent\n45 (3.3%)\n39 (3.5%)\n17 (3.2%)\n\n\nPrevious\n39 (2.8%)\n33 (3.0%)\n14 (2.6%)\n\n\nNever\n892 (65.1%)\n799 (71.5%)\n486 (91.7%)\n\n\nMissing\n394 (28.8%)\n247 (22.1%)\n13 (2.5%)\n\n\n\n\n\n\n\nAssociations between Crohn’s Disease-only variables and cohort membership\nNone of the CD-only variables were found to significantly differ across cohorts.\nMontreal location\n\nCodepander(fisher.test(comp$Location, comp$cohort, workspace = 200000000))\n\n\nFisher’s Exact Test for Count Data: comp$Location and comp$cohort\n\n\n\n\n\n\nP value\nAlternative hypothesis\n\n\n0.659\ntwo.sided\n\n\n\n\nUpper gastrointestinal inflammation\n\nCodepander(chisq.test(comp$L4, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$L4 and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.616\n2\n0.4457\n\n\n\n\nHarvey-Bradshaw index\n\nCodepander(summary(aov(HBI ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n2.721\n1.36\n0.2382\n0.788\n\n\nResiduals\n1221\n6972\n5.71\nNA\nNA\n\n\n\n\n\nPRO2\n\nCodepander(summary(aov(PRO2 ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n0.6806\n0.3403\n0.08516\n0.9184\n\n\nResiduals\n1835\n7333\n3.996\nNA\nNA\n\n\n\n\n\nMontreal behaviour\n\nCodepander(chisq.test(comp$Behaviour, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Behaviour and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.81\n4\n0.7707\n\n\n\n\nPerianal disease\n\nCodepander(chisq.test(comp$Perianal, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Perianal and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.2153\n2\n0.898\n\n\n\n\nSurgery\n\nCodepander(chisq.test(comp$Surgery, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Surgery and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.961\n2\n0.2276\n\n\n\n\nSmoking status\n\nCodepander(chisq.test(comp$Smoke, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Smoke and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.023\n4\n0.9063\n\n\n\n\nE-cigarette use\n\nCodepander(chisq.test(comp$ECigs, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$ECigs and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n3.416\n4\n0.4908",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables",
    "href": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables",
    "title": "Overall tables",
    "section": "Table of ulcerative colitis/IBDU variables",
    "text": "Table of ulcerative colitis/IBDU variables\n\nCodedemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\n\ndemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  table1(\n    x = ~ `IBD Duration` + Extent + Mayo + PRO2 + Smoke + ECigs | cat,\n    render.continuous = my.render.cont\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\nFC &lt; 50(N=544)\nFC 50-250(N=302)\nFC &gt; 250(N=180)\nOverall(N=1026)\n\n\n\nIBD Duration\n\n\n\n\n\n\nMedian (IQR)\n10.1 (4.48 - 17.8)\n8.30 (4.31 - 15.4)\n7.45 (3.10 - 13.4)\n9.28 (4.27 - 16.8)\n\n\nMissing\n27 (5.0%)\n17 (5.6%)\n12 (6.7%)\n56 (5.5%)\n\n\nExtent\n\n\n\n\n\n\nE1\n74 (13.6%)\n34 (11.3%)\n20 (11.1%)\n128 (12.5%)\n\n\nE2\n214 (39.3%)\n126 (41.7%)\n76 (42.2%)\n416 (40.5%)\n\n\nE3\n126 (23.2%)\n79 (26.2%)\n48 (26.7%)\n253 (24.7%)\n\n\nMissing\n130 (23.9%)\n63 (20.9%)\n36 (20.0%)\n229 (22.3%)\n\n\nMayo\n\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0.500 (0 - 2.00)\n0 (0 - 1.00)\n\n\nMissing\n171 (31.4%)\n62 (20.5%)\n58 (32.2%)\n291 (28.4%)\n\n\nPRO2\n\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n\n\nMissing\n172 (31.6%)\n64 (21.2%)\n59 (32.8%)\n295 (28.8%)\n\n\nSmoke\n\n\n\n\n\n\nCurrent\n32 (5.9%)\n10 (3.3%)\n4 (2.2%)\n46 (4.5%)\n\n\nPrevious\n156 (28.7%)\n105 (34.8%)\n64 (35.6%)\n325 (31.7%)\n\n\nNever\n253 (46.5%)\n131 (43.4%)\n73 (40.6%)\n457 (44.5%)\n\n\nMissing\n103 (18.9%)\n56 (18.5%)\n39 (21.7%)\n198 (19.3%)\n\n\nECigs\n\n\n\n\n\n\nCurrent\n9 (1.7%)\n15 (5.0%)\n7 (3.9%)\n31 (3.0%)\n\n\nPrevious\n15 (2.8%)\n3 (1.0%)\n2 (1.1%)\n20 (1.9%)\n\n\nNever\n417 (76.7%)\n228 (75.5%)\n131 (72.8%)\n776 (75.6%)\n\n\nMissing\n103 (18.9%)\n56 (18.5%)\n40 (22.2%)\n199 (19.4%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables-by-cohort",
    "href": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables-by-cohort",
    "title": "Overall tables",
    "section": "Table of Ulcerative colitis/IBDU variables by cohort",
    "text": "Table of Ulcerative colitis/IBDU variables by cohort\n\nCodecomp &lt;- demo.uc\ncomp$cohort &lt;- \"All\"\n\ntemp &lt;- demo.uc %&gt;%\n  drop_na(cat)\ntemp$cohort &lt;- \"FC\"\n\ncomp &lt;- rbind(comp, temp)\n\ntemp &lt;- subset(demo.uc, ParticipantNo %in% FFQ$participantno)\ntemp$cohort &lt;- \"FFQ\"\n\ncomp &lt;- rbind(comp, temp)\n\ncomp$cohort &lt;- factor(comp$cohort,\n  levels = c(\"All\", \"FC\", \"FFQ\"),\n  labels = c(\"Full cohort\", \"FC cohort\", \"FFQ cohort\")\n)\n\n\ntable1(~ Extent + Mayo + PRO2 + Smoke + ECigs | cohort,\n  data = comp,\n  render.continuous = my.render.cont,\n  overall = FALSE\n)\n\n\n\n\n\n\n\n\n\n\n\n\nFull cohort(N=1259)\nFC cohort(N=1026)\nFFQ cohort(N=561)\n\n\n\nExtent\n\n\n\n\n\nE1\n166 (13.2%)\n128 (12.5%)\n81 (14.4%)\n\n\nE2\n503 (40.0%)\n416 (40.5%)\n250 (44.6%)\n\n\nE3\n318 (25.3%)\n253 (24.7%)\n130 (23.2%)\n\n\nMissing\n272 (21.6%)\n229 (22.3%)\n100 (17.8%)\n\n\nMayo\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n\n\nMissing\n366 (29.1%)\n291 (28.4%)\n136 (24.2%)\n\n\nPRO2\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n\n\nMissing\n372 (29.5%)\n295 (28.8%)\n136 (24.2%)\n\n\nSmoke\n\n\n\n\n\nCurrent\n49 (3.9%)\n46 (4.5%)\n31 (5.5%)\n\n\nPrevious\n378 (30.0%)\n325 (31.7%)\n213 (38.0%)\n\n\nNever\n509 (40.4%)\n457 (44.5%)\n298 (53.1%)\n\n\nMissing\n323 (25.7%)\n198 (19.3%)\n19 (3.4%)\n\n\nECigs\n\n\n\n\n\nCurrent\n35 (2.8%)\n31 (3.0%)\n21 (3.7%)\n\n\nPrevious\n22 (1.7%)\n20 (1.9%)\n13 (2.3%)\n\n\nNever\n878 (69.7%)\n776 (75.6%)\n508 (90.6%)\n\n\nMissing\n324 (25.7%)\n199 (19.4%)\n19 (3.4%)\n\n\n\n\n\n\n\nAssociations between UC/IBDU-only variables and cohort membership\nNone of the UC/IBDU-only variables were found to significantly differ across cohorts.\nMontreal extent\n\nCodepander(chisq.test(comp$Extent, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Extent and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.793\n4\n0.593\n\n\n\n\nMayo score\n\nCodepander(summary(aov(Mayo ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n5.821\n2.91\n1.794\n0.1665\n\n\nResiduals\n2050\n3325\n1.622\nNA\nNA\n\n\n\n\n\nPRO2\n\nCodepander(summary(aov(PRO2 ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n1.319\n0.6593\n0.8346\n0.4342\n\n\nResiduals\n2040\n1611\n0.7899\nNA\nNA\n\n\n\n\n\nSmoking status\n\nCodepander(chisq.test(comp$Smoke, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Smoke and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.398\n4\n0.9826\n\n\n\n\nE-cigarette use\n\nCodepander(chisq.test(comp$ECigs, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$ECigs and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.02764\n4\n0.9999\n\n\n\n\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  saveRDS(paste0(outdir, \"demo.RDS\"))\n\ndemo %&gt;%\n  saveRDS(paste0(outdir, \"demo-full.RDS\"))\n\ndemo.cd %&gt;%\n  saveRDS(paste0(outdir, \"demo-cd.RDS\"))\n\ndemo.uc %&gt;%\n  saveRDS(paste0(outdir, \"demo-uc.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#reproduction-and-reproducibility",
    "href": "Baseline/Tables.html#reproduction-and-reproducibility",
    "title": "Overall tables",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), xfun(v.0.44), tidyselect(v.1.2.1), htmltools(v.0.5.8.1), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html",
    "href": "Baseline/Biochemistry.html",
    "title": "Biochemistry",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-IBD.RDS\"))\n\nlabs &lt;- as.data.frame(read_xlsx(paste0(\n  data.path,\n  \"Baseline2022/bloodtestresults.xlsx\"\n)))\n\nlabs &lt;- labs %&gt;%\n  distinct(ParticipantNo, .keep_all = TRUE)\n\n\nlabs &lt;- labs[, c(\n  \"ParticipantNo\",\n  \"CReactiveProtein\",\n  \"Haemoglobin\",\n  \"HaemoglobinUnit\",\n  \"WCC\",\n  \"WCCUnit\",\n  \"Platelets\",\n  \"PlateletsUnit\",\n  \"Albumin\",\n  \"AlbuminUnit\"\n)]\ndemo &lt;- merge(demo, labs, by = \"ParticipantNo\", all.x = TRUE, all.y = FALSE)\n\n\nParticipants’ IBD care teams reported biochemistry results via REDCap. Whilst data from many types of blood tests were collected, only the most relevant tests are presented here. Where possible, reference levels have been denoted on plots via vertical lines.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#introduction",
    "href": "Baseline/Biochemistry.html#introduction",
    "title": "Biochemistry",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-IBD.RDS\"))\n\nlabs &lt;- as.data.frame(read_xlsx(paste0(\n  data.path,\n  \"Baseline2022/bloodtestresults.xlsx\"\n)))\n\nlabs &lt;- labs %&gt;%\n  distinct(ParticipantNo, .keep_all = TRUE)\n\n\nlabs &lt;- labs[, c(\n  \"ParticipantNo\",\n  \"CReactiveProtein\",\n  \"Haemoglobin\",\n  \"HaemoglobinUnit\",\n  \"WCC\",\n  \"WCCUnit\",\n  \"Platelets\",\n  \"PlateletsUnit\",\n  \"Albumin\",\n  \"AlbuminUnit\"\n)]\ndemo &lt;- merge(demo, labs, by = \"ParticipantNo\", all.x = TRUE, all.y = FALSE)\n\n\nParticipants’ IBD care teams reported biochemistry results via REDCap. Whilst data from many types of blood tests were collected, only the most relevant tests are presented here. Where possible, reference levels have been denoted on plots via vertical lines.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#faecal-calprotectin",
    "href": "Baseline/Biochemistry.html#faecal-calprotectin",
    "title": "Biochemistry",
    "section": "Faecal calprotectin",
    "text": "Faecal calprotectin\nAs a reminder, only subjects with a faecal calprotectin are included in this analysis, and therefore NA values are not reported for faecal calprotectin. Faecal calprotectin has been grouped into FC&lt;50, 50 ≤ FC ≤ 250, and FC &gt; 250.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = cat, color = cat, fill = cat)) +\n  geom_bar() +\n  labs(x = \"FC category\", y = \"Frequency\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  scale_fill_manual(values = c(\"#408585\", \"#F59954\", \"#E4384E\")) +\n  scale_color_manual(values = c(\"#244644\", \"#A35805\", \"#9A1027\"))",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#c-reactive-protein",
    "href": "Baseline/Biochemistry.html#c-reactive-protein",
    "title": "Biochemistry",
    "section": "C-reactive protein",
    "text": "C-reactive protein\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(CReactiveProtein) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nAlongside FC, CRP is the most requested laboratory test for monitoring IBD disease activity. Unlike FC which acts as a proxy for gastrointestinal inflammation, CRP provides an indication of inflammation across the body. The reference level for CRP is considered to be &lt; 5 mg/L.\nCRP was generally well-completed with 76.4% of subjects having an associated CRP. As can be seen in Figure 1, there were some extreme, albeit physiologically plausible, values reported.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = CReactiveProtein)) +\n  geom_histogram(bins = 100, fill = \"#EB9486\", color = \"#BF7163\") +\n  theme_minimal() +\n  xlab(\"CRP (mg/L)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 1: Distribution of CRP at recruitment for the FC cohort.\n\n\n\n\nAs should be expected, CRP was found to be associated with FC.\n\nCodepander(summary(aov(CReactiveProtein ~ cat, data = demo)))\n\n\nTable 1: ANOVA between CRP and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1949\n974.4\n7.98\n0.0003556\n\n\nResiduals\n1635\n199628\n122.1\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodep &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x=cat, y = CReactiveProtein)) +\n  geom_boxplot(staplewidth  = 1,\n               fill = \"#C0D8E0\",\n               color = \"#42797B\",\n               outlier.shape = NA) +\n  ylim(0, 12) +\n  theme_minimal() +\n  xlab(\"Faecal calprotectin category (\\U03BCg/g)\") +\n  ylab(\"C-reactivive protein (mg/L)\")\ncairo_pdf(\"plots/CRP-FC-boxplot.pdf\", width = 8, height = 6)\np\n\nWarning: Removed 601 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\nCodeinvisible(dev.off())\n\np\n\nWarning: Removed 601 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\nFigure 2: Boxplot of CRP by FC category.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#haemoglobin",
    "href": "Baseline/Biochemistry.html#haemoglobin",
    "title": "Biochemistry",
    "section": "Haemoglobin",
    "text": "Haemoglobin\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(Haemoglobin) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nHaemoglobin is a protein which facilitates the transport of oxygen in red blood cells. Haemoglobin has been reported for 83.07% of subjects in the FC cohort. Haemoglobin differs between sex and accordingly has sex-specific reference levels (130-170 g/L for men and 120-150g/L for women).\nWhilst a normal distribution for haemoglobin is observed overall (Figure 3), there appears to be some observations substantially lower than one would expect for this distribution. Investigating these observations suggests that these observations are likely to be in units of g/dL instead of the common g/L units (Table 2).\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Haemoglobin)) +\n  geom_histogram(bins = 100, fill = \"#76E5FC\", color = \"#2EB6CD\") +\n  theme_minimal() +\n  xlab(\"Haemoglobin\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 3: Distribution of haemoglobin before processing.\n\n\n\n\n\nCodeknitr::kable(table(subset(demo, Haemoglobin &lt; 50)$HaemoglobinUnit),\n  col.names = c(\"Units\", \"Frequency\")\n)\n\n\nTable 2: Reported unit measurements for Haemoglobin reported less than 50.\n\n\n\n\nUnits\nFrequency\n\n\n\ng/dL\n6\n\n\ng/l\n1\n\n\ng/L\n5\n\n\nmmol/mol\n1\n\n\n\n\n\n\n\n\nHaving assumed any Haemoglobin &lt; 50 has been reported in g/dL, any Haemoglobin observations &lt;50 have been multiplied by 10 to be in g/L units. This results in the distribution seen in Figure 4.\n\nCodedemo &lt;- demo %&gt;%\n  mutate(Haemoglobin = if_else(Haemoglobin &lt; 50,\n    Haemoglobin * 10,\n    Haemoglobin\n  )) %&gt;%\n  select(-HaemoglobinUnit)\n\np1 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  filter(Sex == \"Female\") %&gt;%\n  ggplot(aes(x = Haemoglobin)) +\n  geom_histogram(bins = 100, fill = \"#8789C0\", color = \"#6A6B9C\") +\n  theme_minimal() +\n  xlab(\"Haemoglobin (g/L)\") +\n  ylab(\"Frequency\") +\n  xlim(0, 190) +\n  geom_vline(xintercept = c(120, 150), color = \"#93032E\") +\n  ggtitle(\"Female haemoglobin\")\n\n\n\np2 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  filter(Sex == \"Male\") %&gt;%\n  ggplot(aes(x = Haemoglobin, fill = Sex, color = Sex)) +\n  geom_histogram(bins = 100, fill = \"#225560\", color = \"#044651\") +\n  theme_minimal() +\n  xlab(\"Haemoglobin (g/L)\") +\n  ylab(\"Frequency\") +\n  xlim(0, 190) +\n  geom_vline(xintercept = c(130, 170), color = \"#93032E\") +\n  ggtitle(\"Male haemoglobin\")\n\n(p1 / p2)\n\n\n\n\n\n\nFigure 4: Distribution of haemoglobin after processing.\n\n\n\n\nHaemoglobin was not found to be significantly associated with FC at a 5% significance level.\n\nCodepander(summary(aov(Haemoglobin ~ cat, data = demo)))\n\n\nTable 3: ANOVA between haemoglobin and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n940.6\n470.3\n2.539\n0.07921\n\n\nResiduals\n1778\n329292\n185.2\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#white-cell-count",
    "href": "Baseline/Biochemistry.html#white-cell-count",
    "title": "Biochemistry",
    "section": "White cell count",
    "text": "White cell count\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(WCC) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nWhite cell count (WCC) is a measurement of all white blood cells (neutrophils, lymphocytes, monocytes, basophils and eosinophils) which help to fight infections. 83.02% of subjects have a WCC recorded.\nWhilst some extreme WCC values are observed, most observations fall within the reference range (4-11 (×10^9/L)) and a conventional bell curve is seen overall.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = WCC)) +\n  geom_histogram(bins = 100, fill = \"#7FD8BE\", color = \"#2D977E\") +\n  theme_minimal() +\n  xlab(\"White cell count (×10^9/L\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = c(4, 11), color = \"#FF686B\", alpha = 0.8)\n\n\n\n\n\n\nFigure 5: Distrbution of WCC for the FC cohort. Vertical lines indicate the reference range.\n\n\n\n\nWCC is reported to be associated with FC.\n\nCodepander(summary(aov(WCC ~ cat, data = demo)))\n\n\nTable 4: ANOVA between WCC and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n95.27\n47.63\n8.615\n0.0001891\n\n\nResiduals\n1777\n9826\n5.529\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#platelets",
    "href": "Baseline/Biochemistry.html#platelets",
    "title": "Biochemistry",
    "section": "Platelets",
    "text": "Platelets\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(Platelets) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nThe majority of subjects (83.02%) have a platelets test result recorded.\nWhilst some extreme values are observed, most fall within the reference range.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Platelets)) +\n  geom_histogram(bins = 100, fill = \"#84E6F8\", color = \"#018897\") +\n  theme_minimal() +\n  xlab(\"Platelets (×10^9/L\") +\n  ylab(\"Frequency\") + \n  geom_vline(xintercept = c(150, 450), color = \"#7b1907\", alpha = 0.8)\n\n\n\n\n\n\nFigure 6: Distrbution of Platelets for the FC cohort. Vertical lines indicate the reference range.\n\n\n\n\nPlatelets is reported to be significantly associated with FC.\n\nCodepander(summary(aov(Platelets ~ cat, data = demo)))\n\n\nTable 5: ANOVA between platelets and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n96868\n48434\n9.635\n6.891e-05\n\n\nResiduals\n1777\n8933162\n5027\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#albumin",
    "href": "Baseline/Biochemistry.html#albumin",
    "title": "Biochemistry",
    "section": "Albumin",
    "text": "Albumin\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(Albumin) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nAlbumin is globular protein made in the liver which carries hormones, vitamins, and enzymes. Albumin has a reference range of 35-50 (g/L). 79.1% of subjects in the FC cohort have a recorded Albumin result.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Albumin)) +\n  geom_histogram(bins = 100, fill = \"#21D19F\", color = \"#26A37D\") +\n  theme_minimal() +\n  xlab(\"Albumin\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = c(35, 50), color = \"#FF686B\")\n\n\n\n\n\n\nFigure 7: Distribution of Albumin before processing.\n\n\n\n\nAs can be seen in Figure 7, a very extreme value has been reported. This has been assumed to have been off by a factor of 10. Adjusting this observation results in the distribution seen in Figure 8.\n\nCodedemo &lt;- demo %&gt;%\n  mutate(Albumin = if_else(Albumin &gt; 100, Albumin / 10, Albumin)) %&gt;%\n  select(-AlbuminUnit)\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Albumin)) +\n  geom_histogram(bins = 40, fill = \"#21D19F\", color = \"#26A37D\") +\n  theme_minimal() +\n  xlab(\"Albumin (g/L)\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = c(35, 50), color = \"#FF686B\")\n\n\n\n\n\n\nFigure 8: Distribution of Albumin after processing.\n\n\n\n\nThere is strong evidence for an association between Albumin and FC.\n\nCodepander(summary(aov(Albumin ~ cat, data = demo)))\n\n\nTable 6: ANOVA between Albumin and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1069\n534.5\n23.85\n6.098e-11\n\n\nResiduals\n1693\n37943\n22.41\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-biochem.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#reproduction-and-reproducibility",
    "href": "Baseline/Biochemistry.html#reproduction-and-reproducibility",
    "title": "Biochemistry",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html",
    "href": "Baseline/Demographics.html",
    "title": "Demographic data",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- read_xlsx(paste0(data.path, \"Baseline2022/demographics.xlsx\"),\n  col_types = c(\n    \"text\",\n    \"text\",\n    \"text\",\n    \"text\",\n    \"numeric\",\n    \"numeric\",\n    \"text\",\n    \"text\",\n    \"date\",\n    \"numeric\",\n    \"text\"\n  )\n)\n\nfcal &lt;- read_xlsx(paste0(data.path, \"Baseline2022/calprotectin.xlsx\"))\nfcal$Result &lt;- as.numeric(plyr::mapvalues(fcal$Result, from = \"&lt;20\", to = 20))\n\nfcal &lt;- fcal[, c(\"ParticipantNo\", \"Result\")]\n\nfcal.eof &lt;- read_xlsx(paste0(prefix, \"EOF_fcal.xlsx\"))\n\nfcal.eof &lt;- subset(fcal.eof, IsBaseline == 1)\nfcal.eof &lt;- subset(fcal.eof, FCALLevel != \".\")\nfcal.eof$FCALLevel &lt;- as.numeric(fcal.eof$FCALLevel)\nfcal.eof &lt;- fcal.eof[, c(\"ParticipantNo\", \"FCALLevel\")]\nnames(fcal.eof)[2] &lt;- \"Result\"\n\nfcal &lt;- rbind(fcal, fcal.eof)\nfcal &lt;- distinct(fcal, ParticipantNo, .keep_all = TRUE)\n\nfcal$cat &lt;- 0\nfor (i in 1:nrow(fcal)) {\n  if (fcal[i, \"Result\"] &lt; 50) fcal[i, \"cat\"] &lt;- 1\n  if ((fcal[i, \"Result\"] &gt;= 50) & (fcal[i, \"Result\"] &lt;= 250)) fcal[i, \"cat\"] &lt;- 2\n  if (fcal[i, \"Result\"] &gt; 250) fcal[i, \"cat\"] &lt;- 3\n}\n\n\ndemo &lt;- merge(demo, fcal[, c(\"ParticipantNo\", \"Result\", \"cat\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo$cat &lt;- factor(demo$cat,\n  levels = c(1, 2, 3),\n  labels = c(\"FC &lt; 50\", \"FC 50-250\", \"FC &gt; 250\")\n)\n\nnames(demo)[12] &lt;- \"FC\" # Result ~&gt; FC\n\n\nThis page describes key demographic data collected by the PREdiCCt study.",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#introduction",
    "href": "Baseline/Demographics.html#introduction",
    "title": "Demographic data",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- read_xlsx(paste0(data.path, \"Baseline2022/demographics.xlsx\"),\n  col_types = c(\n    \"text\",\n    \"text\",\n    \"text\",\n    \"text\",\n    \"numeric\",\n    \"numeric\",\n    \"text\",\n    \"text\",\n    \"date\",\n    \"numeric\",\n    \"text\"\n  )\n)\n\nfcal &lt;- read_xlsx(paste0(data.path, \"Baseline2022/calprotectin.xlsx\"))\nfcal$Result &lt;- as.numeric(plyr::mapvalues(fcal$Result, from = \"&lt;20\", to = 20))\n\nfcal &lt;- fcal[, c(\"ParticipantNo\", \"Result\")]\n\nfcal.eof &lt;- read_xlsx(paste0(prefix, \"EOF_fcal.xlsx\"))\n\nfcal.eof &lt;- subset(fcal.eof, IsBaseline == 1)\nfcal.eof &lt;- subset(fcal.eof, FCALLevel != \".\")\nfcal.eof$FCALLevel &lt;- as.numeric(fcal.eof$FCALLevel)\nfcal.eof &lt;- fcal.eof[, c(\"ParticipantNo\", \"FCALLevel\")]\nnames(fcal.eof)[2] &lt;- \"Result\"\n\nfcal &lt;- rbind(fcal, fcal.eof)\nfcal &lt;- distinct(fcal, ParticipantNo, .keep_all = TRUE)\n\nfcal$cat &lt;- 0\nfor (i in 1:nrow(fcal)) {\n  if (fcal[i, \"Result\"] &lt; 50) fcal[i, \"cat\"] &lt;- 1\n  if ((fcal[i, \"Result\"] &gt;= 50) & (fcal[i, \"Result\"] &lt;= 250)) fcal[i, \"cat\"] &lt;- 2\n  if (fcal[i, \"Result\"] &gt; 250) fcal[i, \"cat\"] &lt;- 3\n}\n\n\ndemo &lt;- merge(demo, fcal[, c(\"ParticipantNo\", \"Result\", \"cat\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo$cat &lt;- factor(demo$cat,\n  levels = c(1, 2, 3),\n  labels = c(\"FC &lt; 50\", \"FC 50-250\", \"FC &gt; 250\")\n)\n\nnames(demo)[12] &lt;- \"FC\" # Result ~&gt; FC\n\n\nThis page describes key demographic data collected by the PREdiCCt study.",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#age",
    "href": "Baseline/Demographics.html#age",
    "title": "Demographic data",
    "section": "Age",
    "text": "Age\nThe distribution of age for the study cohort is approximately normally distributed.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(bins = 30, fill = \"#64c7ce\", color = \"#3B9EA4\") +\n  geom_density() +\n  theme_minimal() +\n  xlab(\"Age (years)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 1: Distribution of age in the FC cohort.\n\n\n\n\nAge is significantly associated with faecal calprotectin.\n\nCodepander(summary(aov(age ~ cat, data = demo)))\n\n\nTable 1: ANOVA between age and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n2739\n1370\n5.661\n0.003531\n\n\nResiduals\n2141\n518041\n242\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#sex",
    "href": "Baseline/Demographics.html#sex",
    "title": "Demographic data",
    "section": "Sex",
    "text": "Sex\nSex was self-reported via subject questionnaires. As can be seen in Figure 2, the PREdiCCt cohort is female by majority.\n\nCodedemo$Sex &lt;- factor(demo$Sex, levels = c(\"1\", \"2\"), labels = c(\"Male\", \"Female\"))\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Sex, fill = Sex, color = Sex)) +\n  geom_bar() +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#FCA17D\", \"#60D394\")) +\n  scale_color_manual(values = c(\"#B22A21\", \"#034C3C\"))\n\n\n\n\n\n\nFigure 2: Distribution of sex in the FC cohort.\n\n\n\n\nMoreover, the distribution of sex is significantly different between FCAL groups.\n\nCodepander(chisq.test(demo$Sex, demo$cat))\n\n\nTable 2: Chi-squared test between Sex and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Sex and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n14.2\n2\n0.0008269 * * *",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#bmi",
    "href": "Baseline/Demographics.html#bmi",
    "title": "Demographic data",
    "section": "BMI",
    "text": "BMI\nBody mass index is given by weight (in Kg) divided by height (in M) squared.\nAs thresholds differ in the paediatric population, and are dependent on both age and sex, BMI has not been calculated for those less than 18 years of age. BMI is first considered as a continuous variable.\n\nCodedemo$BMI &lt;- with(demo, Weight / ((Height / 100)^2))\ndemo[demo[, \"age\"] &lt; 18, \"BMI\"] &lt;- NA\np &lt;- demo %&gt;%\n  ggplot(aes(x = BMI)) +\n  geom_histogram(color = \"#AD013B\", fill = \"#F0386B\", bins = 30) +\n  theme_minimal(base_family = \"sans\") +\n  ylab(\"Frequency\")\n\nggsave(\"plots/BMI-full-cohort.png\",\n  p,\n  width = 9,\n  height = 6\n)\nggsave(\"plots/BMI-full-cohort.pdf\", p, width = 9, height = 6)\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = BMI)) +\n  geom_histogram(color = \"#AD013B\", fill = \"#F0386B\", bins = 30) +\n  theme_minimal() +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 3: Distribution of BMI in the FC cohort.\n\n\n\n\nBMI as a continuous variable is not associated with FC groups.\n\nCodepander(summary(aov(BMI ~ cat, data = demo)))\n\n\nTable 3: Fisher’s exact test between BMI and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n134.9\n67.45\n2.387\n0.09219\n\n\nResiduals\n2057\n58135\n28.26\nNA\nNA\n\n\n\n\n\n\n\n\nWe also consider BMI grouped into underweight, normal, overweight, and obese categories using the definitions used by the NIH and WHO (Weir and Jan 2024).\nA cut-off of 30 KgM^{-2} is used to denote obesity in adults without Asian/South Asian backgrounds. As data on Asian and South Asian ethnicity is not available (See Ethnicity), we are unable to adjust the threshold based on ethnicity. However, this is expected to be relevant to relatively few subjects.\n\nCodedemo$BMIcat &lt;- cut(demo$BMI,\n  c(0, 18.5, 25, 30, Inf),\n  include.lowest = TRUE,\n  right = FALSE,\n  labels = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\")\n)\ndemo[demo[, \"age\"] &lt; 18, \"BMIcat\"] &lt;- NA\n\nplt.cols &lt;- c(\"#F6AE2D\", \"#C81D25\", \"#1481BA\", \"#7E1F86\")\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = BMIcat, color = BMIcat, fill = BMIcat)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  scale_fill_manual(values = plt.cols, na.value = \"#032B43\") +\n  scale_color_manual(\n    values = colorspace::darken(plt.cols, 0.2),\n    na.value = \"#032B43\"\n  ) +\n  xlab(\"BMI category\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 4: Distribution of BMI categories in the FC cohort.\n\n\n\n\nBMI by category is not associated with FC groups.\n\nCodepander(chisq.test(demo$BMIcat, demo$cat))\n\n\nTable 4: Chi-squared test between BMI categories and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$BMIcat and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n7.169\n6\n0.3055",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#ethnicity",
    "href": "Baseline/Demographics.html#ethnicity",
    "title": "Demographic data",
    "section": "Ethnicity",
    "text": "Ethnicity\nDue to low counts for non-white ethnicities, we are only able to report frequencies of white and non-white ethnicities.\n\nCodedemo$ethnic_gp &lt;- factor(demo$ethnic_gp,\n  levels = c(\"1\", \"2\"),\n  labels = c(\"White\", \"Non-white\")\n)\ncolnames(demo)[10:11] &lt;- c(\"Age\", \"Ethnicity\")\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Ethnicity, fill = Ethnicity, color = Ethnicity)) +\n  geom_bar() +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#F24236\", \"#2E86AB\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#C0362C\", \"#1E556C\"), na.value = \"#032B43\")\n\n\n\n\n\n\nFigure 5: Distribution of ethnicity in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo$Ethnicity, demo$cat))\n\n\nTable 5: Chi-squared test between ethnicity and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Ethnicity and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.416\n2\n0.2989",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#index-of-multiple-deprivation",
    "href": "Baseline/Demographics.html#index-of-multiple-deprivation",
    "title": "Demographic data",
    "section": "Index of multiple deprivation",
    "text": "Index of multiple deprivation\nThe PREdiCCt SAP states the primary analyses will be controlled for by index of multiple deprivation (IMD). It should be noted that the PREdiCCt study recruited across the UK and there is no consistent measure of IMD across the whole of the UK. Instead, IMD measures are handled slightly differently by each constituent nation.\n\nCodeIMD &lt;- read_xlsx(paste0(redcap.path, \"/IMD.xlsx\"))\n\n\nIMD &lt;- as.data.frame(IMD)\nnames(IMD)[2] &lt;- \"IMD\"\ndemo &lt;- merge(demo, IMD, by = \"ParticipantNo\", all.x = TRUE, all.y = FALSE)\ndemo$IMD &lt;- as.factor(demo$IMD)\n\ncols &lt;- c(\"#A8F9FF\", \"#EF8275\", \"#6D326D\", \"#0B6E4F\", \"#F4D35E\")\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = IMD, color = as.factor(IMD), fill = as.factor(IMD))) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  ylab(\"Frequency\") +\n  xlab(\"IMD (most deprived to least deprived)\") +\n  scale_fill_manual(values = cols) +\n  scale_color_manual(values = colorspace::darken(cols, amount = 0.3))\n\n\n\n\n\n\nFigure 6: Distribution of IMD.\n\n\n\n\n\nCodepander(chisq.test(demo$IMD, demo$cat))\n\n\nTable 6: CHI-squared test between IMD and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$IMD and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n8.464\n8\n0.3895\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-demographics.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#reproduction-and-reproducibility",
    "href": "Baseline/Demographics.html#reproduction-and-reproducibility",
    "title": "Demographic data",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), textshaping(v.0.4.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), ragg(v.1.3.2), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), systemfonts(v.1.1.0), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Demographic data"
    ]
  },
  {
    "objectID": "Baseline/Introduction.html",
    "href": "Baseline/Introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "This section of the website explores the baseline data for the PREdiCCt study, generating inferences and producing display items for publication.\nFor all baseline reports, only the faecal calprotecin cohort, the sub-cohort defined as subjects with baseline faecal calprotecin available, are described (unless otherwise stated). For each variable considered, associations with faecal calprotectin categories (&lt;50, 50–250, &gt;250) are presented using chi-squared tests and ANOVA for categorical and continuous data respectively.\nThere are three main data sources for baseline demographic and phenotypic data in PREdiCCt:\n\nParticipant questionnaires.\nForms completed by a subject’s clinical team (via REDCap) during recruitment.\nData collected retrospectively during the end-of-study (EoS) phenotyping which was completed by a member of the subject’s IBD care team.\n\nAs all three are used, it will be made clear which source the data presented originate from.",
    "crumbs": [
      "Baseline Analyses",
      "Introduction"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About",
    "section": "",
    "text": "To-do\nThis work uses data provided by patients and collected by the NHS as part of their care and support. We are grateful to participants and their IBD care teams for their support.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "About",
    "section": "",
    "text": "To-do\nThis work uses data provided by patients and collected by the NHS as part of their care and support. We are grateful to participants and their IBD care teams for their support.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#using-this-website",
    "href": "index.html#using-this-website",
    "title": "About",
    "section": "Using this website",
    "text": "Using this website\nThe code button at the top of each page can be used to show all code blocks instead of clicking on the code buttons for each individual block of code. Moving the mouse pointer over any citations in a report will produce a pop up box with reference details. Clicking on the citation will link to the bibliography at the bottom of the page.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#software-versions",
    "href": "index.html#software-versions",
    "title": "About",
    "section": "Software versions",
    "text": "Software versions\nAll analyses have been generated using R version 4.4.0. Please see the Session Information sections at the bottom of each report to see the R packages used for that particular analysis and the respective package versions.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#acknowledgements",
    "href": "index.html#acknowledgements",
    "title": "About",
    "section": "Acknowledgements",
    "text": "Acknowledgements\nThis work uses data provided by participants and the NHS. We are grateful to the study participants and their IBD care teams for their support.\nThe PREdiCCt study was funded by Cure Crohn’s Colitis, Crohns & Colitis In Childhood, the Chief Scientist Office, and UKRI.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#section",
    "href": "index.html#section",
    "title": "About",
    "section": "",
    "text": "This website has been generated using the Quarto scientific publishing system built on pandoc.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "Baseline/Recruitment.html",
    "href": "Baseline/Recruitment.html",
    "title": "Study recruitment",
    "section": "",
    "text": "Codeset.seed(123)\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed\"\n  metadir &lt;- \"data/metadata/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n  metadir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/metadata/\"\n}\n\neof &lt;- read_xlsx(paste0(prefix, \"Followup form.xlsx\"))\n\n\n# Demographic data as reported by subjects\ndemo &lt;- read_xlsx(paste0(data.path, \"Baseline2022/demographics.xlsx\"),\n  col_types = c(\n    \"text\",\n    \"text\",\n    \"text\",\n    \"text\",\n    \"numeric\",\n    \"numeric\",\n    \"text\",\n    \"text\",\n    \"date\",\n    \"numeric\",\n    \"text\"\n  )\n)",
    "crumbs": [
      "Study recruitment"
    ]
  },
  {
    "objectID": "Baseline/Recruitment.html#reproduction-and-reproducibility",
    "href": "Baseline/Recruitment.html#reproduction-and-reproducibility",
    "title": "Study recruitment",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1) and tidyverse(v.2.0.0)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), lattice(v.0.22-6), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), plyr(v.1.8.9), Matrix(v.1.7-0), cellranger(v.1.1.0), jsonlite(v.1.8.8), mgcv(v.1.9-1), pander(v.0.6.5), fansi(v.1.0.6), viridisLite(v.0.4.2), scales(v.1.3.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), splines(v.4.4.0), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), xfun(v.0.44), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), knitr(v.1.47), farver(v.2.1.2), nlme(v.3.1-164), htmltools(v.0.5.8.1), rmarkdown(v.2.27), labeling(v.0.4.3) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Study recruitment"
    ]
  },
  {
    "objectID": "Baseline/IBD.html",
    "href": "Baseline/IBD.html",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-demographics.RDS\"))\ndemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\n\ncat_theme &lt;- function(gg) {\n  p &lt;- gg +\n    scale_fill_manual(values = c(\"#DA4167\", \"#F4D35E\", \"#083D77\")) +\n    scale_color_manual(values = colorspace::darken(c(\"#DA4167\",\n                                                     \"#F4D35E\",\n                                                     \"#083D77\"),\n                                                   0.2)\n                     ) +\n  theme_minimal()\n  p\n}\n\n\nThis page explores data which describes subjects’ IBD, primarily consisting of clinical data.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#introduction",
    "href": "Baseline/IBD.html#introduction",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-demographics.RDS\"))\ndemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\n\ncat_theme &lt;- function(gg) {\n  p &lt;- gg +\n    scale_fill_manual(values = c(\"#DA4167\", \"#F4D35E\", \"#083D77\")) +\n    scale_color_manual(values = colorspace::darken(c(\"#DA4167\",\n                                                     \"#F4D35E\",\n                                                     \"#083D77\"),\n                                                   0.2)\n                     ) +\n  theme_minimal()\n  p\n}\n\n\nThis page explores data which describes subjects’ IBD, primarily consisting of clinical data.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#ibd-type",
    "href": "Baseline/IBD.html#ibd-type",
    "title": "Inflammatory bowel disease",
    "section": "IBD type",
    "text": "IBD type\nFor this study, we have grouped ulcerative colitis (UC) and inflammatory bowel disease unclassified (IBDU) into one category. IBD type is self-reported.\nWhilst PREdiCCt was designed to recruit an equal number of CD and UC/IBDU subjects, the COVID-19 pandemic halted recruitment which has resulted in there not being an equal balance of CD and UC/IBDU subjects.There are slightly more Crohn’s disease (CD) than UC/IBDU subjects in the FC cohort.\n\nCodedemo$diagnosis2 &lt;- plyr::mapvalues(demo$diagnosis,\n  from = seq(1, 4),\n  to = c(1, 2, 2, 2)\n) %&gt;%\n  factor(levels = c(\"1\", \"2\"), labels = c(\"CD\", \"UC/IBDU\"))\n\ndemo$diagnosis &lt;- plyr::mapvalues(demo$diagnosis,\n  from = seq(1, 4),\n  to = c(1, 2, 3, 3)\n) %&gt;%\n  factor(levels = c(\"1\", \"2\", \"3\"), labels = c(\"CD\", \"UC\", \"IBDU\"))\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = diagnosis2, fill = diagnosis2, color = diagnosis2)) +\n  geom_bar() +\n  ylab(\"Frequency\") +\n  xlab(\"IBD type\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#2B2D42\", \"#92DCE5\")) +\n  scale_color_manual(values = c(\"#1E203A\", \"#1D9BA5\")) +\n  guides(\n    fill = guide_legend(title = \"IBD type\"),\n    color = guide_legend(title = \"IBD type\")\n  )\n\n\n\n\n\n\nFigure 1: Distribution of IBD type in the FC cohort.\n\n\n\n\nIBD type is significantly associated with FC at recruitment.\n\nCodepander(chisq.test(demo$diagnosis2, demo$cat))\n\n\nTable 1: Chi-squared test between IBD type and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$diagnosis2 and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n6.815\n2\n0.03313 *\n\n\n\n\n\n\n\nFrom Figure 2, we can see subjects with UC/IBDU are more likely to have FC &lt; 50, whiilst CD subjects are more likely to have FC 50-250. Roughtly the same proportion of subjects with CD and UC/IBDU have FC &gt; 250.\n\nCodep &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  mutate(cat = fct_rev(cat)) %&gt;%\n  ggplot(aes(x = diagnosis2, fill = cat, color = cat)) +\n  geom_bar(position=\"fill\") +\n  scale_y_continuous(labels = scales::percent) + \n  labs(x = \"IBD subtype\",\n       y = \"Proportion\",\n       fill = \"FC group\",\n       color = \"FC group\")\ncat_theme(p)\n\n\n\n\n\n\nFigure 2: Distribution of FC category by IBD subtype.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#disease-duration",
    "href": "Baseline/IBD.html#disease-duration",
    "title": "Inflammatory bowel disease",
    "section": "Disease duration",
    "text": "Disease duration\nDisease duration has been calculated by subtracting reported date of diagnosis from the date of entry into PREdiCCt. Date of diagnosis has been obtained via REDcap. Where only year was available, the datefixR R package was used to impute the middle of the year. Any disease durations reported to be negative using this method were mapped to 0.\n\nCoderedcap &lt;- read_xlsx(paste0(redcap.path, \"redcap_clean.xlsx\"))\nredcap &lt;- distinct(redcap, participantno, .keep_all = TRUE)\n\ndiag.date &lt;- redcap[, c(\"participantno\", \"date_diag\")]\ncolnames(diag.date)[1] &lt;- \"ParticipantNo\"\ndiag.date &lt;- subset(diag.date, (!is.na(date_diag)) &\n  (!is.null(date_diag)) &\n  date_diag != \"\")\nduration &lt;- merge(diag.date,\n  demo,\n  by = \"ParticipantNo\",\n  all.x = FALSE,\n  all.y = TRUE\n)\nduration &lt;- distinct(duration, ParticipantNo, .keep_all = TRUE)\n\nduration &lt;- subset(duration, tolower(date_diag) != \"unknown\")\nduration[duration[, \"date_diag\"] == \"16/032016\", \"date_diag\"] &lt;- \"16/03/2016\"\nduration[duration[, \"date_diag\"] == \"19/04/2017P\", \"date_diag\"] &lt;- \"19/04/2017\"\nduration[duration[, \"date_diag\"] == \"2007 APPROX\", \"date_diag\"] &lt;- \"2007\"\nduration[duration[, \"date_diag\"] == \"approx 1988\", \"date_diag\"] &lt;- \"1988\"\nduration[duration[, \"date_diag\"] == \"?2014\", \"date_diag\"] &lt;- \"2014\"\n\nduration &lt;- fix_date_df(duration, c(\"entry_date\", \"date_diag\"))\n\nduration$duration &lt;- as.numeric(with(\n  duration,\n  (entry_date - date_diag) / 365.25\n))\n\nduration[duration[, \"duration\"] &lt; 0, \"duration\"] &lt;- 0\n\n\nduration.cd &lt;- subset(duration, diagnosis == \"1\")\n\nduration.uc &lt;- subset(duration, diagnosis != \"1\")\n\np &lt;- duration %&gt;%\n  ggplot(aes(x = duration, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  labs(\n    x = \"Duration (years)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  )\nggsave(\"plots/Duration-full-cohort.png\",\n  p,\n  width = 9,\n  height = 6\n)\nggsave(\"plots/Duration-full-cohort.pdf\", p, width = 9, height = 6)\n\n\nduration %&gt;%\n  drop_na(duration) %&gt;%\n  ggplot(aes(x = duration, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  labs(\n    x = \"Duration (years)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  )\n\n\n\n\n\n\nFigure 3\n\n\n\n\nWhilst a low p-value was observed, disease duration was not significantly different between FC groups.\n\nCodedemo &lt;- merge(demo, duration[, c(\"ParticipantNo\", \"duration\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\nnames(demo)[18] &lt;- \"IBD Duration\"\n\ndemo %&gt;%\n  aov(formula = `IBD Duration` ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 2: ANOVA between IBD disease duration and FC groups\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n639.6\n319.8\n2.708\n0.06691\n\n\nResiduals\n2021\n238664\n118.1\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = `IBD Duration` ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 3: ANOVA between IBD disease duration and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n162\n81\n0.6239\n0.5361\n\n\nResiduals\n1051\n136459\n129.8\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = `IBD Duration` ~ cat,) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 4: ANOVA between IBD disease duration and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n756\n378\n3.654\n0.02626\n\n\nResiduals\n967\n1e+05\n103.5\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodep &lt;- demo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  drop_na(cat) %&gt;%\n  mutate(cat = fct_rev(cat)) %&gt;%\n  ggplot(aes(x = `IBD Duration`, fill = cat, color = cat)) +\n  geom_density() +\n  facet_grid(rows = vars(cat)) +\n  labs(x = \"Disease duration (years)\",\n       y = \"Density\",\n       fill = \"FC group\",\n       color = \"FC group\")\ncat_theme(p)\n\nWarning: Removed 56 rows containing non-finite outside the scale range\n(`stat_density()`).\n\n\n\n\n\n\n\nFigure 4: Distribution of disease duration by FC in UC.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#ibd-control",
    "href": "Baseline/IBD.html#ibd-control",
    "title": "Inflammatory bowel disease",
    "section": "IBD Control",
    "text": "IBD Control\n\nCodeIBD &lt;- read_xlsx(paste0(data.path, \"Baseline2022/IBD.xlsx\"))\n\n# create flare_group in IBD_C and make into level\nIBD &lt;- IBD %&gt;%\n  mutate(flare_group = ifelse(FlaresInPastYear == 0,\n    \"No Flares\",\n    \"1 or More Flares\"\n  ))\nIBD$flare_group &lt;- factor(IBD$flare_group,\n  levels = c(\"No Flares\", \"1 or More Flares\")\n)\n\nIBD &lt;- IBD %&gt;%\n  mutate(treatment = ifelse(TreatmentUseful == 4,\n    \"Not On Treatment\",\n    \"On Treatment\"\n  ))\nIBD$treatment &lt;- factor(IBD$treatment,\n  levels = c(\"Not On Treatment\", \"On Treatment\")\n)\n\n# correcting scores where No is favourable and Yes is unfavourable outcomes\n# answer options were always YES/NO/Not sure\nif (any(IBD$MissPlannedActivities == 3)) {\n  IBD &lt;- IBD %&gt;%\n    mutate_at(\n      vars(\"MissPlannedActivities\":\"NewSymptoms\"),\n      ~ recode(., `3` = 1, `2` = 2, `1` = 0)\n    )\n}\n\n# correct TreatmentUseful (Yes is favourable, No unfavourable)\n# not on treatment was assigned the value 1\nif (any(IBD$TreatmentUseful == 3)) {\n  IBD &lt;- IBD %&gt;%\n    mutate_at(\n      \"TreatmentUseful\",\n      ~ recode(., `4` = 2, `3` = 1, `2` = 0, `1` = 2)\n    )\n}\n\n# exclude rows with missing data, 17 participants excluded for missing IBD-control questionnaire data\nIBD &lt;- IBD %&gt;%\n  filter(!rowSums(is.na(select(., 17:27))) &gt; 0)\n\n# new column with total control score\nIBD &lt;- IBD %&gt;%\n  mutate(control_score = rowSums(select(., 17:27), na.rm = TRUE))\n\n# new column with IBD-control-8 score\n# added 2 to make comparable to future scores where the first question is asked to make comparable to future and against the cut off of 13 which indicates remission\nIBD &lt;- IBD %&gt;%\n  mutate(control_8 = TreatmentUseful +\n    MissPlannedActivities +\n    WakeUpAtNight +\n    SignificantPain +\n    OftenLackEnergy +\n    AnxiousDepressed +\n    NeedChangeTreatment +\n    2)\n\n# create groups with cut off of IBD-control-8 scores quiescent (13 or above)/not quiescent\nIBD &lt;- IBD %&gt;%\n  mutate(control_grouped = ifelse(control_8 &gt;= 13, \"13-16\", \"0-12\"))\n\nIBD$control_8 &lt;- as.factor(IBD$control_8)\n\nIBD &lt;- IBD %&gt;%\n  mutate(vas_control = ifelse(OverallControl &gt;= 85, \"85+\", \"&lt;85\"))\n\ndemo &lt;- merge(demo, IBD[, c(\"ParticipantNo\", \"control_8\", \"OverallControl\", \"vas_control\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nIBD Control is a validated questionnaire designed to assess disease control from a patient’s perspective (Bodger et al. 2013). We considered an eight question subset, IBD-Control-8 which ranges in potential scores from 0 to 16. We also consider the IBD-Control visual analogue scale (VAS). Bodger et al. (2013) found a cut-off of \\geq 13 for IBD-Control-8 and a cut-off of \\geq 85 for IBD-Control-VAS to be optimal for identifying quiescent disease.\n\nCodep1 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = control_8, color = control_8, fill = control_8)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  xlab(\"Control-8 Scores\") +\n  ylab(\"Frequency\") +\n  scale_color_manual(values = viridis::viridis(15), na.value = \"#032B43\") +\n  scale_fill_manual(values = viridis::viridis(15), na.value = \"#032B43\") +\n  geom_vline(xintercept = 11.5, color = \"#FF4B3E\")\n\np2 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = OverallControl)) +\n  geom_histogram(binwidth = 5, fill = \"#FFD23F\", color = \"#947805\") +\n  theme_minimal() +\n  xlab(\"VAS Scores\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = 85, color = \"#FF4B3E\") +\n  scale_x_continuous(breaks = seq(0, 100, 10))\np1 / p2 + plot_annotation(tag_levels = \"A\")\n\n\n\n\n\n\nFigure 5: Distributiuon of IBD Control scores for (A) Control-8 and (B) Visual analogue scale. The vertical red lines denote the cut-offs for quiescent disease reported by Bodger et al. (2013).\n\n\n\n\nIBD-Control-8 scores and VAS were both found to be significantly associated with FC.\n\nCodedemo %&gt;%\n  aov(formula = as.numeric(control_8) ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 5: ANOVA between control-8 and FC groups across the FC cohort.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n65.25\n32.63\n3.335\n0.03586\n\n\nResiduals\n1694\n16574\n9.784\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = as.numeric(control_8) ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 6: ANOVA between control-8 and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n29.06\n14.53\n1.373\n0.254\n\n\nResiduals\n867\n9179\n10.59\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = as.numeric(control_8) ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 7: ANOVA between control-8 and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n73.18\n36.59\n4.166\n0.01584\n\n\nResiduals\n824\n7238\n8.783\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  aov(formula = OverallControl ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 8: ANOVA between control VAS and FC groups across the FC cohort.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n4692\n2346\n9.996\n4.836e-05\n\n\nResiduals\n1687\n395921\n234.7\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = OverallControl ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 9: ANOVA between control VAS and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1632\n815.8\n3.4\n0.03383\n\n\nResiduals\n862\n206848\n240\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = OverallControl ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 10: ANOVA between control VAS and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n2933\n1467\n6.448\n0.001665\n\n\nResiduals\n822\n186983\n227.5\nNA\nNA\n\n\n\n\n\n\n\n\nInstead to treating VAS as a continuous value, going forward, VAS will be discretised into below 85 and 85 and above as a VAS of 85 was found by Bodger et al. (2013) to be predictive of quiescent disease.\n\nCodedemo &lt;- demo %&gt;%\n  select(-OverallControl)\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = vas_control, color = vas_control, fill = vas_control)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  xlab(\"Visual analogue scores\") +\n  ylab(\"Frequency\") +\n  scale_color_manual(values = c(\"#D00000\", \"#447604\"), na.value = \"#032B43\") +\n  scale_fill_manual(values = c(\"#D00000\", \"#447604\"), na.value = \"#032B43\")\n\n\n\n\n\n\nFigure 6: Distribution of discretised IBD-Control-VAS scores.\n\n\n\n\nThe discretised VAS is continued to be significantly associated with FC.\n\nCodepander(chisq.test(demo$vas_control, demo$cat))\n\n\nTable 11: Chi squared test between VAS and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$vas_control and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n16.89\n2\n0.0002153 * * *",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#medication-use",
    "href": "Baseline/IBD.html#medication-use",
    "title": "Inflammatory bowel disease",
    "section": "Medication use",
    "text": "Medication use\nThis section is concerned with medication used by study participants. Current treatment strategy, bio-naive status and antibiotic use are considered.\nIBD treatment strategy\n\nCodedrugs &lt;- data.frame(ParticipantNo = demo$ParticipantNo)\n\ndrugs$ASA &lt;- FALSE\ndrugs$imm &lt;- FALSE\ndrugs$bio &lt;- FALSE\ndrugs$category &lt;- NA\n\nredcap &lt;- redcap %&gt;% mutate(\n  curr_on_mesa = ifelse(is.na(curr_on_mesa),\n    0,\n    curr_on_mesa\n  ),\n  curr_on_aza = ifelse(is.na(curr_on_aza),\n    0,\n    curr_on_aza\n  ),\n  curr_on_merc = ifelse(is.na(curr_on_merc),\n    0,\n    curr_on_merc\n  ),\n  curr_on_metho = ifelse(is.na(curr_on_metho),\n    0,\n    curr_on_metho\n  ),\n  curr_on_ciclo = ifelse(is.na(curr_on_ciclo),\n    0,\n    curr_on_ciclo\n  ),\n  curr_on_inflix = ifelse(is.na(curr_on_inflix),\n    0,\n    curr_on_inflix\n  ),\n  curr_on_ada = ifelse(is.na(curr_on_ada),\n    0,\n    curr_on_ada\n  ),\n  curr_on_goli = ifelse(is.na(curr_on_goli),\n    0,\n    curr_on_goli\n  ),\n  curr_on_vedo = ifelse(is.na(curr_on_vedo),\n    0,\n    curr_on_vedo\n  ),\n  curr_on_ust = ifelse(is.na(curr_on_ust),\n    0,\n    curr_on_ust\n  )\n)\n\nfor (i in 1:nrow(drugs)) {\n  if (drugs[i, \"ParticipantNo\"] %in% redcap$participantno) {\n    subject.data &lt;- subset(redcap, participantno == drugs[i, \"ParticipantNo\"])[1, ]\n    if (subject.data$curr_on_mesa == 1) drugs[i, \"ASA\"] &lt;- TRUE\n\n    # Immunosuppressants\n    if (subject.data$curr_on_aza == 1 |\n      subject.data$curr_on_merc == 1 |\n      subject.data$curr_on_metho == 1 |\n      subject.data$curr_on_ciclo == 1) {\n      drugs[i, \"imm\"] &lt;- TRUE\n    }\n\n    # Biologics\n    if (subject.data$curr_on_inflix == 1 |\n      subject.data$curr_on_ada == 1 |\n      subject.data$curr_on_goli == 1 |\n      subject.data$curr_on_vedo == 1 |\n      subject.data$curr_on_ust == 1) {\n      drugs[i, \"bio\"] &lt;- TRUE\n    }\n    if (drugs[i, \"imm\"] & drugs[i, \"bio\"]) {\n      drugs[i, \"category\"] &lt;- 4\n    } else if (drugs[i, \"imm\"]) {\n      drugs[i, \"category\"] &lt;- 2\n    } else if (drugs[i, \"bio\"]) {\n      drugs[i, \"category\"] &lt;- 3\n    } else if (drugs[i, \"ASA\"]) {\n      drugs[i, \"category\"] &lt;- 1\n    }\n  }\n}\n\ndrugs$category &lt;- factor(drugs$category,\n  levels = 1:4,\n  labels = c(\n    \"5-ASA\",\n    \"Mono immunotherapy\",\n    \"Mono biologic\",\n    \"Combo therapy\"\n  )\n)\n\ndrugs &lt;- merge(drugs, demo[, c(\"ParticipantNo\", \"cat\", \"diagnosis2\")], by = \"ParticipantNo\")\ncolnames(drugs)[5] &lt;- \"Treatment\"\n\n\nFor IBD treatment, subjects are categorised as being on either a 5-ASA, mono immunotherapy, mono biologic, or immuno-biologic combination treatment strategy based upon REDCap data provided by participants’ IBD care teams.\nTreatments. in REDCap were selected via check boxes. As such, NA (unticked) is assumed to mean the participant is not on a given medication.\nImmunosuppressants are defined as:\n\nAzathioprine\nMercaptopurine\nMethotrexate\nCiclosporin\n\nBiologics are defined as:\n\nInfliximab\nAdalimumab\nGolimumab\nVedolizumab\nUstekinumab\n\nPatients are only categorised as receiving a 5-ASA treatment plan if 5-ASA is the only IBD treatment they are receiving (I.E no immunotherapy or biologics).\nAs should be expected given poor efficacy in CD, a 5-ASA treatment strategy is much more common for UC/IBDU participants (Figure 7). Mono biologic therapy is the most common treatment strategy for CD subjects.\n\nCodeplt.cols &lt;- c(\"#52528C\", \"#DD6E42\", \"#048A81\", \"#C585B3\")\n\n\np &lt;- drugs %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Treatment, fill = Treatment, color = Treatment)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  xlab(\"Treatment strategy\") +\n  ylab(\"Frequency\") +\n  scale_fill_manual(values = plt.cols, na.value = \"#032B43\") +\n  scale_colour_manual(\n    values = colorspace::darken(plt.cols, 0.3),\n    na.value = \"#032B43\"\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\nggsave(\"plots/baseline/treat_strat.pdf\" , p, width = 10, height = 8)\nggsave(\"plots/baseline/treat_strat.png\" , p, width = 10, height = 8)\np\n\n\n\n\n\n\nFigure 7: Reported treatment strategies for the FC cohort.\n\n\n\n\n\nCodepander(with(subset(drugs, diagnosis2 == \"CD\"), chisq.test(Treatment, cat)))\n\n\nTable 12: Chi-squared test between treatment strategy and FC groups for participants with Crohn’s disease.\n\n\n\nPearson’s Chi-squared test: Treatment and cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.828\n6\n0.4427\n\n\n\n\n\n\n\n\nCodepander(with(subset(drugs, diagnosis2 == \"UC/IBDU\"), chisq.test(Treatment, cat)))\n\n\nTable 13: Chi-squared test between treatment strategy and FC groups for participants with Ulcerative colitis/IBDU.\n\n\n\nPearson’s Chi-squared test: Treatment and cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n9.163\n6\n0.1646\n\n\n\n\n\n\n\nCurrent medications\n\nCodefindCurrent &lt;- function(x) {\n  sum(x == 1)\n}\n\n\ndrug.cols &lt;- c(\"participantno\",\n               \"curr_on_mesa\",\n               \"curr_on_aza\",\n               \"curr_on_merc\",\n               \"curr_on_metho\",\n               \"curr_on_ciclo\",\n               \"curr_on_inflix\",\n               \"curr_on_ada\",\n               \"curr_on_goli\",\n               \"curr_on_vedo\",\n               \"curr_on_ust\")\n\ndrug.tab &lt;- redcap[, drug.cols]\n\ndrug.available &lt;- c()\nfor (i in 1:nrow(drug.tab)) {\n  if (any(drug.tab[i, -1] != 0)) {\n    drug.available &lt;- c(drug.available, \"yes\")\n  } else(drug.available &lt;- c(drug.available, \"no\"))\n}\n\ndrug.tab$available &lt;- drug.available\n\n\nWhole cohort\n\nCodedrug.tab.cd &lt;- subset(drug.tab,\n                     participantno %in%\n                       subset(demo, diagnosis2 == \"CD\")$ParticipantNo)\ndrug.tab.uc &lt;- subset(drug.tab,\n                     participantno %in%\n                       subset(demo, diagnosis2 == \"UC/IBDU\")$ParticipantNo)\n\n\n\n\ncd.rx.counts &lt;- sapply(drug.tab.cd[, -1], findCurrent) \nuc.rx.counts &lt;- sapply(drug.tab.uc[, -1], findCurrent) \n\nrx.counts &lt;- cbind(cd.rx.counts, uc.rx.counts)\nrx.counts &lt;- rx.counts[-nrow(rx.counts), ] # remove available row \nrownames(rx.counts) &lt;- c(\"5-ASA\",\n                         \"Azathioprine\",\n                         \"Mercaptopurine\",\n                         \"Methotrexate\",\n                         \"Ciclosporin\",\n                         \"Infliximab\",\n                         \"Adalimumab\",\n                         \"Golimumab\",\n                         \"Vedolizumab\",\n                         \"Ustekinumab\")\ncolnames(rx.counts) &lt;- c(\"Crohn's disease\",\n                         \"Ulcerative colitis/IBDU\")\n\n\nknitr::kable(rx.counts)\n\n\n\n\nCrohn’s disease\nUlcerative colitis/IBDU\n\n\n\n5-ASA\n89\n551\n\n\nAzathioprine\n325\n218\n\n\nMercaptopurine\n93\n64\n\n\nMethotrexate\n61\n14\n\n\nCiclosporin\n1\n1\n\n\nInfliximab\n286\n104\n\n\nAdalimumab\n164\n29\n\n\nGolimumab\n0\n6\n\n\nVedolizumab\n65\n102\n\n\nUstekinumab\n14\n3\n\n\n\n\n\nFC cohort\n\nCodefc.ids &lt;- demo %&gt;%\n  filter(!is.na(cat)) %&gt;%\n  pull(ParticipantNo)\n\n\ndrug.tab.fc &lt;- subset(drug.tab,\n                      participantno %in% fc.ids)\n\ndrug.tab.fc.cd &lt;- subset(drug.tab.fc,\n                     participantno %in%\n                       subset(demo, diagnosis2 == \"CD\")$ParticipantNo)\ndrug.tab.fc.uc &lt;- subset(drug.tab.fc,\n                     participantno %in%\n                       subset(demo, diagnosis2 == \"UC/IBDU\")$ParticipantNo)\n\n\n\n\ncd.rx.counts &lt;- sapply(drug.tab.fc.cd[, -1], findCurrent) \nuc.rx.counts &lt;- sapply(drug.tab.fc.uc[, -1], findCurrent) \n\nrx.counts &lt;- cbind(cd.rx.counts, uc.rx.counts)\nrx.counts &lt;- rx.counts[-nrow(rx.counts), ] # remove available row\nrownames(rx.counts) &lt;- c(\"5-ASA\",\n                         \"Azathioprine\",\n                         \"Mercaptopurine\",\n                         \"Methotrexate\",\n                         \"Ciclosporin\",\n                         \"Infliximab\",\n                         \"Adalimumab\",\n                         \"Golimumab\",\n                         \"Vedolizumab\",\n                         \"Ustekinumab\")\ncolnames(rx.counts) &lt;- c(\"Crohn's disease\",\n                         \"Ulcerative colitis/IBDU\")\n\nknitr::kable(rx.counts)\n\n\n\n\nCrohn’s disease\nUlcerative colitis/IBDU\n\n\n\n5-ASA\n75\n436\n\n\nAzathioprine\n270\n177\n\n\nMercaptopurine\n78\n51\n\n\nMethotrexate\n52\n12\n\n\nCiclosporin\n1\n1\n\n\nInfliximab\n241\n87\n\n\nAdalimumab\n137\n21\n\n\nGolimumab\n0\n5\n\n\nVedolizumab\n55\n90\n\n\nUstekinumab\n10\n3\n\n\n\n\n\nFFQ Cohort\n\nCodeFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\nFFQ &lt;- FFQ %&gt;%\n  filter(!is.na(fibre))\n\nffq.ids &lt;- fc.ids[fc.ids %in% FFQ$participantno]\n\n\n\n\ndrug.tab.ffq &lt;- subset(drug.tab,\n                      participantno %in% ffq.ids)\n\ndrug.tab.ffq.cd &lt;- subset(drug.tab.ffq,\n                     participantno %in%\n                       subset(demo, diagnosis2 == \"CD\")$ParticipantNo)\ndrug.tab.ffq.uc &lt;- subset(drug.tab.ffq,\n                     participantno %in%\n                       subset(demo, diagnosis2 == \"UC/IBDU\")$ParticipantNo)\n\n\n\n\ncd.rx.counts &lt;- sapply(drug.tab.ffq.cd[, -1], findCurrent) \nuc.rx.counts &lt;- sapply(drug.tab.ffq.uc[, -1], findCurrent) \n\nrx.counts &lt;- cbind(cd.rx.counts, uc.rx.counts)\nrx.counts &lt;- rx.counts[-nrow(rx.counts), ] # remove available row\nrownames(rx.counts) &lt;- c(\"5-ASA\",\n                         \"Azathioprine\",\n                         \"Mercaptopurine\",\n                         \"Methotrexate\",\n                         \"Ciclosporin\",\n                         \"Infliximab\",\n                         \"Adalimumab\",\n                         \"Golimumab\",\n                         \"Vedolizumab\",\n                         \"Ustekinumab\")\ncolnames(rx.counts) &lt;- c(\"Crohn's disease\",\n                         \"Ulcerative colitis/IBDU\")\n\nknitr::kable(rx.counts)\n\n\n\n\nCrohn’s disease\nUlcerative colitis/IBDU\n\n\n\n5-ASA\n30\n223\n\n\nAzathioprine\n111\n79\n\n\nMercaptopurine\n32\n23\n\n\nMethotrexate\n16\n4\n\n\nCiclosporin\n0\n0\n\n\nInfliximab\n81\n27\n\n\nAdalimumab\n69\n13\n\n\nGolimumab\n0\n4\n\n\nVedolizumab\n19\n29\n\n\nUstekinumab\n3\n2\n\n\n\n\n\nBio-naive status\n\nCodebio.naive &lt;- data.frame(ParticipantNo = redcap$participantno)\nbio.naive &lt;- subset(bio.naive, ParticipantNo %in% demo$ParticipantNo)\nbio.naive &lt;- merge(bio.naive,\n  demo[, c(\"ParticipantNo\", \"diagnosis\")],\n  all.y = TRUE,\n  all.x = FALSE\n)\nbio.naive &lt;- distinct(bio.naive, ParticipantNo, .keep_all = TRUE)\nbio.naive$naive &lt;- \"yes\"\n\nbio.vars &lt;- c(\"inflix\", \"ada\", \"goli\", \"vedo\", \"ust\")\n\nfor (i in 1:nrow(bio.naive)) {\n  temp.df &lt;- as.data.frame(subset(redcap, participantno == bio.naive[i, 1]))\n  temp.df &lt;- temp.df[, paste0(\"curr_on_\", bio.vars)]\n  temp.df &lt;- temp.df[, !is.na(temp.df[1, ])]\n\n  if (any(temp.df == 1)) {\n    bio.naive[i, \"naive\"] &lt;- \"no-using\"\n  } else if (any(temp.df == 2)) {\n    bio.naive[i, \"naive\"] &lt;- \"no-not-using\"\n  } # else naive\n}\n\ndrugs.eof &lt;- read_xlsx(paste0(prefix, \"EOF_drugs.xlsx\"))\nusing &lt;- subset(drugs.eof, AtRecruitmentYN == 1)\nbio.list &lt;- seq(4, 8)\nusing &lt;- subset(using, DrugType %in% bio.list)\nusing &lt;- subset(demo, ParticipantId %in% using$ParticipantId)\nusing &lt;- using[, c(\"ParticipantNo\", \"diagnosis\")]\nusing$naive &lt;- c(\"no-using\")\n\ndrugs &lt;- rbind(bio.naive, using)\n\nfor (i in unique(drugs$ParticipantNo)) {\n  temp &lt;- subset(drugs, ParticipantNo == i)\n  # if \"no-using\" in either extract then report using\n  if (nrow(temp) &gt; 1) {\n    if (any(temp$naive == \"no-using\")) {\n      drugs &lt;- subset(drugs, ParticipantNo != i)\n      drugs &lt;- rbind(\n        drugs,\n        data.frame(\n          ParticipantNo = i,\n          diagnosis = temp[1, \"diagnosis\"],\n          naive = \"no-using\"\n        )\n      )\n    }\n  }\n}\n\ndrugs &lt;- distinct(drugs, ParticipantNo, .keep_all = TRUE)\n\ndemo &lt;- merge(demo,\n  drugs[, c(1, 3)],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo$naive &lt;- factor(demo$naive,\n  levels = c(\"no-using\", \"no-not-using\", \"yes\"),\n  labels = c(\"Current\", \"Previously\", \"Never prescribed\")\n)\n\ncolnames(demo)[colnames(demo) == \"naive\"] &lt;- \"Biologic\"\n\n\nBio-naive status has been determined using REDCap and EoS data. As clinical teams were not explicitly asked if a subject was bio-naive, the subject is instead defined as being bio-naive if there are no recorded biologics for the subject (which may bias subjects with missing data towards incorrectly being reported as bio-naive). Non bio-naive subjects are categorised further into either “currently using” or “previously used”.\nBiologic treatments are defined as infliximab, adalimumab, golimumab, vedolizumab, and ustekinumab.\nSmall molecule treatments are not considered in this report due to their low prescribing rates during the recruitment period (which ended March 2020).\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Biologic, fill = Biologic, color = Biologic)) +\n  geom_bar() +\n  xlab(\"Biologic status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  scale_fill_manual(values = c(\"#CACF85\", \"#8CBA80\", \"#E58F65\")) +\n  scale_color_manual(values = c(\"#747825\", \"#4A6E3F\", \"#934D1B\")) +\n  guides(\n    fill = guide_legend(title = \"Biologic status\"),\n    color = guide_legend(title = \"Biologic status\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 8: Bio-naivety in the FC cohort.\n\n\n\n\nBio-naive status was found to be associated with FC groups which may be due to patients with more active disease being more likely to be prescribed a biologic.\n\nCodepander(chisq.test(demo$Biologic, demo$cat))\n\n\nTable 14: Chi-squared test between bio-naive status and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Biologic and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n16.51\n4\n0.002406 * *",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#smoking",
    "href": "Baseline/IBD.html#smoking",
    "title": "Inflammatory bowel disease",
    "section": "Smoking",
    "text": "Smoking\n\nCodesmoking &lt;- read_xlsx(paste0(data.path, \"Baseline2022/lifestyle.xlsx\")) %&gt;%\n  select(ParticipantNo, Smoke, SmokedInPast)\nsmoking$Smoke &lt;- plyr::mapvalues(smoking$Smoke, from = 2, to = 3)\n\nfor (i in 1:nrow(smoking)) {\n  if ((!is.na(smoking[i, \"SmokedInPast\"]) & smoking[i, \"SmokedInPast\"] == 1) & (!is.na(smoking[i, \"Smoke\"]) & smoking[i, \"Smoke\"] == 3)) {\n    smoking[i, \"Smoke\"] &lt;- 2\n  }\n}\n\nsmoking$Smoke &lt;- factor(smoking$Smoke,\n  levels = seq(1, 3),\n  labels = c(\"Current\", \"Previous\", \"Never\")\n)\n\nsmoking &lt;- smoking[, -3]\n\n\ndemo &lt;- merge(demo,\n  smoking,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\nesmoking &lt;- read_xlsx(paste0(data.path, \"Baseline2022/lifestyle.xlsx\")) %&gt;%\n  select(ParticipantNo, ECigs, ECigsPast)\nesmoking$ECigs &lt;- plyr::mapvalues(esmoking$ECigs, from = 2, to = 3)\n\nfor (i in 1:nrow(esmoking)) {\n  if ((!is.na(esmoking[i, \"ECigsPast\"] == 1) & esmoking[i, \"ECigsPast\"] == 1) &\n      (!is.na(esmoking[i, \"ECigs\"]) & esmoking[i, \"ECigs\"] == 3)) {\n    esmoking[i, \"ECigs\"] &lt;- 2\n  }\n}\n\nesmoking$ECigs &lt;- factor(esmoking$ECigs,\n  levels = seq(1, 3),\n  labels = c(\"Current\", \"Previous\", \"Never\")\n)\n\nesmoking &lt;- esmoking[, -3]\n\n\ndemo &lt;- merge(demo,\n  esmoking,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Smoke, fill = Smoke, color = Smoke)) +\n  geom_bar() +\n  xlab(\"Smoking status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Smoking status\"),\n    color = guide_legend(title = \"Smoking status\")\n  )\n\n\n\n\n\n\nFigure 9: Smoking status for subjects in the FC cohort.\n\n\n\n\nSmoking status is not associated with FC at recruitment across the entire FC cohort.\n\nCodepander(chisq.test(demo$Smoke, demo$cat))\n\n\nTable 15: Chi-squared test between between smoking status and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Smoke and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n8.662\n4\n0.07013",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#e-cigarette-use",
    "href": "Baseline/IBD.html#e-cigarette-use",
    "title": "Inflammatory bowel disease",
    "section": "E-cigarette use",
    "text": "E-cigarette use\nThe vast majority of participants do not report using some form of e-cigarettes. It should be noted that as recruitment ended March 2020, these day may not reflect more modern trends.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = ECigs, fill = ECigs, color = ECigs)) +\n  geom_bar() +\n  xlab(\"E-cigarette status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"E-cigarette status\"),\n    color = guide_legend(title = \"E-cigarette status\")\n  )\n\n\n\n\n\n\nFigure 10: E-cigarette usage for subjects in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo.cd$ECigs, demo.cd$cat))\n\n\nTable 16: Chi-squared test between between E-cigarettte usage and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$ECigs and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.96\n4\n0.2022",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#variables-only-relevant-to-crohns-disease-subjects",
    "href": "Baseline/IBD.html#variables-only-relevant-to-crohns-disease-subjects",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to Crohn’s disease subjects",
    "text": "Variables only relevant to Crohn’s disease subjects\nThis section looks at data only applicable to subjects with CD. The following variables are considered: surgery, Montreal location, Montreal behaviour, Harvey-Bradshaw index, and smoking.\nSurgery\n\nCodepredicct.surgery &lt;- read_xlsx(paste0(\n  data.path,\n  \"Baseline2022/IBD.xlsx\"\n))[, c(\"ParticipantNo\", \"HadSurgeryForIBD\")]\ncolnames(predicct.surgery)[2] &lt;- \"Surgery\"\n\n\nredcap.surgery &lt;- redcap[, c(\"participantno\", \"surgery\")]\n\n\nnames(redcap.surgery) &lt;- c(\"ParticipantNo\", \"Surgery\")\n\nsurgery &lt;- rbind(redcap.surgery, predicct.surgery)\nsurgery &lt;- subset(surgery, !is.na(surgery$Surgery))\n\n# As REDCap is first, this will be prioritised over subject (if not NA)\nsurgery &lt;- distinct(surgery, ParticipantNo, .keep_all = TRUE)\n\ndemo.cd &lt;- subset(demo, diagnosis2 == \"CD\")\ndemo.cd &lt;- merge(demo.cd, surgery, all.x = TRUE, all.y = FALSE)\ndemo.cd$Surgery &lt;- factor(demo.cd$Surgery,\n  levels = c(2, 1),\n  labels = c(\"No\", \"Yes\")\n)\n\n\nSurgical data has been obtained from both REDCap and patient-completed questionnaires. Where data are available from both data sources, REDCap is the preferred data source.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Surgery, fill = Surgery, color = Surgery)) +\n  geom_bar() +\n  xlab(\"Previous surgery\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#F9B9B7\", \"#96C9DC\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#D06965\", \"#448CA2\"), na.value = \"#032B43\")\n\n\n\n\n\n\nFigure 11: Previous surgery for Crohn’s disease subjects in the FC cohort.\n\n\n\n\nFC at study recruitment is significantly associated with having previously undergone surgery for CD.\n\nCodepander(chisq.test(demo.cd$Surgery, demo.cd$cat))\n\n\nTable 17: Chi-squared test between previous surgery and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$Surgery and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n7.389\n2\n0.02486 *\n\n\n\n\n\n\n\nMontreal location\n\nCodemapping &lt;- data.frame(\n  code = seq(1, 6),\n  definition = c(\n    \"Oesophago-gastric\",\n    \"Duodenal\",\n    \"Jejunal\",\n    \"Ileal\",\n    \"Colonic\",\n    \"Rectal\"\n  )\n)\n\ncd.location &lt;- redcap[, c(\"participantno\", paste0(\"mac_extent___\", 1:6))]\nL4 &lt;- rep(0, nrow(cd.location))\nLocation &lt;- rep(NA, nrow(cd.location))\n\nfor (i in 1:nrow(cd.location)) {\n  # If Oesophago-gastric, Duodenal, Jejunal, then L4 is present\n  if (any(cd.location[i, 2:4] == 1)) L4[i] &lt;- 1\n  if (cd.location[i, 5] == 1 & cd.location[i, 6] == 1) {\n    Location[i] &lt;- 3 # Ileal-colonic\n  } else if (cd.location[i, 5] == 1 & cd.location[i, 6] == 0) {\n    Location[i] &lt;- 1 # Ileal only\n  } else if (cd.location[i, 5] == 0 & cd.location[i, 6] == 1) {\n    Location[i] &lt;- 2 # Colonic only\n  }\n  if (is.na(Location[i]) & L4[i] == 1) {\n    Location[i] &lt;- 4 # L4 Only\n  }\n}\n\nL4[is.na(Location) & L4 == 0] &lt;- NA\n\nmont.df &lt;- data.frame(\n  cd.location[, \"participantno\"],\n  Location,\n  L4\n)\ncolnames(mont.df)[1] &lt;- \"ParticipantNo\"\ndemo.cd &lt;- merge(demo.cd, mont.df,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.cd$Location &lt;- factor(demo.cd$Location,\n  levels = c(1, 2, 3, 4),\n  labels = c(\"L1\", \"L2\", \"L3\", \"L4 only\")\n)\n\ndemo.cd$L4 &lt;- factor(demo.cd$L4,\n  levels = c(0, 1),\n  labels = c(\"Not present\", \"Present\")\n)\n\n\nMontreal location has been obtained from REDcap data. Rather than being asked for Montreal location directly, clinical teams were asked to provide more granular detail by ticking boxes if inflammation was in any of the following areas Oesophago-gastric, Duodenal, Jejunal, Ileal, Colonic, Rectal. If only any of the first 3 were reported then the subject was assigned “L4 only”. L1-L3 were assigned as per convention (Silverberg et al. 2005). If no location was reported then location was assigned NA.\nAs can be seen in Figure 12, L3 is the most common Montreal location in this cohort with roughly an equal amount of subjects having either L1 or L2.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Location, fill = Location, color = Location)) +\n  geom_bar() +\n  xlab(\"Montreal location\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#33CA7F\", \"#96C9DC\", \"#C33C54\", \"#FCB97D\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#318859\", \"#448CA2\", \"#80333E\", \"#BD7700\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Montreal location\"),\n    color = guide_legend(title = \"Montreal location\")\n  )\n\n\n\n\n\n\nFigure 12: Montreal location for CD subjects in the FC cohort.\n\n\n\n\nDue to the low number of subjects with L4-only, Fisher’s exact test has been used to compare with FC.\n\nCodepander(fisher.test(demo.cd$Location, demo.cd$cat, workspace = 20000000))\n\n\nTable 18: Fisher’s exact test between Montreal location and FC groups.\n\n\n\nFisher’s Exact Test for Count Data: demo.cd$Location and demo.cd$cat\n\n\n\n\n\n\nP value\nAlternative hypothesis\n\n\n0.6059\ntwo.sided\n\n\n\n\n\n\n\nIn addition to L4-only being considered, we also investigate L4 as a modifier.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = L4, fill = L4, color = L4)) +\n  geom_bar() +\n  xlab(\"Presence of L4\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#51E5FF\", \"#EC368D\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#079DB1\", \"#AF0863\"), na.value = \"#032B43\") +\n  guides(\n    fill = guide_legend(title = \"Presence of L4\"),\n    color = guide_legend(title = \"Presence of L4\")\n  )\n\n\n\n\n\n\nFigure 13: L4 (upper GI involvement) in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo.cd$L4, demo.cd$cat))\n\n\nTable 19: Chi-squared test between L4 and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$L4 and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.611\n2\n0.06047\n\n\n\n\n\n\n\nMontreal behaviour\n\nCodecd.behaviour &lt;- redcap[, c(\"participantno\", \"behaviour\", \"perianal\")]\ncolnames(cd.behaviour) &lt;- c(\"ParticipantNo\", \"Behaviour\", \"Perianal\")\ncd.behaviour$Perianal[!is.na(cd.behaviour$Perianal) & cd.behaviour$Perianal == 3] &lt;- NA\n\n\ndemo.cd &lt;- merge(demo.cd,\n  cd.behaviour,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.cd$Behaviour &lt;- factor(demo.cd$Behaviour,\n  levels = c(1, 2, 3),\n  labels = c(\"B1\", \"B2\", \"B3\")\n)\n\n\nMontreal behaviour has been obtained from REDCap data and was recorded conventionally. The majority of CD subjects have the B1 (inflammatory) phenotype.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Behaviour, fill = Behaviour, color = Behaviour)) +\n  geom_bar() +\n  xlab(\"Montreal behaviour\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#7AE7C7\", \"#440381\", \"#D64045\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#07A282\", \"#340165\", \"#942E31\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Montreal behaviour\"),\n    color = guide_legend(title = \"Montreal behaviour\")\n  )\n\n\n\n\n\n\nFigure 14: Montreal behaviour for CD subjects in the FC cohort.\n\n\n\n\nMontreal behaviour is not significantly associated with FC at recruitment.\n\nCodepander(chisq.test(demo.cd$Behaviour, demo.cd$cat))\n\n\nTable 20: Chi-squared test between Montreal behaviour and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$Behaviour and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.136\n4\n0.2736\n\n\n\n\n\n\n\nApproximately a third of CD subjects are reported to have perianal disease.\n\nCodedemo.cd$Perianal &lt;- factor(demo.cd$Perianal,\n  levels = c(2, 1),\n  labels = c(\"No\", \"Yes\")\n)\n\ndemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Perianal, fill = Perianal, color = Perianal)) +\n  geom_bar() +\n  xlab(\"Perianal disease\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#023C40\", \"#AF5B5B\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#002C30\", \"#754242\"), na.value = \"#032B43\") +\n  guides(\n    fill = guide_legend(title = \"Perianal disease\"),\n    color = guide_legend(title = \"Perianal disease\")\n  )\n\n\n\n\n\n\nFigure 15: Perianal disease for CD subjects in the FC cohort.\n\n\n\n\nPerianal disease is not associated with FC at recruitment.\n\nCodepander(chisq.test(demo.cd$Perianal, demo.cd$cat))\n\n\nTable 21: Chi-squared test between between perianal disease and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$Perianal and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.305\n2\n0.5207\n\n\n\n\n\n\n\nHarvey-Bradshaw Index\n\nCodeHBI.df &lt;- redcap[, c(\"participantid\", \"current_hb\")]\ncolnames(HBI.df) &lt;- c(\"ParticipantId\", \"HBI\")\nHBI.df &lt;- subset(HBI.df, ParticipantId %in% demo.cd$ParticipantId)\n\ndemo.cd &lt;- merge(demo.cd, HBI.df, by = \"ParticipantId\", all.x = TRUE)\n\ntemp &lt;- demo.cd %&gt;%\n  drop_na(cat)\npercHBI &lt;- round(sum(is.na(temp$HBI)) / nrow(temp), 2) * 100\n\n\nWhilst HBI was collected via REDCap, substantial missingness is observed with 60% of CD subjects in the FC sub-cohort missing HBI.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = as.factor(HBI))) +\n  geom_bar(fill = \"#A167A5\", color = \"#4A306D\") +\n  theme_minimal() +\n  ylab(\"Frequency\") +\n  xlab(\"Harvey-Bradshaw index at time of recruitment\")\n\n\n\n\n\n\nFigure 16: Harvey-Bradshaw index for CD subjects in the FC cohort.\n\n\n\n\n\nCodepander(summary(aov(HBI ~ cat, data = demo.cd)))\n\n\nTable 22: ANOVA between between Harvey-Bradshaw index and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n13.1\n6.548\n1.174\n0.3102\n\n\nResiduals\n441\n2461\n5.579\nNA\nNA\n\n\n\n\n\n\n\n\nPRO-2 in Crohn’s disease\nSum of liquid stools per day and abdominal pain.\n\nCodePRO2 &lt;- redcap[, c(\"participantno\", \"liq_stool_day\", \"abdo_pain\")]\nPRO2$liq_stool_day &lt;- as.numeric(PRO2$liq_stool_day) # Drop ileostomies\n\nPRO2$PRO2 &lt;- with(PRO2, liq_stool_day + abdo_pain)\n\nPRO2$ParticipantNo &lt;- PRO2$participantno\ndemo.cd &lt;- merge(demo.cd,\n  PRO2[, c(\"ParticipantNo\", \"PRO2\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.cd %&gt;%\n  ggplot(aes(x = as.factor(PRO2))) +\n  geom_bar(fill = \"#FF8552\", color = \"#D2632A\") +\n  scale_fill_manual(na.value = \"#032B43\") +\n  scale_color_manual(na.value = \"#032B43\") +\n  theme_minimal()\n\n\n\n\n\n\n\n\nCodepander(summary(aov(PRO2 ~ cat, data = demo.cd)))\n\n\nTable 23: ANOVA between between PRO2 and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n4.8\n2.4\n0.6194\n0.5386\n\n\nResiduals\n669\n2592\n3.875\nNA\nNA\n\n\n\n\n\n\n\n\nSmoking\n\nCodepercPrev &lt;- round(sum(temp$Smoke == \"Previous\", na.rm = TRUE) / nrow(temp), 2) * 100\n\n\nWe consider smoking for CD and UC separately as smoking is often reported to worsen outcomes in CD but is possibly protective in UC. Smoking status is self-reported by study participants.\nWhilst most subjects have never been a smoker, a substantial proportion of subjects (27%) have previously been smokers.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Smoke, fill = Smoke, color = Smoke)) +\n  geom_bar() +\n  xlab(\"Smoking status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Smoking status\"),\n    color = guide_legend(title = \"Smoking status\")\n  )\n\n\n\n\n\n\nFigure 17: Smoking status for CD subjects in the FC cohort.\n\n\n\n\nSmoking status is associated with FC at recruitment for CD subjects.\n\nCodepander(chisq.test(demo.cd$Smoke, demo.cd$cat))\n\n\nTable 24: Chi-squared test between between smoking status and FC groups for CD subjects.\n\n\n\nPearson’s Chi-squared test: demo.cd$Smoke and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n11.08\n4\n0.02572 *\n\n\n\n\n\n\n\nE-cigarette use\nThe vast majority of participants do not report using some form of e-cigarettes. It should be noted that as recruitment ended March 2020, these day may not reflect more modern trends.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = ECigs, fill = ECigs, color = ECigs)) +\n  geom_bar() +\n  xlab(\"E-cigarette status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"E-cigarette status\"),\n    color = guide_legend(title = \"E-cigarette status\")\n  )\n\n\n\n\n\n\nFigure 18: E-cigarette usage for CD subjects in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo.cd$ECigs, demo.cd$cat))\n\n\nTable 25: Chi-squared test between between E-cigarettte usage and FC groups for CD subjects.\n\n\n\nPearson’s Chi-squared test: demo.cd$ECigs and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.96\n4\n0.2022",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#variables-only-relevant-to-ulcerative-colitisibdu-subjects",
    "href": "Baseline/IBD.html#variables-only-relevant-to-ulcerative-colitisibdu-subjects",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to ulcerative colitis/IBDU subjects",
    "text": "Variables only relevant to ulcerative colitis/IBDU subjects\nThis section looks at variables only relevant to UC/IBDU subjects: Montreal extent, Mayo score, Smoking status and E-cigarette use.\nAs PREdiCCt required subjects to be able to flare, this effectively excluded UC subjects who had undergone a proctocolectomy. As such, previous surgery is not considered. Montreal severity was not collected by PREdiCCt.\nMontreal extent\n\nCodemapping &lt;- data.frame(\n  code = seq(1, 6),\n  definition = c(\n    \"Rectum\",\n    \"Recto-sigmoid\",\n    \"&lt; Splenic\",\n    \"&lt; Hepatic\",\n    \"Total\",\n    \"Unknown\"\n  ),\n  mont = c(1, 2, 2, 3, 3, NA)\n)\n\ndemo.uc &lt;- subset(demo, diagnosis2 == \"UC/IBDU\")\nredcap.uc &lt;- subset(redcap, participantno %in% demo.uc$ParticipantNo)\nnames(redcap.uc)[names(redcap.uc) == \"participantno\"] &lt;- \"ParticipantNo\"\nredcap.uc &lt;- redcap.uc[, c(\"ParticipantNo\", \"max_extent\")]\nredcap.uc$Extent &lt;- mapvalues(redcap.uc$max_extent,\n  from = mapping$code,\n  to = mapping$mont\n)\n\ndemo.uc &lt;- merge(demo.uc,\n  redcap.uc[, c(\"ParticipantNo\", \"Extent\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\ndemo.uc$Extent &lt;- factor(demo.uc$Extent,\n  levels = seq(1, 3),\n  labels = c(\"E1\", \"E2\", \"E3\")\n)\n\n\nMontreal extent has been obtained from REDCap. Similar to Montreal location, the extent of inflammation has been reported in more granular detail than is required for the Montreal classification. The below table shows how these definitions have been mapped to Montreal extent.\n\nCodekable(mapping,\n  col.names = c(\"Coding\", \"Definition\", \"Montreal extent\"),\n  align = c(\"l\", \"c\", \"c\")\n)\n\n\n\nCoding\nDefinition\nMontreal extent\n\n\n\n1\nRectum\n1\n\n\n2\nRecto-sigmoid\n2\n\n\n3\n&lt; Splenic\n2\n\n\n4\n&lt; Hepatic\n3\n\n\n5\nTotal\n3\n\n\n6\nUnknown\nNA\n\n\n\n\n\nAs can be seen in Figure 19 E2 is the most common Montreal extent classification.\n\nCodedemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Extent, fill = Extent, color = Extent)) +\n  geom_bar() +\n  xlab(\"Montreal extent\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#7AE7C7\", \"#440381\", \"#D64045\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#07A282\", \"#340165\", \"#942E31\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Montreal extent\"),\n    color = guide_legend(title = \"Montreal extent\")\n  )\n\n\n\n\n\n\nFigure 19: Montreal extent for UC/IBDU subjects in the FC cohort.\n\n\n\n\nMontreal extent is not associated with FC\n\nCodepander(chisq.test(demo.uc$Extent, demo.uc$cat))\n\n\nTable 26: Chi-squared test between Montreal extent and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.uc$Extent and demo.uc$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.281\n4\n0.6842\n\n\n\n\n\n\n\nMayo score\nMayo score was collected via REDCap and is more complete than HBI.\n\nCodemayo.df &lt;- redcap[, c(\"participantid\", \"current_mayo\")]\ncolnames(mayo.df) &lt;- c(\"ParticipantId\", \"Mayo\")\nmayo.df &lt;- subset(mayo.df, ParticipantId %in% demo.uc$ParticipantId)\n\ndemo.uc &lt;- merge(demo.uc, mayo.df, by = \"ParticipantId\", all.x = TRUE)\ndemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = as.factor(Mayo))) +\n  geom_bar(fill = \"#284B63\", color = \"#153243\") +\n  theme_minimal() +\n  ylab(\"Frequency\") +\n  xlab(\"Mayo score at time of recruitment\")\n\n\n\n\n\n\nFigure 20\n\n\n\n\nMayo score is highly significantly associated with FC.\n\nCodepander(summary(aov(Mayo ~ cat, data = demo.uc)))\n\n\nTable 27: ANOVA between between Mayo score and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n25.2\n12.6\n8.212\n0.0002973\n\n\nResiduals\n732\n1123\n1.534\nNA\nNA\n\n\n\n\n\n\n\n\nPRO-2 in ulcerative colitis\nSum of stool frequency and rectal bleeding categories.\n\nCodePRO2 &lt;- redcap[, c(\"participantno\", \"stool_freq\", \"rectal_bleed\")]\n\nPRO2$PRO2 &lt;- with(PRO2, stool_freq + rectal_bleed)\n\nPRO2$ParticipantNo &lt;- PRO2$participantno\ndemo.uc &lt;- merge(demo.uc,\n  PRO2[, c(\"ParticipantNo\", \"PRO2\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.uc %&gt;%\n  ggplot(aes(x = as.factor(PRO2), fill = diagnosis2, color = diagnosis2)) +\n  geom_bar() +\n  scale_fill_manual(values = \"#FF8552\", na.value = \"#032B43\") +\n  scale_color_manual(values = \"#D2632A\", na.value = \"#032B43\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\nCodepander(summary(aov(PRO2 ~ cat, data = demo.uc)))\n\n\nTable 28: ANOVA between between PRO2 and FC groups in ulcerative colitis/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n7.752\n3.876\n5.049\n0.006645\n\n\nResiduals\n728\n558.9\n0.7678\nNA\nNA\n\n\n\n\n\n\n\n\nSmoking\nAs with CD subjects, smoking status for UC/IBDU subjects is self-reported.\n\nCodedemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Smoke, fill = Smoke, color = Smoke)) +\n  geom_bar() +\n  xlab(\"Smoking status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Smoking status\"),\n    color = guide_legend(title = \"Smoking status\")\n  )\n\n\n\n\n\n\nFigure 21: Smoking status for UC/IBDU subjects in the FC cohort.\n\n\n\n\nAs with CD, smoking status is significantly associated with FC.\n\nCodepander(chisq.test(demo.uc$Smoke, demo.uc$cat))\n\n\nTable 29: Chi-squared test between between smoking status and FC groups for UC subjects.\n\n\n\nPearson’s Chi-squared test: demo.uc$Smoke and demo.uc$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n9.781\n4\n0.04427 *\n\n\n\n\n\n\n\nE-cigarette use\nSimilar to CD, very few subjects reported using E-cigarettes.\n\nCodedemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = ECigs, fill = ECigs, color = ECigs)) +\n  geom_bar() +\n  xlab(\"E-cigarette status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"E-cigarette status\"),\n    color = guide_legend(title = \"E-cigarette status\")\n  )\n\n\n\n\n\n\nFigure 22: E-cigarette usage for UC subjects in the FC cohort.\n\n\n\n\nE-cigarette use was found to significantly differ between FC groups in UC. However, the low number of subjects reported to use E-cigarettes (Figure 22) should be beared in mind when interpretting this finding.\n\nCodepander(fisher.test(demo.uc$ECigs, demo.uc$cat))\n\n\nTable 30: Chi-squared test between between E-cigarettte usage and FC groups for UC subjects.\n\n\n\nFisher’s Exact Test for Count Data: demo.uc$ECigs and demo.uc$cat\n\n\n\n\n\n\nP value\nAlternative hypothesis\n\n\n0.0196 *\ntwo.sided\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-IBD.RDS\"))\nsaveRDS(demo.cd, paste0(outdir, \"demo-cd.RDS\"))\nsaveRDS(demo.uc, paste0(outdir, \"demo-uc.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#reproducibility-reproduction",
    "href": "Baseline/IBD.html#reproducibility-reproduction",
    "title": "Inflammatory bowel disease",
    "section": "Reproducibility & reproduction",
    "text": "Reproducibility & reproduction\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): viridis(v.0.6.5), utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), gridExtra(v.2.3), fansi(v.1.0.6), viridisLite(v.0.4.2), scales(v.1.3.0), textshaping(v.0.4.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), ragg(v.1.3.2), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), systemfonts(v.1.1.0), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/Diet.html",
    "href": "Baseline/Diet.html",
    "title": "Diet",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  upf.path &lt;- \"data/final/20240924/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  upf.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20240924/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-biochem.RDS\"))\n\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\nFFQ$meat_overall &lt;- rowSums(FFQ[, paste0(\"meat7\", letters[1:12], \"_grams\")])\n\nFFQ$fish_overall &lt;- rowSums(FFQ[, paste0(\"fish8\", letters[1:13], \"_grams\")])\n\nFFQ$ParticipantNo &lt;- FFQ$participantno\ndemo &lt;- merge(demo,\n  FFQ[, c(\n    \"ParticipantNo\",\n    \"Meat_sum\",\n    \"meat_overall\",\n    \"fish_overall\",\n    \"fibre\",\n    \"PUFA_percEng\",\n    \"NOVAScore_cat\",\n    \"dqi_tot\"\n  )],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ncat_theme &lt;- function(gg) {\n  p &lt;- gg +\n    scale_fill_manual(values = c(\"#DA4167\", \"#F4D35E\", \"#083D77\")) +\n    scale_color_manual(values = colorspace::darken(c(\"#DA4167\",\n                                                     \"#F4D35E\",\n                                                     \"#083D77\"),\n                                                   0.2)\n                     ) +\n  theme_minimal()\n  p\n}\n\n\n\nCode# library(writexl)\n# FFQ &lt;- merge(FFQ,\n#  demo[, c(\"ParticipantNo\", \"FC\", \"Sex\", \"diagnosis2\")],\n#  by = \"ParticipantNo\",\n#  all.x = TRUE,\n#  all.y = FALSE\n# )\n\n# FFQ &lt;- subset(FFQ, !is.na(FC))\n# write_xlsx(FFQ, paste0(\"/Volumes/igmm/cvallejo-predicct/predicct/processed/\", \"FFQ-FC.xlsx\"))\n\n\nPREdiCCt has collected data on diet via food frequency questionnaires (FFQs) and food diaries. This dietary data has been analysed by staff at the University of Aberdeen, primarily by Dr Janet Kyle, Dr Graham Horgan, and Professor Alex Johnstone.\nWhilst data for many dietary variables have been collected, this report will focus on the data outlined in the SAP.\n\nProtein from animal-sources\nDietary fibre\nPolyunsaturated fatty acids (PUFAs)\nNova intake score\n\nThe data for these variables were extracted from the FFQs. As reported associations between dietary data and IBD are often specific to a form of IBD rather than IBD as a whole, these data will be presented stratified by disease type.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#introduction",
    "href": "Baseline/Diet.html#introduction",
    "title": "Diet",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  upf.path &lt;- \"data/final/20240924/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  upf.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20240924/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-biochem.RDS\"))\n\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\nFFQ$meat_overall &lt;- rowSums(FFQ[, paste0(\"meat7\", letters[1:12], \"_grams\")])\n\nFFQ$fish_overall &lt;- rowSums(FFQ[, paste0(\"fish8\", letters[1:13], \"_grams\")])\n\nFFQ$ParticipantNo &lt;- FFQ$participantno\ndemo &lt;- merge(demo,\n  FFQ[, c(\n    \"ParticipantNo\",\n    \"Meat_sum\",\n    \"meat_overall\",\n    \"fish_overall\",\n    \"fibre\",\n    \"PUFA_percEng\",\n    \"NOVAScore_cat\",\n    \"dqi_tot\"\n  )],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ncat_theme &lt;- function(gg) {\n  p &lt;- gg +\n    scale_fill_manual(values = c(\"#DA4167\", \"#F4D35E\", \"#083D77\")) +\n    scale_color_manual(values = colorspace::darken(c(\"#DA4167\",\n                                                     \"#F4D35E\",\n                                                     \"#083D77\"),\n                                                   0.2)\n                     ) +\n  theme_minimal()\n  p\n}\n\n\n\nCode# library(writexl)\n# FFQ &lt;- merge(FFQ,\n#  demo[, c(\"ParticipantNo\", \"FC\", \"Sex\", \"diagnosis2\")],\n#  by = \"ParticipantNo\",\n#  all.x = TRUE,\n#  all.y = FALSE\n# )\n\n# FFQ &lt;- subset(FFQ, !is.na(FC))\n# write_xlsx(FFQ, paste0(\"/Volumes/igmm/cvallejo-predicct/predicct/processed/\", \"FFQ-FC.xlsx\"))\n\n\nPREdiCCt has collected data on diet via food frequency questionnaires (FFQs) and food diaries. This dietary data has been analysed by staff at the University of Aberdeen, primarily by Dr Janet Kyle, Dr Graham Horgan, and Professor Alex Johnstone.\nWhilst data for many dietary variables have been collected, this report will focus on the data outlined in the SAP.\n\nProtein from animal-sources\nDietary fibre\nPolyunsaturated fatty acids (PUFAs)\nNova intake score\n\nThe data for these variables were extracted from the FFQs. As reported associations between dietary data and IBD are often specific to a form of IBD rather than IBD as a whole, these data will be presented stratified by disease type.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#protein-from-meat-sources",
    "href": "Baseline/Diet.html#protein-from-meat-sources",
    "title": "Diet",
    "section": "Protein from meat sources",
    "text": "Protein from meat sources\nFigure 1 suggests there are relatively few vegetarians in the PREdiCCt cohort. Whilst some extreme values were observed for protein from meat sources, they remain plausible.\n\nCodedemo %&gt;%\n  drop_na(Meat_sum) %&gt;%\n  ggplot(aes(x = Meat_sum, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Protein from meat sources (g)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 1: Distribution of protein intake from meat.\n\n\n\n\nNo association was observed between protein intake from meat and FC in either CD or UC.\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = Meat_sum ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 1: ANOVA between protein intake from meat and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n237.6\n118.8\n0.2419\n0.7852\n\n\nResiduals\n494\n242579\n491.1\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = Meat_sum ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 2: ANOVA between protein intake from meat and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n3350\n1675\n2.814\n0.06088\n\n\nResiduals\n512\n304730\n595.2\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#overall-meat-intake",
    "href": "Baseline/Diet.html#overall-meat-intake",
    "title": "Diet",
    "section": "Overall meat intake",
    "text": "Overall meat intake\n\nCodedemo %&gt;%\n  drop_na(meat_overall) %&gt;%\n  ggplot(aes(x = meat_overall, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Meat intake (g)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 2: Distribution of overall meat intake.\n\n\n\n\nNo association was observed between meat intake and FC in CD. However, a significant association was observed between meat intake and FC in UC/IBDU Table 4.\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = meat_overall ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 3: ANOVA between meat intake and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n730.4\n365.2\n0.05301\n0.9484\n\n\nResiduals\n494\n3403211\n6889\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = meat_overall ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 4: ANOVA between meat intake and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n69131\n34565\n4.373\n0.01309\n\n\nResiduals\n512\n4046939\n7904\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodep &lt;- demo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  drop_na(cat, meat_overall) %&gt;%\n  mutate(cat = fct_rev(cat)) %&gt;%\n  ggplot(aes(x = meat_overall, fill = cat, color = cat)) +\n  geom_density() +\n  facet_grid(rows = vars(cat)) +\n  labs(x = \"Meat intake\",\n       y = \"Density\",\n       fill = \"FC group\",\n       color = \"FC group\")\ncat_theme(p)\n\n\n\n\n\n\nFigure 3: Distribution of meat intake by FC in UC.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#overall-fish-intake",
    "href": "Baseline/Diet.html#overall-fish-intake",
    "title": "Diet",
    "section": "Overall fish intake",
    "text": "Overall fish intake\n\nCodedemo %&gt;%\n  drop_na(fish_overall) %&gt;%\n  ggplot(aes(x = fish_overall, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Fish intake (g)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 4: Distribution of overall fish intake.\n\n\n\n\nNo association was observed between meat intake and FC in CD. However, a significant association was observed between meat intake and FC in UC/IBDU Table 4.\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = fish_overall ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 5: ANOVA between fish intake and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n4855\n2427\n1.085\n0.3388\n\n\nResiduals\n494\n1105599\n2238\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = fish_overall ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 6: ANOVA between fish intake and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1986\n992.9\n0.2838\n0.753\n\n\nResiduals\n512\n1791051\n3498\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#dietary-fibre",
    "href": "Baseline/Diet.html#dietary-fibre",
    "title": "Diet",
    "section": "Dietary fibre",
    "text": "Dietary fibre\nFibre has frequently investigated as a potential factor in IBD pathogenesis, particularly in CD.\nA study of 170,776 women across 26 years found fibre intake, particularly fibre derived from fruits, to be low for incident CD patients (Ananthakrishnan et al. 2013).\nA US study of 1,130 CD subjects found CD patients who reported that they did not avoid high-fibre foods were approximately 40% less likely to have a disease flare in a 6-month period than those who avoided high-fibre foods (Brotherton et al. 2016).\nThere is less evidence of a relationship between UC and dietary fibre.\nThere does not appear to be substantial differences in fibre between CD and UC/IBDU PREdiCCt participants.\n\nCodedemo %&gt;%\n  drop_na(fibre) %&gt;%\n  ggplot(aes(x = fibre, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Dietary fibre\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 5: Distribution of dietary fibre.\n\n\n\n\nNo association was found between dietary fibre intake and FC.\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = fibre ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 7: ANOVA between dietary fibre and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n333.4\n166.7\n1.496\n0.2251\n\n\nResiduals\n494\n55046\n111.4\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = fibre ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 8: ANOVA between dietary fibre and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n80.2\n40.1\n0.3739\n0.6882\n\n\nResiduals\n512\n54910\n107.2\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#polyunsaturated-fatty-acids",
    "href": "Baseline/Diet.html#polyunsaturated-fatty-acids",
    "title": "Diet",
    "section": "Polyunsaturated fatty acids",
    "text": "Polyunsaturated fatty acids\nPUFAs exhibit anti-inflammatory properties and there is evidence of a relationship between PUFAs and UC incidence (Marion-Letellier et al. 2013). Research suggests that a diet with a poor balance of n-3 and n-6 PUFAs, commonly seen in “Western” diets is associated with IBD risk.\nThe PREdiCCt SAP states n-6 PUFAs will be examined. However, the data obtained from the FFQs describes PUFAs as a whole (including n-3 PUFAs).\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = PUFA_percEng, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"PUFA intake\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 6: Distribution of polyunsaturated fatty acids.\n\n\n\n\nA significant association was not seen between PUFA intake and FC.\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = PUFA_percEng ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 9: ANOVA between polyunsaturated fatty acids and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n0.9349\n0.4674\n0.2489\n0.7798\n\n\nResiduals\n494\n927.9\n1.878\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = PUFA_percEng ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 10: ANOVA between polyunsaturated fatty acids and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n10.72\n5.359\n3.378\n0.03487\n\n\nResiduals\n512\n812.1\n1.586\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodep &lt;- demo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  drop_na(cat, PUFA_percEng) %&gt;%\n  mutate(cat = fct_rev(cat)) %&gt;%\n  ggplot(aes(x = PUFA_percEng, fill = cat, color = cat)) +\n  geom_density() +\n  facet_grid(rows = vars(cat)) +\n  labs(x = \"PUFA intake\",\n       y = \"Density\",\n       fill = \"FC group\",\n       color = \"FC group\")\ncat_theme(p)\n\n\n\n\n\n\nFigure 7: Distribution ofpolyunsaturated fatty acid intake by FC in UC.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#diet-qualiy-index",
    "href": "Baseline/Diet.html#diet-qualiy-index",
    "title": "Diet",
    "section": "Diet qualiy index",
    "text": "Diet qualiy index\nDiet quality index (DQI) is a measure of overall diet quality ranging from 0 to 100. A higher DQI indicates a diverse diet likely meeting recommended daily intakes but reflecting moderation whilst low values indicate the converse. We used Diet Quality Index-International (DQI-I) which has been validated for use in diverse populations (Kim et al. 2003). It should be noted DQI does not necessarily relate to ultra-processed food intake.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = dqi_tot, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Diet quality index\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\nWarning: Removed 1132 rows containing non-finite outside the scale range\n(`stat_bin()`).\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = dqi_tot ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 11: ANOVA between diet quality index and FC groups in Crohn’s disease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n121.6\n60.8\n0.4786\n0.62\n\n\nResiduals\n494\n62761\n127\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = dqi_tot ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 12: ANOVA between diet quality index and FC groups in UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n769.2\n384.6\n3.393\n0.03436\n\n\nResiduals\n512\n58031\n113.3\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodep &lt;- demo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  drop_na(cat, dqi_tot) %&gt;%\n  mutate(cat = fct_rev(cat)) %&gt;%\n  ggplot(aes(x = dqi_tot, fill = cat, color = cat)) +\n  geom_density() +\n  facet_grid(rows = vars(cat)) +\n  labs(x = \"Diet quality index\",\n       y = \"Density\",\n       fill = \"FC group\",\n       color = \"FC group\")\ncat_theme(p)\n\n\n\n\n\n\nFigure 8: Distribution of diet quality index by FC in UC.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#nova-intake-score",
    "href": "Baseline/Diet.html#nova-intake-score",
    "title": "Diet",
    "section": "Nova intake score",
    "text": "Nova intake score\nThere has been a great deal of recent research interest in ultra processed food (UPF) and IBD. For example, Narula et al. (2021) found UPF intake to be positively associated with IBD risk.\nThe Nova score is a popular approach for classifying UPFs (Monteiro et al. 2017). Food is classified as either unprocessed, processed culinary, processed food, or ultra-processed via the Nova score. The University of Aberdeen have developed an extension of the Nova score, the Nova intake score, which can be used to categorise individuals and their diets instead of individual food items.\nThe following definition of the Nova intake score was written by Liam McAdie during a 5th year medical elective in which he worked on the PREdiCCt dietary data. The formulae have received minor modifications, but otherwise the definitions remain unchanged from McAdie’s work.\nDefinition\nWhen completing the FFQ, participants were asked to report (a) portion size normally consumed, (b) number of times this portion is consumed in one day and (c) number of days per week food type is consumed. Participant’s daily average consumption (in grams) of a food and drink type (x) was calculated by:\n\nx=\\frac{c}{7}(a+b)\n\nStandardised number of portions consumed daily for food and drink type (y) was calculated by dividing consumption (x) by the Foods Standard Agency average UK-portion size (z).\n\ny= \\frac{x}{z}\n\nNova intake scores (N) were calculated by multiplying the number of standardised portions consumed (y) by their corresponding Nova score (M) assigned in the database. This process is repeated for all 169 food and drink types and totalled to give one overall Nova intake score. This score is a marker representative of UPF intake.\n\nN = \\sum_{i = 1}^{169} (y_i M_i)\n\nResults\nThe distribution of Nova intake score appears to be uniform across the cohort, as such, it seems likely that these data have been mapped to quantiles and are no longer describing Nova Score categories.\n\nCodedemo$NOVAScore_cat &lt;- factor(demo$NOVAScore_cat,\n  levels = 1:4,\n  labels = c(\n    \"Unprocessed\",\n    \"Processed culinary\",\n    \"Processed food\",\n    \"Ultra-processed\"\n  )\n)\n\ndemo %&gt;%\n  drop_na(NOVAScore_cat) %&gt;%\n  ggplot(aes(x = NOVAScore_cat, color = diagnosis2, fill = diagnosis2)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Nova intake score\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 9: Distribution of Nova intake scores.\n\n\n\n\nNo significant association was observed between Nova intake scores and FC groups.\n\nCodetemp &lt;- demo %&gt;%\n  filter(diagnosis2 == \"CD\")\n\npander(chisq.test(temp$NOVAScore_cat, temp$cat))\n\n\nChi-squared test between Nova intake score and FC groups in Crohn’s disease.\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n11.12\n6\n0.08488\n\n\n\n\n\nCodetemp &lt;- demo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\")\n\npander(chisq.test(temp$NOVAScore_cat, temp$cat))\n\n\nChi-squared test between Nova intake score and FC groups in UC/IBDU.\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n4.197\n6\n0.6501",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#processed-food-subgroups",
    "href": "Baseline/Diet.html#processed-food-subgroups",
    "title": "Diet",
    "section": "Processed food subgroups",
    "text": "Processed food subgroups\nIn addition to exploring UPF intake as a whole, we also explore UPF intake by subcategories. This approach is based on the methodology used by Cordova et al. (2023). The following categories have been identified by Dr Maiara Brusco De Freitas using FFQ groupings.\nAnimal-based products (processed meat) is the only subgroup considered which we found to be significantly associated with FC.\n\n\nBreads and cereals\nSweets and desserts/snack foods\nArtificially and sugar-sweetened beverages\nAnimal-based products (processed meat)\nPlant-based alternatives\n\n\n\n\nCodeFFQ$breadIntake &lt;- with(FFQ,\n                        (bread1a_grams +\n                          bread1b_grams +\n                          bread1c_grams +\n                          bread1d_grams +\n                          cereal2a_grams +\n                          cereal2b_grams +\n                          cereal2c_grams +\n                          cereal2d_grams + \n                          cereal2e_grams) /\n                          EnergykCAL) * 100\n\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"breadIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(breadIntake) %&gt;%\n  ggplot(aes(x = breadIntake)) +\n  geom_histogram(bins = 25, color = \"#5C738F\", fill = \"#759EB8\") +\n  theme_minimal() +\n  xlab(\"Processed bread and cereal intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 10: Distribution of processed bread and cereal intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(breadIntake ~ cat, data = demo)))\n\n\nTable 13: ANOVA between processed bread/cereal intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n15.73\n7.867\n1.718\n0.1799\n\n\nResiduals\n1009\n4620\n4.579\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nCodeFFQ$sweetIntake &lt;- with(FFQ,\n                        (Puddings13a_grams +\n                          Puddings13b_grams +\n                          Puddings13c_grams +\n                          Puddings13d_grams +\n                          Puddings13e_grams +\n                          Puddings13f_grams + \n                          Puddings13g_grams +\n                          Puddings13h_grams +\n                          Chocsetc14a_grams +\n                          Chocsetc14b_grams +\n                          Chocsetc14c_grams +\n                          Chocsetc14d_grams +\n                          Chocsetc14g_grams +\n                          Chocsetc14h_grams +\n                          Chocsetc14i_grams +\n                          Biscuits15a_grams +\n                          Biscuits15b_grams +\n                          Biscuits15c_grams +\n                          Biscuits15d_grams +\n                          Biscuits15e_grams +\n                          Biscuits15g_grams +\n                          Cakes16a_grams +\n                          Cakes16b_grams +\n                          Cakes16c_grams +\n                          Cakes16d_grams +\n                          Cakes16e_grams) /\n                          EnergykCAL) * 100\n\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"sweetIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(sweetIntake) %&gt;%\n  ggplot(aes(x = sweetIntake)) +\n  geom_histogram(bins = 25, color = \"#B25966\", fill = \"#FFA3AF\") +\n  theme_minimal() +\n  xlab(\"Sweet/dessert/snack intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 11: Distribution of Sweet and dessert/snack intake divided by daily energy intake.\n\n\n\n\n\nCode#| label: tbl-sweetintake-uc\n#| tbl-cap: \"ANOVA between sweet/dessert/snack intake intake and FC for UC/IBDU.\"\n\ndemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = sweetIntake ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n28.62\n14.31\n2.053\n0.1294\n\n\nResiduals\n512\n3569\n6.971\nNA\nNA\n\n\n\n\n\n\nCode#| label: tbl-sweetIntake\n#| tbl-cap: \"ANOVA between sweet/dessert/snack intake and FC groups.\"\npander(summary(aov(sweetIntake ~ cat, data = demo)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1.351\n0.6754\n0.09064\n0.9134\n\n\nResiduals\n1009\n7518\n7.451\nNA\nNA\n\n\n\n\n\n\n\n\nCodeFFQ$drinkIntake &lt;- with(FFQ,\n                        (Beverages18h_grams + \n                          Beverages18i_grams +\n                          Beverages18j_grams +\n                          Beverages18k_grams +\n                          Beverages18n_grams +\n                          Beverages18o_grams) /\n                          EnergykCAL) * 100\n\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"drinkIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(drinkIntake) %&gt;%\n  ggplot(aes(x = drinkIntake)) +\n  geom_histogram(bins = 25, color = \"#C58500\", fill = \"#F4AC45\") +\n  theme_minimal() +\n  xlab(\"Artificial/sugar-sweetened beverage intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 12: Distribution of artificially and sugar-sweetened drink intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(sweetIntake ~ cat, data = demo)))\n\n\nTable 14: ANOVA between artificial/sugar-sweetened beverage intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1.351\n0.6754\n0.09064\n0.9134\n\n\nResiduals\n1009\n7518\n7.451\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nCodeFFQ$processedMeatIntake &lt;- with(FFQ,\n                                (meat7b_grams +\n                                  meat7c_grams +\n                                  meat7g_grams +\n                                  meat7i_grams +\n                                  meat7j_grams +\n                                  meat7k_grams +\n                                  meat7l_grams +\n                                  fish8a_grams +\n                                  fish8e_grams +\n                                  fish8k_grams) /\n                                  EnergykCAL) * 100\n\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"processedMeatIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(processedMeatIntake) %&gt;%\n  ggplot(aes(x = processedMeatIntake)) +\n  geom_histogram(bins = 25, color = \"#BC0019\", fill = \"#FF4C55\") +\n  theme_minimal() +\n  xlab(\"Processed animal-based product intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 13: Distribution of processed animal-based product intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(processedMeatIntake ~ cat, data = demo)))\n\n\nTable 15: ANOVA between processed meat intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n27.23\n13.62\n6.328\n0.001857\n\n\nResiduals\n1009\n2171\n2.152\nNA\nNA\n\n\n\n\n\n\n\n\nFrom Figure 14, it appears subjects with FC&lt;50μg/g at recruitment were more likely to consume no, or low levels of, processed meat.\n\nCodedemo %&gt;%\n  drop_na(processedMeatIntake, cat) %&gt;%\n  ggplot(aes(x = processedMeatIntake)) +\n  geom_histogram(bins = 25, color = \"#BC0019\", fill = \"#FF4C55\") +\n  theme_minimal() +\n  xlab(\"Processed animal-based product intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\") +\n  facet_grid(rows = vars(cat))\n\n\n\n\n\n\nFigure 14: Distribution of processed animal-based product intake, divided by daily energy intake, and stratified by faecal calprotectin category.\n\n\n\n\n\n\nAs one would likely expect, consumption of processed plant-based alternatives is low.\n\nCodeFFQ$processedPlantIntake &lt;- with(FFQ,\n                                (Milk3d_grams +\n                                   Sav_etc10d_grams +\n                                   Sav_etc10e_grams +\n                                   Sav_etc10f_grams) /\n                                  EnergykCAL) * 100\n\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"processedPlantIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(processedPlantIntake) %&gt;%\n  ggplot(aes(x = processedPlantIntake)) +\n  geom_histogram(bins = 25, color = \"#069E79\", fill = \"#08C99B\") +\n  theme_minimal() +\n  xlab(\"Processed plant-based alternative intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 15: Distribution of processed plant-based alternatives divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(processedPlantIntake ~ cat, data = demo)))\n\n\nTable 16: ANOVA between processed plant-based alternatives intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n11.35\n5.675\n0.4328\n0.6488\n\n\nResiduals\n1009\n13230\n13.11\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#un-processedminimally-processed-food-subgroups",
    "href": "Baseline/Diet.html#un-processedminimally-processed-food-subgroups",
    "title": "Diet",
    "section": "Un-processed/minimally processed food subgroups",
    "text": "Un-processed/minimally processed food subgroups\n\n\nFruit\nVegetable and legumes\nRed meat\nWhite meat\nFish (white and oily)\n\n\n\n\nCodeFFQ$fruitIntake &lt;- with(FFQ,\n                        (fruit12a_grams + \n                           fruit12b_grams +\n                           fruit12c_grams +\n                           fruit12c_grams +\n                           fruit12f_grams +\n                           fruit12g_grams +\n                           fruit12h_grams +\n                           fruit12i_grams +\n                           fruit12j_grams) /\n                         EnergykCAL) * 100\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"fruitIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(fruitIntake) %&gt;%\n  ggplot(aes(x = fruitIntake)) +\n  geom_histogram(bins = 25, color =  \"#C58901\", fill = \"#FFD639\") +\n  theme_minimal() +\n  xlab(\"Fruit intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 16: Distribution of fruit intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(fruitIntake ~ cat, data = demo)))\n\n\nTable 17: ANOVA between fruit intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n193.2\n96.59\n1.821\n0.1624\n\n\nResiduals\n1009\n53513\n53.04\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nCodeFFQ$vegIntake &lt;- with(FFQ,\n                        (Veg11a_grams + \n                           Veg11b_grams + \n                           Veg11c_grams + \n                           Veg11d_grams +\n                           Veg11e_grams +\n                           Veg11f_grams + \n                           Veg11g_grams +\n                           Veg11h_grams +\n                           Veg11i_grams + \n                           Veg11j_grams +\n                           Veg11k_grams + \n                           Veg11l_grams + \n                           Veg11m_grams + \n                           Veg11n_grams + \n                           Veg11o_grams + \n                           Veg11p_grams +\n                           Pulses) /\n                         EnergykCAL) * 100\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"vegIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(vegIntake) %&gt;%\n  ggplot(aes(x = vegIntake)) +\n  geom_histogram(bins = 25, color =  \"#662E9B\", fill = \"#A57CD9\") +\n  theme_minimal() +\n  xlab(\"Vegetable and legume intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 17: Distribution of vegetable and legume intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(vegIntake ~ cat, data = demo)))\n\n\nTable 18: ANOVA between vegetable/legume intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n335.3\n167.6\n2.71\n0.06702\n\n\nResiduals\n1006\n62228\n61.86\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nCodeFFQ$redMeatIntake &lt;- with(FFQ,\n                        (meat7d_grams + \n                           meat7e_grams + \n                           meat7h_grams) /\n                         EnergykCAL) * 100\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"redMeatIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(redMeatIntake) %&gt;%\n  ggplot(aes(x = redMeatIntake)) +\n  geom_histogram(bins = 25, color =  \"#93250B\", fill = \"#F34213\") +\n  theme_minimal() +\n  xlab(\"VRed meat intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 18: Distribution of red meat intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(redMeatIntake ~ cat, data = demo)))\n\n\nTable 19: ANOVA between red meat intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n0.2782\n0.1391\n0.1716\n0.8424\n\n\nResiduals\n1009\n818\n0.8107\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nCodeFFQ$whiteMeatIntake &lt;- with(FFQ,\n                            meat7f_grams /\n                              EnergykCAL) * 100\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"whiteMeatIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(whiteMeatIntake) %&gt;%\n  ggplot(aes(x = whiteMeatIntake)) +\n  geom_histogram(bins = 25, color =  \"#829399\", fill = \"#545F66\") +\n  theme_minimal() +\n  xlab(\"White meat intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 19: Distribution of white/oily fish intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(whiteMeatIntake ~ cat, data = demo)))\n\n\nTable 20: ANOVA between white meat intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n3.262\n1.631\n0.8655\n0.4212\n\n\nResiduals\n1009\n1901\n1.884\nNA\nNA\n\n\n\n\n\n\n\n\n\n\n\nCodeFFQ$whiteFishIntake &lt;- with(FFQ,\n                        (WhiteFish + \n                           OilyFish) /\n                         EnergykCAL) * 100\ndemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"whiteFishIntake\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(whiteFishIntake) %&gt;%\n  ggplot(aes(x = whiteFishIntake)) +\n  geom_histogram(bins = 25, color =  \"#003559\", fill = \"#006DAA\") +\n  theme_minimal() +\n  xlab(\"White fish intake / energy intake (g/kcal)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 20: Distribution of white/oily fish intake divided by daily energy intake.\n\n\n\n\n\nCodepander(summary(aov(whiteFishIntake ~ cat, data = demo)))\n\n\nTable 21: ANOVA between fish (white and oily) intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n8.924\n4.462\n1.089\n0.3369\n\n\nResiduals\n1003\n4109\n4.097\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#percentage-of-energy-intake",
    "href": "Baseline/Diet.html#percentage-of-energy-intake",
    "title": "Diet",
    "section": "Percentage of energy intake",
    "text": "Percentage of energy intake\n\nCodenova4 &lt;- read_xlsx(paste0(upf.path, \"NOVA4Scores.xlsx\"))\ncolnames(nova4)[c(1, 6)] &lt;- c(\"ParticipantNo\", \"UPF_perc\")\ndemo &lt;- merge(demo,\n  nova4[, c(\"ParticipantNo\", \"UPF_perc\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nAs an alternative to the above analyses, we have also explored the percentage of daily energy intake which is derived from ultra processed (UPF4) groups.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = UPF_perc, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"% of energy intake attributed to Nova 4 food and drink\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\nWarning: Removed 1132 rows containing non-finite outside the scale range\n(`stat_bin()`).\n\n\n\n\n\n\n\nFigure 21: Distribution of the percentage of daily energy intake sourced from UPF (Nova score 4) food and drink.\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"CD\") %&gt;%\n  aov(formula = UPF_perc ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 22: ANOVA between Nova 4 food as a percentage of energy intake and FC for Crohn’s diseease.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n242.9\n121.4\n0.7854\n0.4565\n\n\nResiduals\n494\n76379\n154.6\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodedemo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  aov(formula = UPF_perc ~ cat) %&gt;%\n  summary() %&gt;%\n  pander()\n\n\nTable 23: ANOVA between Nova 4 food as a percentage of energy intake and FC for UC/IBDU.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1357\n678.4\n4.822\n0.008423\n\n\nResiduals\n512\n72042\n140.7\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodep &lt;- demo %&gt;%\n  filter(diagnosis2 == \"UC/IBDU\") %&gt;%\n  drop_na(cat, UPF_perc) %&gt;%\n  mutate(cat = fct_rev(cat)) %&gt;%\n  ggplot(aes(x = UPF_perc, fill = cat, color = cat)) +\n  geom_density() +\n  facet_grid(rows = vars(cat)) +\n  labs(x = \"Nova 4 food as a percentage of energy intake\",\n       y = \"Density\",\n       fill = \"FC group\",\n       color = \"FC group\")\ncat_theme(p)\n\n\n\n\n\n\nFigure 22: Distribution of Nova 4 food as a percentage of energy intake by FC in UC.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#alcohol-use",
    "href": "Baseline/Diet.html#alcohol-use",
    "title": "Diet",
    "section": "Alcohol use",
    "text": "Alcohol use\n\nCodedemo &lt;- merge(demo,\n              FFQ[, c(\"ParticipantNo\", \"Alcohol_percEng\")],\n              by = \"ParticipantNo\",\n              all.x = TRUE,\n              all.y = FALSE)\n\ndemo %&gt;%\n  drop_na(Alcohol_percEng) %&gt;%\n  ggplot(aes(x = Alcohol_percEng, color = Sex, fill = Sex)) +\n  geom_histogram(bins = 20) +\n  facet_grid(cols = vars(Sex)) + \n  theme_minimal() +\n  labs(x = \"Alcohol intake per energy\",\n       y = \"Frequency\",\n       color = \"Diagnosis\",\n       fill = \"Diagnosis\") +\n  scale_fill_manual(values = c(\"#FF966E\", \"#6A90A3\")) +\n  scale_color_manual(values = c(\"#D16014\",  \"#114B5F\"))\n\n\n\n\n\n\nFigure 23: Distribution of alcohol per energy intake, stratified by sex.\n\n\n\n\n\nCodepander(summary(aov(Alcohol_percEng ~ cat, data = demo)))\n\n\nTable 24: ANOVA between alcohol intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n60.53\n30.26\n1.624\n0.1977\n\n\nResiduals\n1009\n18806\n18.64\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#diet-quality-index",
    "href": "Baseline/Diet.html#diet-quality-index",
    "title": "Diet",
    "section": "Diet quality index",
    "text": "Diet quality index\n\nCodedemo %&gt;%\n  drop_na(dqi_tot) %&gt;%\n  ggplot(aes(x = dqi_tot, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 20) +\n  facet_grid(cols = vars(diagnosis2)) + \n  theme_minimal() +\n  labs(x = \"Diet quality index\",\n       y = \"Frequency\",\n       color = \"Diagnosis\",\n       fill = \"Diagnosis\") +\n  scale_fill_manual(values = c(\"#86DEB7\", \"#FC5A66\")) +\n  scale_color_manual(values = c(\"#529176\",  \"#AC353F\"))\n\n\n\n\n\n\nFigure 24: Distribution of diet quality index, stratified by IBD type.\n\n\n\n\n\nCodedemo %&gt;%\n  drop_na(dqi_tot, cat) %&gt;%\n  pull(dqi_tot) %&gt;%\n  quantile() %&gt;%\n  knitr::kable(digits = 2,\n    caption = \"Diet quality index quantiles for the FFQ subcohort.\",\n    col.names = c(\"Quantile\", \"DQI\")\n  )\n\n\nDiet quality index quantiles for the FFQ subcohort.\n\nQuantile\nDQI\n\n\n\n0%\n5.59\n\n\n25%\n26.60\n\n\n50%\n33.99\n\n\n75%\n41.36\n\n\n100%\n60.00\n\n\n\n\n\n\nCodepander(summary(aov(dqi_tot ~ cat, data = demo)))\n\n\nTable 25: ANOVA between diet quality index and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n676.6\n338.3\n2.818\n0.06019\n\n\nResiduals\n1009\n121118\n120\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-diet.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#comparison",
    "href": "Baseline/Diet.html#comparison",
    "title": "Diet",
    "section": "Comparison",
    "text": "Comparison\nFigure 25 presents macronutrient, PUFA and UPF intake as percentages of total energy intake.\n\nCodeFFQ$Prot_percEng &lt;- ((FFQ$Protng * 4) / FFQ$EnergykCAL) * 100\n\nFFQ &lt;- merge(FFQ,\n  nova4[, c(\"ParticipantNo\", \"UPF_perc\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\ncomparison &lt;- reshape2::melt(FFQ,\n  id.vars = \"ParticipantNo\",\n  measure.vars = c(\n    \"CHO_percEng\",\n    \"Fat_percEng\",\n    \"Prot_percEng\",\n    \"SatFat_percEng\",\n    \"PUFA_percEng\",\n    \"UPF_perc\"\n  )\n)\n\ncomparison &lt;- merge(comparison,\n  demo[, c(\"ParticipantNo\", \"Sex\", \"diagnosis2\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ncomparison$variable &lt;- factor(comparison$variable,\n  levels = c(\n    \"CHO_percEng\",\n    \"Fat_percEng\",\n    \"Prot_percEng\",\n    \"SatFat_percEng\",\n    \"PUFA_percEng\",\n    \"UPF_perc\"\n  ),\n  labels = c(\n    \"Carbohydrate\",\n    \"Fat\",\n    \"Protein\",\n    \"Saturated fat\",\n    \"Polyunsaturated fatty acids\",\n    \"Ultra-processed food\"\n  ))\n\np &lt;- ggplot(\n  comparison,\n  aes(color = variable, fill = variable, y = value, x = Sex)\n) +\n  geom_violin() +\n  facet_grid(~diagnosis2,\n    scales = \"free_x\",\n    space = \"free_x\",\n    switch = \"x\"\n  ) +\n  theme_minimal() +\n  theme(\n    strip.placement = \"outside\",\n    strip.background = element_rect(fill = \"white\"),\n    strip.clip = \"on\",\n    axis.title.x = element_blank(),\n    legend.position = \"bottom\"\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"#4F359B\",\n      \"#FFED49\",\n      \"#2EC4B6\",\n      \"#E71D36\",\n      \"#FF9F1C\",\n      \"#80BF56\"\n    )\n  ) +\n  scale_color_manual(\n    values = c(\n      \"#392376\",\n      \"#ADA009\",\n      \"#00877C\",\n      \"#9F1C29\",\n      \"#B06B01\",\n      \"#568238\"\n    )\n  ) +\n  labs(\n    y = \"% of total energy intake\",\n    color = \"\",\n    fill = \"\"\n  ) + guides(\n    colour = guide_legend(nrow = 1),\n    fill = guide_legend(nrow = 1))\n\nggsave(\"plots/baseline/diet.png\", p, width = 12 * 0.8, height = 7 * 0.8)\nggsave(\"plots/baseline/diet.pdf\", p, width = 12 * 0.8, height = 7 * 0.8)\np\n\n\n\n\n\n\nFigure 25: Dietary distribution of the FFQ subcohort expressed as percentages of energy intake and stratified by sex and diagnosis of either Crohn’s disease or ulcerative colitis/inflammatory bowel disease unclassified.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#reproduction-and-reproducibility",
    "href": "Baseline/Diet.html#reproduction-and-reproducibility",
    "title": "Diet",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), textshaping(v.0.4.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), reshape2(v.1.4.4), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), ragg(v.1.3.2), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), systemfonts(v.1.1.0), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Introduction.html",
    "href": "Survival/Introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "This report explores associations between time to flare and the variables recorded at baseline. Time to flare is modelled using Cox models with the variable of interest and controlled variables (sex, and deprivation) included as fixed effects. A gamma frailty term is employed for hospital sites (which may capture inter-hospital differences).\nThe primary study endpoint is patient-reported flare which is defined as a participant reporting their disease as being uncontrolled when they completed a monthly study questionnaire.\nFor patient-reported flares, only the first two years of follow-up are considered as this was the time interval in which questionnaires were sent to participants.\nThe secondary study endpoint is hard flare, which required elevated CRP and/or CRP and for the subject to change medication. Data for this endpoint was collected via end-of-study phenotyping.\nFor hard flares, the full study follow-up period has been used, from study recruitment to the time the end of study phenotyping was completed.\nPatient-reported and hard flares have been identified by Dr Linda Williams, the PREdiCCt trial statistician. The same flare definitions have been used across all teams working on PREdiCCt. The full steps for defining patient-reported flares are included below.\n\n\nSteps for calculating patient-reported flares\n\n\nIf date of flare is before date of entry to study, then delete flare date and recode diseasecontrolled as 1.\nIf flare date is after the questionnaire date (I.E in the future), reset flare date to questionnaire date.\nIf questionnaire completed after date of withdrawal, remove.\nIf date of flare is &gt;2 years after entry, censor patient-reported flare at 2 years.\nTime is earliest of flare time or end of follow up, from entry date.\nAll data censored at 2 years.\nIncluding the hard flares (hard flare data are much more straightforward, flare=diseaseflareyn and flare date=firstflarestartdate from EOS data)\n\nIf both datasets say no flare, patient-reported flare is no and follow up time from hard flare &lt;= 2 years, patient-reported flare time is longest of questionnaire and hard flare times\nIf both datasets say no flare, patient-reported flare is no and follow up time from hard flare &gt; 2 years, patient-reported time is 2 years\nIf no flare in questionnaires, but hard flare reported before 2 years of follow up, take hard flare data\nIf no flare in questionnaires, but hard flare reported after 2 years, patient-reported flare is no and patient-reported flare time is 2 years\nIf flare in questionnaire and no hard flare, patient-reported flare from questionnaire data\nIf flare in questionnaire and also hard flare, take the earliest time\nIf questionnaire data is missing and no hard flare, patient-reported flare is no and time is earliest of hard flare follow up and 2 years\nIf questionnaire data is missing and hard flare reported within 2 years, patient-reported flare data are taken from hard flare data\nIf questionnaire data is missing and hard flare reported after 2 years then patient-reported flare is no and time is 2 years\nOtherwise if questionnaire data is not missing and hardflare is, then patient-reported flare is taken from questionnaire data\n\n\nAll times are taken from the earliest reported flare.",
    "crumbs": [
      "Time to flare",
      "Introduction"
    ]
  },
  {
    "objectID": "Survival/Controlled.html",
    "href": "Survival/Controlled.html",
    "title": "Controlled variables",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-overview.RDS\"))\nflare.cd.df &lt;- subset(flare.df, diagnosis2 == \"CD\")\nflare.uc.df &lt;- subset(flare.df, diagnosis2 == \"UC/IBDU\")\n\n\nThe variables being controlled for in later cox models analyses are first investigated.\nAlthough smoking status was originally planned to be controlled for, the high degree of missingness for these data and the lack of significant associations with time to flare has resulted in smoking status not being controlled for in later analyses.\nOf the variables considered here, only sex is associated with disease flare.",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#introduction",
    "href": "Survival/Controlled.html#introduction",
    "title": "Controlled variables",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-overview.RDS\"))\nflare.cd.df &lt;- subset(flare.df, diagnosis2 == \"CD\")\nflare.uc.df &lt;- subset(flare.df, diagnosis2 == \"UC/IBDU\")\n\n\nThe variables being controlled for in later cox models analyses are first investigated.\nAlthough smoking status was originally planned to be controlled for, the high degree of missingness for these data and the lack of significant associations with time to flare has resulted in smoking status not being controlled for in later analyses.\nOf the variables considered here, only sex is associated with disease flare.",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#sex",
    "href": "Survival/Controlled.html#sex",
    "title": "Controlled variables",
    "section": "Sex",
    "text": "Sex\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(softflare_time, softflare) ~ Sex,\n  legend_title = \"Sex\",\n  legend_labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/cd/soft-flare/controlled/sex\"\n)\nsaveRDS(p, paste0(paths$outdir, \"sex-cd-soft.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(hardflare_time, hardflare) ~ Sex,\n  legend_title = \"Sex\",\n  legend_labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/cd/hard-flare/controlled/sex\"\n)\nsaveRDS(p, paste0(paths$outdir, \"sex-cd-hard.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(softflare_time, softflare) ~ Sex,\n  legend_title = \"Sex\",\n  legend_labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/uc/soft-flare/controlled/sex\"\n)\nsaveRDS(p, paste0(paths$outdir, \"sex-uc-soft.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(hardflare_time, hardflare) ~ Sex,\n  legend_title = \"Sex\",\n  legend_labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/uc/hard-flare/controlled/sex\"\n)\nsaveRDS(p, paste0(paths$outdir, \"sex-uc-hard.RDS\"))\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#smoking-status",
    "href": "Survival/Controlled.html#smoking-status",
    "title": "Controlled variables",
    "section": "Smoking status",
    "text": "Smoking status\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(softflare_time, softflare) ~ Smoke,\n  legend_title = \"Smoking status\",\n  legend_labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/cd/soft-flare/controlled/smoke\"\n)\nsaveRDS(p, paste0(paths$outdir, \"smoke-cd-soft.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(hardflare_time, hardflare) ~ Smoke,\n  legend_title = \"Smoking status\",\n  legend_labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/cd/hard-flare/controlled/smoke\"\n)\nsaveRDS(p, paste0(paths$outdir, \"smoke-cd-hard.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(softflare_time, softflare) ~ Smoke,\n  legend_title = \"Smoking status\",\n  legend_labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/uc/soft-flare/controlled/smoke\"\n)\nsaveRDS(p, paste0(paths$outdir, \"smoke-uc-soft.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(hardflare_time, hardflare) ~ Smoke,\n  legend_title = \"Smoking status\",\n  legend_labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/uc/hard-flare/controlled/smoke\"\n)\n\nsaveRDS(p, paste0(paths$outdir, \"smoke-uc-hard.RDS\"))\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#social-deprivation",
    "href": "Survival/Controlled.html#social-deprivation",
    "title": "Controlled variables",
    "section": "Social deprivation",
    "text": "Social deprivation\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(softflare_time, softflare) ~ IMD,\n  legend_title = \"IMD\",\n  legend_labs = c(\"1 (least deprived)\", \"2\", \"3\", \"4\", \"5 (most deprived)\"),\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/cd/soft-flare/controlled/imd\"\n)\nsaveRDS(p, paste0(paths$outdir, \"imd-cd-soft.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(hardflare_time, hardflare) ~ IMD,\n  legend_title = \"IMD\",\n  legend_labs = c(\"1 (least deprived)\", \"2\", \"3\", \"4\", \"5 (most deprived)\"),\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/cd/hard-flare/controlled/imd\"\n)\nsaveRDS(p, paste0(paths$outdir, \"imd-cd-hard.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(softflare_time, softflare) ~ IMD,\n  legend_title = \"IMD\",\n  legend_labs = c(\"1 (least deprived)\", \"2\", \"3\", \"4\", \"5 (most deprived)\"),\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/uc/soft-flare/controlled/imd\"\n)\nsaveRDS(p, paste0(paths$outdir, \"imd-uc-soft.RDS\"))\np\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(hardflare_time, hardflare) ~ IMD,\n  legend_title = \"IMD\",\n  legend_labs = c(\"1 (least deprived)\", \"2\", \"3\", \"4\", \"5 (most deprived)\"),\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/uc/hard-flare/controlled/imd\"\n)\nsaveRDS(p, paste0(paths$outdir, \"imd-uc-hard.RDS\"))\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#faecal-calprotectin",
    "href": "Survival/Controlled.html#faecal-calprotectin",
    "title": "Controlled variables",
    "section": "Faecal calprotectin",
    "text": "Faecal calprotectin\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(softflare_time, softflare) ~ cat,\n  legend_title = \"Faecal calprotectin\",\n  legend_labs = c(\"FC &lt; 50\", \"50 ≤ FC ≤ 250\", \"FC &gt; 250\"),\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/cd/soft-flare/controlled/fc\"\n)\n\nsaveRDS(p, paste0(paths$outdir, \"fc-cd-soft.RDS\"))\n\nprint(p, newpage = FALSE)\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.cd.df,\n  formula = Surv(hardflare_time, hardflare) ~ cat,\n  legend_title = \"Faecal calprotectin\",\n  legend_labs = c(\"FC &lt; 50\", \"50 ≤ FC ≤ 250\", \"FC &gt; 250\"),\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/cd/hard-flare/controlled/fc\"\n)\n\nsaveRDS(p, paste0(paths$outdir, \"fc-cd-hard.RDS\"))\n\nprint(p, newpage = FALSE)\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(softflare_time, softflare) ~ cat,\n  legend_title = \"Faecal calprotectin\",\n  legend_labs = c(\"FC &lt; 50\", \"50 ≤ FC ≤ 250\", \"FC &gt; 250\"),\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to patient-reported flare\",\n  break_time_by = 200,\n  plot_path = \"plots/uc/soft-flare/controlled/fc\"\n)\n\nsaveRDS(p, paste0(paths$outdir, \"fc-uc-soft.RDS\"))\n\nprint(p, newpage = FALSE)\n\n\n\n\n\n\n\n\n\n\nCodep &lt;- generate_survival_plot(\n  data = flare.uc.df,\n  formula = Surv(hardflare_time, hardflare) ~ cat,\n  legend_title = \"Faecal calprotectin\",\n  legend_labs = c(\"FC &lt; 50\", \"50 ≤ FC ≤ 250\", \"FC &gt; 250\"),\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recruitment (days)\",\n  title = \"Time to hard flare\",\n  break_time_by = 500,\n  plot_path = \"plots/uc/hard-flare/controlled/fc\"\n)\n\nsaveRDS(p, paste0(paths$outdir, \"fc-uc-hard.RDS\"))\n\nprint(p, newpage = FALSE)",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#cox-models",
    "href": "Survival/Controlled.html#cox-models",
    "title": "Controlled variables",
    "section": "Cox models",
    "text": "Cox models\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Smoke + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df,\n  model = TRUE\n)\n\ncd.clin.forest &lt;- get_HR(\n  fit.me,\n  c(\"SmokePrevious\", \"SmokeNever\")\n)\n\n\n\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df,\n  model = TRUE\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(\n    fit.me,\n    c(\n      \"SexFemale\",\n      paste0(\"IMD\", seq(2, 5)),\n      \"catFC 50-250\",\n      \"catFC &gt; 250\"\n    )\n  )\n)\n\n\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9989\n1.5753\n2.5364\n0.0000\n\n\nIMD2\n0.9364\n0.5970\n1.4686\n0.7746\n\n\nIMD3\n0.8868\n0.5609\n1.4021\n0.6074\n\n\nIMD4\n0.9417\n0.6062\n1.4631\n0.7894\n\n\nIMD5\n0.9857\n0.6443\n1.5078\n0.9469\n\n\ncatFC 50-250\n1.5844\n1.2278\n2.0445\n0.0004\n\n\ncatFC &gt; 250\n2.4138\n1.8192\n3.2028\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3091\n0.9923\n0.5750\n\n\nIMD\n5.8397\n3.9497\n0.2063\n\n\ncat\n2.3232\n1.9815\n0.3093\n\n\nGLOBAL\n8.4076\n13.9400\n0.8643\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Smoke + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- get_HR(\n  fit.me,\n  c(\"SmokePrevious\", \"SmokeNever\")\n)\n\n\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(\n    fit.me,\n    c(\n      \"SexFemale\",\n      paste0(\"IMD\", seq(2, 5)),\n      \"catFC &gt; 250\"\n    )\n  )\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3887\n1.0579\n1.8227\n0.0180\n\n\nIMD2\n0.9220\n0.5365\n1.5844\n0.7688\n\n\nIMD3\n0.9675\n0.5566\n1.6817\n0.9068\n\n\nIMD4\n0.8950\n0.5222\n1.5338\n0.6864\n\n\nIMD5\n0.9035\n0.5370\n1.5199\n0.7021\n\n\ncatFC 50-250\n2.0217\n1.4730\n2.7750\n0.0000\n\n\ncatFC &gt; 250\n3.3366\n2.3693\n4.6989\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2571\n0.9863\n0.6064\n\n\nIMD\n4.2174\n3.9407\n0.3689\n\n\ncat\n8.8712\n1.9847\n0.0116\n\n\nGLOBAL\n13.9394\n19.6668\n0.8190\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Smoke + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- get_HR(\n  fit.me,\n  c(\"SmokePrevious\", \"SmokeNever\")\n)\n\n\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(\n    fit.me,\n    c(\n      \"SexFemale\",\n      paste0(\"IMD\", seq(2, 5)),\n      \"catFC &gt; 250\"\n    )\n  )\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5438\n1.2475\n1.9104\n0.0001\n\n\nIMD2\n1.2433\n0.7856\n1.9678\n0.3525\n\n\nIMD3\n1.1010\n0.7025\n1.7255\n0.6748\n\n\nIMD4\n1.4420\n0.9388\n2.2151\n0.0946\n\n\nIMD5\n1.1988\n0.7858\n1.8290\n0.4002\n\n\ncatFC 50-250\n1.5688\n1.2269\n2.0058\n0.0003\n\n\ncatFC &gt; 250\n2.1447\n1.6433\n2.7991\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.3013\n0.9907\n0.2514\n\n\nIMD\n4.0189\n3.9418\n0.3949\n\n\ncat\n5.7453\n1.9706\n0.0550\n\n\nGLOBAL\n11.3236\n18.7016\n0.9037\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Smoke + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- get_HR(\n  fit.me,\n  c(\"SmokePrevious\", \"SmokeNever\")\n)\n\n\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(\n    fit.me,\n    c(\n      \"SexFemale\",\n      paste0(\"IMD\", seq(2, 5)),\n      \"catFC 50-250\",\n      \"catFC &gt; 250\"\n    )\n  )\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3259\n1.0208\n1.7221\n0.0345\n\n\nIMD2\n1.4092\n0.7861\n2.5260\n0.2494\n\n\nIMD3\n1.3774\n0.7835\n2.4213\n0.2659\n\n\nIMD4\n1.7484\n1.0130\n3.0174\n0.0448\n\n\nIMD5\n1.2989\n0.7566\n2.2298\n0.3430\n\n\ncatFC 50-250\n2.0322\n1.4885\n2.7744\n0.0000\n\n\ncatFC &gt; 250\n3.2203\n2.3245\n4.4614\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1461\n0.9849\n0.6962\n\n\nIMD\n2.6145\n3.9368\n0.6145\n\n\ncat\n4.3647\n1.9671\n0.1096\n\n\nGLOBAL\n7.4355\n23.5846\n0.9994\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nAcross IBD\n\n\nPatient-reported flare\nHard flare\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7183\n1.4676\n2.0119\n0.0000\n\n\nIMD2\n1.0417\n0.7555\n1.4364\n0.8032\n\n\nIMD3\n0.9689\n0.7027\n1.3360\n0.8474\n\n\nIMD4\n1.1549\n0.8490\n1.5712\n0.3590\n\n\nIMD5\n1.0554\n0.7814\n1.4255\n0.7252\n\n\ncatFC 50-250\n1.5194\n1.2743\n1.8117\n0.0000\n\n\ncatFC &gt; 250\n2.2203\n1.8303\n2.6934\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.9368\n0.9936\n0.1627\n\n\nIMD\n8.9273\n3.9484\n0.0609\n\n\ncat\n1.1234\n1.9824\n0.5659\n\n\nGLOBAL\n12.1742\n22.3691\n0.9594\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\ninvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3310\n1.1037\n1.6051\n0.0028\n\n\nIMD2\n1.1029\n0.7416\n1.6402\n0.6286\n\n\nIMD3\n1.1157\n0.7525\n1.6542\n0.5858\n\n\nIMD4\n1.2392\n0.8452\n1.8169\n0.2720\n\n\nIMD5\n1.0508\n0.7220\n1.5293\n0.7959\n\n\ncatFC 50-250\n1.9760\n1.5846\n2.4641\n0.0000\n\n\ncatFC &gt; 250\n3.2506\n2.5702\n4.1112\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2285\n0.9928\n0.6297\n\n\nIMD\n0.8488\n3.9546\n0.9289\n\n\ncat\n8.4343\n1.9867\n0.0145\n\n\nGLOBAL\n9.9289\n29.8504\n0.9998\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(paths$outdir, \"flares-controlled.RDS\"))\nsaveRDS(flare.cd.df, paste0(paths$outdir, \"flares-controlled-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(paths$outdir, \"flares-controlled-uc.RDS\"))\n\nsaveRDS(cd.clin.forest, paste0(paths$outdir, \"cd-clin-controlled.RDS\"))\nsaveRDS(cd.hard.forest, paste0(paths$outdir, \"cd-hard-controlled.RDS\"))\nsaveRDS(uc.clin.forest, paste0(paths$outdir, \"uc-clin-controlled.RDS\"))\nsaveRDS(uc.hard.forest, paste0(paths$outdir, \"uc-hard-controlled.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#reproduction-and-reproducibility",
    "href": "Survival/Controlled.html#reproduction-and-reproducibility",
    "title": "Controlled variables",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/IBD.html",
    "href": "Survival/IBD.html",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\ndemo$FC &lt;- log(demo$FC)\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-demographics.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-demographics-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-demographics-uc.RDS\"))\n\ncd.clin.forest &lt;- readRDS(paste0(paths$outdir, \"cd-clin-demographics.RDS\"))\ncd.hard.forest &lt;- readRDS(paste0(paths$outdir, \"cd-hard-demographics.RDS\"))\nuc.clin.forest &lt;- readRDS(paste0(paths$outdir, \"uc-clin-demographics.RDS\"))\nuc.hard.forest &lt;- readRDS(paste0(paths$outdir, \"uc-hard-demographics.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#introduction",
    "href": "Survival/IBD.html#introduction",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\ndemo$FC &lt;- log(demo$FC)\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-demographics.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-demographics-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-demographics-uc.RDS\"))\n\ncd.clin.forest &lt;- readRDS(paste0(paths$outdir, \"cd-clin-demographics.RDS\"))\ncd.hard.forest &lt;- readRDS(paste0(paths$outdir, \"cd-hard-demographics.RDS\"))\nuc.clin.forest &lt;- readRDS(paste0(paths$outdir, \"uc-clin-demographics.RDS\"))\nuc.hard.forest &lt;- readRDS(paste0(paths$outdir, \"uc-hard-demographics.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#ibd-control-8",
    "href": "Survival/IBD.html#ibd-control-8",
    "title": "Inflammatory bowel disease",
    "section": "IBD Control-8",
    "text": "IBD Control-8\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize IBD Control-8\nflare.cd.df &lt;- categorize_variable(flare.cd.df, \"control_8\",\n                                  breaks = c(0, 13, 16),\n                                  labels = c(\"0-12\", \"13-16\"))\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"control_8\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"IBD Control-8\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/control-8\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for continuous control_8 variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(cd.clin.forest, get_HR(fit.me, \"control_8\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9227\n1.4759\n2.5049\n0.0000\n\n\nIMD2\n0.8074\n0.4922\n1.3246\n0.3970\n\n\nIMD3\n0.8700\n0.5315\n1.4241\n0.5796\n\n\nIMD4\n0.8528\n0.5286\n1.3758\n0.5141\n\n\nIMD5\n0.9833\n0.6177\n1.5655\n0.9435\n\n\ncatFC 50-250\n1.4397\n1.0987\n1.8866\n0.0082\n\n\ncatFC &gt; 250\n2.4014\n1.7740\n3.2506\n0.0000\n\n\ncontrol_8\n0.8902\n0.8606\n0.9207\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0012\n0.9903\n0.9717\n\n\nIMD\n6.0925\n3.9280\n0.1855\n\n\ncat\n1.3577\n1.9739\n0.5009\n\n\ncontrol_8\n8.4939\n0.9670\n0.0034\n\n\nGLOBAL\n15.1377\n14.9466\n0.4376\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"control_8\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"IBD Control-8\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/control-8\",\n  break_time_by = 500,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for continuous control_8 variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(cd.hard.forest, get_HR(fit.me, \"control_8\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3756\n1.0112\n1.8714\n0.0423\n\n\nIMD2\n0.6980\n0.3790\n1.2855\n0.2485\n\n\nIMD3\n0.8591\n0.4697\n1.5715\n0.6221\n\n\nIMD4\n0.7891\n0.4392\n1.4178\n0.4282\n\n\nIMD5\n0.7981\n0.4509\n1.4124\n0.4387\n\n\ncatFC 50-250\n1.9417\n1.3669\n2.7584\n0.0002\n\n\ncatFC &gt; 250\n3.5422\n2.4220\n5.1804\n0.0000\n\n\ncontrol_8\n0.9792\n0.9359\n1.0245\n0.3621\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.5133\n0.9850\n0.2149\n\n\nIMD\n8.1252\n3.9413\n0.0840\n\n\ncat\n7.2016\n1.9860\n0.0269\n\n\ncontrol_8\n2.8005\n0.9806\n0.0918\n\n\nGLOBAL\n20.3170\n15.1753\n0.1677\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize IBD Control-8\nflare.uc.df &lt;- categorize_variable(flare.uc.df, \"control_8\",\n                                  breaks = c(0, 13, 16),\n                                  labels = c(\"0-12\", \"13-16\"))\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"control_8\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"IBD Control-8\",\n  plot_base_path = \"plots/uc/soft-flare/ibd/control-8\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for continuous control_8 variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(uc.clin.forest, get_HR(fit.me, \"control_8\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4904\n1.1840\n1.8761\n0.0007\n\n\nIMD2\n1.3212\n0.7897\n2.2106\n0.2888\n\n\nIMD3\n1.2137\n0.7394\n1.9922\n0.4437\n\n\nIMD4\n1.4949\n0.9289\n2.4059\n0.0977\n\n\nIMD5\n1.3596\n0.8507\n2.1729\n0.1992\n\n\ncatFC 50-250\n1.5424\n1.1893\n2.0002\n0.0011\n\n\ncatFC &gt; 250\n2.0139\n1.5095\n2.6868\n0.0000\n\n\ncontrol_8\n0.9225\n0.8909\n0.9553\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.9678\n0.9953\n0.0844\n\n\nIMD\n4.2823\n3.9667\n0.3644\n\n\ncat\n4.5769\n1.9835\n0.1000\n\n\ncontrol_8\n5.2699\n0.9948\n0.0215\n\n\nGLOBAL\n15.8660\n12.7158\n0.2390\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"control_8\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"IBD Control-8\",\n  plot_base_path = \"plots/uc/hard-flare/ibd/control-8\",\n  break_time_by = 500,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for continuous control_8 variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(uc.hard.forest, get_HR(fit.me, \"control_8\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3913\n1.0274\n1.8840\n0.0328\n\n\nIMD2\n1.3477\n0.6476\n2.8046\n0.4248\n\n\nIMD3\n1.5031\n0.7484\n3.0187\n0.2520\n\n\nIMD4\n2.1278\n1.0942\n4.1375\n0.0261\n\n\nIMD5\n1.6178\n0.8327\n3.1432\n0.1557\n\n\ncatFC 50-250\n2.0148\n1.4131\n2.8728\n0.0001\n\n\ncatFC &gt; 250\n3.0295\n2.0721\n4.4293\n0.0000\n\n\ncontrol_8\n0.9453\n0.9026\n0.9899\n0.0169\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1400\n0.9860\n0.7027\n\n\nIMD\n2.7617\n3.9396\n0.5890\n\n\ncat\n3.5264\n1.9665\n0.1671\n\n\ncontrol_8\n1.7488\n0.9845\n0.1826\n\n\nGLOBAL\n8.2255\n23.1839\n0.9982\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#ibd-control-visual-analogue-scale",
    "href": "Survival/IBD.html#ibd-control-visual-analogue-scale",
    "title": "Inflammatory bowel disease",
    "section": "IBD Control visual analogue scale",
    "text": "IBD Control visual analogue scale\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Handle VAS control (already categorized as character)\nflare.cd.df$vas_control_cat &lt;- factor(flare.cd.df$vas_control)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"vas_control\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"IBD Control VAS\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/control-vas\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for vas_control variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0996\n1.6160\n2.7280\n0.0000\n\n\nIMD2\n0.7695\n0.4706\n1.2582\n0.2962\n\n\nIMD3\n0.9004\n0.5525\n1.4672\n0.6736\n\n\nIMD4\n0.8423\n0.5237\n1.3546\n0.4789\n\n\nIMD5\n0.9688\n0.6121\n1.5333\n0.8924\n\n\ncatFC 50-250\n1.3678\n1.0415\n1.7963\n0.0243\n\n\ncatFC &gt; 250\n2.3897\n1.7645\n3.2362\n0.0000\n\n\nvas_control85+\n0.5710\n0.4500\n0.7246\n0.0000\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0298\n0.9934\n0.8610\n\n\nIMD\n5.8028\n3.9533\n0.2095\n\n\ncat\n1.3945\n1.9837\n0.4940\n\n\nvas_control\n6.4668\n0.9893\n0.0108\n\n\nGLOBAL\n13.2734\n12.1071\n0.3576\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"vas_control\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"IBD Control VAS\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/control-vas\",\n  break_time_by = 500,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for continuous vas_control variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3751\n1.0101\n1.8721\n0.0430\n\n\nIMD2\n0.6859\n0.3715\n1.2665\n0.2282\n\n\nIMD3\n0.8599\n0.4699\n1.5734\n0.6244\n\n\nIMD4\n0.7481\n0.4148\n1.3491\n0.3347\n\n\nIMD5\n0.7802\n0.4412\n1.3800\n0.3937\n\n\ncatFC 50-250\n1.8928\n1.3283\n2.6973\n0.0004\n\n\ncatFC &gt; 250\n3.4895\n2.3810\n5.1142\n0.0000\n\n\nvas_control85+\n0.9359\n0.6894\n1.2705\n0.6708\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.6756\n0.9837\n0.1918\n\n\nIMD\n7.9021\n3.9395\n0.0918\n\n\ncat\n8.1082\n1.9864\n0.0171\n\n\nvas_control\n0.2524\n0.9877\n0.6102\n\n\nGLOBAL\n20.3223\n15.8147\n0.1970\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Handle VAS control (already categorized as character)\nflare.uc.df$vas_control_cat &lt;- factor(flare.uc.df$vas_control)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"vas_control\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"IBD Control VAS\",\n  plot_base_path = \"plots/uc/soft-flare/ibd/control-vas\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for vas_control variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5419\n1.2247\n1.9413\n0.0002\n\n\nIMD2\n1.3325\n0.7893\n2.2496\n0.2826\n\n\nIMD3\n1.2056\n0.7280\n1.9968\n0.4675\n\n\nIMD4\n1.4696\n0.9046\n2.3874\n0.1199\n\n\nIMD5\n1.3493\n0.8371\n2.1749\n0.2188\n\n\ncatFC 50-250\n1.5798\n1.2174\n2.0502\n0.0006\n\n\ncatFC &gt; 250\n1.9587\n1.4652\n2.6185\n0.0000\n\n\nvas_control85+\n0.6861\n0.5423\n0.8679\n0.0017\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.9736\n0.9943\n0.0840\n\n\nIMD\n4.3116\n3.9618\n0.3601\n\n\ncat\n5.7100\n1.9817\n0.0566\n\n\nvas_control\n3.5219\n0.9923\n0.0599\n\n\nGLOBAL\n16.5023\n13.4488\n0.2495\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"vas_control\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"IBD Control VAS\",\n  plot_base_path = \"plots/uc/hard-flare/ibd/control-vas\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Extract hazard ratio for vas_control variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3848\n1.0220\n1.8763\n0.0357\n\n\nIMD2\n1.2918\n0.6208\n2.6877\n0.4935\n\n\nIMD3\n1.4220\n0.7087\n2.8532\n0.3218\n\n\nIMD4\n1.9936\n1.0297\n3.8599\n0.0407\n\n\nIMD5\n1.5530\n0.8031\n3.0034\n0.1908\n\n\ncatFC 50-250\n2.0459\n1.4357\n2.9155\n0.0001\n\n\ncatFC &gt; 250\n2.9077\n1.9851\n4.2592\n0.0000\n\n\nvas_control85+\n0.6559\n0.4815\n0.8933\n0.0075\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1785\n0.9852\n0.6666\n\n\nIMD\n2.8643\n3.9383\n0.5711\n\n\ncat\n3.3111\n1.9665\n0.1862\n\n\nvas_control\n0.2632\n0.9852\n0.6017\n\n\nGLOBAL\n7.3842\n23.0999\n0.9992\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#biologic-use",
    "href": "Survival/IBD.html#biologic-use",
    "title": "Inflammatory bowel disease",
    "section": "Biologic use",
    "text": "Biologic use\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Transform biologic variable and create categorized version\nflare.cd.df &lt;- flare.cd.df %&gt;%\n  mutate(Biologic = plyr::mapvalues(Biologic,\n                                    from = c(\"Current\",\n                                             \"Previously\",\n                                             \"Never prescribed\"),\n                                    to = c(\"Prescribed\",\n                                           \"Not prescribed\",\n                                           \"Not prescribed\")))\n\n# Create categorized version for survival analysis\nflare.cd.df$Biologic_cat &lt;- flare.cd.df$Biologic\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Biologic\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Biologic\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/biologic\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Biologic + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9618\n1.5445\n2.4920\n0.0000\n\n\nIMD2\n0.9342\n0.5961\n1.4640\n0.7665\n\n\nIMD3\n0.8935\n0.5657\n1.4112\n0.6293\n\n\nIMD4\n0.9413\n0.6065\n1.4608\n0.7872\n\n\nIMD5\n0.9803\n0.6415\n1.4982\n0.9269\n\n\ncatFC 50-250\n1.5753\n1.2209\n2.0325\n0.0005\n\n\ncatFC &gt; 250\n2.4212\n1.8260\n3.2105\n0.0000\n\n\nBiologicNot prescribed\n1.1577\n0.9238\n1.4509\n0.2034\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3184\n0.9938\n0.5700\n\n\nIMD\n5.8410\n3.9587\n0.2071\n\n\ncat\n2.2735\n1.9848\n0.3178\n\n\nBiologic\n6.5065\n0.9707\n0.0102\n\n\nGLOBAL\n15.8608\n13.0633\n0.2607\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Biologic\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Biologic\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/biologic\",\n  break_time_by = 500,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Biologic + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3883\n1.0557\n1.8257\n0.0189\n\n\nIMD2\n0.9219\n0.5363\n1.5847\n0.7685\n\n\nIMD3\n0.9676\n0.5566\n1.6820\n0.9070\n\n\nIMD4\n0.8948\n0.5220\n1.5340\n0.6862\n\n\nIMD5\n0.9034\n0.5369\n1.5200\n0.7019\n\n\ncatFC 50-250\n2.0215\n1.4724\n2.7754\n0.0000\n\n\ncatFC &gt; 250\n3.3369\n2.3692\n4.6999\n0.0000\n\n\nBiologicNot prescribed\n1.0022\n0.7633\n1.3158\n0.9876\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2572\n0.9867\n0.6065\n\n\nIMD\n4.2175\n3.9404\n0.3689\n\n\ncat\n8.8719\n1.9846\n0.0116\n\n\nBiologic\n0.0442\n0.9583\n0.8196\n\n\nGLOBAL\n14.1651\n20.5809\n0.8464\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Transform biologic variable and create categorized version\nflare.uc.df &lt;- flare.uc.df %&gt;%\n  mutate(Biologic = plyr::mapvalues(Biologic,\n                                    from = c(\"Current\",\n                                             \"Previously\",\n                                             \"Never prescribed\"),\n                                    to = c(\"Prescribed\",\n                                           \"Not prescribed\",\n                                           \"Not prescribed\")))\n\n# Create categorized version for survival analysis\nflare.uc.df$Biologic_cat &lt;- flare.uc.df$Biologic\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Biologic\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Biologic\",\n  plot_base_path = \"plots/uc/soft-flare/ibd/biologic\",\n  break_time_by = 200,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Biologic + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5457\n1.2492\n1.9126\n0.0001\n\n\nIMD2\n1.2605\n0.7970\n1.9934\n0.3223\n\n\nIMD3\n1.0597\n0.6766\n1.6596\n0.8001\n\n\nIMD4\n1.4046\n0.9150\n2.1560\n0.1202\n\n\nIMD5\n1.1438\n0.7503\n1.7438\n0.5322\n\n\ncatFC 50-250\n1.5415\n1.2061\n1.9702\n0.0005\n\n\ncatFC &gt; 250\n2.1682\n1.6622\n2.8283\n0.0000\n\n\nBiologicNot prescribed\n1.6853\n1.2700\n2.2363\n0.0003\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.2814\n0.9920\n0.2554\n\n\nIMD\n4.0168\n3.9495\n0.3963\n\n\ncat\n5.5881\n1.9739\n0.0597\n\n\nBiologic\n0.8627\n0.9374\n0.3312\n\n\nGLOBAL\n12.2828\n17.5375\n0.8105\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Biologic\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Biologic\",\n  plot_base_path = \"plots/uc/hard-flare/ibd/biologic\",\n  break_time_by = 500,\n  palette = c(\"#1A8FE3\", \"#E76D83\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Biologic + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3299\n1.0239\n1.7273\n0.0326\n\n\nIMD2\n1.4037\n0.7829\n2.5167\n0.2549\n\n\nIMD3\n1.3959\n0.7936\n2.4554\n0.2471\n\n\nIMD4\n1.7610\n1.0200\n3.0403\n0.0422\n\n\nIMD5\n1.3247\n0.7702\n2.2783\n0.3095\n\n\ncatFC 50-250\n2.0523\n1.5024\n2.8035\n0.0000\n\n\ncatFC &gt; 250\n3.2198\n2.3238\n4.4613\n0.0000\n\n\nBiologicNot prescribed\n0.8410\n0.6128\n1.1542\n0.2838\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1497\n0.9849\n0.6927\n\n\nIMD\n2.5933\n3.9365\n0.6182\n\n\ncat\n4.3484\n1.9676\n0.1106\n\n\nBiologic\n3.8871\n0.9212\n0.0431\n\n\nGLOBAL\n11.4032\n24.4735\n0.9884\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#variables-only-relevant-to-crohns-disease",
    "href": "Survival/IBD.html#variables-only-relevant-to-crohns-disease",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to Crohn’s disease",
    "text": "Variables only relevant to Crohn’s disease\n\nCodedemo.cd &lt;- readRDS(paste0(paths$outdir, \"demo-cd.RDS\"))\ndemo.cd &lt;- demo.cd[, c(\n  \"ParticipantNo\",\n  \"Surgery\",\n  \"Location\",\n  \"L4\",\n  \"Behaviour\",\n  \"Perianal\",\n  \"HBI\",\n  \"PRO2\"\n)]\nflare.cd.df &lt;- merge(flare.cd.df,\n  demo.cd,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n# Create categorized versions for survival analysis\nflare.cd.df$Surgery_cat &lt;- flare.cd.df$Surgery\nflare.cd.df$Location_cat &lt;- flare.cd.df$Location\nflare.cd.df$L4_cat &lt;- flare.cd.df$L4\nflare.cd.df$Behaviour_cat &lt;- flare.cd.df$Behaviour\nflare.cd.df$Perianal_cat &lt;- flare.cd.df$Perianal\n\n\nSurgery\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Surgery\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Previous surgery\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/surgery\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Surgery +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ncd.clin.forest &lt;- rbind(cd.clin.forest, get_HR(fit.me, \"SurgeryYes\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9970\n1.5704\n2.5394\n0.0000\n\n\ncatFC 50-250\n1.5774\n1.2210\n2.0379\n0.0005\n\n\ncatFC &gt; 250\n2.3834\n1.7891\n3.1751\n0.0000\n\n\nIMD2\n0.8921\n0.5692\n1.3983\n0.6186\n\n\nIMD3\n0.8326\n0.5264\n1.3170\n0.4336\n\n\nIMD4\n0.8750\n0.5640\n1.3575\n0.5512\n\n\nIMD5\n0.9325\n0.6106\n1.4240\n0.7462\n\n\nSurgeryYes\n1.0130\n0.8111\n1.2652\n0.9092\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3138\n0.9943\n0.5730\n\n\ncat\n2.4348\n1.9874\n0.2936\n\n\nIMD\n5.3005\n3.9665\n0.2539\n\n\nSurgery\n0.6320\n0.9915\n0.4234\n\n\nGLOBAL\n8.9435\n11.8427\n0.6958\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Surgery\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Previous surgery\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/surgery\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Surgery +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ncd.hard.forest &lt;- rbind(cd.hard.forest, get_HR(fit.me, \"SurgeryYes\"))\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4133\n1.0743\n1.8592\n0.0134\n\n\ncatFC 50-250\n2.0584\n1.4977\n2.8292\n0.0000\n\n\ncatFC &gt; 250\n3.2393\n2.2905\n4.5812\n0.0000\n\n\nIMD2\n0.8768\n0.5106\n1.5058\n0.6338\n\n\nIMD3\n0.8923\n0.5114\n1.5569\n0.6882\n\n\nIMD4\n0.8420\n0.4913\n1.4430\n0.5314\n\n\nIMD5\n0.8745\n0.5201\n1.4706\n0.6132\n\n\nSurgeryYes\n0.7516\n0.5744\n0.9835\n0.0374\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3300\n0.9858\n0.5597\n\n\ncat\n8.5496\n1.9843\n0.0137\n\n\nIMD\n4.0006\n3.9415\n0.3973\n\n\nSurgery\n2.5667\n0.9872\n0.1073\n\n\nGLOBAL\n17.3483\n20.3096\n0.6492\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMontreal location\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Location\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Montreal location\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/location\",\n  break_time_by = 200,\n  palette = c(\"#3B3561\", \"#5BC0EB\", \"#FFD166\", \"#E4572E\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Location +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, c(\"LocationL2\", \"LocationL3\"))\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0379\n1.5673\n2.6498\n0.0000\n\n\ncatFC 50-250\n1.6798\n1.2692\n2.2231\n0.0003\n\n\ncatFC &gt; 250\n2.4535\n1.8007\n3.3429\n0.0000\n\n\nIMD2\n0.9218\n0.5727\n1.4836\n0.7372\n\n\nIMD3\n0.8187\n0.5015\n1.3365\n0.4237\n\n\nIMD4\n0.8363\n0.5225\n1.3386\n0.4564\n\n\nIMD5\n0.9443\n0.6018\n1.4816\n0.8029\n\n\nLocationL2\n0.8397\n0.6095\n1.1570\n0.2855\n\n\nLocationL3\n1.0929\n0.8212\n1.4543\n0.5425\n\n\nLocationL4 only\n0.9482\n0.2984\n3.0126\n0.9281\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2323\n0.9980\n0.6290\n\n\ncat\n3.2675\n1.9968\n0.1947\n\n\nIMD\n5.1401\n3.9898\n0.2720\n\n\nLocation\n1.1604\n2.9932\n0.7614\n\n\nGLOBAL\n9.8488\n10.7869\n0.5251\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Location\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Montreal location\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/location\",\n  break_time_by = 200,\n  palette = c(\"#3B3561\", \"#5BC0EB\", \"#FFD166\", \"#E4572E\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Location +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, c(\"LocationL2\", \"LocationL3\"))\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4122\n1.0506\n1.8982\n0.0222\n\n\ncatFC 50-250\n1.9337\n1.3740\n2.7214\n0.0002\n\n\ncatFC &gt; 250\n3.1807\n2.2094\n4.5789\n0.0000\n\n\nIMD2\n0.8819\n0.4941\n1.5742\n0.6707\n\n\nIMD3\n0.9504\n0.5256\n1.7185\n0.8663\n\n\nIMD4\n0.9099\n0.5129\n1.6144\n0.7470\n\n\nIMD5\n0.9891\n0.5687\n1.7202\n0.9691\n\n\nLocationL2\n1.2964\n0.8834\n1.9025\n0.1846\n\n\nLocationL3\n1.3328\n0.9285\n1.9132\n0.1193\n\n\nLocationL4 only\n1.2113\n0.2871\n5.1108\n0.7941\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1424\n0.9830\n0.6991\n\n\ncat\n6.3620\n1.9837\n0.0409\n\n\nIMD\n3.8329\n3.9412\n0.4203\n\n\nLocation\n0.5903\n2.9550\n0.8941\n\n\nGLOBAL\n11.3705\n21.5180\n0.9629\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMontreal L4\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"L4\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Montreal L4 presence\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/l4\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + L4 +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"L4Present\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0268\n1.5589\n2.6350\n0.0000\n\n\ncatFC 50-250\n1.6892\n1.2767\n2.2352\n0.0002\n\n\ncatFC &gt; 250\n2.3738\n1.7423\n3.2342\n0.0000\n\n\nIMD2\n0.8815\n0.5472\n1.4199\n0.6040\n\n\nIMD3\n0.7833\n0.4794\n1.2799\n0.3296\n\n\nIMD4\n0.8069\n0.5031\n1.2941\n0.3733\n\n\nIMD5\n0.9046\n0.5765\n1.4193\n0.6625\n\n\nL4Present\n1.2936\n0.9172\n1.8244\n0.1423\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2367\n0.9981\n0.6258\n\n\ncat\n3.4174\n1.9965\n0.1806\n\n\nIMD\n5.2745\n3.9899\n0.2591\n\n\nL4\n2.9817\n0.9968\n0.0838\n\n\nGLOBAL\n12.5997\n8.8065\n0.1700\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"L4\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Montreal L4 presence\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/l4\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + L4 +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"L4Present\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4360\n1.0684\n1.9301\n0.0165\n\n\ncatFC 50-250\n1.9358\n1.3756\n2.7240\n0.0002\n\n\ncatFC &gt; 250\n3.1320\n2.1758\n4.5085\n0.0000\n\n\nIMD2\n0.8257\n0.4627\n1.4736\n0.5170\n\n\nIMD3\n0.8677\n0.4791\n1.5715\n0.6396\n\n\nIMD4\n0.8321\n0.4680\n1.4794\n0.5314\n\n\nIMD5\n0.9026\n0.5188\n1.5705\n0.7169\n\n\nL4Present\n1.5676\n1.0693\n2.2981\n0.0213\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1595\n0.9826\n0.6825\n\n\ncat\n6.4740\n1.9836\n0.0386\n\n\nIMD\n4.0148\n3.9425\n0.3956\n\n\nL4\n0.0375\n0.9606\n0.8338\n\n\nGLOBAL\n10.7469\n19.2888\n0.9386\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMontreal Behaviour\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Behaviour\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Montreal behaviour\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/behaviour\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#FFD166\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Behaviour +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, c(\"BehaviourB2\", \"BehaviourB3\"))\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0640\n1.5766\n2.7020\n0.0000\n\n\ncatFC 50-250\n1.6340\n1.2279\n2.1746\n0.0008\n\n\ncatFC &gt; 250\n2.3258\n1.6953\n3.1909\n0.0000\n\n\nIMD2\n0.9230\n0.5693\n1.4965\n0.7452\n\n\nIMD3\n0.7493\n0.4518\n1.2430\n0.2637\n\n\nIMD4\n0.8865\n0.5480\n1.4342\n0.6236\n\n\nIMD5\n0.9870\n0.6239\n1.5614\n0.9554\n\n\nBehaviourB2\n1.0662\n0.7953\n1.4294\n0.6683\n\n\nBehaviourB3\n0.7879\n0.4947\n1.2549\n0.3155\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1946\n0.9978\n0.6582\n\n\ncat\n3.9115\n1.9961\n0.1410\n\n\nIMD\n4.3369\n3.9877\n0.3606\n\n\nBehaviour\n0.9019\n1.9953\n0.6359\n\n\nGLOBAL\n9.4596\n10.0044\n0.4895\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Behaviour\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Montreal behaviour\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/behaviour\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#FFD166\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Behaviour +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, c(\"BehaviourB2\", \"BehaviourB3\"))\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5091\n1.1174\n2.0383\n0.0073\n\n\ncatFC 50-250\n2.0811\n1.4681\n2.9499\n0.0000\n\n\ncatFC &gt; 250\n3.4647\n2.3857\n5.0316\n0.0000\n\n\nIMD2\n0.9419\n0.5228\n1.6971\n0.8421\n\n\nIMD3\n0.8970\n0.4872\n1.6518\n0.7272\n\n\nIMD4\n0.9794\n0.5448\n1.7605\n0.9444\n\n\nIMD5\n1.0317\n0.5866\n1.8145\n0.9137\n\n\nBehaviourB2\n0.8913\n0.6267\n1.2677\n0.5221\n\n\nBehaviourB3\n0.8505\n0.5012\n1.4431\n0.5483\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0070\n0.9845\n0.9303\n\n\ncat\n5.6993\n1.9835\n0.0570\n\n\nIMD\n2.8336\n3.9427\n0.5771\n\n\nBehaviour\n2.7982\n1.9761\n0.2427\n\n\nGLOBAL\n12.1681\n20.1919\n0.9154\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nPerinanal disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Perianal\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Perianal disease\",\n  plot_base_path = \"plots/cd/soft-flare/ibd/perinal\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Perianal +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.clin.forest &lt;- rbind(\n  cd.clin.forest,\n  get_HR(fit.me, \"PerianalYes\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0572\n1.5795\n2.6794\n0.0000\n\n\ncatFC 50-250\n1.6277\n1.2282\n2.1573\n0.0007\n\n\ncatFC &gt; 250\n2.3910\n1.7543\n3.2587\n0.0000\n\n\nIMD2\n0.9586\n0.5934\n1.5485\n0.8628\n\n\nIMD3\n0.8177\n0.4975\n1.3441\n0.4274\n\n\nIMD4\n0.8333\n0.5158\n1.3464\n0.4564\n\n\nIMD5\n0.8992\n0.5679\n1.4237\n0.6503\n\n\nPerianalYes\n1.3022\n1.0174\n1.6667\n0.0360\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0684\n0.9950\n0.7920\n\n\ncat\n4.5984\n1.9892\n0.0994\n\n\nIMD\n5.5262\n3.9719\n0.2343\n\n\nPerianal\n0.2214\n0.9919\n0.6346\n\n\nGLOBAL\n10.2702\n10.9257\n0.4997\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Perianal\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Perianal disease\",\n  plot_base_path = \"plots/cd/hard-flare/ibd/perinal\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Perianal +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\ncd.hard.forest &lt;- rbind(\n  cd.hard.forest,\n  get_HR(fit.me, \"PerianalYes\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4036\n1.0483\n1.8795\n0.0228\n\n\ncatFC 50-250\n1.8951\n1.3518\n2.6569\n0.0002\n\n\ncatFC &gt; 250\n3.1094\n2.1650\n4.4659\n0.0000\n\n\nIMD2\n0.9969\n0.5566\n1.7855\n0.9918\n\n\nIMD3\n1.0334\n0.5690\n1.8768\n0.9140\n\n\nIMD4\n0.9261\n0.5160\n1.6621\n0.7969\n\n\nIMD5\n0.9379\n0.5339\n1.6477\n0.8235\n\n\nPerianalYes\n1.1428\n0.8537\n1.5299\n0.3697\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1937\n0.9841\n0.6533\n\n\ncat\n7.0942\n1.9838\n0.0283\n\n\nIMD\n2.3289\n3.9479\n0.6677\n\n\nPerianal\n1.9313\n0.9841\n0.1614\n\n\nGLOBAL\n11.5538\n19.8863\n0.9279\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#variables-only-relevant-to-ucibdu",
    "href": "Survival/IBD.html#variables-only-relevant-to-ucibdu",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to UC/IBDU",
    "text": "Variables only relevant to UC/IBDU\n\nCodedemo.uc &lt;- readRDS(paste0(paths$outdir, \"demo-uc.RDS\"))\ndemo.uc &lt;- demo.uc[, c(\"ParticipantNo\", \"Extent\", \"Mayo\")]\nflare.uc.df &lt;- merge(flare.uc.df,\n  demo.uc,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n# Create categorized version for survival analysis\nflare.uc.df$Extent_cat &lt;- flare.uc.df$Extent\n\n\nMontreal extent\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Extent\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Montreal extent\",\n  plot_base_path = \"plots/uc/soft-flare/ibd/extent\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Extent +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, c(\"ExtentE2\", \"ExtentE3\"))\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4261\n1.1158\n1.8227\n0.0046\n\n\ncatFC 50-250\n1.6346\n1.2328\n2.1673\n0.0006\n\n\ncatFC &gt; 250\n2.2553\n1.6710\n3.0440\n0.0000\n\n\nIMD2\n1.2814\n0.7812\n2.1019\n0.3262\n\n\nIMD3\n1.0697\n0.6587\n1.7371\n0.7854\n\n\nIMD4\n1.4373\n0.9127\n2.2636\n0.1175\n\n\nIMD5\n1.1749\n0.7483\n1.8449\n0.4838\n\n\nExtentE2\n0.9196\n0.6607\n1.2801\n0.6196\n\n\nExtentE3\n0.6967\n0.4810\n1.0090\n0.0558\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0215\n0.9891\n0.8804\n\n\ncat\n4.6159\n1.9587\n0.0959\n\n\nIMD\n2.9011\n3.9332\n0.5640\n\n\nExtent\n4.1788\n1.9657\n0.1202\n\n\nGLOBAL\n12.0732\n21.9250\n0.9547\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Extent\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Montreal extent\",\n  plot_base_path = \"plots/uc/hard-flare/ibd/extent\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\")\n)\n\n# Cox model\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Extent +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, c(\"ExtentE2\", \"ExtentE3\"))\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4242\n1.0492\n1.9334\n0.0234\n\n\ncatFC 50-250\n1.9574\n1.3666\n2.8037\n0.0002\n\n\ncatFC &gt; 250\n3.2458\n2.2460\n4.6907\n0.0000\n\n\nIMD2\n1.6852\n0.8594\n3.3047\n0.1288\n\n\nIMD3\n1.6813\n0.8824\n3.2033\n0.1142\n\n\nIMD4\n2.2154\n1.1918\n4.1182\n0.0119\n\n\nIMD5\n1.6230\n0.8722\n3.0201\n0.1264\n\n\nExtentE2\n2.1493\n1.2632\n3.6570\n0.0048\n\n\nExtentE3\n1.8507\n1.0529\n3.2532\n0.0324\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.6040\n0.9857\n0.4315\n\n\ncat\n5.9334\n1.9616\n0.0496\n\n\nIMD\n2.5189\n3.9364\n0.6315\n\n\nExtent\n0.7654\n1.9746\n0.6760\n\n\nGLOBAL\n9.5946\n21.8882\n0.9891\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMayo score\n\nCodeflare.uc.df$Mayo_cat &lt;- cut(flare.uc.df$Mayo,\n  c(0, 2, 5, 9),\n  labels = c(\"Inactive\", \"Mild\", \"Moderate\"),\n  right = TRUE\n)\n\n\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Mayo\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Mayo score\",\n  plot_base_path = \"plots/uc/soft-flare/ibd/mayo\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\")\n)\n\n# Cox model using continuous Mayo variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + Mayo + Extent +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.clin.forest &lt;- rbind(\n  uc.clin.forest,\n  get_HR(fit.me, \"Mayo\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4049\n1.0761\n1.8343\n0.0125\n\n\ncatFC 50-250\n1.6646\n1.2283\n2.2557\n0.0010\n\n\ncatFC &gt; 250\n2.4320\n1.7451\n3.3892\n0.0000\n\n\nMayo\n1.1117\n1.0094\n1.2243\n0.0316\n\n\nExtentE2\n1.0050\n0.6957\n1.4518\n0.9789\n\n\nExtentE3\n0.7477\n0.4960\n1.1274\n0.1652\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2221\n0.9943\n0.6351\n\n\ncat\n3.2655\n1.9791\n0.1924\n\n\nMayo\n2.8510\n0.9265\n0.0823\n\n\nExtent\n4.4854\n1.9674\n0.1032\n\n\nGLOBAL\n10.5608\n13.9227\n0.7149\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Mayo\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Mayo score\",\n  plot_base_path = \"plots/uc/hard-flare/ibd/mayo\",\n  break_time_by = 200,\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\")\n)\n\n# Cox model using continuous Mayo variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Mayo +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\nuc.hard.forest &lt;- rbind(\n  uc.hard.forest,\n  get_HR(fit.me, \"Mayo\")\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2672\n0.9438\n1.7015\n0.1152\n\n\ncatFC 50-250\n1.8912\n1.3331\n2.6830\n0.0004\n\n\ncatFC &gt; 250\n3.1128\n2.1355\n4.5373\n0.0000\n\n\nIMD2\n1.6242\n0.8553\n3.0844\n0.1383\n\n\nIMD3\n1.1995\n0.6373\n2.2574\n0.5729\n\n\nIMD4\n1.5787\n0.8645\n2.8828\n0.1373\n\n\nIMD5\n1.2277\n0.6754\n2.2314\n0.5011\n\n\nMayo\n1.0890\n0.9753\n1.2161\n0.1297\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0043\n0.9878\n0.9457\n\n\ncat\n3.1681\n1.9834\n0.2026\n\n\nIMD\n1.4273\n3.9518\n0.8342\n\n\nMayo\n0.1658\n0.9504\n0.6632\n\n\nGLOBAL\n4.6901\n17.1518\n0.9987\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(paths$outdir, \"flares-IBD.RDS\"))\nsaveRDS(flare.cd.df, paste0(paths$outdir, \"flares-IBD-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(paths$outdir, \"flares-IBD-uc.RDS\"))\n\nsaveRDS(cd.clin.forest, paste0(paths$outdir, \"cd-clin-IBD.RDS\"))\nsaveRDS(cd.hard.forest, paste0(paths$outdir, \"cd-hard-IBD.RDS\"))\nsaveRDS(uc.clin.forest, paste0(paths$outdir, \"uc-clin-IBD.RDS\"))\nsaveRDS(uc.hard.forest, paste0(paths$outdir, \"uc-hard-IBD.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#reproduction-and-reproducibility",
    "href": "Survival/IBD.html#reproduction-and-reproducibility",
    "title": "Inflammatory bowel disease",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), plyr(v.1.8.9), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/Diet.html",
    "href": "Survival/Diet.html",
    "title": "Diet",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\ndemo$FC &lt;- log(demo$FC)\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-biochem.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-biochem-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-biochem-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#introduction",
    "href": "Survival/Diet.html#introduction",
    "title": "Diet",
    "section": "",
    "text": "Codesource(\"Survival/utils.R\")\n\n# Setup analysis environment\nanalysis_setup &lt;- setup_analysis()\npaths &lt;- analysis_setup$paths\ndemo &lt;- analysis_setup$demo\n\ndemo$FC &lt;- log(demo$FC)\n\nflare.df &lt;- readRDS(paste0(paths$outdir, \"flares-biochem.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(paths$outdir, \"flares-biochem-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(paths$outdir, \"flares-biochem-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#total-meat-protein",
    "href": "Survival/Diet.html#total-meat-protein",
    "title": "Diet",
    "section": "Total meat protein",
    "text": "Total meat protein\nProtein intake from animal sources is not found to be significantly associated with flares in CD. However, there is evidence of an association for UC. At present, it is difficult to explore this in more detail (e.g. by meat type).\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize meat protein by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"Meat_sum\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Meat_sum\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Meat protein quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/meat\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + Meat_sum_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9330\n1.3884\n2.6912\n0.0001\n\n\ncatFC 50-250\n1.3110\n0.9289\n1.8504\n0.1235\n\n\ncatFC &gt; 250\n1.9974\n1.3682\n2.9160\n0.0003\n\n\nIMD2\n0.7245\n0.3828\n1.3713\n0.3222\n\n\nIMD3\n0.9050\n0.4996\n1.6395\n0.7420\n\n\nIMD4\n0.8296\n0.4564\n1.5079\n0.5400\n\n\nIMD5\n0.9966\n0.5737\n1.7313\n0.9904\n\n\ndqi_tot\n1.0039\n0.9902\n1.0177\n0.5800\n\n\nMeat_sum_cat[24.9,35.8)\n0.9972\n0.6580\n1.5114\n0.9896\n\n\nMeat_sum_cat[35.8,50.6)\n0.8668\n0.5687\n1.3213\n0.5064\n\n\nMeat_sum_cat[50.6,331]\n0.9280\n0.5963\n1.4442\n0.7406\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2035\n1.0000\n0.6519\n\n\ncat\n1.0755\n2.0000\n0.5841\n\n\nIMD\n3.0237\n4.0000\n0.5539\n\n\ndqi_tot\n0.1664\n1.0000\n0.6834\n\n\nMeat_sum_cat\n1.3198\n3.0000\n0.7244\n\n\nGLOBAL\n5.5992\n11.0001\n0.8987\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"Meat_sum\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Meat protein quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/meat\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + Meat_sum_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2718\n0.8442\n1.9160\n0.2501\n\n\ncatFC 50-250\n1.9436\n1.2242\n3.0859\n0.0048\n\n\ncatFC &gt; 250\n2.9448\n1.7832\n4.8629\n0.0000\n\n\nIMD2\n0.5613\n0.2421\n1.3010\n0.1781\n\n\nIMD3\n0.7347\n0.3371\n1.6014\n0.4381\n\n\nIMD4\n0.6942\n0.3202\n1.5051\n0.3552\n\n\nIMD5\n0.6491\n0.3135\n1.3436\n0.2443\n\n\ndqi_tot\n1.0027\n0.9849\n1.0208\n0.7668\n\n\nMeat_sum_cat[24.9,35.8)\n1.3035\n0.7468\n2.2752\n0.3509\n\n\nMeat_sum_cat[35.8,50.6)\n1.1908\n0.6836\n2.0743\n0.5374\n\n\nMeat_sum_cat[50.6,331]\n0.9684\n0.5387\n1.7407\n0.9145\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0858\n0.9758\n0.7605\n\n\ncat\n10.6562\n1.9802\n0.0047\n\n\nIMD\n2.8910\n3.9262\n0.5646\n\n\ndqi_tot\n2.8736\n0.9913\n0.0890\n\n\nMeat_sum_cat\n2.8562\n2.9740\n0.4098\n\n\nGLOBAL\n21.6864\n17.0383\n0.1989\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize meat protein by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"Meat_sum\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Meat_sum\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Meat protein quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/meat\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + Meat_sum_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7482\n1.3166\n2.3214\n0.0001\n\n\ncatFC 50-250\n1.8207\n1.3322\n2.4883\n0.0002\n\n\ncatFC &gt; 250\n2.1674\n1.5186\n3.0933\n0.0000\n\n\nIMD2\n1.5406\n0.8082\n2.9368\n0.1892\n\n\nIMD3\n1.3026\n0.7003\n2.4229\n0.4038\n\n\nIMD4\n1.4203\n0.7876\n2.5613\n0.2434\n\n\nIMD5\n1.3201\n0.7406\n2.3529\n0.3464\n\n\ndqi_tot\n1.0034\n0.9904\n1.0166\n0.6107\n\n\nMeat_sum_cat[24.9,35.8)\n1.1736\n0.7894\n1.7448\n0.4289\n\n\nMeat_sum_cat[35.8,50.6)\n1.3622\n0.9159\n2.0259\n0.1270\n\n\nMeat_sum_cat[50.6,331]\n1.2700\n0.8408\n1.9185\n0.2560\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0456\n0.9999\n0.8309\n\n\ncat\n3.8911\n1.9999\n0.1429\n\n\nIMD\n2.6428\n3.9999\n0.6192\n\n\ndqi_tot\n0.6440\n1.0000\n0.4223\n\n\nMeat_sum_cat\n11.4044\n2.9999\n0.0097\n\n\nGLOBAL\n18.1848\n11.0089\n0.0776\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"Meat_sum\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Meat protein quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/meat\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + Meat_sum_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2917\n0.8895\n1.8756\n0.1787\n\n\ncatFC 50-250\n1.9278\n1.2624\n2.9439\n0.0024\n\n\ncatFC &gt; 250\n2.4267\n1.4961\n3.9360\n0.0003\n\n\nIMD2\n1.6747\n0.6343\n4.4215\n0.2979\n\n\nIMD3\n1.5942\n0.6246\n4.0687\n0.3293\n\n\nIMD4\n2.6769\n1.1151\n6.4257\n0.0275\n\n\nIMD5\n1.6306\n0.6779\n3.9222\n0.2749\n\n\ndqi_tot\n1.0115\n0.9934\n1.0301\n0.2147\n\n\nMeat_sum_cat[24.9,35.8)\n1.3961\n0.7831\n2.4891\n0.2580\n\n\nMeat_sum_cat[35.8,50.6)\n1.5504\n0.8753\n2.7461\n0.1327\n\n\nMeat_sum_cat[50.6,331]\n2.1853\n1.2371\n3.8603\n0.0071\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1730\n0.9851\n0.6714\n\n\ncat\n7.0075\n1.9595\n0.0288\n\n\nIMD\n1.8409\n3.9355\n0.7564\n\n\ndqi_tot\n0.0332\n0.9866\n0.8513\n\n\nMeat_sum_cat\n1.1868\n2.9607\n0.7498\n\n\nGLOBAL\n10.4857\n18.8915\n0.9376\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize meat protein by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"Meat_sum\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"Meat_sum\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Meat protein quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/meat\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + Meat_sum_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7655\n1.4275\n2.1834\n0.0000\n\n\ncatFC 50-250\n1.5389\n1.2227\n1.9369\n0.0002\n\n\ncatFC &gt; 250\n2.0361\n1.5728\n2.6359\n0.0000\n\n\nIMD2\n1.0276\n0.6548\n1.6126\n0.9059\n\n\nIMD3\n1.0568\n0.6893\n1.6202\n0.7999\n\n\nIMD4\n1.1037\n0.7289\n1.6712\n0.6412\n\n\nIMD5\n1.1073\n0.7443\n1.6474\n0.6149\n\n\ndqi_tot\n1.0035\n0.9941\n1.0129\n0.4646\n\n\nMeat_sum_cat[24.9,35.8)\n1.0840\n0.8143\n1.4429\n0.5806\n\n\nMeat_sum_cat[35.8,50.6)\n1.1101\n0.8338\n1.4779\n0.4743\n\n\nMeat_sum_cat[50.6,331]\n1.0996\n0.8149\n1.4839\n0.5346\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0003\n1.0000\n0.9858\n\n\ncat\n0.8204\n2.0000\n0.6635\n\n\nIMD\n4.6867\n4.0000\n0.3210\n\n\ndqi_tot\n0.9433\n1.0000\n0.3314\n\n\nMeat_sum_cat\n7.6387\n3.0000\n0.0541\n\n\nGLOBAL\n13.9143\n11.0002\n0.2378\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"Meat_sum\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Meat protein quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/meat\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + Meat_sum_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2339\n0.9394\n1.6209\n0.1309\n\n\ncatFC 50-250\n1.8917\n1.3882\n2.5777\n0.0001\n\n\ncatFC &gt; 250\n2.6316\n1.8634\n3.7165\n0.0000\n\n\nIMD2\n0.9745\n0.5203\n1.8252\n0.9357\n\n\nIMD3\n1.0492\n0.5795\n1.8996\n0.8740\n\n\nIMD4\n1.4170\n0.8068\n2.4888\n0.2252\n\n\nIMD5\n1.0324\n0.5939\n1.7948\n0.9100\n\n\ndqi_tot\n1.0063\n0.9937\n1.0191\n0.3262\n\n\nMeat_sum_cat[24.9,35.8)\n1.3293\n0.8923\n1.9805\n0.1616\n\n\nMeat_sum_cat[35.8,50.6)\n1.3662\n0.9215\n2.0256\n0.1204\n\n\nMeat_sum_cat[50.6,331]\n1.5038\n1.0091\n2.2411\n0.0450\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1190\n0.9876\n0.7253\n\n\ncat\n6.5934\n1.9792\n0.0362\n\n\nIMD\n2.3284\n3.9449\n0.6674\n\n\ndqi_tot\n1.4570\n0.9915\n0.2252\n\n\nMeat_sum_cat\n1.2857\n2.9785\n0.7289\n\n\nGLOBAL\n12.6525\n22.9723\n0.9587\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#overall-meat-intake",
    "href": "Survival/Diet.html#overall-meat-intake",
    "title": "Diet",
    "section": "Overall meat intake",
    "text": "Overall meat intake\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize overall meat intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"meat_overall\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"meat_overall\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Meat intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/meat_overall\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-overall-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + meat_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9283\n1.3852\n2.6842\n0.0001\n\n\ncatFC 50-250\n1.3105\n0.9275\n1.8516\n0.1252\n\n\ncatFC &gt; 250\n2.0021\n1.3693\n2.9275\n0.0003\n\n\nIMD2\n0.7228\n0.3804\n1.3732\n0.3215\n\n\nIMD3\n0.8950\n0.4922\n1.6273\n0.7161\n\n\nIMD4\n0.8338\n0.4587\n1.5153\n0.5509\n\n\nIMD5\n0.9839\n0.5656\n1.7115\n0.9542\n\n\ndqi_tot\n1.0027\n0.9881\n1.0175\n0.7219\n\n\nmeat_overall_cat[59.5,101\n0.9729\n0.6398\n1.4793\n0.8976\n\n\nmeat_overall_cat[101,153)\n0.8923\n0.5762\n1.3816\n0.6094\n\n\nmeat_overall_cat[153,927]\n0.8927\n0.5557\n1.4341\n0.6388\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2004\n1.0000\n0.6544\n\n\ncat\n1.0758\n2.0000\n0.5840\n\n\nIMD\n3.0383\n4.0000\n0.5514\n\n\ndqi_tot\n0.1606\n1.0000\n0.6886\n\n\nmeat_overall_cat\n2.8814\n3.0000\n0.4103\n\n\nGLOBAL\n8.0855\n11.0001\n0.7056\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"meat_overall\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Meat intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/meat_overall\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-overall-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + meat_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3000\n0.8615\n1.9619\n0.2114\n\n\ncatFC 50-250\n1.9286\n1.2142\n3.0635\n0.0054\n\n\ncatFC &gt; 250\n2.9723\n1.7957\n4.9199\n0.0000\n\n\nIMD2\n0.5555\n0.2385\n1.2939\n0.1730\n\n\nIMD3\n0.7479\n0.3427\n1.6325\n0.4658\n\n\nIMD4\n0.7130\n0.3285\n1.5478\n0.3924\n\n\nIMD5\n0.6695\n0.3239\n1.3842\n0.2790\n\n\ndqi_tot\n1.0012\n0.9821\n1.0207\n0.9048\n\n\nmeat_overall_cat[59.5,101\n0.8740\n0.5032\n1.5183\n0.6328\n\n\nmeat_overall_cat[101,153)\n0.9062\n0.5151\n1.5943\n0.7326\n\n\nmeat_overall_cat[153,927]\n0.8502\n0.4650\n1.5545\n0.5981\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1074\n0.9741\n0.7330\n\n\ncat\n10.3961\n1.9794\n0.0054\n\n\nIMD\n2.7691\n3.9317\n0.5865\n\n\ndqi_tot\n2.8689\n0.9910\n0.0892\n\n\nmeat_overall_cat\n0.4851\n2.9711\n0.9197\n\n\nGLOBAL\n16.1019\n17.2467\n0.5339\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize overall meat intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"meat_overall\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"meat_overall\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Meat intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/meat_overall\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-overall-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + meat_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7285\n1.2992\n2.2997\n0.0002\n\n\ncatFC 50-250\n1.8389\n1.3440\n2.5161\n0.0001\n\n\ncatFC &gt; 250\n2.1393\n1.4976\n3.0559\n0.0000\n\n\nIMD2\n1.4663\n0.7712\n2.7881\n0.2431\n\n\nIMD3\n1.2909\n0.6936\n2.4025\n0.4204\n\n\nIMD4\n1.3819\n0.7648\n2.4970\n0.2839\n\n\nIMD5\n1.2718\n0.7126\n2.2698\n0.4158\n\n\ndqi_tot\n1.0039\n0.9895\n1.0184\n0.5978\n\n\nmeat_overall_cat[59.5,101\n0.9258\n0.6231\n1.3755\n0.7026\n\n\nmeat_overall_cat[101,153)\n1.2290\n0.8270\n1.8266\n0.3077\n\n\nmeat_overall_cat[153,927]\n1.0747\n0.6919\n1.6693\n0.7484\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0329\n1.0000\n0.8562\n\n\ncat\n3.7928\n2.0000\n0.1501\n\n\nIMD\n2.6095\n4.0000\n0.6251\n\n\ndqi_tot\n0.6535\n1.0000\n0.4189\n\n\nmeat_overall_cat\n8.7443\n3.0000\n0.0329\n\n\nGLOBAL\n15.7031\n11.0001\n0.1525\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"meat_overall\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Meat intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/meat_overall\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"meat-overall-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + meat_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3107\n0.8948\n1.9200\n0.1648\n\n\ncatFC 50-250\n1.9627\n1.2813\n3.0063\n0.0019\n\n\ncatFC &gt; 250\n2.3648\n1.4567\n3.8391\n0.0005\n\n\nIMD2\n1.6660\n0.6329\n4.3854\n0.3013\n\n\nIMD3\n1.5465\n0.6044\n3.9569\n0.3631\n\n\nIMD4\n2.6029\n1.0826\n6.2585\n0.0326\n\n\nIMD5\n1.5688\n0.6520\n3.7747\n0.3148\n\n\ndqi_tot\n1.0190\n0.9986\n1.0398\n0.0686\n\n\nmeat_overall_cat[59.5,101\n0.7688\n0.4211\n1.4037\n0.3921\n\n\nmeat_overall_cat[101,153)\n1.5264\n0.8791\n2.6503\n0.1330\n\n\nmeat_overall_cat[153,927]\n1.9492\n1.0666\n3.5619\n0.0300\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1586\n0.9811\n0.6827\n\n\ncat\n6.5851\n1.9573\n0.0356\n\n\nIMD\n1.8899\n3.9269\n0.7461\n\n\ndqi_tot\n0.0381\n0.9811\n0.8394\n\n\nmeat_overall_cat\n1.1463\n2.9449\n0.7570\n\n\nGLOBAL\n10.6928\n19.8397\n0.9510\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize overall meat intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"meat_overall\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"meat_overall\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Meat intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/meat_overall\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + meat_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7617\n1.4244\n2.1790\n0.0000\n\n\ncatFC 50-250\n1.5474\n1.2287\n1.9487\n0.0002\n\n\ncatFC &gt; 250\n2.0422\n1.5777\n2.6433\n0.0000\n\n\nIMD2\n1.0254\n0.6541\n1.6076\n0.9129\n\n\nIMD3\n1.0649\n0.6939\n1.6340\n0.7736\n\n\nIMD4\n1.1039\n0.7295\n1.6704\n0.6402\n\n\nIMD5\n1.1042\n0.7422\n1.6429\n0.6247\n\n\ndqi_tot\n1.0034\n0.9932\n1.0137\n0.5115\n\n\nmeat_overall_cat[59.5,101\n0.9658\n0.7267\n1.2835\n0.8105\n\n\nmeat_overall_cat[101,153)\n1.0830\n0.8101\n1.4477\n0.5905\n\n\nmeat_overall_cat[153,927]\n0.9958\n0.7241\n1.3696\n0.9794\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0001\n1.0000\n0.9915\n\n\ncat\n0.8075\n2.0000\n0.6678\n\n\nIMD\n4.6669\n4.0000\n0.3232\n\n\ndqi_tot\n0.9546\n1.0000\n0.3286\n\n\nmeat_overall_cat\n3.7140\n3.0000\n0.2940\n\n\nGLOBAL\n10.0527\n11.0002\n0.5257\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"meat_overall\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Meat intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/meat_overall\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + meat_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2443\n0.9466\n1.6356\n0.1172\n\n\ncatFC 50-250\n1.9230\n1.4102\n2.6222\n0.0000\n\n\ncatFC &gt; 250\n2.6521\n1.8787\n3.7439\n0.0000\n\n\nIMD2\n0.9601\n0.5133\n1.7960\n0.8987\n\n\nIMD3\n1.0478\n0.5783\n1.8982\n0.8777\n\n\nIMD4\n1.4264\n0.8129\n2.5030\n0.2157\n\n\nIMD5\n1.0348\n0.5956\n1.7981\n0.9033\n\n\ndqi_tot\n1.0091\n0.9953\n1.0231\n0.1972\n\n\nmeat_overall_cat[59.5,101\n0.8306\n0.5560\n1.2407\n0.3646\n\n\nmeat_overall_cat[101,153)\n1.2094\n0.8216\n1.7803\n0.3352\n\n\nmeat_overall_cat[153,927]\n1.3007\n0.8612\n1.9645\n0.2114\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1207\n0.9880\n0.7236\n\n\ncat\n6.3624\n1.9795\n0.0407\n\n\nIMD\n2.4822\n3.9450\n0.6394\n\n\ndqi_tot\n1.4650\n0.9898\n0.2235\n\n\nmeat_overall_cat\n1.9016\n2.9717\n0.5878\n\n\nGLOBAL\n11.7018\n23.1150\n0.9759\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#overall-fish-intake",
    "href": "Survival/Diet.html#overall-fish-intake",
    "title": "Diet",
    "section": "Overall fish intake",
    "text": "Overall fish intake\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize overall fish intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"fish_overall\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"fish_overall\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fish intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/fish_overall\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fish-overall-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + fish_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8915\n1.3593\n2.6322\n0.0002\n\n\ncatFC 50-250\n1.3197\n0.9329\n1.8669\n0.1171\n\n\ncatFC &gt; 250\n2.0898\n1.4279\n3.0585\n0.0001\n\n\nIMD2\n0.7647\n0.4051\n1.4436\n0.4080\n\n\nIMD3\n0.9021\n0.4976\n1.6357\n0.7344\n\n\nIMD4\n0.8322\n0.4594\n1.5075\n0.5446\n\n\nIMD5\n1.0438\n0.5998\n1.8164\n0.8795\n\n\ndqi_tot\n1.0058\n0.9919\n1.0199\n0.4186\n\n\nfish_overall_cat[16.4,36.\n0.5914\n0.3778\n0.9256\n0.0215\n\n\nfish_overall_cat[36.5,65.\n0.6846\n0.4467\n1.0493\n0.0820\n\n\nfish_overall_cat[65.8,647\n0.8655\n0.5684\n1.3179\n0.5006\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1702\n1.0000\n0.6800\n\n\ncat\n1.1851\n2.0000\n0.5529\n\n\nIMD\n2.9824\n4.0000\n0.5608\n\n\ndqi_tot\n0.1405\n1.0000\n0.7078\n\n\nfish_overall_cat\n2.7091\n3.0000\n0.4387\n\n\nGLOBAL\n7.8593\n11.0001\n0.7259\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"fish_overall\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fish intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/fish_overall\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fish-overall-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fish_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3102\n0.8666\n1.9809\n0.2002\n\n\ncatFC 50-250\n1.8784\n1.1759\n3.0005\n0.0083\n\n\ncatFC &gt; 250\n3.1436\n1.8906\n5.2272\n0.0000\n\n\nIMD2\n0.6667\n0.2863\n1.5525\n0.3472\n\n\nIMD3\n0.8078\n0.3638\n1.7937\n0.6001\n\n\nIMD4\n0.7195\n0.3301\n1.5684\n0.4077\n\n\nIMD5\n0.7555\n0.3612\n1.5801\n0.4564\n\n\ndqi_tot\n1.0060\n0.9875\n1.0249\n0.5266\n\n\nBMI\n1.0157\n0.9803\n1.0524\n0.3885\n\n\nfish_overall_cat[16.4,36.\n0.4418\n0.2418\n0.8072\n0.0079\n\n\nfish_overall_cat[36.5,65.\n0.5899\n0.3344\n1.0404\n0.0683\n\n\nfish_overall_cat[65.8,647\n0.7671\n0.4491\n1.3102\n0.3317\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0875\n0.9705\n0.7562\n\n\ncat\n9.5266\n1.9809\n0.0083\n\n\nIMD\n2.6789\n3.9281\n0.6017\n\n\ndqi_tot\n2.6709\n0.9911\n0.1010\n\n\nBMI\n1.2451\n0.9802\n0.2588\n\n\nfish_overall_cat\n9.8922\n2.9629\n0.0189\n\n\nGLOBAL\n25.7218\n17.9134\n0.1038\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize overall fish intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"fish_overall\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"fish_overall\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fish intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/fish_overall\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fish-overall-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fish_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7033\n1.2752\n2.2751\n0.0003\n\n\ncatFC 50-250\n1.7671\n1.2775\n2.4443\n0.0006\n\n\ncatFC &gt; 250\n2.0722\n1.4510\n2.9594\n0.0001\n\n\nIMD2\n1.5200\n0.7951\n2.9058\n0.2054\n\n\nIMD3\n1.1686\n0.6205\n2.2008\n0.6295\n\n\nIMD4\n1.4071\n0.7743\n2.5570\n0.2624\n\n\nIMD5\n1.2361\n0.6872\n2.2233\n0.4792\n\n\ndqi_tot\n0.9962\n0.9830\n1.0095\n0.5737\n\n\nBMI\n0.9773\n0.9481\n1.0074\n0.1383\n\n\nfish_overall_cat[16.4,36.\n1.1858\n0.7883\n1.7838\n0.4132\n\n\nfish_overall_cat[36.5,65.\n1.1459\n0.7555\n1.7379\n0.5216\n\n\nfish_overall_cat[65.8,647\n1.4914\n1.0061\n2.2109\n0.0466\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0111\n1.0000\n0.9161\n\n\ncat\n3.5361\n2.0000\n0.1707\n\n\nIMD\n2.6892\n4.0000\n0.6111\n\n\ndqi_tot\n0.7602\n1.0000\n0.3833\n\n\nBMI\n0.9453\n1.0000\n0.3309\n\n\nfish_overall_cat\n0.6666\n3.0000\n0.8810\n\n\nGLOBAL\n8.9045\n12.0001\n0.7111\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"fish_overall\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fish intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/fish_overall\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fish-overall-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fish_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.1941\n0.8159\n1.7478\n0.3613\n\n\ncatFC 50-250\n2.0229\n1.2996\n3.1488\n0.0018\n\n\ncatFC &gt; 250\n2.4586\n1.5117\n3.9986\n0.0003\n\n\nIMD2\n1.6328\n0.6183\n4.3116\n0.3223\n\n\nIMD3\n1.3160\n0.5102\n3.3947\n0.5701\n\n\nIMD4\n2.4180\n1.0087\n5.7962\n0.0478\n\n\nIMD5\n1.4286\n0.5916\n3.4499\n0.4277\n\n\ndqi_tot\n1.0002\n0.9821\n1.0186\n0.9857\n\n\nBMI\n0.9605\n0.9204\n1.0024\n0.0641\n\n\nfish_overall_cat[16.4,36.\n0.8017\n0.4619\n1.3914\n0.4320\n\n\nfish_overall_cat[36.5,65.\n0.8688\n0.5070\n1.4889\n0.6088\n\n\nfish_overall_cat[65.8,647\n1.1617\n0.6953\n1.9410\n0.5671\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0334\n0.9883\n0.8515\n\n\ncat\n5.4126\n1.9571\n0.0641\n\n\nIMD\n1.2035\n3.9340\n0.8713\n\n\ndqi_tot\n0.0001\n0.9865\n0.9922\n\n\nBMI\n0.6022\n0.9887\n0.4334\n\n\nfish_overall_cat\n2.4436\n2.9667\n0.4794\n\n\nGLOBAL\n12.4545\n18.9576\n0.8637\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize overall fish intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"fish_overall\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"fish_overall\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fish intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/fish_overall\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fish_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7632\n1.4212\n2.1875\n0.0000\n\n\ncatFC 50-250\n1.4793\n1.1694\n1.8713\n0.0011\n\n\ncatFC &gt; 250\n2.0110\n1.5523\n2.6053\n0.0000\n\n\nIMD2\n1.0159\n0.6451\n1.5999\n0.9458\n\n\nIMD3\n1.0071\n0.6520\n1.5557\n0.9744\n\n\nIMD4\n1.1380\n0.7503\n1.7261\n0.5429\n\n\nIMD5\n1.1013\n0.7368\n1.6461\n0.6380\n\n\ndqi_tot\n1.0012\n0.9916\n1.0108\n0.8128\n\n\nBMI\n0.9950\n0.9753\n1.0151\n0.6231\n\n\nfish_overall_cat[16.4,36.\n0.8621\n0.6390\n1.1630\n0.3313\n\n\nfish_overall_cat[36.5,65.\n0.9355\n0.6958\n1.2576\n0.6586\n\n\nfish_overall_cat[65.8,647\n1.1716\n0.8795\n1.5608\n0.2792\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0037\n1.0000\n0.9515\n\n\ncat\n1.0850\n2.0000\n0.5813\n\n\nIMD\n5.0340\n4.0000\n0.2838\n\n\ndqi_tot\n1.3398\n1.0000\n0.2471\n\n\nBMI\n0.0088\n1.0000\n0.9255\n\n\nfish_overall_cat\n0.6613\n3.0000\n0.8823\n\n\nGLOBAL\n8.6555\n12.0002\n0.7321\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"fish_overall\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fish intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/fish_overall\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fish_overall_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2361\n0.9377\n1.6295\n0.1327\n\n\ncatFC 50-250\n1.8663\n1.3583\n2.5642\n0.0001\n\n\ncatFC &gt; 250\n2.6575\n1.8774\n3.7618\n0.0000\n\n\nIMD2\n0.9622\n0.5142\n1.8005\n0.9040\n\n\nIMD3\n0.9640\n0.5288\n1.7574\n0.9048\n\n\nIMD4\n1.3841\n0.7874\n2.4331\n0.2587\n\n\nIMD5\n1.0097\n0.5785\n1.7622\n0.9728\n\n\ndqi_tot\n1.0022\n0.9894\n1.0152\n0.7350\n\n\nBMI\n0.9909\n0.9645\n1.0181\n0.5086\n\n\nfish_overall_cat[16.4,36.\n0.6319\n0.4235\n0.9427\n0.0245\n\n\nfish_overall_cat[36.5,65.\n0.7394\n0.5040\n1.0846\n0.1225\n\n\nfish_overall_cat[65.8,647\n0.9716\n0.6734\n1.4018\n0.8775\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0378\n0.9882\n0.8422\n\n\ncat\n6.5833\n1.9803\n0.0365\n\n\nIMD\n1.5618\n3.9428\n0.8089\n\n\ndqi_tot\n1.8820\n0.9922\n0.1685\n\n\nBMI\n1.9590\n0.9878\n0.1592\n\n\nfish_overall_cat\n8.8737\n2.9790\n0.0305\n\n\nGLOBAL\n20.5269\n22.9338\n0.6061\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#dietary-fibre",
    "href": "Survival/Diet.html#dietary-fibre",
    "title": "Diet",
    "section": "Dietary fibre",
    "text": "Dietary fibre\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize dietary fibre by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"fibre\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"fibre\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fibre quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/fibre\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fibre-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fibre_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8864\n1.3475\n2.6408\n0.0002\n\n\ncatFC 50-250\n1.2975\n0.9125\n1.8450\n0.1471\n\n\ncatFC &gt; 250\n2.0536\n1.3992\n3.0141\n0.0002\n\n\nIMD2\n0.6955\n0.3632\n1.3319\n0.2733\n\n\nIMD3\n0.9297\n0.5101\n1.6947\n0.8120\n\n\nIMD4\n0.8450\n0.4668\n1.5296\n0.5780\n\n\nIMD5\n0.9776\n0.5611\n1.7032\n0.9362\n\n\ndqi_tot\n1.0068\n0.9912\n1.0226\n0.3971\n\n\nBMI\n1.0079\n0.9804\n1.0363\n0.5756\n\n\nfibre_cat[17,22.9)\n0.7511\n0.4878\n1.1567\n0.1939\n\n\nfibre_cat[22.9,29.4)\n0.8966\n0.5804\n1.3851\n0.6228\n\n\nfibre_cat[29.4,170]\n0.9582\n0.5984\n1.5342\n0.8588\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2744\n1.0000\n0.6004\n\n\ncat\n0.8152\n2.0000\n0.6652\n\n\nIMD\n3.0351\n4.0000\n0.5520\n\n\ndqi_tot\n0.3396\n1.0000\n0.5600\n\n\nBMI\n1.3198\n1.0000\n0.2506\n\n\nfibre_cat\n5.1069\n3.0000\n0.1641\n\n\nGLOBAL\n10.6138\n12.0001\n0.5623\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"fibre\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fibre quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/fibre\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fibre-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fibre_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3807\n0.9086\n2.0981\n0.1308\n\n\ncatFC 50-250\n1.8701\n1.1707\n2.9872\n0.0088\n\n\ncatFC &gt; 250\n3.1224\n1.8748\n5.2003\n0.0000\n\n\nIMD2\n0.6300\n0.2709\n1.4651\n0.2833\n\n\nIMD3\n0.8054\n0.3634\n1.7849\n0.5940\n\n\nIMD4\n0.7541\n0.3466\n1.6404\n0.4766\n\n\nIMD5\n0.7123\n0.3415\n1.4858\n0.3657\n\n\ndqi_tot\n0.9978\n0.9779\n1.0182\n0.8345\n\n\nBMI\n1.0165\n0.9811\n1.0533\n0.3648\n\n\nfibre_cat[17,22.9)\n1.0252\n0.5798\n1.8128\n0.9319\n\n\nfibre_cat[22.9,29.4)\n1.4448\n0.8175\n2.5534\n0.2053\n\n\nfibre_cat[29.4,170]\n1.3901\n0.7530\n2.5660\n0.2923\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0861\n0.9701\n0.7579\n\n\ncat\n10.1182\n1.9787\n0.0062\n\n\nIMD\n2.6037\n3.9266\n0.6148\n\n\ndqi_tot\n2.7993\n0.9906\n0.0931\n\n\nBMI\n1.1389\n0.9815\n0.2803\n\n\nfibre_cat\n9.7004\n2.9616\n0.0206\n\n\nGLOBAL\n22.6456\n18.6611\n0.2362\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize fibre by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"fibre\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"fibre\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fibre quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/fibre\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fibre-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fibre_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6926\n1.2636\n2.2672\n0.0004\n\n\ncatFC 50-250\n1.7837\n1.2980\n2.4513\n0.0004\n\n\ncatFC &gt; 250\n2.1170\n1.4803\n3.0274\n0.0000\n\n\nIMD2\n1.3861\n0.7239\n2.6542\n0.3246\n\n\nIMD3\n1.1466\n0.6076\n2.1636\n0.6728\n\n\nIMD4\n1.3385\n0.7390\n2.4243\n0.3361\n\n\nIMD5\n1.1956\n0.6643\n2.1520\n0.5512\n\n\ndqi_tot\n1.0010\n0.9871\n1.0151\n0.8880\n\n\nBMI\n0.9759\n0.9471\n1.0056\n0.1111\n\n\nfibre_cat[17,22.9)\n0.8763\n0.5895\n1.3026\n0.5138\n\n\nfibre_cat[22.9,29.4)\n0.9668\n0.6292\n1.4855\n0.8776\n\n\nfibre_cat[29.4,170]\n0.8254\n0.5346\n1.2744\n0.3866\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0057\n1.0000\n0.9400\n\n\ncat\n3.5363\n2.0000\n0.1706\n\n\nIMD\n2.6179\n4.0000\n0.6236\n\n\ndqi_tot\n0.7523\n1.0000\n0.3858\n\n\nBMI\n0.9507\n1.0000\n0.3295\n\n\nfibre_cat\n1.0506\n3.0000\n0.7890\n\n\nGLOBAL\n9.0611\n12.0001\n0.6977\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"fibre\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fibre quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/fibre\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fibre-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fibre_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2319\n0.8386\n1.8095\n0.2879\n\n\ncatFC 50-250\n2.0087\n1.3018\n3.0992\n0.0016\n\n\ncatFC &gt; 250\n2.4709\n1.5197\n4.0173\n0.0003\n\n\nIMD2\n1.7192\n0.6445\n4.5859\n0.2790\n\n\nIMD3\n1.3779\n0.5312\n3.5743\n0.5099\n\n\nIMD4\n2.4505\n1.0190\n5.8931\n0.0453\n\n\nIMD5\n1.4399\n0.5943\n3.4885\n0.4194\n\n\ndqi_tot\n0.9996\n0.9808\n1.0188\n0.9682\n\n\nBMI\n0.9644\n0.9247\n1.0057\n0.0900\n\n\nfibre_cat[17,22.9)\n1.2507\n0.7094\n2.2052\n0.4394\n\n\nfibre_cat[22.9,29.4)\n1.4394\n0.7917\n2.6169\n0.2324\n\n\nfibre_cat[29.4,170]\n1.1698\n0.6416\n2.1328\n0.6088\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0292\n0.9895\n0.8613\n\n\ncat\n5.5323\n1.9568\n0.0604\n\n\nIMD\n1.1150\n3.9308\n0.8859\n\n\ndqi_tot\n0.0010\n0.9893\n0.9731\n\n\nBMI\n0.5841\n0.9886\n0.4403\n\n\nfibre_cat\n4.7052\n2.9522\n0.1893\n\n\nGLOBAL\n12.4623\n19.3462\n0.8777\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize dietary fibre by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"fibre\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"fibre\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fibre quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/fibre\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fibre_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7669\n1.4224\n2.1947\n0.0000\n\n\ncatFC 50-250\n1.4980\n1.1859\n1.8921\n0.0007\n\n\ncatFC &gt; 250\n2.0311\n1.5676\n2.6318\n0.0000\n\n\nIMD2\n0.9612\n0.6100\n1.5147\n0.8645\n\n\nIMD3\n0.9914\n0.6418\n1.5315\n0.9690\n\n\nIMD4\n1.0909\n0.7201\n1.6527\n0.6815\n\n\nIMD5\n1.0688\n0.7154\n1.5967\n0.7454\n\n\ndqi_tot\n1.0037\n0.9935\n1.0141\n0.4747\n\n\nBMI\n0.9941\n0.9744\n1.0142\n0.5609\n\n\nfibre_cat[17,22.9)\n0.8419\n0.6320\n1.1214\n0.2393\n\n\nfibre_cat[22.9,29.4)\n0.9420\n0.6978\n1.2717\n0.6964\n\n\nfibre_cat[29.4,170]\n0.8956\n0.6554\n1.2238\n0.4888\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0038\n1.0000\n0.9511\n\n\ncat\n1.0906\n2.0000\n0.5797\n\n\nIMD\n5.0884\n4.0000\n0.2783\n\n\ndqi_tot\n1.3417\n1.0000\n0.2467\n\n\nBMI\n0.0088\n1.0000\n0.9251\n\n\nfibre_cat\n3.6398\n3.0000\n0.3031\n\n\nGLOBAL\n11.6255\n12.0002\n0.4762\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"fibre\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fibre quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/fibre\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fibre_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2919\n0.9786\n1.7056\n0.0707\n\n\ncatFC 50-250\n1.8669\n1.3629\n2.5572\n0.0001\n\n\ncatFC &gt; 250\n2.6881\n1.8992\n3.8048\n0.0000\n\n\nIMD2\n0.9718\n0.5183\n1.8219\n0.9289\n\n\nIMD3\n0.9699\n0.5321\n1.7679\n0.9206\n\n\nIMD4\n1.3801\n0.7858\n2.4238\n0.2623\n\n\nIMD5\n0.9849\n0.5646\n1.7182\n0.9573\n\n\ndqi_tot\n0.9985\n0.9851\n1.0122\n0.8328\n\n\nBMI\n0.9923\n0.9659\n1.0194\n0.5742\n\n\nfibre_cat[17,22.9)\n1.1513\n0.7780\n1.7040\n0.4811\n\n\nfibre_cat[22.9,29.4)\n1.4022\n0.9376\n2.0971\n0.0997\n\n\nfibre_cat[29.4,170]\n1.2760\n0.8406\n1.9370\n0.2523\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0422\n0.9882\n0.8334\n\n\ncat\n6.5765\n1.9786\n0.0365\n\n\nIMD\n1.6603\n3.9441\n0.7910\n\n\ndqi_tot\n2.0448\n0.9939\n0.1516\n\n\nBMI\n1.9420\n0.9890\n0.1612\n\n\nfibre_cat\n11.5963\n2.9788\n0.0087\n\n\nGLOBAL\n22.1617\n22.8286\n0.5002\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#polyunsaturated-fatty-acids",
    "href": "Survival/Diet.html#polyunsaturated-fatty-acids",
    "title": "Diet",
    "section": "Polyunsaturated fatty acids",
    "text": "Polyunsaturated fatty acids\nThe SAP states n-6 PUFAs will be investigated. However, the FFQ data extract lists PUFA collectively, presumably describing both n-3 and n-6 PUFAs. For now, these data will be used.\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize PUFA by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"PUFA_percEng\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"PUFA_percEng\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"PUFA intake (by g) quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/pufa\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"pufa-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + PUFA_percEng_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9094\n1.3738\n2.6539\n0.0001\n\n\ncatFC 50-250\n1.2909\n0.9127\n1.8257\n0.1489\n\n\ncatFC &gt; 250\n1.9690\n1.3482\n2.8756\n0.0005\n\n\nIMD2\n0.7145\n0.3783\n1.3493\n0.3000\n\n\nIMD3\n0.8979\n0.4955\n1.6269\n0.7224\n\n\nIMD4\n0.8463\n0.4671\n1.5331\n0.5819\n\n\nIMD5\n0.9825\n0.5652\n1.7079\n0.9502\n\n\nPUFA_percEng_cat[4.54,5.1\n0.7530\n0.4955\n1.1443\n0.1839\n\n\nPUFA_percEng_cat[5.17,5.9\n0.6531\n0.4246\n1.0045\n0.0525\n\n\nPUFA_percEng_cat[5.92,12.\n0.9356\n0.6336\n1.3814\n0.7378\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1923\n1.0000\n0.6610\n\n\ncat\n1.1166\n2.0000\n0.5722\n\n\nIMD\n3.2044\n4.0000\n0.5242\n\n\nPUFA_percEng_cat\n0.9104\n3.0000\n0.8229\n\n\nGLOBAL\n5.3470\n10.0001\n0.8668\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"PUFA_percEng\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"PUFA intake (by g) quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/pufa\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"pufa-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + PUFA_percEng_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3456\n0.8895\n2.0355\n0.1599\n\n\ncatFC 50-250\n1.8559\n1.1640\n2.9588\n0.0094\n\n\ncatFC &gt; 250\n2.8788\n1.7356\n4.7751\n0.0000\n\n\nIMD2\n0.6383\n0.2747\n1.4829\n0.2965\n\n\nIMD3\n0.8351\n0.3771\n1.8497\n0.6570\n\n\nIMD4\n0.7877\n0.3621\n1.7136\n0.5473\n\n\nIMD5\n0.7257\n0.3490\n1.5090\n0.3907\n\n\ndqi_tot\n1.0035\n0.9857\n1.0217\n0.7013\n\n\nBMI\n1.0187\n0.9834\n1.0553\n0.3026\n\n\nPUFA_percEng_cat[4.54,5.1\n1.1055\n0.6301\n1.9395\n0.7266\n\n\nPUFA_percEng_cat[5.17,5.9\n1.0967\n0.6237\n1.9285\n0.7486\n\n\nPUFA_percEng_cat[5.92,12.\n1.3012\n0.7520\n2.2517\n0.3466\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0505\n0.9726\n0.8128\n\n\ncat\n10.2964\n1.9788\n0.0057\n\n\nIMD\n2.7271\n3.9317\n0.5938\n\n\ndqi_tot\n2.8444\n0.9892\n0.0903\n\n\nBMI\n1.2067\n0.9786\n0.2657\n\n\nPUFA_percEng_cat\n8.4728\n2.9524\n0.0358\n\n\nGLOBAL\n27.3020\n18.3585\n0.0817\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize PUFA by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"PUFA_percEng\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"PUFA_percEng\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"PUFA intake (by g) quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/pufa\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"pufa-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + PUFA_percEng_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6993\n1.2731\n2.2683\n0.0003\n\n\ncatFC 50-250\n1.8254\n1.3279\n2.5092\n0.0002\n\n\ncatFC &gt; 250\n2.1008\n1.4690\n3.0042\n0.0000\n\n\nIMD2\n1.4206\n0.7448\n2.7094\n0.2866\n\n\nIMD3\n1.1143\n0.5917\n2.0984\n0.7375\n\n\nIMD4\n1.3211\n0.7286\n2.3953\n0.3591\n\n\nIMD5\n1.1679\n0.6490\n2.1015\n0.6047\n\n\ndqi_tot\n0.9995\n0.9867\n1.0125\n0.9433\n\n\nBMI\n0.9799\n0.9508\n1.0099\n0.1861\n\n\nPUFA_percEng_cat[4.54,5.1\n0.8929\n0.6036\n1.3208\n0.5706\n\n\nPUFA_percEng_cat[5.17,5.9\n0.8670\n0.5867\n1.2811\n0.4737\n\n\nPUFA_percEng_cat[5.92,12.\n1.1782\n0.8065\n1.7212\n0.3965\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0129\n1.0000\n0.9097\n\n\ncat\n3.5443\n2.0000\n0.1700\n\n\nIMD\n2.6609\n4.0000\n0.6161\n\n\ndqi_tot\n0.7367\n1.0000\n0.3907\n\n\nBMI\n0.8724\n1.0000\n0.3503\n\n\nPUFA_percEng_cat\n2.7154\n3.0000\n0.4376\n\n\nGLOBAL\n11.2593\n12.0001\n0.5068\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"PUFA_percEng\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"PUFA intake (by g) quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/pufa\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"pufa-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + PUFA_percEng_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2077\n0.8256\n1.7666\n0.3308\n\n\ncatFC 50-250\n2.0348\n1.3195\n3.1378\n0.0013\n\n\ncatFC &gt; 250\n2.5288\n1.5496\n4.1269\n0.0002\n\n\nIMD2\n1.5333\n0.5814\n4.0436\n0.3877\n\n\nIMD3\n1.2567\n0.4866\n3.2454\n0.6369\n\n\nIMD4\n2.2494\n0.9365\n5.4030\n0.0698\n\n\nIMD5\n1.3583\n0.5604\n3.2920\n0.4978\n\n\ndqi_tot\n1.0020\n0.9844\n1.0200\n0.8236\n\n\nBMI\n0.9618\n0.9219\n1.0035\n0.0722\n\n\nPUFA_percEng_cat[4.54,5.1\n0.9134\n0.5480\n1.5223\n0.7281\n\n\nPUFA_percEng_cat[5.17,5.9\n0.7609\n0.4497\n1.2875\n0.3086\n\n\nPUFA_percEng_cat[5.92,12.\n0.8666\n0.5136\n1.4621\n0.5916\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0277\n0.9890\n0.8646\n\n\ncat\n5.3713\n1.9576\n0.0655\n\n\nIMD\n1.1788\n3.9319\n0.8753\n\n\ndqi_tot\n0.0028\n0.9861\n0.9558\n\n\nBMI\n0.5505\n0.9901\n0.4542\n\n\nPUFA_percEng_cat\n3.2562\n2.9455\n0.3449\n\n\nGLOBAL\n11.7781\n19.4010\n0.9072\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize PUFA by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"PUFA_percEng\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"PUFA_percEng\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"PUFA intake (by g) quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/pufa\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + PUFA_percEng_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7648\n1.4228\n2.1890\n0.0000\n\n\ncatFC 50-250\n1.5003\n1.1877\n1.8953\n0.0007\n\n\ncatFC &gt; 250\n2.0190\n1.5584\n2.6157\n0.0000\n\n\nIMD2\n0.9653\n0.6131\n1.5199\n0.8789\n\n\nIMD3\n0.9886\n0.6403\n1.5266\n0.9589\n\n\nIMD4\n1.0873\n0.7173\n1.6481\n0.6933\n\n\nIMD5\n1.0602\n0.7092\n1.5850\n0.7755\n\n\ndqi_tot\n1.0021\n0.9928\n1.0115\n0.6604\n\n\nBMI\n0.9966\n0.9768\n1.0168\n0.7386\n\n\nPUFA_percEng_cat[4.54,5.1\n0.8545\n0.6423\n1.1369\n0.2805\n\n\nPUFA_percEng_cat[5.17,5.9\n0.7679\n0.5757\n1.0243\n0.0724\n\n\nPUFA_percEng_cat[5.92,12.\n1.0490\n0.7990\n1.3772\n0.7306\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0016\n1.0000\n0.9682\n\n\ncat\n1.0598\n2.0000\n0.5887\n\n\nIMD\n5.2193\n4.0000\n0.2655\n\n\ndqi_tot\n1.3435\n1.0000\n0.2464\n\n\nBMI\n0.0112\n1.0000\n0.9155\n\n\nPUFA_percEng_cat\n3.8212\n3.0000\n0.2814\n\n\nGLOBAL\n11.7195\n12.0002\n0.4685\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"PUFA_percEng\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"PUFA intake (by g) quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/pufa\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + PUFA_percEng_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2527\n0.9498\n1.6521\n0.1107\n\n\ncatFC 50-250\n1.8650\n1.3617\n2.5542\n0.0001\n\n\ncatFC &gt; 250\n2.6139\n1.8490\n3.6952\n0.0000\n\n\nIMD2\n0.9178\n0.4912\n1.7151\n0.7880\n\n\nIMD3\n0.9535\n0.5230\n1.7383\n0.8765\n\n\nIMD4\n1.3506\n0.7689\n2.3724\n0.2956\n\n\nIMD5\n0.9680\n0.5550\n1.6884\n0.9088\n\n\ndqi_tot\n1.0025\n0.9901\n1.0151\n0.6944\n\n\nBMI\n0.9926\n0.9662\n1.0197\n0.5902\n\n\nPUFA_percEng_cat[4.54,5.1\n1.0478\n0.7206\n1.5234\n0.8070\n\n\nPUFA_percEng_cat[5.17,5.9\n0.8868\n0.6056\n1.2986\n0.5371\n\n\nPUFA_percEng_cat[5.92,12.\n1.0675\n0.7343\n1.5517\n0.7323\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0286\n0.9889\n0.8625\n\n\ncat\n6.8811\n1.9800\n0.0314\n\n\nIMD\n1.6066\n3.9463\n0.8011\n\n\ndqi_tot\n2.0684\n0.9924\n0.1490\n\n\nBMI\n1.8498\n0.9903\n0.1718\n\n\nPUFA_percEng_cat\n5.0558\n2.9659\n0.1643\n\n\nGLOBAL\n17.2508\n22.9415\n0.7942\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#nova-score",
    "href": "Survival/Diet.html#nova-score",
    "title": "Diet",
    "section": "NOVA score",
    "text": "NOVA score\nThe SAP states emulsifiers (specifically lecithin) will be investigated. However, data on emulsifiers are not available in the FFQ data extract. As a proxy for emulsifiers, this report will look at ultra-processed foods via Nova scores (Monteiro et al. 2017).\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"NOVAScore\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Nova score\",\n  plot_base_path = \"plots/cd/soft-flare/diet/nova\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"nova-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9041\n1.3630\n2.6598\n0.0002\n\n\ncatFC 50-250\n1.2913\n0.9079\n1.8365\n0.1549\n\n\ncatFC &gt; 250\n2.0473\n1.3967\n3.0011\n0.0002\n\n\nIMD2\n0.7306\n0.3793\n1.4071\n0.3479\n\n\nIMD3\n0.9623\n0.5254\n1.7625\n0.9009\n\n\nIMD4\n0.8866\n0.4863\n1.6165\n0.6945\n\n\nIMD5\n1.0227\n0.5837\n1.7917\n0.9376\n\n\ndqi_tot\n1.0058\n0.9921\n1.0196\n0.4099\n\n\nBMI\n1.0091\n0.9813\n1.0377\n0.5237\n\n\nNOVAScore_catProcessed cu\n0.9416\n0.6123\n1.4480\n0.7841\n\n\nNOVAScore_catProcessed fo\n1.1200\n0.7347\n1.7074\n0.5983\n\n\nNOVAScore_catUltra-proces\n1.0418\n0.6817\n1.5922\n0.8497\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2700\n1.0000\n0.6033\n\n\ncat\n0.7511\n2.0000\n0.6869\n\n\nIMD\n3.0377\n4.0000\n0.5515\n\n\ndqi_tot\n0.3613\n1.0000\n0.5478\n\n\nBMI\n1.3237\n1.0000\n0.2499\n\n\nNOVAScore_cat\n3.3740\n3.0000\n0.3375\n\n\nGLOBAL\n7.9593\n12.0001\n0.7883\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"NOVAScore\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Nova Score\",\n  plot_base_path = \"plots/cd/hard-flare/diet/nova\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"nova-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3765\n0.9071\n2.0889\n0.1332\n\n\ncatFC 50-250\n1.9265\n1.2064\n3.0765\n0.0060\n\n\ncatFC &gt; 250\n3.0753\n1.8471\n5.1204\n0.0000\n\n\nIMD2\n0.5750\n0.2455\n1.3464\n0.2024\n\n\nIMD3\n0.7991\n0.3604\n1.7718\n0.5810\n\n\nIMD4\n0.7288\n0.3351\n1.5848\n0.4247\n\n\nIMD5\n0.6597\n0.3155\n1.3792\n0.2689\n\n\ndqi_tot\n1.0045\n0.9866\n1.0228\n0.6226\n\n\nBMI\n1.0213\n0.9859\n1.0579\n0.2409\n\n\nNOVAScore_catProcessed cu\n1.4982\n0.8659\n2.5924\n0.1484\n\n\nNOVAScore_catProcessed fo\n1.3744\n0.7708\n2.4508\n0.2812\n\n\nNOVAScore_catUltra-proces\n1.0451\n0.5865\n1.8623\n0.8809\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0551\n0.9677\n0.8032\n\n\ncat\n10.1241\n1.9797\n0.0062\n\n\nIMD\n2.6049\n3.9203\n0.6136\n\n\ndqi_tot\n2.6694\n0.9897\n0.1009\n\n\nBMI\n1.3680\n0.9768\n0.2359\n\n\nNOVAScore_cat\n2.7791\n2.9458\n0.4173\n\n\nGLOBAL\n17.0559\n18.9993\n0.5860\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"NOVAScore\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Nova score\",\n  plot_base_path = \"plots/uc/soft-flare/diet/nova\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"nova-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6755\n1.2539\n2.2390\n0.0005\n\n\ncatFC 50-250\n1.7983\n1.3085\n2.4713\n0.0003\n\n\ncatFC &gt; 250\n2.0842\n1.4585\n2.9783\n0.0001\n\n\nIMD2\n1.3629\n0.7130\n2.6053\n0.3490\n\n\nIMD3\n1.1200\n0.5942\n2.1110\n0.7260\n\n\nIMD4\n1.3073\n0.7193\n2.3759\n0.3794\n\n\nIMD5\n1.1683\n0.6489\n2.1034\n0.6041\n\n\ndqi_tot\n0.9997\n0.9869\n1.0126\n0.9617\n\n\nBMI\n0.9764\n0.9475\n1.0063\n0.1206\n\n\nNOVAScore_catProcessed cu\n0.8762\n0.5993\n1.2810\n0.4953\n\n\nNOVAScore_catProcessed fo\n0.8984\n0.6159\n1.3105\n0.5781\n\n\nNOVAScore_catUltra-proces\n0.8615\n0.5817\n1.2758\n0.4568\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0068\n1.0000\n0.9341\n\n\ncat\n3.5965\n2.0000\n0.1656\n\n\nIMD\n2.6425\n4.0000\n0.6193\n\n\ndqi_tot\n0.7671\n1.0000\n0.3811\n\n\nBMI\n0.9279\n1.0000\n0.3354\n\n\nNOVAScore_cat\n2.4869\n3.0000\n0.4777\n\n\nGLOBAL\n11.7588\n12.0001\n0.4652\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"NOVAScore\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Nova score\",\n  plot_base_path = \"plots/uc/hard-flare/diet/nova\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"nova-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2403\n0.8458\n1.8188\n0.2703\n\n\ncatFC 50-250\n2.0398\n1.3207\n3.1505\n0.0013\n\n\ncatFC &gt; 250\n2.5646\n1.5724\n4.1832\n0.0002\n\n\nIMD2\n1.7138\n0.6466\n4.5423\n0.2787\n\n\nIMD3\n1.4122\n0.5442\n3.6644\n0.4781\n\n\nIMD4\n2.4869\n1.0324\n5.9903\n0.0422\n\n\nIMD5\n1.4772\n0.6083\n3.5870\n0.3888\n\n\ndqi_tot\n1.0022\n0.9846\n1.0200\n0.8109\n\n\nBMI\n0.9636\n0.9235\n1.0053\n0.0864\n\n\nNOVAScore_catProcessed cu\n1.5453\n0.8991\n2.6561\n0.1153\n\n\nNOVAScore_catProcessed fo\n1.6050\n0.9309\n2.7674\n0.0887\n\n\nNOVAScore_catUltra-proces\n1.4460\n0.8215\n2.5455\n0.2011\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0230\n0.9864\n0.8756\n\n\ncat\n5.3361\n1.9527\n0.0664\n\n\nIMD\n1.1314\n3.9238\n0.8825\n\n\ndqi_tot\n0.0031\n0.9868\n0.9534\n\n\nBMI\n0.5418\n0.9878\n0.4569\n\n\nNOVAScore_cat\n5.2061\n2.9510\n0.1526\n\n\nGLOBAL\n12.9505\n19.7960\n0.8723\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"NOVAScore\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Nova score\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/nova\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7682\n1.4251\n2.1939\n0.0000\n\n\ncatFC 50-250\n1.4961\n1.1835\n1.8912\n0.0008\n\n\ncatFC &gt; 250\n2.0124\n1.5527\n2.6082\n0.0000\n\n\nIMD2\n0.9890\n0.6278\n1.5580\n0.9620\n\n\nIMD3\n1.0112\n0.6550\n1.5611\n0.9600\n\n\nIMD4\n1.1080\n0.7308\n1.6800\n0.6290\n\n\nIMD5\n1.0847\n0.7257\n1.6212\n0.6919\n\n\ndqi_tot\n1.0027\n0.9935\n1.0121\n0.5656\n\n\nBMI\n0.9950\n0.9752\n1.0153\n0.6287\n\n\nNOVAScore_catProcessed cu\n0.8931\n0.6731\n1.1849\n0.4331\n\n\nNOVAScore_catProcessed fo\n0.9836\n0.7431\n1.3020\n0.9081\n\n\nNOVAScore_catUltra-proces\n0.9197\n0.6909\n1.2243\n0.5665\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0048\n1.0000\n0.9445\n\n\ncat\n1.1276\n2.0000\n0.5690\n\n\nIMD\n5.0570\n4.0000\n0.2815\n\n\ndqi_tot\n1.3838\n1.0000\n0.2395\n\n\nBMI\n0.0111\n1.0000\n0.9162\n\n\nNOVAScore_cat\n3.0069\n3.0000\n0.3906\n\n\nGLOBAL\n10.9489\n12.0002\n0.5333\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"NOVAScore\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Nova score\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/nova\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2847\n0.9734\n1.6954\n0.0768\n\n\ncatFC 50-250\n1.8810\n1.3722\n2.5785\n0.0001\n\n\ncatFC &gt; 250\n2.7187\n1.9203\n3.8488\n0.0000\n\n\nIMD2\n0.9405\n0.5026\n1.7600\n0.8479\n\n\nIMD3\n0.9990\n0.5481\n1.8208\n0.9973\n\n\nIMD4\n1.3848\n0.7883\n2.4326\n0.2575\n\n\nIMD5\n0.9837\n0.5636\n1.7171\n0.9540\n\n\ndqi_tot\n1.0029\n0.9906\n1.0154\n0.6447\n\n\nBMI\n0.9942\n0.9677\n1.0215\n0.6741\n\n\nNOVAScore_catProcessed cu\n1.4771\n1.0092\n2.1621\n0.0448\n\n\nNOVAScore_catProcessed fo\n1.4512\n0.9798\n2.1494\n0.0631\n\n\nNOVAScore_catUltra-proces\n1.2239\n0.8198\n1.8272\n0.3230\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0289\n0.9869\n0.8611\n\n\ncat\n6.6825\n1.9794\n0.0347\n\n\nIMD\n1.5841\n3.9431\n0.8049\n\n\ndqi_tot\n1.9343\n0.9922\n0.1627\n\n\nBMI\n2.0039\n0.9889\n0.1547\n\n\nNOVAScore_cat\n2.8452\n2.9706\n0.4109\n\n\nGLOBAL\n13.9078\n22.7588\n0.9241\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#upf-intake",
    "href": "Survival/Diet.html#upf-intake",
    "title": "Diet",
    "section": "UPF intake",
    "text": "UPF intake\nAs an alternative approach to characterising ultra-processed food, we considered the percentage of daily energy intake sourced from ultra-processed food and drink (Nova 4).\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize UPF percentage by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"UPF_perc\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"UPF_perc\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"UPF as % of energy\",\n  plot_base_path = \"plots/cd/soft-flare/diet/UPF\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"upf-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + UPF_perc_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9145\n1.3685\n2.6784\n0.0001\n\n\ncatFC 50-250\n1.3268\n0.9315\n1.8898\n0.1171\n\n\ncatFC &gt; 250\n2.0624\n1.4060\n3.0252\n0.0002\n\n\nIMD2\n0.6973\n0.3640\n1.3360\n0.2772\n\n\nIMD3\n0.9313\n0.5110\n1.6972\n0.8161\n\n\nIMD4\n0.8491\n0.4683\n1.5396\n0.5901\n\n\nIMD5\n0.9655\n0.5521\n1.6885\n0.9020\n\n\ndqi_tot\n1.0053\n0.9913\n1.0195\n0.4614\n\n\nBMI\n1.0076\n0.9802\n1.0359\n0.5903\n\n\nUPF_perc_cat[36.8,44.3)\n1.1193\n0.7185\n1.7437\n0.6182\n\n\nUPF_perc_cat[44.3,52.6)\n1.1578\n0.7484\n1.7911\n0.5104\n\n\nUPF_perc_cat[52.6,92.5]\n0.9745\n0.6198\n1.5322\n0.9109\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2738\n1.0000\n0.6008\n\n\ncat\n0.7941\n2.0000\n0.6723\n\n\nIMD\n3.0290\n4.0000\n0.5530\n\n\ndqi_tot\n0.3616\n1.0000\n0.5476\n\n\nBMI\n1.2818\n1.0000\n0.2576\n\n\nUPF_perc_cat\n5.2147\n3.0000\n0.1567\n\n\nGLOBAL\n10.1947\n12.0001\n0.5989\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"UPF_perc\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"UPF as % of energy\",\n  plot_base_path = \"plots/cd/hard-flare/diet/UPF\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"upf-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + UPF_perc_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3186\n0.8713\n1.9957\n0.1908\n\n\ncatFC 50-250\n1.7965\n1.1231\n2.8737\n0.0145\n\n\ncatFC &gt; 250\n2.8936\n1.7406\n4.8105\n0.0000\n\n\nIMD2\n0.6606\n0.2850\n1.5312\n0.3337\n\n\nIMD3\n0.8629\n0.3905\n1.9070\n0.7156\n\n\nIMD4\n0.8169\n0.3771\n1.7698\n0.6081\n\n\nIMD5\n0.7533\n0.3619\n1.5679\n0.4488\n\n\ndqi_tot\n1.0010\n0.9826\n1.0198\n0.9154\n\n\nBMI\n1.0199\n0.9848\n1.0563\n0.2691\n\n\nUPF_perc_cat[36.8,44.3)\n1.0173\n0.5886\n1.7582\n0.9510\n\n\nUPF_perc_cat[44.3,52.6)\n0.6137\n0.3424\n1.1001\n0.1011\n\n\nUPF_perc_cat[52.6,92.5]\n0.8593\n0.4931\n1.4977\n0.5928\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0409\n0.9749\n0.8316\n\n\ncat\n10.3600\n1.9766\n0.0055\n\n\nIMD\n2.6281\n3.9274\n0.6106\n\n\ndqi_tot\n2.6978\n0.9900\n0.0991\n\n\nBMI\n1.2001\n0.9812\n0.2678\n\n\nUPF_perc_cat\n1.9745\n2.9726\n0.5726\n\n\nGLOBAL\n18.0051\n17.8046\n0.4422\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize UPF percentage by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"UPF_perc\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"UPF_perc\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"UPF as % of energy\",\n  plot_base_path = \"plots/uc/soft-flare/diet/UPF\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"upf-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + UPF_perc_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6886\n1.2634\n2.2567\n0.0004\n\n\ncatFC 50-250\n1.9565\n1.4163\n2.7028\n0.0000\n\n\ncatFC &gt; 250\n2.2499\n1.5707\n3.2228\n0.0000\n\n\nIMD2\n1.3050\n0.6834\n2.4921\n0.4200\n\n\nIMD3\n1.0649\n0.5652\n2.0063\n0.8458\n\n\nIMD4\n1.2670\n0.6990\n2.2968\n0.4355\n\n\nIMD5\n1.0858\n0.6007\n1.9625\n0.7852\n\n\ndqi_tot\n0.9944\n0.9811\n1.0079\n0.4132\n\n\nBMI\n0.9753\n0.9466\n1.0050\n0.1018\n\n\nUPF_perc_cat[36.8,44.3)\n0.5985\n0.4148\n0.8636\n0.0061\n\n\nUPF_perc_cat[44.3,52.6)\n0.5624\n0.3809\n0.8304\n0.0038\n\n\nUPF_perc_cat[52.6,92.5]\n0.5871\n0.3917\n0.8800\n0.0099\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0065\n0.9990\n0.9358\n\n\ncat\n3.3668\n1.9979\n0.1854\n\n\nIMD\n2.4615\n3.9959\n0.6509\n\n\ndqi_tot\n0.7873\n0.9996\n0.3748\n\n\nBMI\n0.8257\n0.9994\n0.3633\n\n\nUPF_perc_cat\n0.3640\n2.9981\n0.9475\n\n\nGLOBAL\n8.8670\n12.2308\n0.7312\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"UPF_perc\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"UPF as % of energy\",\n  plot_base_path = \"plots/uc/hard-flare/diet/UPF\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"upf-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + UPF_perc_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2067\n0.8251\n1.7648\n0.3327\n\n\ncatFC 50-250\n2.1249\n1.3740\n3.2864\n0.0007\n\n\ncatFC &gt; 250\n2.7076\n1.6569\n4.4246\n0.0001\n\n\nIMD2\n1.4523\n0.5479\n3.8496\n0.4531\n\n\nIMD3\n1.2522\n0.4827\n3.2487\n0.6437\n\n\nIMD4\n2.2537\n0.9374\n5.4182\n0.0694\n\n\nIMD5\n1.3310\n0.5463\n3.2429\n0.5292\n\n\ndqi_tot\n0.9973\n0.9793\n1.0157\n0.7755\n\n\nBMI\n0.9576\n0.9177\n0.9992\n0.0459\n\n\nUPF_perc_cat[36.8,44.3)\n0.5626\n0.3412\n0.9275\n0.0241\n\n\nUPF_perc_cat[44.3,52.6)\n0.4536\n0.2598\n0.7919\n0.0054\n\n\nUPF_perc_cat[52.6,92.5]\n0.7752\n0.4700\n1.2787\n0.3187\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0395\n0.9884\n0.8387\n\n\ncat\n5.1651\n1.9539\n0.0724\n\n\nIMD\n1.1683\n3.9311\n0.8770\n\n\ndqi_tot\n0.0010\n0.9856\n0.9728\n\n\nBMI\n0.5583\n0.9861\n0.4495\n\n\nUPF_perc_cat\n6.7840\n2.9591\n0.0768\n\n\nGLOBAL\n13.2005\n20.0426\n0.8702\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize UPF percentage by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"UPF_perc\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"UPF_perc\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"UPF as % of energy\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/UPF\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + UPF_perc_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7470\n1.4077\n2.1679\n0.0000\n\n\ncatFC 50-250\n1.5065\n1.1924\n1.9034\n0.0006\n\n\ncatFC &gt; 250\n2.0201\n1.5599\n2.6162\n0.0000\n\n\nIMD2\n0.9629\n0.6117\n1.5157\n0.8702\n\n\nIMD3\n0.9912\n0.6422\n1.5298\n0.9682\n\n\nIMD4\n1.0878\n0.7179\n1.6484\n0.6914\n\n\nIMD5\n1.0509\n0.7025\n1.5720\n0.8091\n\n\ndqi_tot\n1.0004\n0.9909\n1.0100\n0.9335\n\n\nBMI\n0.9961\n0.9765\n1.0162\n0.7034\n\n\nUPF_perc_cat[36.8,44.3)\n0.8250\n0.6262\n1.0868\n0.1713\n\n\nUPF_perc_cat[44.3,52.6)\n0.8052\n0.6071\n1.0680\n0.1328\n\n\nUPF_perc_cat[52.6,92.5]\n0.7405\n0.5512\n0.9948\n0.0461\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0061\n1.0000\n0.9379\n\n\ncat\n1.1551\n2.0000\n0.5613\n\n\nIMD\n4.9207\n4.0000\n0.2955\n\n\ndqi_tot\n1.3621\n1.0000\n0.2432\n\n\nBMI\n0.0163\n1.0000\n0.8983\n\n\nUPF_perc_cat\n2.1786\n3.0000\n0.5362\n\n\nGLOBAL\n9.4588\n12.0002\n0.6633\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"UPF_perc\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"UPF as % of energy\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/UPF\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + UPF_perc_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2431\n0.9425\n1.6397\n0.1234\n\n\ncatFC 50-250\n1.8265\n1.3343\n2.5002\n0.0002\n\n\ncatFC &gt; 250\n2.6243\n1.8574\n3.7077\n0.0000\n\n\nIMD2\n0.9195\n0.4916\n1.7197\n0.7927\n\n\nIMD3\n0.9574\n0.5250\n1.7459\n0.8871\n\n\nIMD4\n1.3706\n0.7806\n2.4066\n0.2724\n\n\nIMD5\n0.9917\n0.5670\n1.7344\n0.9766\n\n\ndqi_tot\n0.9998\n0.9871\n1.0127\n0.9750\n\n\nBMI\n0.9922\n0.9657\n1.0193\n0.5674\n\n\nUPF_perc_cat[36.8,44.3)\n0.7500\n0.5232\n1.0751\n0.1173\n\n\nUPF_perc_cat[44.3,52.6)\n0.5211\n0.3508\n0.7741\n0.0012\n\n\nUPF_perc_cat[52.6,92.5]\n0.8113\n0.5607\n1.1739\n0.2672\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0227\n0.9900\n0.8776\n\n\ncat\n6.9955\n1.9796\n0.0296\n\n\nIMD\n1.4707\n3.9447\n0.8256\n\n\ndqi_tot\n1.8680\n0.9920\n0.1700\n\n\nBMI\n1.8535\n0.9889\n0.1710\n\n\nUPF_perc_cat\n4.0100\n2.9741\n0.2568\n\n\nGLOBAL\n15.7585\n22.4833\n0.8468\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#processed-food-subgroups",
    "href": "Survival/Diet.html#processed-food-subgroups",
    "title": "Diet",
    "section": "Processed food subgroups",
    "text": "Processed food subgroups\nBreads and cereals\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize bread intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"breadIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"breadIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Bread/cereal intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/breadIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"breadIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + breadIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8549\n1.3254\n2.5960\n0.0003\n\n\ncatFC 50-250\n1.3338\n0.9385\n1.8956\n0.1082\n\n\ncatFC &gt; 250\n2.0756\n1.4177\n3.0388\n0.0002\n\n\nIMD2\n0.7180\n0.3723\n1.3845\n0.3227\n\n\nIMD3\n0.9704\n0.5295\n1.7787\n0.9227\n\n\nIMD4\n0.8580\n0.4716\n1.5612\n0.6161\n\n\nIMD5\n1.0216\n0.5822\n1.7927\n0.9406\n\n\ndqi_tot\n1.0053\n0.9918\n1.0191\n0.4432\n\n\nBMI\n1.0101\n0.9820\n1.0390\n0.4866\n\n\nbreadIntake_cat[1.97,3.23\n0.6838\n0.4456\n1.0492\n0.0819\n\n\nbreadIntake_cat[3.23,4.84\n0.7591\n0.4942\n1.1659\n0.2080\n\n\nbreadIntake_cat[4.84,18.9\n0.8312\n0.5455\n1.2665\n0.3896\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2772\n1.0000\n0.5985\n\n\ncat\n0.7971\n2.0000\n0.6713\n\n\nIMD\n2.9801\n4.0000\n0.5612\n\n\ndqi_tot\n0.3946\n1.0000\n0.5299\n\n\nBMI\n1.3054\n1.0000\n0.2532\n\n\nbreadIntake_cat\n1.5017\n3.0000\n0.6819\n\n\nGLOBAL\n6.7240\n12.0001\n0.8753\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"breadIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Bread/cereal intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/breadIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"breadIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + breadIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2818\n0.8447\n1.9450\n0.2433\n\n\ncatFC 50-250\n1.8953\n1.1894\n3.0202\n0.0072\n\n\ncatFC &gt; 250\n2.9513\n1.7806\n4.8916\n0.0000\n\n\nIMD2\n0.6239\n0.2670\n1.4577\n0.2759\n\n\nIMD3\n0.8269\n0.3720\n1.8380\n0.6409\n\n\nIMD4\n0.7789\n0.3576\n1.6967\n0.5294\n\n\nIMD5\n0.7324\n0.3497\n1.5338\n0.4089\n\n\ndqi_tot\n1.0028\n0.9848\n1.0211\n0.7634\n\n\nBMI\n1.0211\n0.9852\n1.0582\n0.2523\n\n\nbreadIntake_cat[1.97,3.23\n0.6760\n0.3934\n1.1616\n0.1563\n\n\nbreadIntake_cat[3.23,4.84\n0.6910\n0.3951\n1.2083\n0.1948\n\n\nbreadIntake_cat[4.84,18.9\n0.6121\n0.3483\n1.0758\n0.0880\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0425\n0.9718\n0.8275\n\n\ncat\n10.1284\n1.9763\n0.0061\n\n\nIMD\n2.7110\n3.9248\n0.5955\n\n\ndqi_tot\n2.7449\n0.9888\n0.0961\n\n\nBMI\n1.2185\n0.9801\n0.2639\n\n\nbreadIntake_cat\n1.3541\n2.9611\n0.7096\n\n\nGLOBAL\n18.0861\n18.7513\n0.5002\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize bread intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"breadIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"breadIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Bread/cereal intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/breadIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"breadIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + breadIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5974\n1.1901\n2.1439\n0.0018\n\n\ncatFC 50-250\n1.8289\n1.3305\n2.5139\n0.0002\n\n\ncatFC &gt; 250\n2.0796\n1.4545\n2.9734\n0.0001\n\n\nIMD2\n1.3869\n0.7273\n2.6447\n0.3206\n\n\nIMD3\n1.1062\n0.5857\n2.0892\n0.7558\n\n\nIMD4\n1.2738\n0.7010\n2.3144\n0.4271\n\n\nIMD5\n1.1090\n0.6140\n2.0030\n0.7317\n\n\ndqi_tot\n0.9994\n0.9868\n1.0122\n0.9267\n\n\nBMI\n0.9753\n0.9463\n1.0051\n0.1038\n\n\nbreadIntake_cat[1.97,3.23\n1.3883\n0.9667\n1.9938\n0.0756\n\n\nbreadIntake_cat[3.23,4.84\n0.9952\n0.6658\n1.4876\n0.9815\n\n\nbreadIntake_cat[4.84,18.9\n0.7822\n0.5191\n1.1787\n0.2403\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0088\n1.0000\n0.9253\n\n\ncat\n3.5302\n2.0000\n0.1712\n\n\nIMD\n2.4471\n4.0000\n0.6541\n\n\ndqi_tot\n0.7841\n1.0000\n0.3759\n\n\nBMI\n1.0910\n1.0000\n0.2962\n\n\nbreadIntake_cat\n7.5792\n3.0000\n0.0556\n\n\nGLOBAL\n16.2972\n12.0001\n0.1780\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"breadIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Bread/cereal intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/breadIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"breadIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + breadIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.1108\n0.7546\n1.6353\n0.5942\n\n\ncatFC 50-250\n2.0656\n1.3386\n3.1876\n0.0010\n\n\ncatFC &gt; 250\n2.5389\n1.5578\n4.1380\n0.0002\n\n\nIMD2\n1.4995\n0.5674\n3.9625\n0.4138\n\n\nIMD3\n1.2679\n0.4881\n3.2937\n0.6261\n\n\nIMD4\n2.2312\n0.9250\n5.3818\n0.0740\n\n\nIMD5\n1.3244\n0.5436\n3.2265\n0.5363\n\n\ndqi_tot\n1.0023\n0.9846\n1.0202\n0.8025\n\n\nBMI\n0.9618\n0.9222\n1.0032\n0.0700\n\n\nbreadIntake_cat[1.97,3.23\n1.3021\n0.7918\n2.1411\n0.2983\n\n\nbreadIntake_cat[3.23,4.84\n1.1248\n0.6651\n1.9022\n0.6609\n\n\nbreadIntake_cat[4.84,18.9\n0.6735\n0.3785\n1.1986\n0.1789\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0579\n0.9871\n0.8054\n\n\ncat\n5.1146\n1.9520\n0.0742\n\n\nIMD\n1.2813\n3.9305\n0.8576\n\n\ndqi_tot\n0.0007\n0.9866\n0.9770\n\n\nBMI\n0.5239\n0.9883\n0.4645\n\n\nbreadIntake_cat\n3.5288\n2.9512\n0.3095\n\n\nGLOBAL\n11.1126\n19.6917\n0.9368\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize bread intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"breadIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"breadIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Bread/cereal intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/breadIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + breadIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7298\n1.3914\n2.1506\n0.0000\n\n\ncatFC 50-250\n1.5032\n1.1900\n1.8989\n0.0006\n\n\ncatFC &gt; 250\n2.0014\n1.5449\n2.5927\n0.0000\n\n\nIMD2\n0.9930\n0.6309\n1.5629\n0.9758\n\n\nIMD3\n1.0106\n0.6549\n1.5593\n0.9621\n\n\nIMD4\n1.1187\n0.7383\n1.6949\n0.5968\n\n\nIMD5\n1.0831\n0.7252\n1.6177\n0.6966\n\n\ndqi_tot\n1.0025\n0.9932\n1.0118\n0.6035\n\n\nBMI\n0.9952\n0.9753\n1.0154\n0.6369\n\n\nbreadIntake_cat[1.97,3.23\n1.0110\n0.7695\n1.3284\n0.9371\n\n\nbreadIntake_cat[3.23,4.84\n0.8747\n0.6552\n1.1678\n0.3640\n\n\nbreadIntake_cat[4.84,18.9\n0.8229\n0.6141\n1.1027\n0.1918\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0067\n1.0000\n0.9346\n\n\ncat\n1.1012\n2.0000\n0.5766\n\n\nIMD\n4.9448\n4.0000\n0.2930\n\n\ndqi_tot\n1.4125\n1.0000\n0.2346\n\n\nBMI\n0.0107\n1.0000\n0.9175\n\n\nbreadIntake_cat\n1.9383\n3.0000\n0.5853\n\n\nGLOBAL\n9.5634\n12.0002\n0.6542\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"breadIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Bread/cereal intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/breadIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + breadIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.1999\n0.9078\n1.5860\n0.2003\n\n\ncatFC 50-250\n1.8702\n1.3660\n2.5605\n0.0001\n\n\ncatFC &gt; 250\n2.6057\n1.8425\n3.6850\n0.0000\n\n\nIMD2\n0.9120\n0.4876\n1.7058\n0.7731\n\n\nIMD3\n0.9527\n0.5226\n1.7370\n0.8745\n\n\nIMD4\n1.3641\n0.7767\n2.3957\n0.2798\n\n\nIMD5\n0.9665\n0.5544\n1.6848\n0.9043\n\n\ndqi_tot\n1.0028\n0.9903\n1.0154\n0.6668\n\n\nBMI\n0.9910\n0.9646\n1.0182\n0.5140\n\n\nbreadIntake_cat[1.97,3.23\n1.0072\n0.7018\n1.4455\n0.9691\n\n\nbreadIntake_cat[3.23,4.84\n0.9468\n0.6516\n1.3759\n0.7744\n\n\nbreadIntake_cat[4.84,18.9\n0.6680\n0.4480\n0.9960\n0.0478\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0416\n0.9886\n0.8347\n\n\ncat\n6.6262\n1.9786\n0.0356\n\n\nIMD\n1.6491\n3.9447\n0.7931\n\n\ndqi_tot\n1.9561\n0.9920\n0.1603\n\n\nBMI\n1.7776\n0.9887\n0.1800\n\n\nbreadIntake_cat\n0.3860\n2.9751\n0.9414\n\n\nGLOBAL\n12.2429\n22.9608\n0.9661\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nSweets and desserts/snack foods\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize sweet intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"sweetIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"sweetIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Sweet/dessert/snack intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/sweetIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"sweetIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + sweetIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8949\n1.3541\n2.6516\n0.0002\n\n\ncatFC 50-250\n1.3187\n0.9275\n1.8750\n0.1234\n\n\ncatFC &gt; 250\n2.0504\n1.4008\n3.0011\n0.0002\n\n\nIMD2\n0.7147\n0.3722\n1.3726\n0.3131\n\n\nIMD3\n0.9678\n0.5283\n1.7728\n0.9155\n\n\nIMD4\n0.8756\n0.4816\n1.5917\n0.6630\n\n\nIMD5\n1.0159\n0.5800\n1.7795\n0.9559\n\n\ndqi_tot\n1.0056\n0.9918\n1.0196\n0.4272\n\n\nBMI\n1.0077\n0.9799\n1.0363\n0.5920\n\n\nsweetIntake_cat[2.83,4.36\n1.0612\n0.7023\n1.6036\n0.7778\n\n\nsweetIntake_cat[4.36,6.17\n0.8063\n0.5172\n1.2571\n0.3421\n\n\nsweetIntake_cat[6.17,17.3\n1.0362\n0.6645\n1.6157\n0.8754\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2861\n1.0000\n0.5928\n\n\ncat\n0.8500\n2.0000\n0.6538\n\n\nIMD\n3.0084\n4.0000\n0.5564\n\n\ndqi_tot\n0.3710\n1.0000\n0.5425\n\n\nBMI\n1.3535\n1.0000\n0.2447\n\n\nsweetIntake_cat\n10.1113\n3.0000\n0.0176\n\n\nGLOBAL\n15.2266\n12.0001\n0.2293\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"sweetIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Sweet/dessert/snack intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/sweetIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"sweetIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + sweetIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3925\n0.9159\n2.1172\n0.1214\n\n\ncatFC 50-250\n1.8455\n1.1581\n2.9407\n0.0100\n\n\ncatFC &gt; 250\n2.9263\n1.7688\n4.8413\n0.0000\n\n\nIMD2\n0.6548\n0.2812\n1.5249\n0.3263\n\n\nIMD3\n0.8444\n0.3807\n1.8729\n0.6774\n\n\nIMD4\n0.8018\n0.3683\n1.7454\n0.5778\n\n\nIMD5\n0.7467\n0.3585\n1.5553\n0.4352\n\n\ndqi_tot\n1.0025\n0.9845\n1.0209\n0.7851\n\n\nBMI\n1.0194\n0.9841\n1.0561\n0.2851\n\n\nsweetIntake_cat[2.83,4.36\n0.7477\n0.4309\n1.2972\n0.3010\n\n\nsweetIntake_cat[4.36,6.17\n0.7720\n0.4479\n1.3306\n0.3515\n\n\nsweetIntake_cat[6.17,17.3\n0.9325\n0.5337\n1.6294\n0.8062\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0651\n0.9718\n0.7885\n\n\ncat\n10.1084\n1.9788\n0.0062\n\n\nIMD\n2.6137\n3.9315\n0.6138\n\n\ndqi_tot\n2.7412\n0.9905\n0.0965\n\n\nBMI\n1.0543\n0.9802\n0.2983\n\n\nsweetIntake_cat\n0.6600\n2.9648\n0.8787\n\n\nGLOBAL\n17.0427\n18.1954\n0.5334\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize sweet intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"sweetIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"sweetIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Sweet/dessert/snack intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/sweetIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"sweetIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + sweetIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7292\n1.2927\n2.3131\n0.0002\n\n\ncatFC 50-250\n1.8689\n1.3547\n2.5782\n0.0001\n\n\ncatFC &gt; 250\n2.0887\n1.4617\n2.9848\n0.0001\n\n\nIMD2\n1.3991\n0.7344\n2.6653\n0.3071\n\n\nIMD3\n1.1566\n0.6119\n2.1863\n0.6542\n\n\nIMD4\n1.3474\n0.7434\n2.4423\n0.3258\n\n\nIMD5\n1.1844\n0.6576\n2.1333\n0.5729\n\n\ndqi_tot\n0.9978\n0.9850\n1.0108\n0.7425\n\n\nBMI\n0.9767\n0.9479\n1.0063\n0.1216\n\n\nsweetIntake_cat[2.83,4.36\n0.7848\n0.5340\n1.1534\n0.2174\n\n\nsweetIntake_cat[4.36,6.17\n0.7567\n0.5144\n1.1130\n0.1568\n\n\nsweetIntake_cat[6.17,17.3\n0.7399\n0.5054\n1.0830\n0.1212\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0034\n1.0000\n0.9532\n\n\ncat\n3.4572\n2.0000\n0.1775\n\n\nIMD\n2.5656\n4.0000\n0.6329\n\n\ndqi_tot\n0.7507\n1.0000\n0.3862\n\n\nBMI\n0.8299\n1.0000\n0.3623\n\n\nsweetIntake_cat\n1.0874\n3.0000\n0.7801\n\n\nGLOBAL\n9.2010\n12.0001\n0.6857\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"sweetIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Sweet/dessert/snack intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/sweetIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"sweetIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + sweetIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2478\n0.8519\n1.8277\n0.2555\n\n\ncatFC 50-250\n2.2171\n1.4295\n3.4385\n0.0004\n\n\ncatFC &gt; 250\n2.6535\n1.6269\n4.3280\n0.0001\n\n\nIMD2\n1.4938\n0.5653\n3.9472\n0.4182\n\n\nIMD3\n1.2641\n0.4863\n3.2855\n0.6306\n\n\nIMD4\n2.3158\n0.9616\n5.5768\n0.0611\n\n\nIMD5\n1.4183\n0.5832\n3.4491\n0.4409\n\n\ndqi_tot\n1.0008\n0.9832\n1.0187\n0.9302\n\n\nBMI\n0.9600\n0.9204\n1.0014\n0.0584\n\n\nsweetIntake_cat[2.83,4.36\n0.6915\n0.4125\n1.1592\n0.1617\n\n\nsweetIntake_cat[4.36,6.17\n0.5093\n0.2909\n0.8916\n0.0182\n\n\nsweetIntake_cat[6.17,17.3\n0.8931\n0.5484\n1.4543\n0.6495\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0144\n0.9879\n0.9017\n\n\ncat\n5.0681\n1.9578\n0.0763\n\n\nIMD\n1.2835\n3.9288\n0.8571\n\n\ndqi_tot\n0.0006\n0.9853\n0.9790\n\n\nBMI\n0.6578\n0.9881\n0.4128\n\n\nsweetIntake_cat\n1.2028\n2.9501\n0.7441\n\n\nGLOBAL\n8.3018\n19.3980\n0.9862\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize sweet intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"sweetIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"sweetIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Sweet/dessert/snack intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/sweetIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + sweetIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7904\n1.4429\n2.2216\n0.0000\n\n\ncatFC 50-250\n1.5176\n1.2007\n1.9180\n0.0005\n\n\ncatFC &gt; 250\n2.0398\n1.5742\n2.6432\n0.0000\n\n\nIMD2\n0.9882\n0.6277\n1.5558\n0.9591\n\n\nIMD3\n1.0169\n0.6583\n1.5708\n0.9398\n\n\nIMD4\n1.1179\n0.7371\n1.6953\n0.6000\n\n\nIMD5\n1.0921\n0.7300\n1.6340\n0.6680\n\n\ndqi_tot\n1.0016\n0.9923\n1.0111\n0.7334\n\n\nBMI\n0.9945\n0.9747\n1.0147\n0.5895\n\n\nsweetIntake_cat[2.83,4.36\n0.9113\n0.6895\n1.2045\n0.5140\n\n\nsweetIntake_cat[4.36,6.17\n0.7899\n0.5917\n1.0544\n0.1095\n\n\nsweetIntake_cat[6.17,17.3\n0.8874\n0.6664\n1.1815\n0.4133\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0085\n1.0000\n0.9267\n\n\ncat\n1.1156\n2.0000\n0.5725\n\n\nIMD\n4.9991\n4.0000\n0.2874\n\n\ndqi_tot\n1.3854\n1.0000\n0.2392\n\n\nBMI\n0.0158\n1.0000\n0.9000\n\n\nsweetIntake_cat\n3.4165\n3.0000\n0.3318\n\n\nGLOBAL\n10.7231\n12.0002\n0.5528\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"sweetIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Sweet/dessert/snack intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/sweetIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + sweetIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3142\n0.9958\n1.7344\n0.0536\n\n\ncatFC 50-250\n1.9148\n1.3966\n2.6252\n0.0001\n\n\ncatFC &gt; 250\n2.7022\n1.9120\n3.8189\n0.0000\n\n\nIMD2\n0.9503\n0.5082\n1.7771\n0.8732\n\n\nIMD3\n0.9898\n0.5425\n1.8057\n0.9733\n\n\nIMD4\n1.4306\n0.8128\n2.5181\n0.2145\n\n\nIMD5\n1.0293\n0.5888\n1.7993\n0.9193\n\n\ndqi_tot\n1.0008\n0.9883\n1.0135\n0.8997\n\n\nBMI\n0.9918\n0.9652\n1.0191\n0.5507\n\n\nsweetIntake_cat[2.83,4.36\n0.7056\n0.4852\n1.0260\n0.0679\n\n\nsweetIntake_cat[4.36,6.17\n0.6232\n0.4235\n0.9171\n0.0164\n\n\nsweetIntake_cat[6.17,17.3\n0.9359\n0.6504\n1.3467\n0.7213\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0198\n0.9883\n0.8850\n\n\ncat\n6.5739\n1.9810\n0.0367\n\n\nIMD\n1.5344\n3.9465\n0.8143\n\n\ndqi_tot\n1.9481\n0.9928\n0.1614\n\n\nBMI\n1.8910\n0.9895\n0.1669\n\n\nsweetIntake_cat\n1.2166\n2.9700\n0.7441\n\n\nGLOBAL\n13.0420\n22.4327\n0.9409\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nArtificially and sugar-sweetened beverages\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize drink intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"drinkIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"drinkIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Artificially and sugar-sweetened drink intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/drinkIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"drinkIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + drinkIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9387\n1.3871\n2.7097\n0.0001\n\n\ncatFC 50-250\n1.3069\n0.9204\n1.8556\n0.1346\n\n\ncatFC &gt; 250\n2.0454\n1.3967\n2.9956\n0.0002\n\n\nIMD2\n0.6844\n0.3543\n1.3220\n0.2589\n\n\nIMD3\n0.9238\n0.5071\n1.6829\n0.7957\n\n\nIMD4\n0.8419\n0.4637\n1.5286\n0.5717\n\n\nIMD5\n0.9577\n0.5483\n1.6727\n0.8792\n\n\ndqi_tot\n1.0050\n0.9913\n1.0189\n0.4744\n\n\nBMI\n1.0118\n0.9847\n1.0397\n0.3967\n\n\ndrinkIntake_cat[0.301,4.2\n0.9939\n0.6424\n1.5378\n0.9781\n\n\ndrinkIntake_cat[4.21,14.4\n0.9088\n0.5884\n1.4038\n0.6665\n\n\ndrinkIntake_cat[14.4,120]\n0.7704\n0.5103\n1.1632\n0.2147\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2680\n1.0000\n0.6047\n\n\ncat\n0.7967\n2.0000\n0.6714\n\n\nIMD\n3.0215\n4.0000\n0.5542\n\n\ndqi_tot\n0.3622\n1.0000\n0.5473\n\n\nBMI\n1.2701\n1.0000\n0.2597\n\n\ndrinkIntake_cat\n3.7125\n3.0000\n0.2942\n\n\nGLOBAL\n8.2120\n12.0001\n0.7684\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"drinkIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Artificially and sugar-sweetened drink intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/drinkIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"drinkIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + drinkIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3563\n0.8966\n2.0518\n0.1490\n\n\ncatFC 50-250\n1.8557\n1.1651\n2.9557\n0.0092\n\n\ncatFC &gt; 250\n2.8668\n1.7284\n4.7549\n0.0000\n\n\nIMD2\n0.6255\n0.2693\n1.4530\n0.2752\n\n\nIMD3\n0.8000\n0.3630\n1.7633\n0.5800\n\n\nIMD4\n0.7414\n0.3439\n1.5984\n0.4452\n\n\nIMD5\n0.6791\n0.3274\n1.4089\n0.2987\n\n\ndqi_tot\n1.0016\n0.9835\n1.0200\n0.8630\n\n\nBMI\n1.0224\n0.9879\n1.0582\n0.2055\n\n\ndrinkIntake_cat[0.301,4.2\n0.9249\n0.5338\n1.6026\n0.7807\n\n\ndrinkIntake_cat[4.21,14.4\n0.7356\n0.4179\n1.2950\n0.2873\n\n\ndrinkIntake_cat[14.4,120]\n0.7043\n0.4133\n1.2000\n0.1973\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0773\n0.9732\n0.7711\n\n\ncat\n10.2074\n1.9787\n0.0059\n\n\nIMD\n2.6390\n3.9298\n0.6090\n\n\ndqi_tot\n2.8909\n0.9919\n0.0881\n\n\nBMI\n1.1251\n0.9790\n0.2824\n\n\ndrinkIntake_cat\n1.3282\n2.9696\n0.7173\n\n\nGLOBAL\n18.0110\n17.9838\n0.4538\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize drink intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"drinkIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"drinkIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Artificially and sugar-sweetened drink intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/drinkIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"drinkIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + drinkIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7014\n1.2739\n2.2724\n0.0003\n\n\ncatFC 50-250\n1.7909\n1.3030\n2.4616\n0.0003\n\n\ncatFC &gt; 250\n2.1016\n1.4714\n3.0016\n0.0000\n\n\nIMD2\n1.4569\n0.7625\n2.7838\n0.2546\n\n\nIMD3\n1.1699\n0.6213\n2.2028\n0.6270\n\n\nIMD4\n1.3703\n0.7558\n2.4846\n0.2994\n\n\nIMD5\n1.1926\n0.6627\n2.1462\n0.5568\n\n\ndqi_tot\n0.9987\n0.9859\n1.0117\n0.8487\n\n\nBMI\n0.9755\n0.9462\n1.0058\n0.1118\n\n\ndrinkIntake_cat[0.301,4.2\n0.8015\n0.5556\n1.1561\n0.2364\n\n\ndrinkIntake_cat[4.21,14.4\n0.9130\n0.6222\n1.3397\n0.6418\n\n\ndrinkIntake_cat[14.4,120]\n0.8593\n0.5746\n1.2849\n0.4600\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0079\n1.0000\n0.9293\n\n\ncat\n3.6394\n2.0000\n0.1621\n\n\nIMD\n2.6102\n4.0000\n0.6250\n\n\ndqi_tot\n0.7818\n1.0000\n0.3766\n\n\nBMI\n0.9537\n1.0000\n0.3288\n\n\ndrinkIntake_cat\n0.5990\n3.0000\n0.8967\n\n\nGLOBAL\n9.3916\n12.0001\n0.6692\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"drinkIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Artificially and sugar-sweetened drink intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/drinkIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"drinkIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + drinkIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2449\n0.8499\n1.8236\n0.2607\n\n\ncatFC 50-250\n2.1052\n1.3646\n3.2477\n0.0008\n\n\ncatFC &gt; 250\n2.4862\n1.5237\n4.0568\n0.0003\n\n\nIMD2\n1.7016\n0.6410\n4.5171\n0.2859\n\n\nIMD3\n1.4188\n0.5468\n3.6820\n0.4721\n\n\nIMD4\n2.3502\n0.9770\n5.6535\n0.0564\n\n\nIMD5\n1.5243\n0.6283\n3.6983\n0.3512\n\n\ndqi_tot\n1.0026\n0.9849\n1.0206\n0.7761\n\n\nBMI\n0.9550\n0.9149\n0.9969\n0.0356\n\n\ndrinkIntake_cat[0.301,4.2\n0.7606\n0.4436\n1.3041\n0.3199\n\n\ndrinkIntake_cat[4.21,14.4\n1.3462\n0.7968\n2.2744\n0.2666\n\n\ndrinkIntake_cat[14.4,120]\n1.2901\n0.7450\n2.2340\n0.3632\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0245\n0.9892\n0.8725\n\n\ncat\n5.2533\n1.9559\n0.0694\n\n\nIMD\n1.2098\n3.9323\n0.8701\n\n\ndqi_tot\n0.0022\n0.9840\n0.9609\n\n\nBMI\n0.5083\n0.9895\n0.4717\n\n\ndrinkIntake_cat\n0.7603\n2.9415\n0.8516\n\n\nGLOBAL\n8.8895\n19.2237\n0.9776\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize drink intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"drinkIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"drinkIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Artificially and sugar-sweetened drink intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/drinkIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + drinkIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7889\n1.4415\n2.2201\n0.0000\n\n\ncatFC 50-250\n1.5012\n1.1881\n1.8969\n0.0007\n\n\ncatFC &gt; 250\n2.0239\n1.5627\n2.6213\n0.0000\n\n\nIMD2\n0.9935\n0.6312\n1.5639\n0.9776\n\n\nIMD3\n1.0123\n0.6563\n1.5615\n0.9558\n\n\nIMD4\n1.1166\n0.7371\n1.6915\n0.6028\n\n\nIMD5\n1.0689\n0.7158\n1.5962\n0.7446\n\n\ndqi_tot\n1.0018\n0.9925\n1.0112\n0.7089\n\n\nBMI\n0.9969\n0.9771\n1.0171\n0.7582\n\n\ndrinkIntake_cat[0.301,4.2\n0.8903\n0.6737\n1.1767\n0.4143\n\n\ndrinkIntake_cat[4.21,14.4\n0.8810\n0.6620\n1.1724\n0.3847\n\n\ndrinkIntake_cat[14.4,120]\n0.7940\n0.5968\n1.0562\n0.1131\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0048\n1.0000\n0.9450\n\n\ncat\n1.0779\n2.0000\n0.5834\n\n\nIMD\n5.0199\n4.0000\n0.2853\n\n\ndqi_tot\n1.3981\n1.0000\n0.2370\n\n\nBMI\n0.0131\n1.0000\n0.9090\n\n\ndrinkIntake_cat\n2.4121\n3.0000\n0.4914\n\n\nGLOBAL\n10.1127\n12.0002\n0.6061\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"drinkIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Artificially and sugar-sweetened drink intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/drinkIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + drinkIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2599\n0.9561\n1.6602\n0.1007\n\n\ncatFC 50-250\n1.8566\n1.3558\n2.5423\n0.0001\n\n\ncatFC &gt; 250\n2.6100\n1.8476\n3.6871\n0.0000\n\n\nIMD2\n0.9362\n0.5011\n1.7492\n0.8362\n\n\nIMD3\n0.9624\n0.5281\n1.7539\n0.9003\n\n\nIMD4\n1.3519\n0.7701\n2.3734\n0.2937\n\n\nIMD5\n0.9825\n0.5630\n1.7147\n0.9506\n\n\ndqi_tot\n1.0025\n0.9901\n1.0151\n0.6931\n\n\nBMI\n0.9913\n0.9647\n1.0187\n0.5304\n\n\ndrinkIntake_cat[0.301,4.2\n0.8415\n0.5749\n1.2319\n0.3749\n\n\ndrinkIntake_cat[4.21,14.4\n0.9888\n0.6803\n1.4373\n0.9531\n\n\ndrinkIntake_cat[14.4,120]\n0.9565\n0.6543\n1.3981\n0.8183\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0391\n0.9891\n0.8399\n\n\ncat\n6.9377\n1.9802\n0.0305\n\n\nIMD\n1.5860\n3.9442\n0.8046\n\n\ndqi_tot\n1.9924\n0.9924\n0.1566\n\n\nBMI\n1.8574\n0.9907\n0.1710\n\n\ndrinkIntake_cat\n0.6547\n2.9754\n0.8811\n\n\nGLOBAL\n12.9558\n22.6243\n0.9466\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nAnimal-based products (processed meat)\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize processed meat intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"processedMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"processedMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Processed meat intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/processedMeatIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedMeatIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9199\n1.3724\n2.6857\n0.0001\n\n\ncatFC 50-250\n1.2723\n0.8939\n1.8109\n0.1811\n\n\ncatFC &gt; 250\n1.9885\n1.3563\n2.9153\n0.0004\n\n\nIMD2\n0.7296\n0.3805\n1.3992\n0.3427\n\n\nIMD3\n0.9467\n0.5172\n1.7326\n0.8589\n\n\nIMD4\n0.8582\n0.4738\n1.5542\n0.6137\n\n\nIMD5\n1.0046\n0.5749\n1.7554\n0.9872\n\n\ndqi_tot\n1.0084\n0.9938\n1.0232\n0.2606\n\n\nBMI\n1.0066\n0.9790\n1.0350\n0.6424\n\n\nprocessedMeatIntake_cat[0\n1.0300\n0.6543\n1.6213\n0.8984\n\n\nprocessedMeatIntake_cat[1\n1.2643\n0.8094\n1.9749\n0.3026\n\n\nprocessedMeatIntake_cat[2\n1.1644\n0.7125\n1.9030\n0.5437\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2725\n1.0000\n0.6016\n\n\ncat\n0.7333\n2.0000\n0.6931\n\n\nIMD\n2.9914\n4.0000\n0.5593\n\n\ndqi_tot\n0.3530\n1.0000\n0.5524\n\n\nBMI\n1.3234\n1.0000\n0.2500\n\n\nprocessedMeatIntake_cat\n0.6750\n3.0000\n0.8791\n\n\nGLOBAL\n5.8796\n12.0001\n0.9220\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"processedMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Processed meat intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/processedMeatIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedMeatIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3115\n0.8651\n1.9881\n0.2015\n\n\ncatFC 50-250\n1.8233\n1.1442\n2.9052\n0.0115\n\n\ncatFC &gt; 250\n2.8472\n1.7164\n4.7231\n0.0001\n\n\nIMD2\n0.6080\n0.2606\n1.4187\n0.2498\n\n\nIMD3\n0.7856\n0.3533\n1.7468\n0.5539\n\n\nIMD4\n0.7381\n0.3410\n1.5978\n0.4409\n\n\nIMD5\n0.6906\n0.3291\n1.4492\n0.3276\n\n\ndqi_tot\n1.0026\n0.9834\n1.0222\n0.7908\n\n\nBMI\n1.0181\n0.9829\n1.0546\n0.3168\n\n\nprocessedMeatIntake_cat[0\n1.0403\n0.5762\n1.8782\n0.8958\n\n\nprocessedMeatIntake_cat[1\n1.2417\n0.7073\n2.1799\n0.4509\n\n\nprocessedMeatIntake_cat[2\n0.8596\n0.4488\n1.6465\n0.6482\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0592\n0.9759\n0.7994\n\n\ncat\n10.2015\n1.9786\n0.0059\n\n\nIMD\n2.7767\n3.9304\n0.5849\n\n\ndqi_tot\n2.8063\n0.9895\n0.0926\n\n\nBMI\n1.0919\n0.9828\n0.2907\n\n\nprocessedMeatIntake_cat\n0.6043\n2.9621\n0.8915\n\n\nGLOBAL\n17.3198\n18.0697\n0.5060\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize processed meat intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"processedMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"processedMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Processed meat intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/processedMeatIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedMeatIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedMeatIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6876\n1.2597\n2.2607\n0.0005\n\n\ncatFC 50-250\n1.8379\n1.3343\n2.5317\n0.0002\n\n\ncatFC &gt; 250\n2.1064\n1.4712\n3.0160\n0.0000\n\n\nIMD2\n1.3897\n0.7283\n2.6515\n0.3182\n\n\nIMD3\n1.1285\n0.5988\n2.1269\n0.7085\n\n\nIMD4\n1.3316\n0.7349\n2.4125\n0.3450\n\n\nIMD5\n1.1648\n0.6464\n2.0992\n0.6116\n\n\ndqi_tot\n0.9975\n0.9837\n1.0116\n0.7285\n\n\nBMI\n0.9775\n0.9486\n1.0074\n0.1392\n\n\nprocessedMeatIntake_cat[0\n0.7309\n0.4976\n1.0736\n0.1100\n\n\nprocessedMeatIntake_cat[1\n0.8183\n0.5511\n1.2152\n0.3204\n\n\nprocessedMeatIntake_cat[2\n0.8006\n0.5248\n1.2213\n0.3020\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0021\n1.0000\n0.9639\n\n\ncat\n3.5998\n2.0000\n0.1653\n\n\nIMD\n2.6384\n4.0000\n0.6200\n\n\ndqi_tot\n0.7445\n1.0000\n0.3882\n\n\nBMI\n0.9629\n1.0000\n0.3265\n\n\nprocessedMeatIntake_cat\n1.8816\n3.0000\n0.5973\n\n\nGLOBAL\n11.4615\n12.0001\n0.4898\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"processedMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Processed meat intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/processedMeatIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedMeatIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2333\n0.8371\n1.8170\n0.2889\n\n\ncatFC 50-250\n1.9897\n1.2858\n3.0790\n0.0020\n\n\ncatFC &gt; 250\n2.4280\n1.4846\n3.9708\n0.0004\n\n\nIMD2\n1.6005\n0.6064\n4.2242\n0.3422\n\n\nIMD3\n1.3379\n0.5162\n3.4673\n0.5491\n\n\nIMD4\n2.3690\n0.9851\n5.6971\n0.0540\n\n\nIMD5\n1.4421\n0.5929\n3.5077\n0.4195\n\n\ndqi_tot\n1.0050\n0.9861\n1.0244\n0.6065\n\n\nBMI\n0.9602\n0.9204\n1.0017\n0.0600\n\n\nprocessedMeatIntake_cat[0\n1.1841\n0.7006\n2.0012\n0.5279\n\n\nprocessedMeatIntake_cat[1\n1.1236\n0.6408\n1.9702\n0.6842\n\n\nprocessedMeatIntake_cat[2\n1.3063\n0.7237\n2.3581\n0.3752\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0299\n0.9888\n0.8593\n\n\ncat\n5.5116\n1.9552\n0.0609\n\n\nIMD\n1.2369\n3.9299\n0.8652\n\n\ndqi_tot\n0.0003\n0.9856\n0.9847\n\n\nBMI\n0.5831\n0.9897\n0.4411\n\n\nprocessedMeatIntake_cat\n3.3900\n2.9535\n0.3279\n\n\nGLOBAL\n11.4414\n19.6258\n0.9251\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize processed meat intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"processedMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"processedMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Processed meat intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/processedMeatIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7738\n1.4278\n2.2036\n0.0000\n\n\ncatFC 50-250\n1.5001\n1.1855\n1.8983\n0.0007\n\n\ncatFC &gt; 250\n2.0101\n1.5496\n2.6074\n0.0000\n\n\nIMD2\n0.9877\n0.6276\n1.5545\n0.9575\n\n\nIMD3\n1.0248\n0.6636\n1.5825\n0.9122\n\n\nIMD4\n1.1136\n0.7352\n1.6867\n0.6116\n\n\nIMD5\n1.0896\n0.7293\n1.6280\n0.6754\n\n\ndqi_tot\n1.0029\n0.9929\n1.0129\n0.5767\n\n\nBMI\n0.9945\n0.9747\n1.0148\n0.5936\n\n\nprocessedMeatIntake_cat[0\n0.8575\n0.6408\n1.1474\n0.3008\n\n\nprocessedMeatIntake_cat[1\n1.0003\n0.7466\n1.3401\n0.9984\n\n\nprocessedMeatIntake_cat[2\n0.9493\n0.6912\n1.3037\n0.7479\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0058\n1.0000\n0.9393\n\n\ncat\n1.0843\n2.0000\n0.5815\n\n\nIMD\n5.0889\n4.0000\n0.2783\n\n\ndqi_tot\n1.4005\n1.0000\n0.2366\n\n\nBMI\n0.0083\n1.0000\n0.9273\n\n\nprocessedMeatIntake_cat\n1.8553\n3.0000\n0.6030\n\n\nGLOBAL\n10.5504\n12.0002\n0.5678\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"processedMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Processed meat intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/processedMeatIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2601\n0.9534\n1.6654\n0.1043\n\n\ncatFC 50-250\n1.8272\n1.3323\n2.5059\n0.0002\n\n\ncatFC &gt; 250\n2.5606\n1.8081\n3.6263\n0.0000\n\n\nIMD2\n0.9287\n0.4958\n1.7396\n0.8173\n\n\nIMD3\n0.9532\n0.5216\n1.7420\n0.8762\n\n\nIMD4\n1.3466\n0.7662\n2.3665\n0.3010\n\n\nIMD5\n0.9717\n0.5549\n1.7016\n0.9200\n\n\ndqi_tot\n1.0034\n0.9900\n1.0170\n0.6229\n\n\nBMI\n0.9921\n0.9656\n1.0192\n0.5622\n\n\nprocessedMeatIntake_cat[0\n1.0861\n0.7356\n1.6036\n0.6779\n\n\nprocessedMeatIntake_cat[1\n1.1960\n0.8077\n1.7709\n0.3716\n\n\nprocessedMeatIntake_cat[2\n1.0518\n0.6819\n1.6223\n0.8194\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0299\n0.9898\n0.8597\n\n\ncat\n6.8809\n1.9794\n0.0314\n\n\nIMD\n1.6227\n3.9444\n0.7979\n\n\ndqi_tot\n2.0094\n0.9907\n0.1545\n\n\nBMI\n1.9520\n0.9903\n0.1604\n\n\nprocessedMeatIntake_cat\n2.9126\n2.9733\n0.4006\n\n\nGLOBAL\n14.6590\n22.6204\n0.8958\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nPlant-based alternatives\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize processed plant intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"processedPlantIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"processedPlantIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Processed plant-based alternative intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/processedPlantIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedPlantIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedPlantIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9000\n1.3617\n2.6512\n0.0002\n\n\ncatFC 50-250\n1.2962\n0.9130\n1.8402\n0.1468\n\n\ncatFC &gt; 250\n2.0441\n1.3974\n2.9900\n0.0002\n\n\nIMD2\n0.6911\n0.3602\n1.3258\n0.2663\n\n\nIMD3\n0.9222\n0.5061\n1.6805\n0.7914\n\n\nIMD4\n0.8536\n0.4718\n1.5443\n0.6008\n\n\nIMD5\n0.9828\n0.5640\n1.7128\n0.9513\n\n\ndqi_tot\n1.0050\n0.9912\n1.0190\n0.4807\n\n\nBMI\n1.0083\n0.9809\n1.0364\n0.5561\n\n\nprocessedPlantIntake_cat[\n1.1581\n0.8189\n1.6379\n0.4064\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2615\n1.0000\n0.6091\n\n\ncat\n0.7725\n2.0000\n0.6796\n\n\nIMD\n3.0236\n4.0000\n0.5539\n\n\ndqi_tot\n0.3814\n1.0000\n0.5369\n\n\nBMI\n1.2745\n1.0000\n0.2589\n\n\nprocessedPlantIntake_cat\n0.1920\n1.0000\n0.6613\n\n\nGLOBAL\n5.5195\n10.0001\n0.8539\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"processedPlantIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Processed plant-based alternative intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/processedPlantIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedPlantIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedPlantIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3411\n0.8879\n2.0257\n0.1630\n\n\ncatFC 50-250\n1.8471\n1.1607\n2.9394\n0.0096\n\n\ncatFC &gt; 250\n2.9260\n1.7696\n4.8379\n0.0000\n\n\nIMD2\n0.6122\n0.2647\n1.4157\n0.2513\n\n\nIMD3\n0.8044\n0.3653\n1.7712\n0.5889\n\n\nIMD4\n0.7524\n0.3492\n1.6211\n0.4676\n\n\nIMD5\n0.7063\n0.3416\n1.4603\n0.3480\n\n\ndqi_tot\n1.0025\n0.9844\n1.0210\n0.7861\n\n\nBMI\n1.0184\n0.9834\n1.0547\n0.3070\n\n\nprocessedPlantIntake_cat[\n1.1481\n0.7332\n1.7978\n0.5461\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0587\n0.9730\n0.7991\n\n\ncat\n10.3351\n1.9797\n0.0056\n\n\nIMD\n2.6687\n3.9328\n0.6042\n\n\ndqi_tot\n2.7554\n0.9896\n0.0956\n\n\nBMI\n1.1366\n0.9814\n0.2807\n\n\nprocessedPlantIntake_cat\n0.0891\n0.9900\n0.7616\n\n\nGLOBAL\n17.0586\n15.8412\n0.3711\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize processed plant intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"processedPlantIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"processedPlantIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Processed plant-based alternative intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/processedPlantIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedPlantIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedPlantIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6856\n1.2624\n2.2507\n0.0004\n\n\ncatFC 50-250\n1.8090\n1.3150\n2.4885\n0.0003\n\n\ncatFC &gt; 250\n2.0717\n1.4515\n2.9570\n0.0001\n\n\nIMD2\n1.4160\n0.7437\n2.6958\n0.2897\n\n\nIMD3\n1.1473\n0.6108\n2.1551\n0.6693\n\n\nIMD4\n1.3481\n0.7453\n2.4385\n0.3233\n\n\nIMD5\n1.1873\n0.6609\n2.1331\n0.5657\n\n\ndqi_tot\n0.9989\n0.9860\n1.0119\n0.8640\n\n\nBMI\n0.9761\n0.9474\n1.0056\n0.1119\n\n\nprocessedPlantIntake_cat[\n1.0707\n0.7769\n1.4755\n0.6765\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0050\n1.0000\n0.9435\n\n\ncat\n3.5698\n2.0000\n0.1678\n\n\nIMD\n2.5950\n4.0000\n0.6277\n\n\ndqi_tot\n0.7488\n1.0000\n0.3869\n\n\nBMI\n0.9742\n1.0000\n0.3236\n\n\nprocessedPlantIntake_cat\n1.1736\n1.0000\n0.2787\n\n\nGLOBAL\n8.8987\n10.0001\n0.5418\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"processedPlantIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Processed plant-based alternative intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/processedPlantIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"processedPlantIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedPlantIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2233\n0.8353\n1.7915\n0.3005\n\n\ncatFC 50-250\n1.9811\n1.2828\n3.0596\n0.0020\n\n\ncatFC &gt; 250\n2.4871\n1.5282\n4.0477\n0.0002\n\n\nIMD2\n1.5340\n0.5818\n4.0444\n0.3870\n\n\nIMD3\n1.2889\n0.5001\n3.3218\n0.5993\n\n\nIMD4\n2.3256\n0.9708\n5.5712\n0.0583\n\n\nIMD5\n1.3975\n0.5782\n3.3777\n0.4573\n\n\ndqi_tot\n1.0036\n0.9859\n1.0217\n0.6899\n\n\nBMI\n0.9612\n0.9217\n1.0025\n0.0649\n\n\nprocessedPlantIntake_cat[\n0.7892\n0.4980\n1.2506\n0.3136\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0305\n0.9874\n0.8577\n\n\ncat\n5.4999\n1.9554\n0.0613\n\n\nIMD\n1.2414\n3.9288\n0.8643\n\n\ndqi_tot\n0.0020\n0.9851\n0.9621\n\n\nBMI\n0.5662\n0.9888\n0.4474\n\n\nprocessedPlantIntake_cat\n3.4042\n0.9842\n0.0636\n\n\nGLOBAL\n11.1370\n17.6787\n0.8769\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize processed plant intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"processedPlantIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"processedPlantIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Processed plant-based alternative intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/processedPlantIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedPlantIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7684\n1.4261\n2.1928\n0.0000\n\n\ncatFC 50-250\n1.5022\n1.1893\n1.8975\n0.0006\n\n\ncatFC &gt; 250\n2.0154\n1.5564\n2.6099\n0.0000\n\n\nIMD2\n0.9812\n0.6238\n1.5434\n0.9347\n\n\nIMD3\n1.0036\n0.6504\n1.5486\n0.9872\n\n\nIMD4\n1.1042\n0.7291\n1.6722\n0.6397\n\n\nIMD5\n1.0751\n0.7199\n1.6056\n0.7233\n\n\ndqi_tot\n1.0021\n0.9927\n1.0115\n0.6643\n\n\nBMI\n0.9945\n0.9749\n1.0145\n0.5870\n\n\nprocessedPlantIntake_cat[\n1.0751\n0.8519\n1.3569\n0.5419\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0052\n1.0000\n0.9428\n\n\ncat\n1.0830\n2.0000\n0.5819\n\n\nIMD\n5.0486\n4.0000\n0.2824\n\n\ndqi_tot\n1.3966\n1.0000\n0.2373\n\n\nBMI\n0.0079\n1.0000\n0.9290\n\n\nprocessedPlantIntake_cat\n1.0240\n1.0000\n0.3116\n\n\nGLOBAL\n8.6179\n10.0002\n0.5687\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"processedPlantIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Processed plant-based alternative intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/processedPlantIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + processedPlantIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2614\n0.9571\n1.6624\n0.0992\n\n\ncatFC 50-250\n1.8514\n1.3523\n2.5348\n0.0001\n\n\ncatFC &gt; 250\n2.6033\n1.8429\n3.6774\n0.0000\n\n\nIMD2\n0.9248\n0.4953\n1.7265\n0.8060\n\n\nIMD3\n0.9545\n0.5242\n1.7380\n0.8790\n\n\nIMD4\n1.3442\n0.7663\n2.3579\n0.3023\n\n\nIMD5\n0.9743\n0.5590\n1.6982\n0.9268\n\n\ndqi_tot\n1.0029\n0.9904\n1.0156\n0.6504\n\n\nBMI\n0.9920\n0.9657\n1.0191\n0.5609\n\n\nprocessedPlantIntake_cat[\n0.9551\n0.6958\n1.3110\n0.7761\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0338\n0.9886\n0.8506\n\n\ncat\n6.8441\n1.9799\n0.0320\n\n\nIMD\n1.6035\n3.9456\n0.8016\n\n\ndqi_tot\n2.0050\n0.9925\n0.1553\n\n\nBMI\n1.8960\n0.9889\n0.1663\n\n\nprocessedPlantIntake_cat\n1.4651\n0.9928\n0.2243\n\n\nGLOBAL\n13.3482\n20.6346\n0.8844\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#un-processedminimally-processed-food-subgroups",
    "href": "Survival/Diet.html#un-processedminimally-processed-food-subgroups",
    "title": "Diet",
    "section": "Un-processed/minimally processed food subgroups",
    "text": "Un-processed/minimally processed food subgroups\nFruit\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize fruit intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"fruitIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"fruitIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fruit intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/fruitIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fruitIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fruitIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8801\n1.3416\n2.6347\n0.0002\n\n\ncatFC 50-250\n1.3110\n0.9224\n1.8633\n0.1311\n\n\ncatFC &gt; 250\n2.0366\n1.3915\n2.9809\n0.0003\n\n\nIMD2\n0.7110\n0.3703\n1.3654\n0.3056\n\n\nIMD3\n0.9318\n0.5089\n1.7062\n0.8189\n\n\nIMD4\n0.8559\n0.4727\n1.5497\n0.6075\n\n\nIMD5\n0.9888\n0.5665\n1.7259\n0.9684\n\n\ndqi_tot\n1.0053\n0.9897\n1.0212\n0.5090\n\n\nBMI\n1.0086\n0.9813\n1.0367\n0.5410\n\n\nfruitIntake_cat[2.1,5.64)\n1.1255\n0.7253\n1.7464\n0.5980\n\n\nfruitIntake_cat[5.64,10.4\n1.0556\n0.6734\n1.6548\n0.8136\n\n\nfruitIntake_cat[10.4,62.9\n1.0500\n0.6325\n1.7433\n0.8503\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2610\n1.0000\n0.6094\n\n\ncat\n0.8034\n2.0000\n0.6692\n\n\nIMD\n3.0519\n4.0000\n0.5492\n\n\ndqi_tot\n0.3626\n1.0000\n0.5470\n\n\nBMI\n1.3223\n1.0000\n0.2502\n\n\nfruitIntake_cat\n0.5976\n3.0000\n0.8970\n\n\nGLOBAL\n6.3144\n12.0001\n0.8994\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"fruitIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fruit intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/fruitIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fruitIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fruitIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3601\n0.8927\n2.0723\n0.1522\n\n\ncatFC 50-250\n1.8300\n1.1495\n2.9135\n0.0109\n\n\ncatFC &gt; 250\n2.8711\n1.7311\n4.7617\n0.0000\n\n\nIMD2\n0.5956\n0.2560\n1.3853\n0.2289\n\n\nIMD3\n0.8086\n0.3627\n1.8027\n0.6035\n\n\nIMD4\n0.7497\n0.3465\n1.6220\n0.4644\n\n\nIMD5\n0.7014\n0.3375\n1.4576\n0.3419\n\n\ndqi_tot\n1.0057\n0.9851\n1.0267\n0.5919\n\n\nBMI\n1.0174\n0.9824\n1.0537\n0.3336\n\n\nfruitIntake_cat[2.1,5.64)\n0.7104\n0.3904\n1.2927\n0.2630\n\n\nfruitIntake_cat[5.64,10.4\n0.9883\n0.5654\n1.7277\n0.9672\n\n\nfruitIntake_cat[10.4,62.9\n0.8585\n0.4521\n1.6301\n0.6409\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0676\n0.9724\n0.7850\n\n\ncat\n10.3750\n1.9788\n0.0054\n\n\nIMD\n2.7906\n3.9322\n0.5828\n\n\ndqi_tot\n2.6125\n0.9875\n0.1043\n\n\nBMI\n1.0987\n0.9792\n0.2881\n\n\nfruitIntake_cat\n2.0898\n2.9692\n0.5482\n\n\nGLOBAL\n18.2208\n18.2141\n0.4555\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize fruit intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"fruitIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"fruitIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fruit intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/fruitIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fruitIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fruitIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6800\n1.2564\n2.2464\n0.0005\n\n\ncatFC 50-250\n1.8014\n1.3116\n2.4740\n0.0003\n\n\ncatFC &gt; 250\n2.0619\n1.4435\n2.9454\n0.0001\n\n\nIMD2\n1.3888\n0.7267\n2.6541\n0.3202\n\n\nIMD3\n1.1294\n0.5995\n2.1278\n0.7064\n\n\nIMD4\n1.3261\n0.7313\n2.4046\n0.3527\n\n\nIMD5\n1.1680\n0.6472\n2.1076\n0.6062\n\n\ndqi_tot\n0.9984\n0.9842\n1.0129\n0.8291\n\n\nBMI\n0.9761\n0.9474\n1.0056\n0.1114\n\n\nfruitIntake_cat[2.1,5.64)\n1.0907\n0.7154\n1.6630\n0.6866\n\n\nfruitIntake_cat[5.64,10.4\n1.1470\n0.7525\n1.7482\n0.5237\n\n\nfruitIntake_cat[10.4,62.9\n1.0947\n0.6921\n1.7314\n0.6989\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0057\n1.0000\n0.9399\n\n\ncat\n3.5410\n2.0000\n0.1702\n\n\nIMD\n2.6427\n4.0000\n0.6193\n\n\ndqi_tot\n0.7629\n1.0000\n0.3824\n\n\nBMI\n0.9614\n1.0000\n0.3268\n\n\nfruitIntake_cat\n3.2348\n3.0000\n0.3568\n\n\nGLOBAL\n11.2109\n12.0001\n0.5109\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"fruitIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fruit intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/fruitIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"fruitIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + fruitIntake_cat + dqi_tot + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2010\n0.8195\n1.7602\n0.3476\n\n\ncatFC 50-250\n2.0242\n1.3124\n3.1221\n0.0014\n\n\ncatFC &gt; 250\n2.4981\n1.5330\n4.0708\n0.0002\n\n\nIMD2\n1.5567\n0.5886\n4.1174\n0.3725\n\n\nIMD3\n1.3012\n0.5039\n3.3603\n0.5865\n\n\nIMD4\n2.3414\n0.9743\n5.6269\n0.0572\n\n\nIMD5\n1.4003\n0.5763\n3.4025\n0.4574\n\n\nfruitIntake_cat[2.1,5.64)\n0.9611\n0.5489\n1.6828\n0.8895\n\n\nfruitIntake_cat[5.64,10.4\n0.8897\n0.5009\n1.5806\n0.6903\n\n\nfruitIntake_cat[10.4,62.9\n1.1199\n0.6155\n2.0375\n0.7108\n\n\ndqi_tot\n0.9998\n0.9802\n1.0198\n0.9862\n\n\nBMI\n0.9617\n0.9220\n1.0030\n0.0686\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0255\n0.9883\n0.8699\n\n\ncat\n5.4338\n1.9546\n0.0633\n\n\nIMD\n1.1608\n3.9313\n0.8783\n\n\nfruitIntake_cat\n1.5003\n2.9573\n0.6746\n\n\ndqi_tot\n0.0000\n0.9856\n0.9977\n\n\nBMI\n0.5821\n0.9901\n0.4416\n\n\nGLOBAL\n9.7198\n19.5655\n0.9677\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize fruit intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"fruitIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"fruitIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Fruit intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/fruitIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fruitIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7482\n1.4072\n2.1718\n0.0000\n\n\ncatFC 50-250\n1.5051\n1.1912\n1.9018\n0.0006\n\n\ncatFC &gt; 250\n2.0149\n1.5550\n2.6107\n0.0000\n\n\nIMD2\n0.9835\n0.6254\n1.5468\n0.9426\n\n\nIMD3\n1.0060\n0.6519\n1.5525\n0.9785\n\n\nIMD4\n1.0986\n0.7253\n1.6641\n0.6572\n\n\nIMD5\n1.0673\n0.7144\n1.5946\n0.7504\n\n\ndqi_tot\n1.0008\n0.9903\n1.0114\n0.8837\n\n\nBMI\n0.9945\n0.9749\n1.0145\n0.5853\n\n\nfruitIntake_cat[2.1,5.64)\n1.1596\n0.8572\n1.5687\n0.3369\n\n\nfruitIntake_cat[5.64,10.4\n1.1359\n0.8380\n1.5398\n0.4115\n\n\nfruitIntake_cat[10.4,62.9\n1.1427\n0.8171\n1.5981\n0.4357\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0033\n1.0000\n0.9544\n\n\ncat\n1.0633\n2.0000\n0.5876\n\n\nIMD\n5.0824\n4.0000\n0.2789\n\n\ndqi_tot\n1.4036\n1.0000\n0.2361\n\n\nBMI\n0.0121\n1.0000\n0.9125\n\n\nfruitIntake_cat\n2.9476\n3.0000\n0.3998\n\n\nGLOBAL\n10.9461\n12.0002\n0.5336\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"fruitIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Fruit intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/fruitIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + fruitIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2627\n0.9556\n1.6686\n0.1009\n\n\ncatFC 50-250\n1.8532\n1.3536\n2.5373\n0.0001\n\n\ncatFC &gt; 250\n2.5946\n1.8348\n3.6690\n0.0000\n\n\nIMD2\n0.9219\n0.4934\n1.7227\n0.7988\n\n\nIMD3\n0.9605\n0.5271\n1.7503\n0.8953\n\n\nIMD4\n1.3513\n0.7700\n2.3713\n0.2941\n\n\nIMD5\n0.9789\n0.5611\n1.7078\n0.9400\n\n\ndqi_tot\n1.0018\n0.9878\n1.0160\n0.8014\n\n\nBMI\n0.9927\n0.9663\n1.0197\n0.5921\n\n\nfruitIntake_cat[2.1,5.64)\n0.8518\n0.5709\n1.2710\n0.4321\n\n\nfruitIntake_cat[5.64,10.4\n0.9814\n0.6624\n1.4539\n0.9253\n\n\nfruitIntake_cat[10.4,62.9\n1.0112\n0.6576\n1.5550\n0.9596\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0368\n0.9890\n0.8445\n\n\ncat\n6.9646\n1.9793\n0.0301\n\n\nIMD\n1.6437\n3.9450\n0.7942\n\n\ndqi_tot\n1.9133\n0.9931\n0.1652\n\n\nBMI\n1.9272\n0.9888\n0.1628\n\n\nfruitIntake_cat\n0.2770\n2.9729\n0.9630\n\n\nGLOBAL\n12.8189\n23.1032\n0.9574\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nVegetable and legumes\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize vegetable intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"vegIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"vegIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Vegetable/legume intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/vegIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"vegIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + vegIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9542\n1.3887\n2.7500\n0.0001\n\n\ncatFC 50-250\n1.3117\n0.9233\n1.8633\n0.1299\n\n\ncatFC &gt; 250\n2.0201\n1.3811\n2.9548\n0.0003\n\n\nIMD2\n0.7181\n0.3746\n1.3765\n0.3185\n\n\nIMD3\n0.9734\n0.5321\n1.7806\n0.9303\n\n\nIMD4\n0.8601\n0.4742\n1.5598\n0.6197\n\n\nIMD5\n1.0221\n0.5857\n1.7837\n0.9386\n\n\ndqi_tot\n1.0070\n0.9917\n1.0225\n0.3717\n\n\nBMI\n1.0067\n0.9794\n1.0348\n0.6325\n\n\nvegIntake_cat[5.04,8.43)\n0.9828\n0.6360\n1.5189\n0.9379\n\n\nvegIntake_cat[8.43,13.4)\n0.7986\n0.5053\n1.2621\n0.3355\n\n\nvegIntake_cat[13.4,63.1]\n0.9932\n0.6210\n1.5883\n0.9772\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2757\n1.0000\n0.5995\n\n\ncat\n0.7686\n2.0000\n0.6809\n\n\nIMD\n3.1235\n4.0000\n0.5374\n\n\ndqi_tot\n0.3712\n1.0000\n0.5424\n\n\nBMI\n1.2712\n1.0000\n0.2595\n\n\nvegIntake_cat\n5.4228\n3.0000\n0.1433\n\n\nGLOBAL\n10.2926\n12.0001\n0.5903\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"vegIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Vegetable/legume intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/vegIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"vegIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + vegIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3135\n0.8600\n2.0063\n0.2070\n\n\ncatFC 50-250\n1.8911\n1.1869\n3.0133\n0.0073\n\n\ncatFC &gt; 250\n2.9526\n1.7842\n4.8860\n0.0000\n\n\nIMD2\n0.6118\n0.2620\n1.4285\n0.2561\n\n\nIMD3\n0.8509\n0.3814\n1.8985\n0.6934\n\n\nIMD4\n0.7557\n0.3466\n1.6478\n0.4813\n\n\nIMD5\n0.7251\n0.3460\n1.5195\n0.3945\n\n\ndqi_tot\n1.0001\n0.9802\n1.0204\n0.9941\n\n\nBMI\n1.0133\n0.9781\n1.0497\n0.4642\n\n\nvegIntake_cat[5.04,8.43)\n0.9201\n0.5234\n1.6172\n0.7722\n\n\nvegIntake_cat[8.43,13.4)\n0.8766\n0.4838\n1.5884\n0.6641\n\n\nvegIntake_cat[13.4,63.1]\n1.4911\n0.8106\n2.7427\n0.1989\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0507\n0.9722\n0.8124\n\n\ncat\n10.6924\n1.9751\n0.0046\n\n\nIMD\n2.6346\n3.9177\n0.6079\n\n\ndqi_tot\n2.9512\n0.9900\n0.0846\n\n\nBMI\n1.0876\n0.9776\n0.2900\n\n\nvegIntake_cat\n3.1115\n2.9567\n0.3674\n\n\nGLOBAL\n19.7739\n19.3391\n0.4299\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize vegetable intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"vegIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"vegIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Vegetable/legume intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/vegIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"vegIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + vegIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6437\n1.2249\n2.2056\n0.0009\n\n\ncatFC 50-250\n1.8196\n1.3214\n2.5058\n0.0002\n\n\ncatFC &gt; 250\n2.0643\n1.4466\n2.9458\n0.0001\n\n\nIMD2\n1.3744\n0.7202\n2.6228\n0.3348\n\n\nIMD3\n1.1272\n0.5971\n2.1278\n0.7119\n\n\nIMD4\n1.3313\n0.7335\n2.4163\n0.3468\n\n\nIMD5\n1.1300\n0.6274\n2.0353\n0.6839\n\n\ndqi_tot\n0.9963\n0.9824\n1.0104\n0.6053\n\n\nBMI\n0.9760\n0.9473\n1.0056\n0.1106\n\n\nvegIntake_cat[5.04,8.43)\n1.0931\n0.7228\n1.6531\n0.6731\n\n\nvegIntake_cat[8.43,13.4)\n1.2690\n0.8365\n1.9251\n0.2625\n\n\nvegIntake_cat[13.4,63.1]\n1.2381\n0.8002\n1.9156\n0.3374\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0077\n1.0000\n0.9303\n\n\ncat\n3.5328\n2.0000\n0.1709\n\n\nIMD\n2.6145\n4.0000\n0.6243\n\n\ndqi_tot\n0.7308\n1.0000\n0.3926\n\n\nBMI\n0.9252\n1.0000\n0.3361\n\n\nvegIntake_cat\n0.1588\n3.0000\n0.9839\n\n\nGLOBAL\n9.0796\n12.0001\n0.6961\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"vegIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Vegetable/legume intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/vegIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"vegIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + vegIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.1590\n0.7857\n1.7097\n0.4569\n\n\ncatFC 50-250\n2.0402\n1.3207\n3.1516\n0.0013\n\n\ncatFC &gt; 250\n2.4817\n1.5249\n4.0390\n0.0003\n\n\nIMD2\n1.5765\n0.5956\n4.1727\n0.3594\n\n\nIMD3\n1.3322\n0.5147\n3.4479\n0.5544\n\n\nIMD4\n2.4411\n1.0109\n5.8950\n0.0473\n\n\nIMD5\n1.3612\n0.5603\n3.3072\n0.4960\n\n\ndqi_tot\n0.9959\n0.9769\n1.0153\n0.6784\n\n\nBMI\n0.9614\n0.9219\n1.0027\n0.0669\n\n\nvegIntake_cat[5.04,8.43)\n1.2609\n0.7109\n2.2363\n0.4279\n\n\nvegIntake_cat[8.43,13.4)\n1.8195\n1.0385\n3.1880\n0.0365\n\n\nvegIntake_cat[13.4,63.1]\n1.4784\n0.8126\n2.6896\n0.2004\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0269\n0.9888\n0.8664\n\n\ncat\n5.3609\n1.9584\n0.0659\n\n\nIMD\n1.2294\n3.9333\n0.8668\n\n\ndqi_tot\n0.0000\n0.9881\n0.9957\n\n\nBMI\n0.5082\n0.9880\n0.4711\n\n\nvegIntake_cat\n4.4812\n2.9426\n0.2070\n\n\nGLOBAL\n12.4241\n18.9236\n0.8638\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize vegetable intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"vegIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"vegIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Vegetable/legume intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/vegIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + vegIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7538\n1.4078\n2.1849\n0.0000\n\n\ncatFC 50-250\n1.5153\n1.1992\n1.9146\n0.0005\n\n\ncatFC &gt; 250\n2.0105\n1.5525\n2.6035\n0.0000\n\n\nIMD2\n0.9657\n0.6138\n1.5195\n0.8801\n\n\nIMD3\n0.9971\n0.6460\n1.5390\n0.9895\n\n\nIMD4\n1.0856\n0.7164\n1.6451\n0.6984\n\n\nIMD5\n1.0677\n0.7144\n1.5959\n0.7492\n\n\ndqi_tot\n1.0014\n0.9913\n1.0117\n0.7847\n\n\nBMI\n0.9938\n0.9741\n1.0138\n0.5380\n\n\nvegIntake_cat[5.04,8.43)\n1.0054\n0.7469\n1.3533\n0.9716\n\n\nvegIntake_cat[8.43,13.4)\n0.9993\n0.7366\n1.3557\n0.9964\n\n\nvegIntake_cat[13.4,63.1]\n1.0946\n0.7983\n1.5010\n0.5746\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0050\n1.0000\n0.9435\n\n\ncat\n1.0871\n2.0000\n0.5807\n\n\nIMD\n5.0962\n4.0000\n0.2776\n\n\ndqi_tot\n1.3847\n1.0000\n0.2393\n\n\nBMI\n0.0088\n1.0000\n0.9254\n\n\nvegIntake_cat\n2.2038\n3.0000\n0.5312\n\n\nGLOBAL\n9.6259\n12.0002\n0.6488\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"vegIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Vegetable/legume intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/vegIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + vegIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.1993\n0.9045\n1.5902\n0.2067\n\n\ncatFC 50-250\n1.8806\n1.3731\n2.5758\n0.0001\n\n\ncatFC &gt; 250\n2.6248\n1.8579\n3.7082\n0.0000\n\n\nIMD2\n0.8961\n0.4790\n1.6765\n0.7314\n\n\nIMD3\n0.9424\n0.5168\n1.7186\n0.8465\n\n\nIMD4\n1.3206\n0.7510\n2.3225\n0.3342\n\n\nIMD5\n0.9518\n0.5448\n1.6628\n0.8621\n\n\ndqi_tot\n0.9980\n0.9844\n1.0117\n0.7710\n\n\nBMI\n0.9912\n0.9649\n1.0182\n0.5205\n\n\nvegIntake_cat[5.04,8.43)\n1.0275\n0.6898\n1.5306\n0.8938\n\n\nvegIntake_cat[8.43,13.4)\n1.1983\n0.8025\n1.7892\n0.3765\n\n\nvegIntake_cat[13.4,63.1]\n1.4011\n0.9170\n2.1406\n0.1189\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0275\n0.9885\n0.8649\n\n\ncat\n6.9737\n1.9790\n0.0299\n\n\nIMD\n1.6200\n3.9445\n0.7984\n\n\ndqi_tot\n2.0266\n0.9941\n0.1534\n\n\nBMI\n1.8300\n0.9887\n0.1737\n\n\nvegIntake_cat\n0.5625\n2.9674\n0.9018\n\n\nGLOBAL\n12.9337\n22.7376\n0.9491\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nRed meat\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize red meat intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"redMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"redMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Red meat intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/redMeatIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"redMeatIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + redMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8753\n1.3428\n2.6191\n0.0002\n\n\ncatFC 50-250\n1.3044\n0.9190\n1.8513\n0.1369\n\n\ncatFC &gt; 250\n2.0075\n1.3712\n2.9391\n0.0003\n\n\nIMD2\n0.7102\n0.3706\n1.3611\n0.3025\n\n\nIMD3\n0.9471\n0.5196\n1.7263\n0.8591\n\n\nIMD4\n0.8601\n0.4753\n1.5563\n0.6183\n\n\nIMD5\n1.0063\n0.5770\n1.7550\n0.9824\n\n\ndqi_tot\n1.0057\n0.9921\n1.0195\n0.4115\n\n\nBMI\n1.0080\n0.9805\n1.0362\n0.5723\n\n\nredMeatIntake_cat[0.365,0\n0.8424\n0.5779\n1.2279\n0.3723\n\n\nredMeatIntake_cat[0.861,9\n0.9142\n0.6253\n1.3365\n0.6433\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2574\n1.0000\n0.6119\n\n\ncat\n0.7623\n2.0000\n0.6831\n\n\nIMD\n3.0114\n4.0000\n0.5559\n\n\ndqi_tot\n0.3696\n1.0000\n0.5432\n\n\nBMI\n1.2684\n1.0000\n0.2601\n\n\nredMeatIntake_cat\n1.0317\n2.0000\n0.5970\n\n\nGLOBAL\n6.0729\n11.0001\n0.8685\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"redMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Red meat intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/redMeatIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"redMeatIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + redMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2987\n0.8610\n1.9588\n0.2127\n\n\ncatFC 50-250\n1.8671\n1.1739\n2.9697\n0.0084\n\n\ncatFC &gt; 250\n2.8795\n1.7423\n4.7592\n0.0000\n\n\nIMD2\n0.6504\n0.2809\n1.5058\n0.3152\n\n\nIMD3\n0.8574\n0.3876\n1.8966\n0.7040\n\n\nIMD4\n0.7642\n0.3546\n1.6468\n0.4924\n\n\nIMD5\n0.7387\n0.3565\n1.5306\n0.4151\n\n\ndqi_tot\n1.0026\n0.9849\n1.0206\n0.7740\n\n\nBMI\n1.0202\n0.9842\n1.0574\n0.2751\n\n\nredMeatIntake_cat[0.365,0\n0.8405\n0.5244\n1.3473\n0.4704\n\n\nredMeatIntake_cat[0.861,9\n0.6369\n0.3715\n1.0919\n0.1009\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0659\n0.9760\n0.7888\n\n\ncat\n10.3796\n1.9822\n0.0055\n\n\nIMD\n2.5244\n3.9375\n0.6307\n\n\ndqi_tot\n2.6842\n0.9914\n0.1002\n\n\nBMI\n1.0069\n0.9847\n0.3107\n\n\nredMeatIntake_cat\n1.6621\n1.9696\n0.4285\n\n\nGLOBAL\n18.0302\n15.9356\n0.3181\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize red meat intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"redMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"redMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Red meat intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/redMeatIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"redMeatIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + redMeatIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7023\n1.2751\n2.2726\n0.0003\n\n\ncatFC 50-250\n1.7708\n1.2882\n2.4343\n0.0004\n\n\ncatFC &gt; 250\n2.0473\n1.4331\n2.9247\n0.0001\n\n\nIMD2\n1.3587\n0.7128\n2.5898\n0.3517\n\n\nIMD3\n1.1233\n0.5974\n2.1122\n0.7182\n\n\nIMD4\n1.3179\n0.7280\n2.3857\n0.3620\n\n\nIMD5\n1.1601\n0.6446\n2.0875\n0.6204\n\n\ndqi_tot\n0.9987\n0.9855\n1.0120\n0.8437\n\n\nBMI\n0.9773\n0.9485\n1.0070\n0.1328\n\n\nredMeatIntake_cat[0.365,0\n1.1968\n0.8642\n1.6573\n0.2796\n\n\nredMeatIntake_cat[0.861,9\n0.9164\n0.6424\n1.3072\n0.6299\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0027\n1.0000\n0.9587\n\n\ncat\n3.6510\n2.0000\n0.1611\n\n\nIMD\n2.6642\n4.0000\n0.6155\n\n\ndqi_tot\n0.7140\n1.0000\n0.3981\n\n\nBMI\n0.8837\n1.0000\n0.3472\n\n\nredMeatIntake_cat\n1.2673\n2.0000\n0.5307\n\n\nGLOBAL\n9.1883\n11.0001\n0.6045\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"redMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Red meat intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/redMeatIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"redMeatIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + redMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2067\n0.8255\n1.7637\n0.3320\n\n\ncatFC 50-250\n1.9946\n1.2929\n3.0772\n0.0018\n\n\ncatFC &gt; 250\n2.4769\n1.5176\n4.0427\n0.0003\n\n\nIMD2\n1.6324\n0.6176\n4.3146\n0.3231\n\n\nIMD3\n1.3157\n0.5099\n3.3953\n0.5705\n\n\nIMD4\n2.3450\n0.9787\n5.6188\n0.0559\n\n\nIMD5\n1.4085\n0.5827\n3.4048\n0.4469\n\n\ndqi_tot\n1.0085\n0.9902\n1.0270\n0.3644\n\n\nBMI\n0.9567\n0.9174\n0.9978\n0.0390\n\n\nredMeatIntake_cat[0.365,0\n1.3080\n0.8204\n2.0855\n0.2592\n\n\nredMeatIntake_cat[0.861,9\n1.8056\n1.1496\n2.8358\n0.0103\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0459\n0.9903\n0.8271\n\n\ncat\n5.6937\n1.9571\n0.0557\n\n\nIMD\n1.1733\n3.9294\n0.8760\n\n\ndqi_tot\n0.0002\n0.9859\n0.9895\n\n\nBMI\n0.5398\n0.9896\n0.4584\n\n\nredMeatIntake_cat\n0.0083\n1.9747\n0.9955\n\n\nGLOBAL\n8.2307\n17.8596\n0.9734\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize red meat intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"redMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"redMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"Red meat intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/redMeatIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + redMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7739\n1.4304\n2.1998\n0.0000\n\n\ncatFC 50-250\n1.4981\n1.1860\n1.8924\n0.0007\n\n\ncatFC &gt; 250\n2.0132\n1.5542\n2.6076\n0.0000\n\n\nIMD2\n0.9808\n0.6235\n1.5427\n0.9330\n\n\nIMD3\n1.0026\n0.6497\n1.5472\n0.9906\n\n\nIMD4\n1.0998\n0.7261\n1.6658\n0.6534\n\n\nIMD5\n1.0726\n0.7180\n1.6025\n0.7321\n\n\ndqi_tot\n1.0022\n0.9928\n1.0116\n0.6521\n\n\nBMI\n0.9951\n0.9754\n1.0152\n0.6295\n\n\nredMeatIntake_cat[0.365,0\n1.0340\n0.8098\n1.3202\n0.7888\n\n\nredMeatIntake_cat[0.861,9\n0.9216\n0.7134\n1.1905\n0.5320\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0059\n1.0000\n0.9388\n\n\ncat\n1.1034\n2.0000\n0.5760\n\n\nIMD\n5.0734\n4.0000\n0.2798\n\n\ndqi_tot\n1.3470\n1.0000\n0.2458\n\n\nBMI\n0.0112\n1.0000\n0.9159\n\n\nredMeatIntake_cat\n1.7438\n2.0000\n0.4182\n\n\nGLOBAL\n9.2067\n11.0002\n0.6028\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"redMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"Red meat intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/redMeatIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + redMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2625\n0.9578\n1.6640\n0.0981\n\n\ncatFC 50-250\n1.8516\n1.3519\n2.5360\n0.0001\n\n\ncatFC &gt; 250\n2.6146\n1.8499\n3.6954\n0.0000\n\n\nIMD2\n0.9265\n0.4962\n1.7300\n0.8106\n\n\nIMD3\n0.9563\n0.5248\n1.7426\n0.8839\n\n\nIMD4\n1.3470\n0.7679\n2.3628\n0.2989\n\n\nIMD5\n0.9748\n0.5591\n1.6996\n0.9283\n\n\ndqi_tot\n1.0031\n0.9906\n1.0158\n0.6256\n\n\nBMI\n0.9914\n0.9650\n1.0185\n0.5302\n\n\nredMeatIntake_cat[0.365,0\n1.0040\n0.7241\n1.3919\n0.9811\n\n\nredMeatIntake_cat[0.861,9\n1.1188\n0.8037\n1.5573\n0.5060\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0348\n0.9885\n0.8484\n\n\ncat\n6.8825\n1.9796\n0.0314\n\n\nIMD\n1.6366\n3.9457\n0.7955\n\n\ndqi_tot\n1.9757\n0.9920\n0.1583\n\n\nBMI\n1.8905\n0.9886\n0.1668\n\n\nredMeatIntake_cat\n0.7511\n1.9791\n0.6820\n\n\nGLOBAL\n13.6333\n21.6243\n0.9038\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nWhite meat\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize white meat intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"whiteMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"whiteMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White meat intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/whiteMeatIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteMeatIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + whiteMeatIntake_cat + dqi_tot + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8873\n1.3481\n2.6422\n0.0002\n\n\ncatFC 50-250\n1.3091\n0.9213\n1.8600\n0.1329\n\n\ncatFC &gt; 250\n2.0572\n1.4045\n3.0132\n0.0002\n\n\nIMD2\n0.7018\n0.3660\n1.3458\n0.2865\n\n\nIMD3\n0.9586\n0.5255\n1.7486\n0.8904\n\n\nIMD4\n0.8582\n0.4744\n1.5526\n0.6132\n\n\nIMD5\n0.9984\n0.5725\n1.7411\n0.9955\n\n\nwhiteMeatIntake_cat[0.426\n0.8350\n0.5366\n1.2994\n0.4242\n\n\nwhiteMeatIntake_cat[1.06,\n0.7647\n0.4805\n1.2169\n0.2577\n\n\nwhiteMeatIntake_cat[1.88,\n0.9321\n0.6077\n1.4296\n0.7471\n\n\ndqi_tot\n1.0054\n0.9917\n1.0193\n0.4407\n\n\nBMI\n1.0080\n0.9805\n1.0363\n0.5706\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2479\n1.0000\n0.6186\n\n\ncat\n0.8277\n2.0000\n0.6611\n\n\nIMD\n3.0804\n4.0000\n0.5445\n\n\nwhiteMeatIntake_cat\n8.1780\n3.0000\n0.0425\n\n\ndqi_tot\n0.3487\n1.0000\n0.5548\n\n\nBMI\n1.2754\n1.0000\n0.2588\n\n\nGLOBAL\n12.8119\n12.0001\n0.3829\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"whiteMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White meat intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/whiteMeatIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteMeatIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3429\n0.8871\n2.0331\n0.1635\n\n\ncatFC 50-250\n1.8461\n1.1560\n2.9481\n0.0103\n\n\ncatFC &gt; 250\n3.0321\n1.8303\n5.0229\n0.0000\n\n\nIMD2\n0.6183\n0.2647\n1.4442\n0.2666\n\n\nIMD3\n0.8853\n0.3981\n1.9688\n0.7652\n\n\nIMD4\n0.7618\n0.3509\n1.6538\n0.4915\n\n\nIMD5\n0.7301\n0.3506\n1.5201\n0.4005\n\n\ndqi_tot\n1.0022\n0.9843\n1.0204\n0.8089\n\n\nBMI\n1.0190\n0.9836\n1.0557\n0.2963\n\n\nwhiteMeatIntake_cat[0.426\n0.5386\n0.3076\n0.9429\n0.0303\n\n\nwhiteMeatIntake_cat[1.06,\n0.5090\n0.2848\n0.9098\n0.0227\n\n\nwhiteMeatIntake_cat[1.88,\n0.7308\n0.4351\n1.2274\n0.2358\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1198\n0.9747\n0.7192\n\n\ncat\n9.6209\n1.9772\n0.0079\n\n\nIMD\n2.7614\n3.9308\n0.5877\n\n\ndqi_tot\n3.1257\n0.9909\n0.0761\n\n\nBMI\n0.9814\n0.9811\n0.3157\n\n\nwhiteMeatIntake_cat\n2.9394\n2.9670\n0.3953\n\n\nGLOBAL\n21.6390\n17.8144\n0.2388\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize white meat intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"whiteMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"whiteMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White meat intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/whiteMeatIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteMeatIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteMeatIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6907\n1.2662\n2.2575\n0.0004\n\n\ncatFC 50-250\n1.8008\n1.3087\n2.4779\n0.0003\n\n\ncatFC &gt; 250\n2.0864\n1.4592\n2.9832\n0.0001\n\n\nIMD2\n1.4120\n0.7410\n2.6906\n0.2943\n\n\nIMD3\n1.1432\n0.6083\n2.1485\n0.6775\n\n\nIMD4\n1.3505\n0.7457\n2.4459\n0.3213\n\n\nIMD5\n1.1880\n0.6604\n2.1369\n0.5653\n\n\ndqi_tot\n0.9997\n0.9868\n1.0128\n0.9689\n\n\nBMI\n0.9762\n0.9473\n1.0059\n0.1145\n\n\nwhiteMeatIntake_cat[0.426\n1.0801\n0.7292\n1.5998\n0.7006\n\n\nwhiteMeatIntake_cat[1.06,\n1.0490\n0.7224\n1.5235\n0.8014\n\n\nwhiteMeatIntake_cat[1.88,\n1.0258\n0.6851\n1.5359\n0.9016\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0061\n1.0000\n0.9378\n\n\ncat\n3.5527\n2.0000\n0.1693\n\n\nIMD\n2.6572\n4.0000\n0.6167\n\n\ndqi_tot\n0.7527\n1.0000\n0.3856\n\n\nBMI\n0.9437\n1.0000\n0.3313\n\n\nwhiteMeatIntake_cat\n2.2827\n3.0000\n0.5158\n\n\nGLOBAL\n11.5067\n12.0001\n0.4861\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"whiteMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White meat intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/whiteMeatIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteMeatIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2080\n0.8259\n1.7669\n0.3300\n\n\ncatFC 50-250\n1.9895\n1.2906\n3.0669\n0.0018\n\n\ncatFC &gt; 250\n2.5817\n1.5809\n4.2161\n0.0002\n\n\nIMD2\n1.6600\n0.6280\n4.3877\n0.3068\n\n\nIMD3\n1.3605\n0.5264\n3.5165\n0.5252\n\n\nIMD4\n2.3763\n0.9885\n5.7124\n0.0531\n\n\nIMD5\n1.4230\n0.5865\n3.4523\n0.4353\n\n\ndqi_tot\n1.0056\n0.9877\n1.0238\n0.5438\n\n\nBMI\n0.9602\n0.9204\n1.0017\n0.0601\n\n\nwhiteMeatIntake_cat[0.426\n1.4066\n0.8059\n2.4551\n0.2299\n\n\nwhiteMeatIntake_cat[1.06,\n1.3778\n0.8083\n2.3483\n0.2389\n\n\nwhiteMeatIntake_cat[1.88,\n1.9050\n1.1014\n3.2949\n0.0211\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0465\n0.9882\n0.8254\n\n\ncat\n5.5121\n1.9616\n0.0613\n\n\nIMD\n1.2786\n3.9366\n0.8587\n\n\ndqi_tot\n0.0026\n0.9885\n0.9573\n\n\nBMI\n0.5757\n0.9902\n0.4442\n\n\nwhiteMeatIntake_cat\n2.8092\n2.9636\n0.4155\n\n\nGLOBAL\n11.4009\n18.5192\n0.8947\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize white meat intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"whiteMeatIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"whiteMeatIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White meat intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/whiteMeatIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7709\n1.4269\n2.1979\n0.0000\n\n\ncatFC 50-250\n1.5011\n1.1882\n1.8964\n0.0007\n\n\ncatFC &gt; 250\n2.0189\n1.5586\n2.6150\n0.0000\n\n\nIMD2\n0.9841\n0.6253\n1.5487\n0.9446\n\n\nIMD3\n1.0151\n0.6575\n1.5673\n0.9460\n\n\nIMD4\n1.1060\n0.7302\n1.6753\n0.6342\n\n\nIMD5\n1.0837\n0.7255\n1.6188\n0.6946\n\n\ndqi_tot\n1.0024\n0.9931\n1.0118\n0.6103\n\n\nBMI\n0.9941\n0.9744\n1.0142\n0.5625\n\n\nwhiteMeatIntake_cat[0.426\n0.9483\n0.7088\n1.2687\n0.7208\n\n\nwhiteMeatIntake_cat[1.06,\n0.9382\n0.7025\n1.2529\n0.6656\n\n\nwhiteMeatIntake_cat[1.88,\n0.9936\n0.7452\n1.3248\n0.9650\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0045\n1.0000\n0.9466\n\n\ncat\n1.0963\n2.0000\n0.5780\n\n\nIMD\n5.0648\n4.0000\n0.2807\n\n\ndqi_tot\n1.3828\n1.0000\n0.2396\n\n\nBMI\n0.0090\n1.0000\n0.9246\n\n\nwhiteMeatIntake_cat\n6.1537\n3.0000\n0.1044\n\n\nGLOBAL\n14.5079\n12.0002\n0.2695\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"whiteMeatIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White meat intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/whiteMeatIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteMeatIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2445\n0.9442\n1.6403\n0.1205\n\n\ncatFC 50-250\n1.8704\n1.3660\n2.5610\n0.0001\n\n\ncatFC &gt; 250\n2.6241\n1.8565\n3.7090\n0.0000\n\n\nIMD2\n0.9482\n0.5073\n1.7726\n0.8678\n\n\nIMD3\n1.0017\n0.5489\n1.8280\n0.9957\n\n\nIMD4\n1.3843\n0.7884\n2.4305\n0.2576\n\n\nIMD5\n1.0005\n0.5734\n1.7457\n0.9986\n\n\ndqi_tot\n1.0032\n0.9907\n1.0158\n0.6189\n\n\nBMI\n0.9902\n0.9639\n1.0173\n0.4741\n\n\nwhiteMeatIntake_cat[0.426\n0.8970\n0.6077\n1.3241\n0.5845\n\n\nwhiteMeatIntake_cat[1.06,\n0.9039\n0.6161\n1.3261\n0.6054\n\n\nwhiteMeatIntake_cat[1.88,\n1.2086\n0.8331\n1.7532\n0.3183\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0306\n0.9897\n0.8581\n\n\ncat\n6.5690\n1.9794\n0.0367\n\n\nIMD\n1.4597\n3.9463\n0.8278\n\n\ndqi_tot\n2.0433\n0.9929\n0.1515\n\n\nBMI\n1.8532\n0.9882\n0.1709\n\n\nwhiteMeatIntake_cat\n2.5360\n2.9711\n0.4635\n\n\nGLOBAL\n15.2956\n22.6568\n0.8726\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nFish (white and oily)\nCrohn’s disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize white fish intake by quantiles\nflare.cd.df &lt;- categorize_by_quantiles(flare.cd.df, \"whiteFishIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"whiteFishIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White fish intake quantiles\",\n  plot_base_path = \"plots/cd/soft-flare/diet/whiteFishIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteFishIntake-cd-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteFishIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.8518\n1.3255\n2.5870\n0.0003\n\n\ncatFC 50-250\n1.4540\n1.0175\n2.0779\n0.0399\n\n\ncatFC &gt; 250\n2.1771\n1.4827\n3.1967\n0.0001\n\n\nIMD2\n0.7516\n0.3920\n1.4410\n0.3899\n\n\nIMD3\n0.9740\n0.5326\n1.7812\n0.9318\n\n\nIMD4\n0.8406\n0.4630\n1.5264\n0.5684\n\n\nIMD5\n1.1131\n0.6339\n1.9545\n0.7091\n\n\ndqi_tot\n1.0080\n0.9939\n1.0223\n0.2698\n\n\nBMI\n1.0082\n0.9809\n1.0364\n0.5585\n\n\nwhiteFishIntake_cat[0.796\n0.4737\n0.2988\n0.7508\n0.0015\n\n\nwhiteFishIntake_cat[1.66,\n0.6477\n0.4185\n1.0024\n0.0513\n\n\nwhiteFishIntake_cat[2.88,\n0.7955\n0.5209\n1.2148\n0.2895\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2468\n1.0000\n0.6193\n\n\ncat\n0.8197\n2.0000\n0.6638\n\n\nIMD\n3.1208\n4.0000\n0.5378\n\n\ndqi_tot\n0.2718\n1.0000\n0.6021\n\n\nBMI\n1.1602\n1.0000\n0.2814\n\n\nwhiteFishIntake_cat\n1.4215\n3.0000\n0.7005\n\n\nGLOBAL\n6.9767\n12.0001\n0.8592\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.cd.df,\n  var_name = \"whiteFishIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White fish intake quantiles\",\n  plot_base_path = \"plots/cd/hard-flare/diet/whiteFishIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteFishIntake-cd-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteFishIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3669\n0.8962\n2.0847\n0.1467\n\n\ncatFC 50-250\n2.0266\n1.2588\n3.2629\n0.0036\n\n\ncatFC &gt; 250\n3.1633\n1.8997\n5.2672\n0.0000\n\n\nIMD2\n0.6713\n0.2893\n1.5580\n0.3535\n\n\nIMD3\n0.8165\n0.3672\n1.8157\n0.6191\n\n\nIMD4\n0.7617\n0.3512\n1.6518\n0.4907\n\n\nIMD5\n0.7861\n0.3748\n1.6486\n0.5242\n\n\ndqi_tot\n1.0052\n0.9869\n1.0240\n0.5780\n\n\nBMI\n1.0167\n0.9812\n1.0534\n0.3605\n\n\nwhiteFishIntake_cat[0.796\n0.3096\n0.1668\n0.5748\n0.0002\n\n\nwhiteFishIntake_cat[1.66,\n0.5213\n0.2928\n0.9282\n0.0269\n\n\nwhiteFishIntake_cat[2.88,\n0.7569\n0.4458\n1.2851\n0.3024\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0086\n0.9671\n0.9192\n\n\ncat\n8.2453\n1.9787\n0.0158\n\n\nIMD\n3.3773\n3.9247\n0.4850\n\n\ndqi_tot\n2.4859\n0.9898\n0.1133\n\n\nBMI\n1.3059\n0.9752\n0.2463\n\n\nwhiteFishIntake_cat\n11.0664\n2.9536\n0.0109\n\n\nGLOBAL\n27.4577\n19.1135\n0.0974\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize white fish intake by quantiles\nflare.uc.df &lt;- categorize_by_quantiles(flare.uc.df, \"whiteFishIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"whiteFishIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White fish intake quantiles\",\n  plot_base_path = \"plots/uc/soft-flare/diet/whiteFishIntake\",\n  break_time_by = 200\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteFishIntake-uc-soft.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteFishIntake_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6795\n1.2559\n2.2461\n0.0005\n\n\ncatFC 50-250\n1.7231\n1.2495\n2.3763\n0.0009\n\n\ncatFC &gt; 250\n2.0810\n1.4563\n2.9737\n0.0001\n\n\nIMD2\n1.4833\n0.7781\n2.8277\n0.2310\n\n\nIMD3\n1.1348\n0.6038\n2.1329\n0.6944\n\n\nIMD4\n1.3866\n0.7641\n2.5160\n0.2824\n\n\nIMD5\n1.2546\n0.6956\n2.2629\n0.4510\n\n\ndqi_tot\n0.9948\n0.9814\n1.0083\n0.4482\n\n\nBMI\n0.9802\n0.9511\n1.0102\n0.1930\n\n\nwhiteFishIntake_cat[0.796\n1.1316\n0.7406\n1.7293\n0.5676\n\n\nwhiteFishIntake_cat[1.66,\n1.1029\n0.7386\n1.6471\n0.6320\n\n\nwhiteFishIntake_cat[2.88,\n1.5903\n1.0731\n2.3568\n0.0208\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0023\n1.0000\n0.9620\n\n\ncat\n3.3157\n2.0000\n0.1905\n\n\nIMD\n2.6930\n4.0000\n0.6104\n\n\ndqi_tot\n0.8417\n1.0000\n0.3589\n\n\nBMI\n0.9320\n1.0000\n0.3343\n\n\nwhiteFishIntake_cat\n4.3829\n3.0000\n0.2230\n\n\nGLOBAL\n13.7361\n12.0001\n0.3179\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.uc.df,\n  var_name = \"whiteFishIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White fish intake quantiles\",\n  plot_base_path = \"plots/uc/hard-flare/diet/whiteFishIntake\",\n  break_time_by = 500\n)\n\n# Save plot as RDS\nsaveRDS(analysis_result$plot, paste0(paths$outdir, \"whiteFishIntake-uc-hard.RDS\"))\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteFishIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2043\n0.8203\n1.7682\n0.3427\n\n\ncatFC 50-250\n2.1393\n1.3771\n3.3234\n0.0007\n\n\ncatFC &gt; 250\n2.5089\n1.5391\n4.0897\n0.0002\n\n\nIMD2\n1.5800\n0.6003\n4.1587\n0.3543\n\n\nIMD3\n1.3207\n0.5126\n3.4029\n0.5645\n\n\nIMD4\n2.3071\n0.9625\n5.5300\n0.0609\n\n\nIMD5\n1.3973\n0.5772\n3.3825\n0.4583\n\n\ndqi_tot\n1.0029\n0.9846\n1.0215\n0.7579\n\n\nBMI\n0.9582\n0.9182\n0.9999\n0.0496\n\n\nwhiteFishIntake_cat[0.796\n0.9208\n0.5366\n1.5801\n0.7646\n\n\nwhiteFishIntake_cat[1.66,\n0.7328\n0.4234\n1.2683\n0.2666\n\n\nwhiteFishIntake_cat[2.88,\n1.0419\n0.6259\n1.7342\n0.8746\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0197\n0.9901\n0.8859\n\n\ncat\n5.2113\n1.9615\n0.0713\n\n\nIMD\n0.9526\n3.9382\n0.9124\n\n\ndqi_tot\n0.0077\n0.9884\n0.9277\n\n\nBMI\n0.5184\n0.9894\n0.4673\n\n\nwhiteFishIntake_cat\n5.4156\n2.9592\n0.1401\n\n\nGLOBAL\n13.7950\n18.1517\n0.7509\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nInflammatory bowel disease\n\n\nPatient-reported flare\nHard flare\n\n\n\nCode# Categorize white fish intake by quantiles\nflare.df &lt;- categorize_by_quantiles(flare.df, \"whiteFishIntake\", reference_data = flare.df)\n\n# Run survival analysis using utility function\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"whiteFishIntake\",\n  outcome_time = \"softflare_time\",\n  outcome_event = \"softflare\",\n  legend_title = \"White fish intake quantiles\",\n  plot_base_path = \"plots/ibd/soft-flare/diet/whiteFishIntake\",\n  break_time_by = 200\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteFishIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7195\n1.3854\n2.1340\n0.0000\n\n\ncatFC 50-250\n1.5094\n1.1920\n1.9113\n0.0006\n\n\ncatFC &gt; 250\n2.0167\n1.5563\n2.6132\n0.0000\n\n\nIMD2\n1.0305\n0.6544\n1.6227\n0.8969\n\n\nIMD3\n1.0248\n0.6636\n1.5827\n0.9119\n\n\nIMD4\n1.1336\n0.7473\n1.7196\n0.5554\n\n\nIMD5\n1.1405\n0.7619\n1.7074\n0.5230\n\n\ndqi_tot\n1.0008\n0.9912\n1.0105\n0.8695\n\n\nBMI\n0.9957\n0.9760\n1.0157\n0.6692\n\n\nwhiteFishIntake_cat[0.796\n0.7342\n0.5396\n0.9990\n0.0493\n\n\nwhiteFishIntake_cat[1.66,\n0.8823\n0.6588\n1.1817\n0.4009\n\n\nwhiteFishIntake_cat[2.88,\n1.1629\n0.8751\n1.5452\n0.2982\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0136\n1.0000\n0.9072\n\n\ncat\n1.0328\n2.0000\n0.5967\n\n\nIMD\n5.1923\n4.0000\n0.2681\n\n\ndqi_tot\n1.3542\n1.0000\n0.2445\n\n\nBMI\n0.0006\n1.0000\n0.9813\n\n\nwhiteFishIntake_cat\n4.4596\n3.0000\n0.2159\n\n\nGLOBAL\n11.8491\n12.0002\n0.4579\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCode# Run survival analysis using utility function for hard flare\nanalysis_result &lt;- run_survival_analysis(\n  data = flare.df,\n  var_name = \"whiteFishIntake\",\n  outcome_time = \"hardflare_time\",\n  outcome_event = \"hardflare\",\n  legend_title = \"White fish intake quantiles\",\n  plot_base_path = \"plots/ibd/hard-flare/diet/whiteFishIntake\",\n  break_time_by = 500\n)\n\n# Run Cox model with categorical variable\nfit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + dqi_tot + BMI + whiteFishIntake_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.df\n)\n\n# Display plot and model summary\nanalysis_result$plot\n\nCodeinvisible(cox_summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2493\n0.9455\n1.6509\n0.1174\n\n\ncatFC 50-250\n1.9337\n1.4033\n2.6647\n0.0001\n\n\ncatFC &gt; 250\n2.6610\n1.8769\n3.7726\n0.0000\n\n\nIMD2\n0.9543\n0.5111\n1.7819\n0.8832\n\n\nIMD3\n0.9657\n0.5304\n1.7585\n0.9092\n\n\nIMD4\n1.3903\n0.7921\n2.4401\n0.2509\n\n\nIMD5\n1.0164\n0.5819\n1.7754\n0.9545\n\n\ndqi_tot\n1.0030\n0.9902\n1.0160\n0.6489\n\n\nBMI\n0.9895\n0.9631\n1.0167\n0.4451\n\n\nwhiteFishIntake_cat[0.796\n0.5553\n0.3721\n0.8287\n0.0040\n\n\nwhiteFishIntake_cat[1.66,\n0.6371\n0.4306\n0.9428\n0.0241\n\n\nwhiteFishIntake_cat[2.88,\n0.9103\n0.6326\n1.3099\n0.6128\n\n\n\nDiagnostics:\n\n\nProportional hazards assumption test\nDF betas\n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0005\n0.9885\n0.9822\n\n\ncat\n5.9214\n1.9787\n0.0507\n\n\nIMD\n1.5648\n3.9443\n0.8085\n\n\ndqi_tot\n1.8045\n0.9919\n0.1774\n\n\nBMI\n1.8165\n0.9874\n0.1750\n\n\nwhiteFishIntake_cat\n13.4644\n2.9681\n0.0036\n\n\nGLOBAL\n24.5262\n22.9639\n0.3731\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n ###### Martingale residuals\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#reproduction-and-reproducibility",
    "href": "Survival/Diet.html#reproduction-and-reproducibility",
    "title": "Diet",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  }
]