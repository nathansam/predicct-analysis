[
  {
    "objectID": "Survival/Diet.html",
    "href": "Survival/Diet.html",
    "title": "Diet",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\nDiagnostics: \\\\newline\n\n\")\n\n  cat(\"\\\\newline\n\n::: {.panel-tabset}\n\n      \")\n\n  cat(\"\n\n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n\n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n\n  cat(\"\\\\newline\n\n###### Martingale residuals \\\\newline\n\n      \")\n\n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n\n  cat(\"\\\\newline\n\n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-biochem.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-biochem-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-biochem-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#introduction",
    "href": "Survival/Diet.html#introduction",
    "title": "Diet",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\nDiagnostics: \\\\newline\n\n\")\n\n  cat(\"\\\\newline\n\n::: {.panel-tabset}\n\n      \")\n\n  cat(\"\n\n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n\n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n\n  cat(\"\\\\newline\n\n###### Martingale residuals \\\\newline\n\n      \")\n\n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n\n  cat(\"\\\\newline\n\n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-biochem.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-biochem-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-biochem-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#total-meat-protein",
    "href": "Survival/Diet.html#total-meat-protein",
    "title": "Diet",
    "section": "Total meat protein",
    "text": "Total meat protein\nProtein intake from animal sources is not found to be significantly associated with flares in CD. However, there is evidence of an association for UC. At present, it is difficult to explore this in more detail (e.g. by meat type).\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodequants &lt;- quantile(flare.df$Meat_sum, na.rm = TRUE)\n\nflare.cd.df$Meat_sum_cat &lt;- cut(flare.cd.df$Meat_sum,\n  breaks = c(0, quants[2:5])\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Meat_sum_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Meat protein quantiles\",\n  legend.labs = levels(flare.cd.df$Meat_sum_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\nsaveRDS(p, paste0(outdir, \"meat-cd-soft.RDS\"))\n\ncairo_pdf(\"plots/cd/soft-flare/diet/meat.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/diet/meat.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Meat_sum + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9301\n1.3879\n2.6839\n0.0001\n\n\ncatFC 50-250\n1.3164\n0.9322\n1.8590\n0.1185\n\n\ncatFC &gt; 250\n2.0001\n1.3704\n2.9193\n0.0003\n\n\nIMD2\n0.7354\n0.3887\n1.3915\n0.3449\n\n\nIMD3\n0.9087\n0.5022\n1.6443\n0.7517\n\n\nIMD4\n0.8456\n0.4671\n1.5307\n0.5796\n\n\nIMD5\n0.9935\n0.5715\n1.7272\n0.9815\n\n\nMeat_sum\n0.9980\n0.9908\n1.0052\n0.5831\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1998\n1.0000\n0.6549\n\n\ncat\n1.1034\n2.0000\n0.5760\n\n\nIMD\n3.0211\n4.0000\n0.5543\n\n\nMeat_sum\n0.4997\n1.0000\n0.4796\n\n\nGLOBAL\n4.7693\n8.0001\n0.7819\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Meat_sum_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Meat protein quantiles\",\n  legend.labs = levels(flare.cd.df$Meat_sum_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\nsaveRDS(p, paste0(outdir, \"meat-cd-hard.RDS\"))\n\ncairo_pdf(\"plots/cd/hard-flare/diet/meat.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/diet/meat.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Meat_sum + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2909\n0.8579\n1.9423\n0.2207\n\n\ncatFC 50-250\n1.9325\n1.2177\n3.0667\n0.0052\n\n\ncatFC &gt; 250\n2.9571\n1.7927\n4.8778\n0.0000\n\n\nIMD2\n0.5451\n0.2330\n1.2756\n0.1619\n\n\nIMD3\n0.7295\n0.3341\n1.5931\n0.4287\n\n\nIMD4\n0.6949\n0.3191\n1.5131\n0.3592\n\n\nIMD5\n0.6557\n0.3155\n1.3628\n0.2582\n\n\nMeat_sum\n0.9972\n0.9882\n1.0063\n0.5441\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1065\n0.9750\n0.7344\n\n\ncat\n10.4064\n1.9815\n0.0054\n\n\nIMD\n2.7341\n3.9304\n0.5924\n\n\nMeat_sum\n2.1912\n0.9929\n0.1375\n\n\nGLOBAL\n17.7783\n14.0968\n0.2224\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$Meat_sum_cat &lt;- cut(flare.uc.df$Meat_sum,\n  breaks = c(0, quants[2:5])\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Meat_sum_cat,\n  data = flare.uc.df\n)\n\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Meat protein quantiles\",\n  legend.labs = levels(flare.uc.df$Meat_sum_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\nsaveRDS(p, paste0(outdir, \"meat-uc-soft.RDS\"))\ncairo_pdf(\"plots/uc/soft-flare/diet/meat.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/diet/meat.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Meat_sum +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7226\n1.2987\n2.2850\n0.0002\n\n\ncatFC 50-250\n1.8240\n1.3354\n2.4915\n0.0002\n\n\ncatFC &gt; 250\n2.1335\n1.4978\n3.0391\n0.0000\n\n\nIMD2\n1.5104\n0.7923\n2.8795\n0.2103\n\n\nIMD3\n1.3211\n0.7100\n2.4582\n0.3795\n\n\nIMD4\n1.4328\n0.7912\n2.5949\n0.2352\n\n\nIMD5\n1.3237\n0.7422\n2.3608\n0.3422\n\n\nMeat_sum\n1.0017\n0.9960\n1.0075\n0.5506\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0309\n1.0000\n0.8605\n\n\ncat\n3.9024\n2.0000\n0.1421\n\n\nIMD\n2.5625\n4.0000\n0.6335\n\n\nMeat_sum\n1.7712\n1.0000\n0.1832\n\n\nGLOBAL\n8.9511\n8.0001\n0.3464\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Meat_sum_cat,\n  data = flare.uc.df\n)\n\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Meat protein quantiles\",\n  legend.labs = levels(flare.uc.df$Meat_sum_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\nsaveRDS(p, paste0(outdir, \"meat-uc-hard.RDS\"))\ncairo_pdf(\"plots/uc/hard-flare/diet/meat.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/diet/meat.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Meat_sum + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2996\n0.8966\n1.8839\n0.1665\n\n\ncatFC 50-250\n1.8729\n1.2268\n2.8592\n0.0037\n\n\ncatFC &gt; 250\n2.3997\n1.4804\n3.8898\n0.0004\n\n\nIMD2\n1.9084\n0.7172\n5.0778\n0.1956\n\n\nIMD3\n1.7493\n0.6789\n4.5072\n0.2469\n\n\nIMD4\n2.9654\n1.2167\n7.2276\n0.0168\n\n\nIMD5\n1.8246\n0.7506\n4.4357\n0.1845\n\n\nMeat_sum\n1.0109\n1.0036\n1.0182\n0.0032\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2065\n0.9854\n0.6435\n\n\ncat\n6.8926\n1.9567\n0.0305\n\n\nIMD\n1.7382\n3.9404\n0.7762\n\n\nMeat_sum\n0.2987\n0.9890\n0.5801\n\n\nGLOBAL\n9.4400\n15.8068\n0.8871\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#dietary-fibre",
    "href": "Survival/Diet.html#dietary-fibre",
    "title": "Diet",
    "section": "Dietary fibre",
    "text": "Dietary fibre\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodequants &lt;- quantile(flare.df$fibre, na.rm = TRUE)\n\nflare.cd.df$fibre_cat &lt;- cut(flare.cd.df$fibre,\n  breaks = c(0, quants[2:5])\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ fibre_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Fibre quantiles\",\n  legend.labs = levels(flare.cd.df$fibre_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/diet/fibre.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/diet/fibre.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + fibre + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9615\n1.4107\n2.7273\n0.0001\n\n\ncatFC 50-250\n1.3002\n0.9206\n1.8363\n0.1361\n\n\ncatFC &gt; 250\n2.0094\n1.3759\n2.9347\n0.0003\n\n\nIMD2\n0.7516\n0.3987\n1.4168\n0.3773\n\n\nIMD3\n0.9090\n0.5023\n1.6447\n0.7524\n\n\nIMD4\n0.8510\n0.4706\n1.5387\n0.5933\n\n\nIMD5\n1.0093\n0.5820\n1.7502\n0.9738\n\n\nfibre\n1.0049\n0.9910\n1.0191\n0.4894\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2088\n1.0000\n0.6477\n\n\ncat\n1.0848\n2.0000\n0.5813\n\n\nIMD\n3.0322\n4.0000\n0.5525\n\n\nfibre\n0.0742\n1.0000\n0.7853\n\n\nGLOBAL\n4.3600\n8.0001\n0.8233\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ fibre_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Fibre quantiles\",\n  legend.labs = levels(flare.cd.df$fibre_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/diet/fibre.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/diet/fibre.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + fibre + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3199\n0.8757\n1.9894\n0.1848\n\n\ncatFC 50-250\n1.9170\n1.2080\n3.0423\n0.0057\n\n\ncatFC &gt; 250\n2.9755\n1.8002\n4.9181\n0.0000\n\n\nIMD2\n0.5885\n0.2556\n1.3550\n0.2128\n\n\nIMD3\n0.7654\n0.3505\n1.6712\n0.5022\n\n\nIMD4\n0.7407\n0.3432\n1.5986\n0.4445\n\n\nIMD5\n0.6976\n0.3389\n1.4359\n0.3282\n\n\nfibre\n1.0055\n0.9880\n1.0233\n0.5411\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1027\n0.9732\n0.7382\n\n\ncat\n10.4574\n1.9803\n0.0052\n\n\nIMD\n2.7475\n3.9283\n0.5897\n\n\nfibre\n1.2064\n0.9905\n0.2693\n\n\nGLOBAL\n14.6804\n14.5074\n0.4380\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$fibre_cat &lt;- cut(flare.uc.df$fibre,\n  breaks = c(0, quants[2:5])\n)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ fibre_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Fibre quantiles\",\n  legend.labs = levels(flare.uc.df$fibre_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/diet/fibre.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/diet/fibre.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + fibre +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7111\n1.2918\n2.2664\n0.0002\n\n\ncatFC 50-250\n1.8409\n1.3491\n2.5120\n0.0001\n\n\ncatFC &gt; 250\n2.1253\n1.4909\n3.0298\n0.0000\n\n\nIMD2\n1.4654\n0.7741\n2.7741\n0.2406\n\n\nIMD3\n1.2925\n0.6961\n2.4000\n0.4164\n\n\nIMD4\n1.3968\n0.7760\n2.5142\n0.2652\n\n\nIMD5\n1.2927\n0.7254\n2.3038\n0.3838\n\n\nfibre\n1.0026\n0.9899\n1.0155\n0.6862\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0293\n1.0000\n0.8641\n\n\ncat\n3.8791\n2.0000\n0.1438\n\n\nIMD\n2.5910\n4.0000\n0.6284\n\n\nfibre\n0.0144\n1.0000\n0.9044\n\n\nGLOBAL\n7.1861\n8.0001\n0.5167\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ fibre_cat,\n  data = flare.uc.df\n)\n\n\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Fibre quantiles\",\n  legend.labs = levels(flare.uc.df$fibre_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/diet/fibre.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/diet/fibre.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + fibre + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2174\n0.8426\n1.7588\n0.2947\n\n\ncatFC 50-250\n2.0164\n1.3230\n3.0730\n0.0011\n\n\ncatFC &gt; 250\n2.4365\n1.5055\n3.9434\n0.0003\n\n\nIMD2\n1.5953\n0.6079\n4.1862\n0.3427\n\n\nIMD3\n1.4574\n0.5731\n3.7065\n0.4290\n\n\nIMD4\n2.4237\n1.0163\n5.7803\n0.0459\n\n\nIMD5\n1.5366\n0.6406\n3.6860\n0.3359\n\n\nfibre\n1.0056\n0.9890\n1.0226\n0.5103\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1389\n0.9846\n0.7032\n\n\ncat\n6.9616\n1.9563\n0.0294\n\n\nIMD\n1.6603\n3.9366\n0.7900\n\n\nfibre\n0.3654\n0.9811\n0.5377\n\n\nGLOBAL\n9.1103\n16.4272\n0.9218\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#polyunsaturated-fatty-acids",
    "href": "Survival/Diet.html#polyunsaturated-fatty-acids",
    "title": "Diet",
    "section": "Polyunsaturated fatty acids",
    "text": "Polyunsaturated fatty acids\nThe SAP states n-6 PUFAs will be investigated. However, the FFQ data extract lists PUFA collectively, presumably describing both n-3 and n-6 PUFAs. For now, these data will be used.\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodequants &lt;- quantile(flare.df$PUFA_percEng, na.rm = TRUE)\n\nflare.cd.df$PUFA_cat &lt;- cut(flare.cd.df$PUFA_percEng,\n  breaks = c(0, quants[2:5])\n)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ PUFA_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"PUFA intake (by g) quantiles\",\n  legend.labs = levels(flare.cd.df$PUFA_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/diet/pufa.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/diet/pufa.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + PUFA_percEng + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9447\n1.4000\n2.7013\n0.0001\n\n\ncatFC 50-250\n1.3114\n0.9292\n1.8510\n0.1231\n\n\ncatFC &gt; 250\n1.9853\n1.3601\n2.8980\n0.0004\n\n\nIMD2\n0.7526\n0.3991\n1.4192\n0.3798\n\n\nIMD3\n0.9146\n0.5051\n1.6563\n0.7684\n\n\nIMD4\n0.8624\n0.4764\n1.5613\n0.6250\n\n\nIMD5\n1.0152\n0.5846\n1.7631\n0.9572\n\n\nPUFA_percEng\n1.0270\n0.9207\n1.1457\n0.6322\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2146\n1.0000\n0.6432\n\n\ncat\n1.0888\n2.0000\n0.5802\n\n\nIMD\n3.0187\n4.0000\n0.5547\n\n\nPUFA_percEng\n0.0551\n1.0000\n0.8145\n\n\nGLOBAL\n4.3368\n8.0001\n0.8255\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ PUFA_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"PUFA intake (by g) quantiles\",\n  legend.labs = levels(flare.cd.df$PUFA_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/diet/pufa.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/diet/pufa.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + PUFA_percEng + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3067\n0.8690\n1.9651\n0.1987\n\n\ncatFC 50-250\n1.9387\n1.2217\n3.0765\n0.0050\n\n\ncatFC &gt; 250\n2.9054\n1.7600\n4.7964\n0.0000\n\n\nIMD2\n0.5966\n0.2591\n1.3737\n0.2249\n\n\nIMD3\n0.7781\n0.3554\n1.7038\n0.5304\n\n\nIMD4\n0.7601\n0.3504\n1.6488\n0.4875\n\n\nIMD5\n0.7050\n0.3420\n1.4532\n0.3436\n\n\nPUFA_percEng\n1.0606\n0.9239\n1.2176\n0.4030\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1012\n0.9728\n0.7398\n\n\ncat\n10.5954\n1.9805\n0.0049\n\n\nIMD\n2.8015\n3.9297\n0.5805\n\n\nPUFA_percEng\n0.0328\n0.9835\n0.8512\n\n\nGLOBAL\n14.7107\n14.4787\n0.4337\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$PUFA_cat &lt;- cut(flare.uc.df$PUFA_percEng,\n  breaks = c(0, quants[2:5])\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ PUFA_cat,\n  data = flare.uc.df\n)\n\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"PUFA intake (by g) quantiles\",\n  legend.labs = levels(flare.uc.df$fibre_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/diet/pufa.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/diet/pufa.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + PUFA_percEng +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6828\n1.2700\n2.2298\n0.0003\n\n\ncatFC 50-250\n1.8944\n1.3852\n2.5908\n0.0001\n\n\ncatFC &gt; 250\n2.1753\n1.5263\n3.1000\n0.0000\n\n\nIMD2\n1.5122\n0.7986\n2.8632\n0.2042\n\n\nIMD3\n1.2901\n0.6954\n2.3934\n0.4192\n\n\nIMD4\n1.4068\n0.7819\n2.5308\n0.2547\n\n\nIMD5\n1.3008\n0.7316\n2.3129\n0.3705\n\n\nPUFA_percEng\n1.1027\n0.9954\n1.2216\n0.0613\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0384\n1.0000\n0.8446\n\n\ncat\n4.0370\n2.0000\n0.1329\n\n\nIMD\n2.5687\n4.0000\n0.6324\n\n\nPUFA_percEng\n2.6856\n1.0000\n0.1013\n\n\nGLOBAL\n9.3293\n8.0001\n0.3153\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ PUFA_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"PUFA intake (by g) quantiles\",\n  legend.labs = levels(flare.uc.df$PUFA_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/diet/pufa.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/diet/pufa.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + PUFA_percEng + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2097\n0.8370\n1.7484\n0.3111\n\n\ncatFC 50-250\n2.0095\n1.3178\n3.0644\n0.0012\n\n\ncatFC &gt; 250\n2.4326\n1.5029\n3.9373\n0.0003\n\n\nIMD2\n1.5889\n0.6058\n4.1671\n0.3466\n\n\nIMD3\n1.4714\n0.5790\n3.7391\n0.4170\n\n\nIMD4\n2.4283\n1.0185\n5.7898\n0.0454\n\n\nIMD5\n1.5511\n0.6471\n3.7180\n0.3250\n\n\nPUFA_percEng\n1.0164\n0.8766\n1.1784\n0.8297\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1470\n0.9845\n0.6951\n\n\ncat\n7.0787\n1.9579\n0.0278\n\n\nIMD\n1.6675\n3.9383\n0.7889\n\n\nPUFA_percEng\n0.0812\n0.9791\n0.7679\n\n\nGLOBAL\n9.1091\n16.2902\n0.9178\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#nova-score",
    "href": "Survival/Diet.html#nova-score",
    "title": "Diet",
    "section": "NOVA score",
    "text": "NOVA score\nThe SAP states emulsifiers (specifically lecithin) will be investigated. However, data on emulsifiers are not available in the FFQ data extract. As a proxy for emulsifiers, this report will look at ultra-processed foods via Nova scores (Monteiro et al. 2017).\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ NOVAScore_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Nova score\",\n  legend.labs = levels(flare.cd.df$NOVAScore_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/diet/nova.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/diet/nova.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9456\n1.3992\n2.7054\n0.0001\n\n\ncatFC 50-250\n1.2948\n0.9159\n1.8305\n0.1436\n\n\ncatFC &gt; 250\n1.9987\n1.3667\n2.9229\n0.0004\n\n\nIMD2\n0.7782\n0.4106\n1.4750\n0.4421\n\n\nIMD3\n0.9378\n0.5160\n1.7044\n0.8331\n\n\nIMD4\n0.8878\n0.4876\n1.6166\n0.6973\n\n\nIMD5\n1.0403\n0.5968\n1.8134\n0.8891\n\n\nNOVAScore_catProcessed cu\n0.8975\n0.5879\n1.3702\n0.6165\n\n\nNOVAScore_catProcesed foo\n1.0877\n0.7202\n1.6426\n0.6895\n\n\nNOVAScore_catUltra-proces\n1.0127\n0.6690\n1.5332\n0.9523\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2079\n1.0000\n0.6484\n\n\ncat\n1.0624\n2.0000\n0.5879\n\n\nIMD\n3.0175\n4.0000\n0.5549\n\n\nNOVAScore_cat\n5.0074\n3.0000\n0.1713\n\n\nGLOBAL\n8.6954\n10.0001\n0.5612\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ NOVAScore_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Nova Score\",\n  legend.labs = levels(flare.cd.df$NOVAScore_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/diet/nova.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/diet/nova.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3344\n0.8851\n2.0116\n0.1684\n\n\ncatFC 50-250\n1.9736\n1.2411\n3.1386\n0.0041\n\n\ncatFC &gt; 250\n3.0204\n1.8218\n5.0078\n0.0000\n\n\nIMD2\n0.5377\n0.2316\n1.2483\n0.1488\n\n\nIMD3\n0.7285\n0.3333\n1.5924\n0.4273\n\n\nIMD4\n0.7037\n0.3247\n1.5253\n0.3733\n\n\nIMD5\n0.6451\n0.3119\n1.3342\n0.2371\n\n\nNOVAScore_catProcessed cu\n1.4501\n0.8451\n2.4885\n0.1774\n\n\nNOVAScore_catProcesed foo\n1.2813\n0.7246\n2.2656\n0.3940\n\n\nNOVAScore_catUltra-proces\n1.0536\n0.5976\n1.8577\n0.8567\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1016\n0.9687\n0.7378\n\n\ncat\n10.4301\n1.9830\n0.0053\n\n\nIMD\n2.7017\n3.9245\n0.5971\n\n\nNOVAScore_cat\n2.6455\n2.9499\n0.4405\n\n\nGLOBAL\n15.3634\n16.1560\n0.5095\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCode#|\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ NOVAScore_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Nova score\",\n  legend.labs = levels(flare.uc.df$NOVAScore_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/diet/nova.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/diet/nova.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + NOVAScore_cat +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6922\n1.2762\n2.2437\n0.0003\n\n\ncatFC 50-250\n1.8447\n1.3500\n2.5207\n0.0001\n\n\ncatFC &gt; 250\n2.1416\n1.5012\n3.0551\n0.0000\n\n\nIMD2\n1.4306\n0.7525\n2.7198\n0.2746\n\n\nIMD3\n1.2725\n0.6836\n2.3689\n0.4471\n\n\nIMD4\n1.3610\n0.7524\n2.4618\n0.3081\n\n\nIMD5\n1.2814\n0.7186\n2.2849\n0.4008\n\n\nNOVAScore_catProcessed cu\n0.9050\n0.6195\n1.3220\n0.6056\n\n\nNOVAScore_catProcesed foo\n0.9125\n0.6282\n1.3253\n0.6305\n\n\nNOVAScore_catUltra-proces\n0.8677\n0.5899\n1.2763\n0.4709\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0273\n1.0000\n0.8688\n\n\ncat\n3.8811\n2.0000\n0.1436\n\n\nIMD\n2.5955\n4.0000\n0.6276\n\n\nNOVAScore_cat\n2.6381\n3.0000\n0.4509\n\n\nGLOBAL\n10.2727\n10.0001\n0.4169\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ NOVAScore_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Nova score\",\n  legend.labs = levels(flare.uc.df$NOVAScore_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/diet/nova.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/diet/nova.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + NOVAScore_cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2497\n0.8627\n1.8102\n0.2384\n\n\ncatFC 50-250\n2.0109\n1.3177\n3.0686\n0.0012\n\n\ncatFC &gt; 250\n2.5280\n1.5593\n4.0987\n0.0002\n\n\nIMD2\n1.7298\n0.6564\n4.5587\n0.2677\n\n\nIMD3\n1.6094\n0.6302\n4.1098\n0.3198\n\n\nIMD4\n2.5895\n1.0806\n6.2051\n0.0329\n\n\nIMD5\n1.6427\n0.6828\n3.9520\n0.2679\n\n\nNOVAScore_catProcessed cu\n1.6661\n0.9712\n2.8583\n0.0638\n\n\nNOVAScore_catProcesed foo\n1.6541\n0.9680\n2.8264\n0.0656\n\n\nNOVAScore_catUltra-proces\n1.4855\n0.8523\n2.5890\n0.1627\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1180\n0.9839\n0.7249\n\n\ncat\n6.9070\n1.9567\n0.0303\n\n\nIMD\n1.5903\n3.9353\n0.8028\n\n\nNOVAScore_cat\n4.4917\n2.9595\n0.2081\n\n\nGLOBAL\n14.5359\n17.4963\n0.6617\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#upf-intake",
    "href": "Survival/Diet.html#upf-intake",
    "title": "Diet",
    "section": "UPF intake",
    "text": "UPF intake\nAs an alternative approach to characterising ultra-processed food, we considered the percentage of daily energy intake sourced from ultra-processed food and drink (Nova 4).\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodequants &lt;- quantile(flare.df$UPF_perc, na.rm = TRUE)\n\nflare.cd.df$UPF_perc_cat &lt;- cut(flare.cd.df$UPF_perc,\n  breaks = c(0, quants[2:5])\n)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ UPF_perc_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"UPF as % of energy\",\n  legend.labs = levels(flare.cd.df$UPF_perc_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/diet/UPF.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/diet/UPF.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + UPF_perc + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9612\n1.4073\n2.7330\n0.0001\n\n\ncatFC 50-250\n1.3178\n0.9324\n1.8625\n0.1180\n\n\ncatFC &gt; 250\n2.0010\n1.3701\n2.9223\n0.0003\n\n\nIMD2\n0.7495\n0.3975\n1.4130\n0.3727\n\n\nIMD3\n0.9066\n0.5009\n1.6410\n0.7461\n\n\nIMD4\n0.8547\n0.4727\n1.5453\n0.6033\n\n\nIMD5\n1.0095\n0.5819\n1.7511\n0.9733\n\n\nUPF_perc\n1.0024\n0.9900\n1.0149\n0.7088\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2054\n1.0000\n0.6504\n\n\ncat\n1.1175\n2.0000\n0.5719\n\n\nIMD\n3.0242\n4.0000\n0.5538\n\n\nUPF_perc\n4.6650\n1.0000\n0.0308\n\n\nGLOBAL\n7.9995\n8.0001\n0.4335\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ UPF_perc_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = FALSE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"UPF as % of energy\",\n  legend.labs = levels(flare.cd.df$UPF_perc_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/diet/UPF.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/diet/UPF.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + UPF_perc + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2706\n0.8413\n1.9191\n0.2550\n\n\ncatFC 50-250\n1.8905\n1.1890\n3.0059\n0.0071\n\n\ncatFC &gt; 250\n2.8882\n1.7488\n4.7699\n0.0000\n\n\nIMD2\n0.5820\n0.2538\n1.3347\n0.2012\n\n\nIMD3\n0.7502\n0.3447\n1.6326\n0.4687\n\n\nIMD4\n0.7272\n0.3380\n1.5644\n0.4150\n\n\nIMD5\n0.6776\n0.3301\n1.3909\n0.2888\n\n\nUPF_perc\n0.9937\n0.9776\n1.0101\n0.4516\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1015\n0.9743\n0.7401\n\n\ncat\n10.4868\n1.9819\n0.0052\n\n\nIMD\n2.7331\n3.9299\n0.5925\n\n\nUPF_perc\n0.1382\n0.9832\n0.7033\n\n\nGLOBAL\n14.5088\n14.0372\n0.4153\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$UPF_perc_cat &lt;- cut(flare.uc.df$UPF_perc,\n  breaks = c(0, quants[2:5])\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ UPF_perc_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"UPF as % of energy\",\n  legend.labs = levels(flare.uc.df$UPF_perc_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/diet/UPF.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/diet/UPF.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + UPF_perc +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.7055\n1.2864\n2.2613\n0.0002\n\n\ncatFC 50-250\n2.0272\n1.4760\n2.7841\n0.0000\n\n\ncatFC &gt; 250\n2.2718\n1.5915\n3.2428\n0.0000\n\n\nIMD2\n1.3870\n0.7326\n2.6257\n0.3151\n\n\nIMD3\n1.2065\n0.6492\n2.2423\n0.5527\n\n\nIMD4\n1.3482\n0.7487\n2.4276\n0.3195\n\n\nIMD5\n1.1803\n0.6616\n2.1055\n0.5746\n\n\nUPF_perc\n0.9806\n0.9691\n0.9923\n0.0012\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0293\n0.9985\n0.8636\n\n\ncat\n3.5951\n1.9969\n0.1653\n\n\nIMD\n2.5893\n3.9947\n0.6279\n\n\nUPF_perc\n0.0001\n0.9992\n0.9936\n\n\nGLOBAL\n6.7857\n8.3345\n0.5945\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ UPF_perc_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = FALSE,\n  pval = FALSE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"UPF as % of energy\",\n  legend.labs = levels(flare.uc.df$UPF_perc_cat),\n  palette = c(\"#2274A5\", \"#F0B67F\", \"#440381\", \"#FE5F55\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/diet/UPF.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/diet/UPF.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + UPF_perc + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.1924\n0.8255\n1.7225\n0.3483\n\n\ncatFC 50-250\n2.1006\n1.3733\n3.2132\n0.0006\n\n\ncatFC &gt; 250\n2.4942\n1.5390\n4.0423\n0.0002\n\n\nIMD2\n1.5128\n0.5754\n3.9772\n0.4013\n\n\nIMD3\n1.4063\n0.5515\n3.5860\n0.4752\n\n\nIMD4\n2.4092\n1.0085\n5.7553\n0.0478\n\n\nIMD5\n1.4731\n0.6126\n3.5427\n0.3869\n\n\nUPF_perc\n0.9869\n0.9715\n1.0024\n0.0977\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1768\n0.9864\n0.6685\n\n\ncat\n6.9896\n1.9566\n0.0290\n\n\nIMD\n1.6734\n3.9354\n0.7875\n\n\nUPF_perc\n0.0469\n0.9864\n0.8241\n\n\nGLOBAL\n9.0422\n16.4165\n0.9240\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/Diet.html#reproduction-and-reproducibility",
    "href": "Survival/Diet.html#reproduction-and-reproducibility",
    "title": "Diet",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Diet"
    ]
  },
  {
    "objectID": "Survival/IBD.html",
    "href": "Survival/IBD.html",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n  \nDiagnostics: \\\\newline\n  \n\")\n  \n  cat('\\\\newline\n  \n::: {.panel-tabset} \n\n      ')\n  \n  cat(\"\n  \n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"\\\\newline \n  \n###### Martingale residuals \\\\newline\n      \n      \")\n  \n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\"\\\\newline\n  \n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-demographics.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-demographics-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-demographics-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#introduction",
    "href": "Survival/IBD.html#introduction",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n  \nDiagnostics: \\\\newline\n  \n\")\n  \n  cat('\\\\newline\n  \n::: {.panel-tabset} \n\n      ')\n  \n  cat(\"\n  \n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"\\\\newline \n  \n###### Martingale residuals \\\\newline\n      \n      \")\n  \n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\"\\\\newline\n  \n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-demographics.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-demographics-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-demographics-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#ibd-control-8",
    "href": "Survival/IBD.html#ibd-control-8",
    "title": "Inflammatory bowel disease",
    "section": "IBD Control-8",
    "text": "IBD Control-8\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.cd.df$control_cat &lt;- \n  cut(flare.cd.df$control_8,\n      c(0, 13, 16),\n      labels = c(\"0-12\", \"13-16\"),\n      include.lowest = TRUE,\n      right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ control_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control-8\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/control-8.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/control-8.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9227\n1.4759\n2.5049\n0.0000\n\n\nIMD2\n0.8074\n0.4922\n1.3246\n0.3970\n\n\nIMD3\n0.8700\n0.5315\n1.4241\n0.5796\n\n\nIMD4\n0.8528\n0.5286\n1.3758\n0.5141\n\n\nIMD5\n0.9833\n0.6177\n1.5655\n0.9435\n\n\ncatFC 50-250\n1.4397\n1.0987\n1.8866\n0.0082\n\n\ncatFC &gt; 250\n2.4014\n1.7740\n3.2506\n0.0000\n\n\ncontrol_8\n0.8902\n0.8606\n0.9207\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0012\n0.9903\n0.9717\n\n\nIMD\n6.0925\n3.9280\n0.1855\n\n\ncat\n1.3577\n1.9739\n0.5009\n\n\ncontrol_8\n8.4939\n0.9670\n0.0034\n\n\nGLOBAL\n15.1377\n14.9466\n0.4376\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ control_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control-8\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/control-8.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/control-8.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3756\n1.0112\n1.8714\n0.0423\n\n\nIMD2\n0.6980\n0.3790\n1.2855\n0.2485\n\n\nIMD3\n0.8591\n0.4697\n1.5715\n0.6221\n\n\nIMD4\n0.7891\n0.4392\n1.4178\n0.4282\n\n\nIMD5\n0.7981\n0.4509\n1.4124\n0.4387\n\n\ncatFC 50-250\n1.9417\n1.3669\n2.7584\n0.0002\n\n\ncatFC &gt; 250\n3.5422\n2.4220\n5.1804\n0.0000\n\n\ncontrol_8\n0.9792\n0.9359\n1.0245\n0.3621\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.5133\n0.9850\n0.2149\n\n\nIMD\n8.1252\n3.9413\n0.0840\n\n\ncat\n7.2016\n1.9860\n0.0269\n\n\ncontrol_8\n2.8005\n0.9806\n0.0918\n\n\nGLOBAL\n20.3170\n15.1753\n0.1677\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$control_cat &lt;- \n  cut(flare.uc.df$control_8,\n      c(0, 13, 16),\n      labels = c(\"0-12\", \"13-16\"),\n      include.lowest = TRUE,\n      right = FALSE)\n\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ control_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control-8\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\n\ncairo_pdf(\"plots/uc/soft-flare/ibd/control-8.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/ibd/control-8.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4904\n1.1840\n1.8761\n0.0007\n\n\nIMD2\n1.3212\n0.7897\n2.2106\n0.2888\n\n\nIMD3\n1.2137\n0.7394\n1.9922\n0.4437\n\n\nIMD4\n1.4949\n0.9289\n2.4059\n0.0977\n\n\nIMD5\n1.3596\n0.8507\n2.1729\n0.1992\n\n\ncatFC 50-250\n1.5424\n1.1893\n2.0002\n0.0011\n\n\ncatFC &gt; 250\n2.0139\n1.5095\n2.6868\n0.0000\n\n\ncontrol_8\n0.9225\n0.8909\n0.9553\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.9678\n0.9953\n0.0844\n\n\nIMD\n4.2823\n3.9667\n0.3644\n\n\ncat\n4.5769\n1.9835\n0.1000\n\n\ncontrol_8\n5.2699\n0.9948\n0.0215\n\n\nGLOBAL\n15.8660\n12.7158\n0.2390\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ control_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control-8\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/ibd/control-8.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/ibd/control-8.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + control_8 + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3913\n1.0274\n1.8840\n0.0328\n\n\nIMD2\n1.3477\n0.6476\n2.8046\n0.4248\n\n\nIMD3\n1.5031\n0.7484\n3.0187\n0.2520\n\n\nIMD4\n2.1278\n1.0942\n4.1375\n0.0261\n\n\nIMD5\n1.6178\n0.8327\n3.1432\n0.1557\n\n\ncatFC 50-250\n2.0148\n1.4131\n2.8728\n0.0001\n\n\ncatFC &gt; 250\n3.0295\n2.0721\n4.4293\n0.0000\n\n\ncontrol_8\n0.9453\n0.9026\n0.9899\n0.0169\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1400\n0.9860\n0.7027\n\n\nIMD\n2.7617\n3.9396\n0.5890\n\n\ncat\n3.5264\n1.9665\n0.1671\n\n\ncontrol_8\n1.7488\n0.9845\n0.1826\n\n\nGLOBAL\n8.2255\n23.1839\n0.9982\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#ibd-control-visual-analogue-scale",
    "href": "Survival/IBD.html#ibd-control-visual-analogue-scale",
    "title": "Inflammatory bowel disease",
    "section": "IBD Control visual analogue scale",
    "text": "IBD Control visual analogue scale\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ vas_control,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control VAS\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/control-vas.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/control-vas.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0996\n1.6160\n2.7280\n0.0000\n\n\nIMD2\n0.7695\n0.4706\n1.2582\n0.2962\n\n\nIMD3\n0.9004\n0.5525\n1.4672\n0.6736\n\n\nIMD4\n0.8423\n0.5237\n1.3546\n0.4789\n\n\nIMD5\n0.9688\n0.6121\n1.5333\n0.8924\n\n\ncatFC 50-250\n1.3678\n1.0415\n1.7963\n0.0243\n\n\ncatFC &gt; 250\n2.3897\n1.7645\n3.2362\n0.0000\n\n\nvas_control85+\n0.5710\n0.4500\n0.7246\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0298\n0.9934\n0.8610\n\n\nIMD\n5.8028\n3.9533\n0.2095\n\n\ncat\n1.3945\n1.9837\n0.4940\n\n\nvas_control\n6.4668\n0.9893\n0.0108\n\n\nGLOBAL\n13.2734\n12.1071\n0.3576\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ vas_control,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control VAS\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/control-vas.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/control-vas.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3751\n1.0101\n1.8721\n0.0430\n\n\nIMD2\n0.6859\n0.3715\n1.2665\n0.2282\n\n\nIMD3\n0.8599\n0.4699\n1.5734\n0.6244\n\n\nIMD4\n0.7481\n0.4148\n1.3491\n0.3347\n\n\nIMD5\n0.7802\n0.4412\n1.3800\n0.3937\n\n\ncatFC 50-250\n1.8928\n1.3283\n2.6973\n0.0004\n\n\ncatFC &gt; 250\n3.4895\n2.3810\n5.1142\n0.0000\n\n\nvas_control85+\n0.9359\n0.6894\n1.2705\n0.6708\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.6756\n0.9837\n0.1918\n\n\nIMD\n7.9021\n3.9395\n0.0918\n\n\ncat\n8.1082\n1.9864\n0.0171\n\n\nvas_control\n0.2524\n0.9877\n0.6102\n\n\nGLOBAL\n20.3223\n15.8147\n0.1970\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n::: {.panel-tabset group=“followup”}\nSoft flare\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ vas_control,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control VAS\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/ibd/control-vas.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/ibd/control-vas.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5419\n1.2247\n1.9413\n0.0002\n\n\nIMD2\n1.3325\n0.7893\n2.2496\n0.2826\n\n\nIMD3\n1.2056\n0.7280\n1.9968\n0.4675\n\n\nIMD4\n1.4696\n0.9046\n2.3874\n0.1199\n\n\nIMD5\n1.3493\n0.8371\n2.1749\n0.2188\n\n\ncatFC 50-250\n1.5798\n1.2174\n2.0502\n0.0006\n\n\ncatFC &gt; 250\n1.9587\n1.4652\n2.6185\n0.0000\n\n\nvas_control85+\n0.6861\n0.5423\n0.8679\n0.0017\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.9736\n0.9943\n0.0840\n\n\nIMD\n4.3116\n3.9618\n0.3601\n\n\ncat\n5.7100\n1.9817\n0.0566\n\n\nvas_control\n3.5219\n0.9923\n0.0599\n\n\nGLOBAL\n16.5023\n13.4488\n0.2495\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\nHard flare\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ vas_control,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Control VAS\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/hard-flare/ibd/control-vas.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/ibd/control-vas.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + vas_control + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3848\n1.0220\n1.8763\n0.0357\n\n\nIMD2\n1.2918\n0.6208\n2.6877\n0.4935\n\n\nIMD3\n1.4220\n0.7087\n2.8532\n0.3218\n\n\nIMD4\n1.9936\n1.0297\n3.8599\n0.0407\n\n\nIMD5\n1.5530\n0.8031\n3.0034\n0.1908\n\n\ncatFC 50-250\n2.0459\n1.4357\n2.9155\n0.0001\n\n\ncatFC &gt; 250\n2.9077\n1.9851\n4.2592\n0.0000\n\n\nvas_control85+\n0.6559\n0.4815\n0.8933\n0.0075\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1785\n0.9852\n0.6666\n\n\nIMD\n2.8643\n3.9383\n0.5711\n\n\ncat\n3.3111\n1.9665\n0.1862\n\n\nvas_control\n0.2632\n0.9852\n0.6017\n\n\nGLOBAL\n7.3842\n23.0999\n0.9992\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#variables-only-relevant-to-crohns-disease",
    "href": "Survival/IBD.html#variables-only-relevant-to-crohns-disease",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to Crohn’s disease",
    "text": "Variables only relevant to Crohn’s disease\n\nCodedemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.cd &lt;- demo.cd[, c(\"ParticipantNo\",\n                       \"Surgery\",\n                       \"Location\",\n                       \"L4\",\n                       \"Behaviour\",\n                       \"Perianal\",\n                       \"HBI\",\n                       \"PRO2\")]\nflare.cd.df &lt;- merge(flare.cd.df,\n                     demo.cd,\n                     by = \"ParticipantNo\",\n                     all.x = TRUE,\n                     all.y = FALSE)\n\n\nSurgery\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Surgery, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Previous surgery\",\n  palette = c(\"#3DDC97\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/surgery.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/surgery.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Surgery +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9970\n1.5704\n2.5394\n0.0000\n\n\ncatFC 50-250\n1.5774\n1.2210\n2.0379\n0.0005\n\n\ncatFC &gt; 250\n2.3834\n1.7891\n3.1751\n0.0000\n\n\nIMD2\n0.8921\n0.5692\n1.3983\n0.6186\n\n\nIMD3\n0.8326\n0.5264\n1.3170\n0.4336\n\n\nIMD4\n0.8750\n0.5640\n1.3575\n0.5512\n\n\nIMD5\n0.9325\n0.6106\n1.4240\n0.7462\n\n\nSurgeryNo\n0.9871\n0.7904\n1.2329\n0.9092\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3138\n0.9943\n0.5730\n\n\ncat\n2.4348\n1.9874\n0.2936\n\n\nIMD\n5.3005\n3.9665\n0.2539\n\n\nSurgery\n0.6320\n0.9915\n0.4234\n\n\nGLOBAL\n8.9435\n11.8427\n0.6958\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Surgery, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Previous surgery\",\n  palette = c(\"#3DDC97\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/surgery.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/surgery.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Surgery +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4133\n1.0743\n1.8592\n0.0134\n\n\ncatFC 50-250\n2.0584\n1.4977\n2.8292\n0.0000\n\n\ncatFC &gt; 250\n3.2393\n2.2905\n4.5812\n0.0000\n\n\nIMD2\n0.8768\n0.5106\n1.5058\n0.6338\n\n\nIMD3\n0.8923\n0.5114\n1.5569\n0.6882\n\n\nIMD4\n0.8420\n0.4913\n1.4430\n0.5314\n\n\nIMD5\n0.8745\n0.5201\n1.4706\n0.6132\n\n\nSurgeryNo\n1.3305\n1.0168\n1.7410\n0.0374\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3300\n0.9858\n0.5597\n\n\ncat\n8.5496\n1.9843\n0.0137\n\n\nIMD\n4.0006\n3.9415\n0.3973\n\n\nSurgery\n2.5667\n0.9872\n0.1073\n\n\nGLOBAL\n17.3483\n20.3096\n0.6492\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMontreal location\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Location, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal location\",\n  palette = c(\"#3B3561\", \"#5BC0EB\", \"#FFD166\", \"#E4572E\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/location.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/location.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Location +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0379\n1.5673\n2.6498\n0.0000\n\n\ncatFC 50-250\n1.6798\n1.2692\n2.2231\n0.0003\n\n\ncatFC &gt; 250\n2.4535\n1.8007\n3.3429\n0.0000\n\n\nIMD2\n0.9218\n0.5727\n1.4836\n0.7372\n\n\nIMD3\n0.8187\n0.5015\n1.3365\n0.4237\n\n\nIMD4\n0.8363\n0.5225\n1.3386\n0.4564\n\n\nIMD5\n0.9443\n0.6018\n1.4816\n0.8029\n\n\nLocationL2\n0.8397\n0.6095\n1.1570\n0.2855\n\n\nLocationL3\n1.0929\n0.8212\n1.4543\n0.5425\n\n\nLocationL4 only\n0.9482\n0.2984\n3.0126\n0.9281\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2323\n0.9980\n0.6290\n\n\ncat\n3.2675\n1.9968\n0.1947\n\n\nIMD\n5.1401\n3.9898\n0.2720\n\n\nLocation\n1.1604\n2.9932\n0.7614\n\n\nGLOBAL\n9.8488\n10.7869\n0.5251\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Location, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal location\",\n  palette = c(\"#3B3561\", \"#5BC0EB\", \"#FFD166\", \"#E4572E\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/location.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/location.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Location +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4122\n1.0506\n1.8982\n0.0222\n\n\ncatFC 50-250\n1.9337\n1.3740\n2.7214\n0.0002\n\n\ncatFC &gt; 250\n3.1807\n2.2094\n4.5789\n0.0000\n\n\nIMD2\n0.8819\n0.4941\n1.5742\n0.6707\n\n\nIMD3\n0.9504\n0.5256\n1.7185\n0.8663\n\n\nIMD4\n0.9099\n0.5129\n1.6144\n0.7470\n\n\nIMD5\n0.9891\n0.5687\n1.7202\n0.9691\n\n\nLocationL2\n1.2964\n0.8834\n1.9025\n0.1846\n\n\nLocationL3\n1.3328\n0.9285\n1.9132\n0.1193\n\n\nLocationL4 only\n1.2113\n0.2871\n5.1108\n0.7941\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1424\n0.9830\n0.6991\n\n\ncat\n6.3620\n1.9837\n0.0409\n\n\nIMD\n3.8329\n3.9412\n0.4203\n\n\nLocation\n0.5903\n2.9550\n0.8941\n\n\nGLOBAL\n11.3705\n21.5180\n0.9629\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMontreal L4\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ L4, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal L4 presence\",\n  palette = c(\"#3DDC97\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/l4.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/l4.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + L4 +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0268\n1.5589\n2.6350\n0.0000\n\n\ncatFC 50-250\n1.6892\n1.2767\n2.2352\n0.0002\n\n\ncatFC &gt; 250\n2.3738\n1.7423\n3.2342\n0.0000\n\n\nIMD2\n0.8815\n0.5472\n1.4199\n0.6040\n\n\nIMD3\n0.7833\n0.4794\n1.2799\n0.3296\n\n\nIMD4\n0.8069\n0.5031\n1.2941\n0.3733\n\n\nIMD5\n0.9046\n0.5765\n1.4193\n0.6625\n\n\nL4Present\n1.2936\n0.9172\n1.8244\n0.1423\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2367\n0.9981\n0.6258\n\n\ncat\n3.4174\n1.9965\n0.1806\n\n\nIMD\n5.2745\n3.9899\n0.2591\n\n\nL4\n2.9817\n0.9968\n0.0838\n\n\nGLOBAL\n12.5997\n8.8065\n0.1700\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ L4, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal L4 presence\",\n  palette = c(\"#3DDC97\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/l4.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/l4.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + L4 +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4360\n1.0684\n1.9301\n0.0165\n\n\ncatFC 50-250\n1.9358\n1.3756\n2.7240\n0.0002\n\n\ncatFC &gt; 250\n3.1320\n2.1758\n4.5085\n0.0000\n\n\nIMD2\n0.8257\n0.4627\n1.4736\n0.5170\n\n\nIMD3\n0.8677\n0.4791\n1.5715\n0.6396\n\n\nIMD4\n0.8321\n0.4680\n1.4794\n0.5314\n\n\nIMD5\n0.9026\n0.5188\n1.5705\n0.7169\n\n\nL4Present\n1.5676\n1.0693\n2.2981\n0.0213\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1595\n0.9826\n0.6825\n\n\ncat\n6.4740\n1.9836\n0.0386\n\n\nIMD\n4.0148\n3.9425\n0.3956\n\n\nL4\n0.0375\n0.9606\n0.8338\n\n\nGLOBAL\n10.7469\n19.2888\n0.9386\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMontreal Behaviour\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Behaviour, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal behaviour\",\n  palette = c(\"#3DDC97\", \"#FFD166\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/behaviour.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/behaviour.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Behaviour +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0640\n1.5766\n2.7020\n0.0000\n\n\ncatFC 50-250\n1.6340\n1.2279\n2.1746\n0.0008\n\n\ncatFC &gt; 250\n2.3258\n1.6953\n3.1909\n0.0000\n\n\nIMD2\n0.9230\n0.5693\n1.4965\n0.7452\n\n\nIMD3\n0.7493\n0.4518\n1.2430\n0.2637\n\n\nIMD4\n0.8865\n0.5480\n1.4342\n0.6236\n\n\nIMD5\n0.9870\n0.6239\n1.5614\n0.9554\n\n\nBehaviourB2\n1.0662\n0.7953\n1.4294\n0.6683\n\n\nBehaviourB3\n0.7879\n0.4947\n1.2549\n0.3155\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1946\n0.9978\n0.6582\n\n\ncat\n3.9115\n1.9961\n0.1410\n\n\nIMD\n4.3369\n3.9877\n0.3606\n\n\nBehaviour\n0.9019\n1.9953\n0.6359\n\n\nGLOBAL\n9.4596\n10.0044\n0.4895\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Behaviour, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal behaviour\",\n  palette = c(\"#3DDC97\", \"#FFD166\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/behaviour.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/behaviour.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Behaviour +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5091\n1.1174\n2.0383\n0.0073\n\n\ncatFC 50-250\n2.0811\n1.4681\n2.9499\n0.0000\n\n\ncatFC &gt; 250\n3.4647\n2.3857\n5.0316\n0.0000\n\n\nIMD2\n0.9419\n0.5228\n1.6971\n0.8421\n\n\nIMD3\n0.8970\n0.4872\n1.6518\n0.7272\n\n\nIMD4\n0.9794\n0.5448\n1.7605\n0.9444\n\n\nIMD5\n1.0317\n0.5866\n1.8145\n0.9137\n\n\nBehaviourB2\n0.8913\n0.6267\n1.2677\n0.5221\n\n\nBehaviourB3\n0.8505\n0.5012\n1.4431\n0.5483\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0070\n0.9845\n0.9303\n\n\ncat\n5.6993\n1.9835\n0.0570\n\n\nIMD\n2.8336\n3.9427\n0.5771\n\n\nBehaviour\n2.7982\n1.9761\n0.2427\n\n\nGLOBAL\n12.1681\n20.1919\n0.9154\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nPerinanal disease\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Perianal, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Perianal disease\",\n  palette = c(\"#3DDC97\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/ibd/perinal.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/ibd/perinal.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Perianal +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0572\n1.5795\n2.6794\n0.0000\n\n\ncatFC 50-250\n1.6277\n1.2282\n2.1573\n0.0007\n\n\ncatFC &gt; 250\n2.3910\n1.7543\n3.2587\n0.0000\n\n\nIMD2\n0.9586\n0.5934\n1.5485\n0.8628\n\n\nIMD3\n0.8177\n0.4975\n1.3441\n0.4274\n\n\nIMD4\n0.8333\n0.5158\n1.3464\n0.4564\n\n\nIMD5\n0.8992\n0.5679\n1.4237\n0.6503\n\n\nPerianalNo\n0.7679\n0.6000\n0.9829\n0.0360\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0684\n0.9950\n0.7920\n\n\ncat\n4.5984\n1.9892\n0.0994\n\n\nIMD\n5.5262\n3.9719\n0.2343\n\n\nPerianal\n0.2214\n0.9919\n0.6346\n\n\nGLOBAL\n10.2702\n10.9257\n0.4997\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Perianal, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Perianal disease\",\n  palette = c(\"#3DDC97\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/ibd/perinal.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/ibd/perinal.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Perianal +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4036\n1.0483\n1.8795\n0.0228\n\n\ncatFC 50-250\n1.8951\n1.3518\n2.6569\n0.0002\n\n\ncatFC &gt; 250\n3.1094\n2.1650\n4.4659\n0.0000\n\n\nIMD2\n0.9969\n0.5566\n1.7855\n0.9918\n\n\nIMD3\n1.0334\n0.5690\n1.8768\n0.9140\n\n\nIMD4\n0.9261\n0.5160\n1.6621\n0.7969\n\n\nIMD5\n0.9379\n0.5339\n1.6477\n0.8235\n\n\nPerianalNo\n0.8750\n0.6536\n1.1714\n0.3697\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1937\n0.9841\n0.6533\n\n\ncat\n7.0942\n1.9838\n0.0283\n\n\nIMD\n2.3289\n3.9479\n0.6677\n\n\nPerianal\n1.9313\n0.9841\n0.1614\n\n\nGLOBAL\n11.5538\n19.8863\n0.9279\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#variables-only-relevant-to-ucibdu",
    "href": "Survival/IBD.html#variables-only-relevant-to-ucibdu",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to UC/IBDU",
    "text": "Variables only relevant to UC/IBDU\n\nCodedemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\ndemo.uc &lt;- demo.uc[, c(\"ParticipantNo\", \"Extent\", \"Mayo\")]\nflare.uc.df &lt;- merge(flare.uc.df,\n                     demo.uc,\n                     by = \"ParticipantNo\",\n                     all.x = TRUE,\n                     all.y = FALSE)\n\n\nMontreal extent\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Extent, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal extent\",\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\n\ncairo_pdf(\"plots/uc/soft-flare/ibd/extent.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/ibd/extent.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + IMD + Extent +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4261\n1.1158\n1.8227\n0.0046\n\n\ncatFC 50-250\n1.6346\n1.2328\n2.1673\n0.0006\n\n\ncatFC &gt; 250\n2.2553\n1.6710\n3.0440\n0.0000\n\n\nIMD2\n1.2814\n0.7812\n2.1019\n0.3262\n\n\nIMD3\n1.0697\n0.6587\n1.7371\n0.7854\n\n\nIMD4\n1.4373\n0.9127\n2.2636\n0.1175\n\n\nIMD5\n1.1749\n0.7483\n1.8449\n0.4838\n\n\nExtentE2\n0.9196\n0.6607\n1.2801\n0.6196\n\n\nExtentE3\n0.6967\n0.4810\n1.0090\n0.0558\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0215\n0.9891\n0.8804\n\n\ncat\n4.6159\n1.9587\n0.0959\n\n\nIMD\n2.9011\n3.9332\n0.5640\n\n\nExtent\n4.1788\n1.9657\n0.1202\n\n\nGLOBAL\n12.0732\n21.9250\n0.9547\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Extent, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Montreal extent\",\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/uc/hard-flare/ibd/extent.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/ibd/extent.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Extent +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4242\n1.0492\n1.9334\n0.0234\n\n\ncatFC 50-250\n1.9574\n1.3666\n2.8037\n0.0002\n\n\ncatFC &gt; 250\n3.2458\n2.2460\n4.6907\n0.0000\n\n\nIMD2\n1.6852\n0.8594\n3.3047\n0.1288\n\n\nIMD3\n1.6813\n0.8824\n3.2033\n0.1142\n\n\nIMD4\n2.2154\n1.1918\n4.1182\n0.0119\n\n\nIMD5\n1.6230\n0.8722\n3.0201\n0.1264\n\n\nExtentE2\n2.1493\n1.2632\n3.6570\n0.0048\n\n\nExtentE3\n1.8507\n1.0529\n3.2532\n0.0324\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.6040\n0.9857\n0.4315\n\n\ncat\n5.9334\n1.9616\n0.0496\n\n\nIMD\n2.5189\n3.9364\n0.6315\n\n\nExtent\n0.7654\n1.9746\n0.6760\n\n\nGLOBAL\n9.5946\n21.8882\n0.9891\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMayo score\n\nCodeflare.uc.df$Mayo_cat &lt;- cut(flare.uc.df$Mayo,\n                            c(0, 2, 5, 9),\n                            labels = c(\"Inactive\", \"Mild\", \"Moderate\"),\n                            right = TRUE)\n\n\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Mayo_cat, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Mayo score\",\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/uc/soft-flare/ibd/mayo.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/ibd/mayo.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + cat + Mayo + Extent +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4049\n1.0761\n1.8343\n0.0125\n\n\ncatFC 50-250\n1.6646\n1.2283\n2.2557\n0.0010\n\n\ncatFC &gt; 250\n2.4320\n1.7451\n3.3892\n0.0000\n\n\nMayo\n1.1117\n1.0094\n1.2243\n0.0316\n\n\nExtentE2\n1.0050\n0.6957\n1.4518\n0.9789\n\n\nExtentE3\n0.7477\n0.4960\n1.1274\n0.1652\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2221\n0.9943\n0.6351\n\n\ncat\n3.2655\n1.9791\n0.1924\n\n\nMayo\n2.8510\n0.9265\n0.0823\n\n\nExtent\n4.4854\n1.9674\n0.1032\n\n\nGLOBAL\n10.5608\n13.9227\n0.7149\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Mayo_cat, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Mayo score\",\n  palette = c(\"#3DDC97\", \"orange\", \"#DD7373\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/uc/hard-flare/ibd/mayo.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/ibd/mayo.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + cat + IMD + Mayo +\n    frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2672\n0.9438\n1.7015\n0.1152\n\n\ncatFC 50-250\n1.8912\n1.3331\n2.6830\n0.0004\n\n\ncatFC &gt; 250\n3.1128\n2.1355\n4.5373\n0.0000\n\n\nIMD2\n1.6242\n0.8553\n3.0844\n0.1383\n\n\nIMD3\n1.1995\n0.6373\n2.2574\n0.5729\n\n\nIMD4\n1.5787\n0.8645\n2.8828\n0.1373\n\n\nIMD5\n1.2277\n0.6754\n2.2314\n0.5011\n\n\nMayo\n1.0890\n0.9753\n1.2161\n0.1297\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0043\n0.9878\n0.9457\n\n\ncat\n3.1681\n1.9834\n0.2026\n\n\nIMD\n1.4273\n3.9518\n0.8342\n\n\nMayo\n0.1658\n0.9504\n0.6632\n\n\nGLOBAL\n4.6901\n17.1518\n0.9987\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(outdir, \"flares-IBD.RDS\"))\nsaveRDS(flare.cd.df, paste0(outdir, \"flares-IBD-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(outdir, \"flares-IBD-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/IBD.html#reproduction-and-reproducibility",
    "href": "Survival/IBD.html#reproduction-and-reproducibility",
    "title": "Inflammatory bowel disease",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Survival/Controlled.html",
    "href": "Survival/Controlled.html",
    "title": "Controlled variables",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n  \nDiagnostics: \\\\newline\n  \n\")\n  \n  cat('\\\\newline\n  \n::: {.panel-tabset} \n\n      ')\n  \n  cat(\"\n  \n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"\\\\newline \n  \n###### Martingale residuals \\\\newline\n      \n      \")\n  \n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\"\\\\newline\n  \n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-overview.RDS\"))\nflare.cd.df &lt;- subset(flare.df, diagnosis2 == \"CD\")\nflare.uc.df &lt;- subset(flare.df, diagnosis2 == \"UC/IBDU\")\n\n\nThe variables being controlled for in later cox models analyses are first investigated.\nAlthough smoking status was originally planned to be controlled for, the high degree of missingness for these data and the lack of significant associations with time to flare has resulted in smoking status not being controlled for in later analyses.\nOf the variables considered here, only sex is associated with disease flare.",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#introduction",
    "href": "Survival/Controlled.html#introduction",
    "title": "Controlled variables",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n  \nDiagnostics: \\\\newline\n  \n\")\n  \n  cat('\\\\newline\n  \n::: {.panel-tabset} \n\n      ')\n  \n  cat(\"\n  \n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"\\\\newline \n  \n###### Martingale residuals \\\\newline\n      \n      \")\n  \n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\"\\\\newline\n  \n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-overview.RDS\"))\nflare.cd.df &lt;- subset(flare.df, diagnosis2 == \"CD\")\nflare.uc.df &lt;- subset(flare.df, diagnosis2 == \"UC/IBDU\")\n\n\nThe variables being controlled for in later cox models analyses are first investigated.\nAlthough smoking status was originally planned to be controlled for, the high degree of missingness for these data and the lack of significant associations with time to flare has resulted in smoking status not being controlled for in later analyses.\nOf the variables considered here, only sex is associated with disease flare.",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#sex",
    "href": "Survival/Controlled.html#sex",
    "title": "Controlled variables",
    "section": "Sex",
    "text": "Sex\nCrohn’s disease\n\n\nSoft flare\nHard flares\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Sex, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  legend.labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/controlled/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/controlled/sex.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Sex, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  legend.labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/controlled/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/controlled/sex.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Sex, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  legend.labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/uc/soft-flare/controlled/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/controlled/sex.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Sex, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  legend.labs = c(\"Male\", \"Female\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/uc/hard-flare/controlled/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/controlled/sex.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#smoking-status",
    "href": "Survival/Controlled.html#smoking-status",
    "title": "Controlled variables",
    "section": "Smoking status",
    "text": "Smoking status\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Smoke, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Smoking status\",\n  legend.labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/controlled/smoke.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/controlled/smoke.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Smoke, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Smoking status\",\n  legend.labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/controlled/smoke.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/controlled/smoke.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Smoke, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Smoking status\",\n  legend.labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/uc/soft-flare/controlled/smoke.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/controlled/smoke.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Smoke, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Smoking status\",\n  legend.labs = c(\"Current\", \"Previous\", \"Never\"),\n  palette = c(\"#00A6ED\", \"#FFB400\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/uc/hard-flare/controlled/smoke.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/controlled/smoke.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#social-deprivation",
    "href": "Survival/Controlled.html#social-deprivation",
    "title": "Controlled variables",
    "section": "Social deprivation",
    "text": "Social deprivation\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ IMD, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IMD\",\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/controlled/imd.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/controlled/imd.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ IMD, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IMD\",\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/controlled/imd.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/controlled/imd.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ IMD, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IMD\",\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/uc/soft-flare/controlled/imd.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/controlled/imd.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ IMD, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IMD\",\n  palette = c(\"#F05D5E\", \"#00C2D1\", \"#FFBA49\", \"#EDC9FF\", \"#034C3C\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/uc/hard-flare/controlled/imd.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/controlled/imd.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#faecal-calprotectin",
    "href": "Survival/Controlled.html#faecal-calprotectin",
    "title": "Controlled variables",
    "section": "Faecal calprotectin",
    "text": "Faecal calprotectin\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ cat, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Faecal calprotectin\",\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/cd/soft-flare/controlled/fc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/controlled/fc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\nsaveRDS(p, paste0(outdir, \"fc-cd-soft.RDS\"))\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ cat, data = flare.cd.df)\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Faecal calprotectin\",\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/cd/hard-flare/controlled/fc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/controlled/fc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\nsaveRDS(p, paste0(outdir, \"fc-cd-hard.RDS\"))\n\np\n\n\n\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ cat, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Faecal calprotectin\",\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\n\ncairo_pdf(\"plots/uc/soft-flare/controlled/fc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/controlled/fc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\nsaveRDS(p, paste0(outdir, \"fc-uc-soft.RDS\"))\n\np\n\n\n\n\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ cat, data = flare.uc.df)\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Faecal calprotectin\",\n  palette = c(\"#2AAACE\", \"#FFBF1C\", \"#FF6726\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\"\n)\n\ncairo_pdf(\"plots/uc/hard-flare/controlled/fc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/controlled/fc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\nsaveRDS(p, paste0(outdir, \"fc-uc-hard.RDS\"))\n\np",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#cox-models",
    "href": "Survival/Controlled.html#cox-models",
    "title": "Controlled variables",
    "section": "Cox models",
    "text": "Cox models\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df,\n  model = TRUE\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9989\n1.5753\n2.5364\n0.0000\n\n\nIMD2\n0.9364\n0.5970\n1.4686\n0.7746\n\n\nIMD3\n0.8868\n0.5609\n1.4021\n0.6074\n\n\nIMD4\n0.9417\n0.6062\n1.4631\n0.7894\n\n\nIMD5\n0.9857\n0.6443\n1.5078\n0.9469\n\n\ncatFC 50-250\n1.5844\n1.2278\n2.0445\n0.0004\n\n\ncatFC &gt; 250\n2.4138\n1.8192\n3.2028\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3091\n0.9923\n0.5750\n\n\nIMD\n5.8397\n3.9497\n0.2063\n\n\ncat\n2.3232\n1.9815\n0.3093\n\n\nGLOBAL\n8.4076\n13.9400\n0.8643\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3887\n1.0579\n1.8227\n0.0180\n\n\nIMD2\n0.9220\n0.5365\n1.5844\n0.7688\n\n\nIMD3\n0.9675\n0.5566\n1.6817\n0.9068\n\n\nIMD4\n0.8950\n0.5222\n1.5338\n0.6864\n\n\nIMD5\n0.9035\n0.5370\n1.5199\n0.7021\n\n\ncatFC 50-250\n2.0217\n1.4730\n2.7750\n0.0000\n\n\ncatFC &gt; 250\n3.3366\n2.3693\n4.6989\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2571\n0.9863\n0.6064\n\n\nIMD\n4.2174\n3.9407\n0.3689\n\n\ncat\n8.8712\n1.9847\n0.0116\n\n\nGLOBAL\n13.9394\n19.6668\n0.8190\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5438\n1.2475\n1.9104\n0.0001\n\n\nIMD2\n1.2433\n0.7856\n1.9678\n0.3525\n\n\nIMD3\n1.1010\n0.7025\n1.7255\n0.6748\n\n\nIMD4\n1.4420\n0.9388\n2.2151\n0.0946\n\n\nIMD5\n1.1988\n0.7858\n1.8290\n0.4002\n\n\ncatFC 50-250\n1.5688\n1.2269\n2.0058\n0.0003\n\n\ncatFC &gt; 250\n2.1447\n1.6433\n2.7991\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.3013\n0.9907\n0.2514\n\n\nIMD\n4.0189\n3.9418\n0.3949\n\n\ncat\n5.7453\n1.9706\n0.0550\n\n\nGLOBAL\n11.3236\n18.7016\n0.9037\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3259\n1.0208\n1.7221\n0.0345\n\n\nIMD2\n1.4092\n0.7861\n2.5260\n0.2494\n\n\nIMD3\n1.3774\n0.7835\n2.4213\n0.2659\n\n\nIMD4\n1.7484\n1.0130\n3.0174\n0.0448\n\n\nIMD5\n1.2989\n0.7566\n2.2298\n0.3430\n\n\ncatFC 50-250\n2.0322\n1.4885\n2.7744\n0.0000\n\n\ncatFC &gt; 250\n3.2203\n2.3245\n4.4614\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1461\n0.9849\n0.6962\n\n\nIMD\n2.6145\n3.9368\n0.6145\n\n\ncat\n4.3647\n1.9671\n0.1096\n\n\nGLOBAL\n7.4355\n23.5846\n0.9994\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(outdir, \"flares-contolled.RDS\"))\nsaveRDS(flare.cd.df, paste0(outdir, \"flares-controlled-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(outdir, \"flares-controlled-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Controlled.html#reproduction-and-reproducibility",
    "href": "Survival/Controlled.html#reproduction-and-reproducibility",
    "title": "Controlled variables",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Controlled variables"
    ]
  },
  {
    "objectID": "Survival/Introduction.html",
    "href": "Survival/Introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "This report explores associations between time to flare and the variables recorded at baseline. Time to flare is modelled using Cox models with the variable of interest and controlled variables (sex, and deprivation) included as fixed effects. A gamma frailty term is employed for hospital sites (which may capture inter-hospital differences).\nThe primary study endpoint is soft flare which is defined as a participant reporting their disease as being uncontrolled when they completed a monthly study questionnaire.\nFor soft flares, only the first two years of follow-up are considered as this was the time interval in which questionnaires were sent to participants.\nThe secondary study endpoint is hard flare, which required elevated CRP and/or CRP and for the subject to change medication. Data for this endpoint was collected via end-of-study phenotyping.\nFor hard flares, the full study follow-up period has been used, from study recruitment to the time the end of study phenotyping was completed.\nSoft and hard flares have been identified by Dr Linda Williams, the PREdiCCt trial statistician. The same flare definitions have been used across all teams working on PREdiCCt.",
    "crumbs": [
      "Time to flare",
      "Introduction"
    ]
  },
  {
    "objectID": "Baseline/Diet.html",
    "href": "Baseline/Diet.html",
    "title": "Diet",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  upf.path &lt;- \"data/final/20240924/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  upf.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20240924/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-biochem.RDS\"))\n\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\nFFQ$ParticipantNo &lt;- FFQ$participantno\ndemo &lt;- merge(demo,\n  FFQ[, c(\"ParticipantNo\", \"Meat_sum\", \"fibre\", \"PUFA_percEng\", \"NOVAScore_cat\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nPREdiCCt has collected data on diet via food frequency questionnaires (FFQs) and food diaries. This dietary data has been analysed by staff at the University of Aberdeen, primarily by Dr Janet Kyle, Dr Graham Horgan, and Professor Alex Johnstone.\nWhilst data for many dietary variables have been collected, this report will focus on the data outlined in the SAP.\n\nProtein from animal-sources\nDietary fibre\nPolyunsaturated fatty acids (PUFAs)\nNova intake score\n\nThe data for these variables were extracted from the FFQs. As reported associations between dietary data and IBD are often specific to a form of IBD rather than IBD as a whole, these data will be presented stratified by disease type.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#introduction",
    "href": "Baseline/Diet.html#introduction",
    "title": "Diet",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  upf.path &lt;- \"data/final/20240924/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  upf.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20240924/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-biochem.RDS\"))\n\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\nFFQ$ParticipantNo &lt;- FFQ$participantno\ndemo &lt;- merge(demo,\n  FFQ[, c(\"ParticipantNo\", \"Meat_sum\", \"fibre\", \"PUFA_percEng\", \"NOVAScore_cat\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nPREdiCCt has collected data on diet via food frequency questionnaires (FFQs) and food diaries. This dietary data has been analysed by staff at the University of Aberdeen, primarily by Dr Janet Kyle, Dr Graham Horgan, and Professor Alex Johnstone.\nWhilst data for many dietary variables have been collected, this report will focus on the data outlined in the SAP.\n\nProtein from animal-sources\nDietary fibre\nPolyunsaturated fatty acids (PUFAs)\nNova intake score\n\nThe data for these variables were extracted from the FFQs. As reported associations between dietary data and IBD are often specific to a form of IBD rather than IBD as a whole, these data will be presented stratified by disease type.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#protein-from-meat-sources",
    "href": "Baseline/Diet.html#protein-from-meat-sources",
    "title": "Diet",
    "section": "Protein from meat sources",
    "text": "Protein from meat sources\nFigure 1 suggests there are relatively few vegetarians in the PREdiCCt cohort. Whilst some extreme values were observed for protein from meat sources, they remain plausible.\n\nCodedemo %&gt;%\n  drop_na(Meat_sum) %&gt;%\n  ggplot(aes(x = Meat_sum, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Protein from meat sources (g)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    labels = c(\"UC/IBDU\", \"Crohn's\"),\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 1: Distribution of protein intake from meat.\n\n\n\n\nNo association was observed between protein intake from meat and FC.\n\nCodepander(summary(aov(Meat_sum ~ cat, data = demo)))\n\n\nTable 1: ANOVA between protein intake from meat and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n2499\n1250\n2.297\n0.1011\n\n\nResiduals\n1009\n548990\n544.1\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#dietary-fibre",
    "href": "Baseline/Diet.html#dietary-fibre",
    "title": "Diet",
    "section": "Dietary fibre",
    "text": "Dietary fibre\nFibre has frequently investigated as a potential factor in IBD pathogenesis, particularly in CD.\nA study of 170,776 women across 26 years found fibre intake, particularly fibre derived from fruits, to be low for incident CD patients (Ananthakrishnan et al. 2013).\nA US study of 1,130 CD subjects found CD patients who reported that they did not avoid high-fibre foods were approximately 40% less likely to have a disease flare in a 6-month period than those who avoided high-fibre foods (Brotherton et al. 2016).\nThere is less evidence of a relationship between UC and dietary fibre.\nThere does not appear to be substantial differences in fibre between CD and UC/IBDU PREdiCCt participants.\n\nCodedemo %&gt;%\n  drop_na(fibre) %&gt;%\n  ggplot(aes(x = fibre, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Dietary fibre\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 2: Distribution of dietary fibre.\n\n\n\n\nNo association was found between dietary fibre intake and FC.\n\nCodepander(summary(aov(fibre ~ cat, data = demo)))\n\n\nTable 2: ANOVA between dietary fibre and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n68.97\n34.48\n0.3141\n0.7305\n\n\nResiduals\n1009\n110777\n109.8\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#polyunsaturated-fatty-acids",
    "href": "Baseline/Diet.html#polyunsaturated-fatty-acids",
    "title": "Diet",
    "section": "Polyunsaturated fatty acids",
    "text": "Polyunsaturated fatty acids\nPUFAs exhibit anti-inflammatory properties and there is evidence of a relationship between PUFAs and UC incidence (Marion-Letellier et al. 2013). Research suggests that a diet with a poor balance of n-3 and n-6 PUFAs, commonly seen in “Western” diets is associated with IBD risk.\nThe PREdiCCt SAP states n-6 PUFAs will be examined. However, the data obtained from the FFQs describes PUFAs as a whole (including n-3 PUFAs).\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = PUFA_percEng, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"PUFA intake\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 3: Distribution of polyunsaturated fatty acids.\n\n\n\n\nA significant association was not seen between PUFA intake and FC.\n\nCodepander(summary(aov(PUFA_percEng ~ cat, data = demo)))\n\n\nTable 3: ANOVA between polyunsaturated fatty acids and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n8.176\n4.088\n2.365\n0.09451\n\n\nResiduals\n1009\n1744\n1.729\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#nova-intake-score",
    "href": "Baseline/Diet.html#nova-intake-score",
    "title": "Diet",
    "section": "Nova intake score",
    "text": "Nova intake score\nThere has been a great deal of recent research interest in ultra processed food (UPF) and IBD. For example, Narula et al. (2021) found UPF intake to be positively associated with IBD risk.\nThe Nova score is a popular approach for classifying UPFs (Monteiro et al. 2017). Food is classified as either unprocessed, processed culinary, processed food, or ultra-processed via the Nova score. The University of Aberdeen have developed an extension of the Nova score, the Nova intake score, which can be used to categorise individuals and their diets instead of individual food items.\nThe following definition of the Nova intake score was written by Liam McAdie during a 5th year medical elective in which he worked on the PREdiCCt dietary data. The formulae have received minor modifications, but otherwise the definitions remain unchanged from McAdie’s work.\nDefinition\nWhen completing the FFQ, participants were asked to report (a) portion size normally consumed, (b) number of times this portion is consumed in one day and (c) number of days per week food type is consumed. Participant’s daily average consumption (in grams) of a food and drink type (x) was calculated by:\n\nx=\\frac{c}{7}(a+b)\n\nStandardised number of portions consumed daily for food and drink type (y) was calculated by dividing consumption (x) by the Foods Standard Agency average UK-portion size (z).\n\ny= \\frac{x}{z}\n\nNova intake scores (N) were calculated by multiplying the number of standardised portions consumed (y) by their corresponding Nova score (M) assigned in the database. This process is repeated for all 169 food and drink types and totalled to give one overall Nova intake score. This score is a marker representative of UPF intake.\n\nN = \\sum_{i = 1}^{169} (y_i M_i)\n\nResults\nThe distribution of Nova intake score appears to be uniform across the cohort, as such, it seems likely that these data have been mapped to quantiles and are no longer describing Nova Score categories.\n\nCodedemo$NOVAScore_cat &lt;- factor(demo$NOVAScore_cat,\n  levels = 1:4,\n  labels = c(\n    \"Unprocessed\",\n    \"Processed culinary\",\n    \"Procesed food\",\n    \"Ultra-processed\"\n  )\n)\n\ndemo %&gt;%\n  drop_na(NOVAScore_cat) %&gt;%\n  ggplot(aes(x = NOVAScore_cat, color = diagnosis2, fill = diagnosis2)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"Nova intake score\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 4: Distribution of Nova intake scores.\n\n\n\n\nNo significant association was observed between Nova intake scores and FC groups.\n\nCodepander(chisq.test(demo$NOVAScore_cat, demo$cat))\n\n\nChi-squared test between Nova intake score and FC groups.\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n11.43\n6\n0.07589\n\n\n\n\nPercentage of energy intake\n\nCodenova4 &lt;- read_xlsx(paste0(upf.path, \"NOVA4Scores.xlsx\"))\ncolnames(nova4)[c(1, 6)] &lt;- c(\"ParticipantNo\", \"UPF_perc\")\ndemo &lt;- merge(demo,\n  nova4[, c(\"ParticipantNo\", \"UPF_perc\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nAs an alternative to the above analyses, we have also explored the percentage of daily energy intake which is derived from ultra processed (UPF4) groups.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = UPF_perc, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  labs(\n    x = \"% of energy intake attributed to Nova 4 food and drink\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\nWarning: Removed 1132 rows containing non-finite outside the scale range\n(`stat_bin()`).\n\n\n\n\n\n\n\nFigure 5: Distribution of the percentage of daily energy intake sourced from UPF (Nova score 4) food and drink.\n\n\n\n\n\nCodepander(summary(aov(UPF_perc ~ cat, data = demo)))\n\n\nTable 4: ANOVA between UP4 as percentage of energy intake and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n305.1\n152.6\n1.023\n0.36\n\n\nResiduals\n1009\n150505\n149.2\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-diet.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#comparison",
    "href": "Baseline/Diet.html#comparison",
    "title": "Diet",
    "section": "Comparison",
    "text": "Comparison\nFigure 6 presents macronutrient, PUFA and UPF intake as percentages of total energy intake.\n\nCodeFFQ$Prot_percEng &lt;- ((FFQ$Protng * 4) / FFQ$EnergykCAL) * 100\n\nFFQ &lt;- merge(FFQ,\n  nova4[, c(\"ParticipantNo\", \"UPF_perc\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\ncomparison &lt;- reshape2::melt(FFQ,\n  id.vars = \"ParticipantNo\",\n  measure.vars = c(\n    \"CHO_percEng\",\n    \"Fat_percEng\",\n    \"Prot_percEng\",\n    \"SatFat_percEng\",\n    \"PUFA_percEng\",\n    \"UPF_perc\"\n  )\n)\n\ncomparison &lt;- merge(comparison,\n  demo[, c(\"ParticipantNo\", \"Sex\", \"diagnosis2\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\np &lt;- ggplot(\n  comparison,\n  aes(color = variable, fill = variable, y = value, x = Sex)\n) +\n  geom_violin() +\n  facet_grid(~diagnosis2,\n    scales = \"free_x\",\n    space = \"free_x\",\n    switch = \"x\"\n  ) +\n  theme_minimal() +\n  theme(\n    strip.placement = \"outside\",\n    strip.background = element_rect(fill = \"white\"),\n    strip.clip = \"on\",\n    axis.title.x = element_blank(),\n    legend.position = \"bottom\"\n  ) +\n  scale_fill_manual(\n    values = c(\n      \"#4F359B\",\n      \"#FFED49\",\n      \"#2EC4B6\",\n      \"#E71D36\",\n      \"#FF9F1C\",\n      \"#80BF56\"\n    ),\n    labels = c(\n      \"Carbohydrate\",\n      \"Fat\",\n      \"Protein\",\n      \"Saturated fat\",\n      \"Polyunsaturated fatty acids\",\n      \"Ultra-processed foods\"\n    )\n  ) +\n  scale_color_manual(\n    values = c(\n      \"#392376\",\n      \"#ADA009\",\n      \"#00877C\",\n      \"#9F1C29\",\n      \"#B06B01\",\n      \"#568238\"\n    ),\n    labels = c(\n      \"Carbohydrate\",\n      \"Fat\",\n      \"Protein\",\n      \"Saturated fat\",\n      \"Polyunsaturated fatty acids\",\n      \"Ultra-processed food\"\n    )\n  ) +\n  labs(\n    y = \"% of total energy intake\",\n    color = \"\",\n    fill = \"\"\n  ) +\n  guides(\n    colour = guide_legend(nrow = 1),\n    fill = guide_legend(nrow = 1)\n  )\n\nggsave(\"plots/baseline/diet.png\", p, width = 12 * 0.8, height = 7 * 0.8)\nggsave(\"plots/baseline/diet.pdf\", p, width = 12 * 0.8, height = 7 * 0.8)\np\n\n\n\n\n\n\nFigure 6: Dietary distribution of the FFQ subcohort expressed as percentages of energy intake and stratified by sex and diagnosis of either Crohn’s disease or ulcerative colitis/inflammatory bowel disease unclassified.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/Diet.html#reproduction-and-reproducibility",
    "href": "Baseline/Diet.html#reproduction-and-reproducibility",
    "title": "Diet",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), textshaping(v.0.4.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), reshape2(v.1.4.4), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), ragg(v.1.3.2), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), systemfonts(v.1.1.0), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Diet"
    ]
  },
  {
    "objectID": "Baseline/IBD.html",
    "href": "Baseline/IBD.html",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-demographics.RDS\"))\ndemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\n\n\nThis page explores data which describes subjects’ IBD, primarily consisting of clinical data.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#introduction",
    "href": "Baseline/IBD.html#introduction",
    "title": "Inflammatory bowel disease",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-demographics.RDS\"))\ndemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\n\n\nThis page explores data which describes subjects’ IBD, primarily consisting of clinical data.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#ibd-type",
    "href": "Baseline/IBD.html#ibd-type",
    "title": "Inflammatory bowel disease",
    "section": "IBD type",
    "text": "IBD type\nFor this study, we have grouped ulcerative colitis (UC) and inflammatory bowel disease unclassified (IBDU) into one category. IBD type is self-reported.\nWhilst PREdiCCt was designed to recruit an equal number of CD and UC/IBDU subjects, the COVID-19 pandemic halted recruitment which has resulted in there not being an equal balance of CD and UC/IBDU subjects.There are slightly more Crohn’s disease (CD) than UC/IBDU subjects in the FC cohort.\n\nCodedemo$diagnosis2 &lt;- plyr::mapvalues(demo$diagnosis,\n  from = seq(1, 4),\n  to = c(1, 2, 2, 2)\n) %&gt;%\n  factor(levels = c(\"1\", \"2\"), labels = c(\"CD\", \"UC/IBDU\"))\n\ndemo$diagnosis &lt;- plyr::mapvalues(demo$diagnosis,\n  from = seq(1, 4),\n  to = c(1, 2, 3, 3)\n) %&gt;%\n  factor(levels = c(\"1\", \"2\", \"3\"), labels = c(\"CD\", \"UC\", \"IBDU\"))\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = diagnosis2, fill = diagnosis2, color = diagnosis2)) +\n  geom_bar() +\n  ylab(\"Frequency\") +\n  xlab(\"IBD type\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#2B2D42\", \"#92DCE5\")) +\n  scale_color_manual(values = c(\"#1E203A\", \"#1D9BA5\")) +\n  guides(\n    fill = guide_legend(title = \"IBD type\"),\n    color = guide_legend(title = \"IBD type\")\n  )\n\n\n\n\n\n\nFigure 1: Distribution of IBD type in the FC cohort.\n\n\n\n\nIBD type is significantly associated with FC at recruitment.\n\nCodepander(chisq.test(demo$diagnosis2, demo$cat))\n\n\nTable 1: Chi-squared test between IBD type and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$diagnosis2 and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n6.815\n2\n0.03313 *",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#disease-duration",
    "href": "Baseline/IBD.html#disease-duration",
    "title": "Inflammatory bowel disease",
    "section": "Disease duration",
    "text": "Disease duration\nDisease duration has been calculated by subtracting reported date of diagnosis from the date of entry into PREdiCCt. Date of diagnosis has been obtained via REDcap. Where only year was available, the datefixR R package was used to impute the middle of the year. Any disease durations reported to be negative using this method were mapped to 0.\n\nCoderedcap &lt;- read_xlsx(paste0(redcap.path, \"redcap_clean.xlsx\"))\nredcap &lt;- distinct(redcap, participantno, .keep_all = TRUE)\n\ndiag.date &lt;- redcap[, c(\"participantno\", \"date_diag\")]\ncolnames(diag.date)[1] &lt;- \"ParticipantNo\"\ndiag.date &lt;- subset(diag.date, (!is.na(date_diag)) &\n  (!is.null(date_diag)) &\n  date_diag != \"\")\nduration &lt;- merge(diag.date,\n  demo,\n  by = \"ParticipantNo\",\n  all.x = FALSE,\n  all.y = TRUE\n)\nduration &lt;- distinct(duration, ParticipantNo, .keep_all = TRUE)\n\nduration &lt;- subset(duration, tolower(date_diag) != \"unknown\")\nduration[duration[, \"date_diag\"] == \"16/032016\", \"date_diag\"] &lt;- \"16/03/2016\"\nduration[duration[, \"date_diag\"] == \"19/04/2017P\", \"date_diag\"] &lt;- \"19/04/2017\"\nduration[duration[, \"date_diag\"] == \"2007 APPROX\", \"date_diag\"] &lt;- \"2007\"\nduration[duration[, \"date_diag\"] == \"approx 1988\", \"date_diag\"] &lt;- \"1988\"\nduration[duration[, \"date_diag\"] == \"?2014\", \"date_diag\"] &lt;- \"2014\"\n\nduration &lt;- fix_date_df(duration, c(\"entry_date\", \"date_diag\"))\n\nduration$duration &lt;- as.numeric(with(\n  duration,\n  (entry_date - date_diag) / 365.25\n))\n\nduration[duration[, \"duration\"] &lt; 0, \"duration\"] &lt;- 0\n\n\nduration.cd &lt;- subset(duration, diagnosis == \"1\")\n\nduration.uc &lt;- subset(duration, diagnosis != \"1\")\n\np &lt;- duration %&gt;%\n  ggplot(aes(x = duration, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  labs(\n    x = \"Duration (years)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  )\nggsave(\"plots/Duration-full-cohort.png\",\n  p,\n  width = 9,\n  height = 6\n)\nggsave(\"plots/Duration-full-cohort.pdf\", p, width = 9, height = 6)\n\n\nduration %&gt;%\n  drop_na(duration) %&gt;%\n  ggplot(aes(x = duration, color = diagnosis2, fill = diagnosis2)) +\n  geom_histogram(bins = 25) +\n  theme_minimal() +\n  labs(\n    x = \"Duration (years)\",\n    y = \"Frequency\",\n    color = \"IBD type\",\n    fill = \"IBD type\"\n  ) +\n  scale_fill_manual(\n    values = c(\"#CDEDF6\", \"#FF6B6B\")\n  ) +\n  scale_color_manual(\n    values = c(\"#5EB1BF\", \"#C24343\")\n  )\n\n\n\n\n\n\nFigure 2\n\n\n\n\nWhilst a low p-value was observed, disease duration was not significantly different between FC groups.\n\nCodedemo &lt;- merge(demo, duration[, c(\"ParticipantNo\", \"duration\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\nnames(demo)[18] &lt;- \"IBD Duration\"\npander(summary(aov(`IBD Duration` ~ cat, data = demo)))\n\n\nTable 2: ANOVA between IBD disease duration and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n639.6\n319.8\n2.708\n0.06691\n\n\nResiduals\n2021\n238664\n118.1\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#ibd-control",
    "href": "Baseline/IBD.html#ibd-control",
    "title": "Inflammatory bowel disease",
    "section": "IBD Control",
    "text": "IBD Control\n\nCodeIBD &lt;- read_xlsx(paste0(data.path, \"Baseline2022/IBD.xlsx\"))\n\n# create flare_group in IBD_C and make into level\nIBD &lt;- IBD %&gt;%\n  mutate(flare_group = ifelse(FlaresInPastYear == 0,\n    \"No Flares\",\n    \"1 or More Flares\"\n  ))\nIBD$flare_group &lt;- factor(IBD$flare_group,\n  levels = c(\"No Flares\", \"1 or More Flares\")\n)\n\nIBD &lt;- IBD %&gt;%\n  mutate(treatment = ifelse(TreatmentUseful == 4,\n    \"Not On Treatment\",\n    \"On Treatment\"\n  ))\nIBD$treatment &lt;- factor(IBD$treatment,\n  levels = c(\"Not On Treatment\", \"On Treatment\")\n)\n\n# correcting scores where No is favourable and Yes is unfavourable outcomes\n# answer options were always YES/NO/Not sure\nif (any(IBD$MissPlannedActivities == 3)) {\n  IBD &lt;- IBD %&gt;%\n    mutate_at(\n      vars(\"MissPlannedActivities\":\"NewSymptoms\"),\n      ~ recode(., `3` = 1, `2` = 2, `1` = 0)\n    )\n}\n\n# correct TreatmentUseful (Yes is favourable, No unfavourable)\n# not on treatment was assigned the value 1\nif (any(IBD$TreatmentUseful == 3)) {\n  IBD &lt;- IBD %&gt;%\n    mutate_at(\n      \"TreatmentUseful\",\n      ~ recode(., `4` = 2, `3` = 1, `2` = 0, `1` = 2)\n    )\n}\n\n# exclude rows with missing data, 17 participants excluded for missing IBD-control questionnaire data\nIBD &lt;- IBD %&gt;%\n  filter(!rowSums(is.na(select(., 17:27))) &gt; 0)\n\n# new column with total control score\nIBD &lt;- IBD %&gt;%\n  mutate(control_score = rowSums(select(., 17:27), na.rm = TRUE))\n\n# new column with IBD-control-8 score\n# added 2 to make comparable to future scores where the first question is asked to make comparable to future and against the cut off of 13 which indicates remission\nIBD &lt;- IBD %&gt;%\n  mutate(control_8 = TreatmentUseful +\n    MissPlannedActivities +\n    WakeUpAtNight +\n    SignificantPain +\n    OftenLackEnergy +\n    AnxiousDepressed +\n    NeedChangeTreatment +\n    2)\n\n# create groups with cut off of IBD-control-8 scores quiescent (13 or above)/not quiescent\nIBD &lt;- IBD %&gt;%\n  mutate(control_grouped = ifelse(control_8 &gt;= 13, \"13-16\", \"0-12\"))\n\nIBD$control_8 &lt;- as.factor(IBD$control_8)\n\nIBD &lt;- IBD %&gt;%\n  mutate(vas_control = ifelse(OverallControl &gt;= 85, \"85+\", \"&lt;85\"))\n\ndemo &lt;- merge(demo, IBD[, c(\"ParticipantNo\", \"control_8\", \"OverallControl\", \"vas_control\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nIBD Control is a validated questionnaire designed to assess disease control from a patient’s perspective (Bodger et al. 2013). We considered an eight question subset, IBD-Control-8 which ranges in potential scores from 0 to 16. We also consider the IBD-Control visual analogue scale (VAS). Bodger et al. (2013) found a cut-off of \\geq 13 for IBD-Control-8 and a cut-off of \\geq 85 for IBD-Control-VAS to be optimal for identifying quiescent disease.\n\nCodep1 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = control_8, color = control_8, fill = control_8)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  xlab(\"Control-8 Scores\") +\n  ylab(\"Frequency\") +\n  scale_color_manual(values = viridis::viridis(15), na.value = \"#032B43\") +\n  scale_fill_manual(values = viridis::viridis(15), na.value = \"#032B43\") +\n  geom_vline(xintercept = 11.5, color = \"#FF4B3E\")\n\np2 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = OverallControl)) +\n  geom_histogram(binwidth = 5, fill = \"#FFD23F\", color = \"#947805\") +\n  theme_minimal() +\n  xlab(\"VAS Scores\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = 85, color = \"#FF4B3E\") +\n  scale_x_continuous(breaks = seq(0, 100, 10))\np1 / p2 + plot_annotation(tag_levels = \"A\")\n\n\n\n\n\n\nFigure 3: Distributiuon of IBD Control scores for (A) Control-8 and (B) Visual analogue scale. The vertical red lines denote the cut-offs for quiescent disease reported by Bodger et al. (2013).\n\n\n\n\nIBD-Control-8 scores and VAS were both found to be significantly associated with FC.\n\nCodepander(summary(aov(as.numeric(control_8) ~ cat, data = demo)))\n\n\nTable 3: ANOVA between control-8 and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n65.25\n32.63\n3.335\n0.03586\n\n\nResiduals\n1694\n16574\n9.784\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodepander(summary(aov(OverallControl ~ cat, data = demo)))\n\n\nTable 4: ANOVA between control VAS and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n4692\n2346\n9.996\n4.836e-05\n\n\nResiduals\n1687\n395921\n234.7\nNA\nNA\n\n\n\n\n\n\n\n\nInstead to treating VAS as a continuous value, going forward, VAS will be discretised into below 85 and 85 and above as a VAS of 85 was found by Bodger et al. (2013) to be predictive of quiescent disease.\n\nCodedemo &lt;- demo %&gt;%\n  select(-OverallControl)\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = vas_control, color = vas_control, fill = vas_control)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  xlab(\"Visual analogue scores\") +\n  ylab(\"Frequency\") +\n  scale_color_manual(values = c(\"#D00000\", \"#447604\"), na.value = \"#032B43\") +\n  scale_fill_manual(values = c(\"#D00000\", \"#447604\"), na.value = \"#032B43\")\n\n\n\n\n\n\nFigure 4: Distribution of discretised IBD-Control-VAS scores.\n\n\n\n\nThe discretised VAS is continued to be significantly associated with FC.\n\nCodepander(chisq.test(demo$vas_control, demo$cat))\n\n\nTable 5: Chi squared test between VAS and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$vas_control and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n16.89\n2\n0.0002153 * * *",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#medication-use",
    "href": "Baseline/IBD.html#medication-use",
    "title": "Inflammatory bowel disease",
    "section": "Medication use",
    "text": "Medication use\nThis section is concerned with medication used by study participants. Current treatment strategy, bio-naive status and antibiotic use are considered.\nIBD treatment strategy\n\nCodedrugs &lt;- data.frame(ParticipantNo = demo$ParticipantNo)\n\ndrugs$ASA &lt;- FALSE\ndrugs$imm &lt;- FALSE\ndrugs$bio &lt;- FALSE\ndrugs$category &lt;- NA\n\nredcap &lt;- redcap %&gt;% mutate(\n  curr_on_mesa = ifelse(is.na(curr_on_mesa),\n    0,\n    curr_on_mesa\n  ),\n  curr_on_aza = ifelse(is.na(curr_on_aza),\n    0,\n    curr_on_aza\n  ),\n  curr_on_merc = ifelse(is.na(curr_on_merc),\n    0,\n    curr_on_merc\n  ),\n  curr_on_metho = ifelse(is.na(curr_on_metho),\n    0,\n    curr_on_metho\n  ),\n  curr_on_ciclo = ifelse(is.na(curr_on_ciclo),\n    0,\n    curr_on_ciclo\n  ),\n  curr_on_inflix = ifelse(is.na(curr_on_inflix),\n    0,\n    curr_on_inflix\n  ),\n  curr_on_ada = ifelse(is.na(curr_on_ada),\n    0,\n    curr_on_ada\n  ),\n  curr_on_goli = ifelse(is.na(curr_on_goli),\n    0,\n    curr_on_goli\n  ),\n  curr_on_vedo = ifelse(is.na(curr_on_vedo),\n    0,\n    curr_on_vedo\n  ),\n  curr_on_ust = ifelse(is.na(curr_on_ust),\n    0,\n    curr_on_ust\n  )\n)\n\nfor (i in 1:nrow(drugs)) {\n  if (drugs[i, \"ParticipantNo\"] %in% redcap$participantno) {\n    subject.data &lt;- subset(redcap, participantno == drugs[i, \"ParticipantNo\"])[1, ]\n    if (subject.data$curr_on_mesa == 1) drugs[i, \"ASA\"] &lt;- TRUE\n\n    # Immunosuppressants\n    if (subject.data$curr_on_aza == 1 |\n      subject.data$curr_on_merc == 1 |\n      subject.data$curr_on_metho == 1 |\n      subject.data$curr_on_ciclo == 1) {\n      drugs[i, \"imm\"] &lt;- TRUE\n    }\n\n    # Biologics\n    if (subject.data$curr_on_inflix == 1 |\n      subject.data$curr_on_ada == 1 |\n      subject.data$curr_on_goli == 1 |\n      subject.data$curr_on_vedo == 1 |\n      subject.data$curr_on_ust == 1) {\n      drugs[i, \"bio\"] &lt;- TRUE\n    }\n    if (drugs[i, \"imm\"] & drugs[i, \"bio\"]) {\n      drugs[i, \"category\"] &lt;- 4\n    } else if (drugs[i, \"imm\"]) {\n      drugs[i, \"category\"] &lt;- 2\n    } else if (drugs[i, \"bio\"]) {\n      drugs[i, \"category\"] &lt;- 3\n    } else if (drugs[i, \"ASA\"]) {\n      drugs[i, \"category\"] &lt;- 1\n    }\n  }\n}\n\ndrugs$category &lt;- factor(drugs$category,\n  levels = 1:4,\n  labels = c(\n    \"5-ASA\",\n    \"Mono immunotherapy\",\n    \"Mono biologic\",\n    \"Combo therapy\"\n  )\n)\n\ndrugs &lt;- merge(drugs, demo[, c(\"ParticipantNo\", \"cat\", \"diagnosis2\")], by = \"ParticipantNo\")\ncolnames(drugs)[5] &lt;- \"Treatment\"\n\n\nFor IBD treatment, subjects are categorised as being on either a 5-ASA, mono immunotherapy, mono biologic, or immuno-biologic combination treatment strategy based upon REDCap data provided by participants’ IBD care teams.\nTreatments. in REDCap were selected via check boxes. As such, NA (unticked) is assumed to mean the participant is not on a given medication.\nImmunosuppressants are defined as:\n\nAzathioprine\nMercaptopurine\nMethotrexate\nCiclosporin\n\nBiologics are defined as:\n\nInfliximab\nAdalimumab\nGolimumab\nVedolizumab\nUstekinumab\n\nPatients are only categorised as receiving a 5-ASA treatment plan if 5-ASA is the only IBD treatment they are receiving (I.E no immunotherapy or biologics).\nAs should be expected given poor efficacy in CD, a 5-ASA treatment strategy is much more common for UC/IBDU participants (Figure 5). Mono biologic therapy is the most common treatment strategy for CD subjects.\n\nCodeplt.cols &lt;- c(\"#52528C\", \"#DD6E42\", \"#048A81\", \"#C585B3\")\n\n\ndrugs %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Treatment, fill = Treatment, color = Treatment)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  xlab(\"Treatment strategy\") +\n  ylab(\"Frequency\") +\n  scale_fill_manual(values = plt.cols, na.value = \"#032B43\") +\n  scale_colour_manual(\n    values = colorspace::darken(plt.cols, 0.3),\n    na.value = \"#032B43\"\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 5: Reported treatment strategies for the FC cohort.\n\n\n\n\n\nCodepander(with(subset(drugs, diagnosis2 == \"CD\"), chisq.test(Treatment, cat)))\n\n\nTable 6: Chi-squared test between treatment strategy and FC groups for participants with Crohn’s disease.\n\n\n\nPearson’s Chi-squared test: Treatment and cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.828\n6\n0.4427\n\n\n\n\n\n\n\n\nCodepander(with(subset(drugs, diagnosis2 == \"UC/IBDU\"), chisq.test(Treatment, cat)))\n\n\nTable 7: Chi-squared test between treatment strategy and FC groups for participants with Ulcerative colitis/IBDU.\n\n\n\nPearson’s Chi-squared test: Treatment and cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n9.163\n6\n0.1646\n\n\n\n\n\n\n\nBio-naive status\n\nCodebio.naive &lt;- data.frame(ParticipantNo = redcap$participantno)\nbio.naive &lt;- subset(bio.naive, ParticipantNo %in% demo$ParticipantNo)\nbio.naive &lt;- merge(bio.naive,\n  demo[, c(\"ParticipantNo\", \"diagnosis\")],\n  all.y = TRUE,\n  all.x = FALSE\n)\nbio.naive &lt;- distinct(bio.naive, ParticipantNo, .keep_all = TRUE)\nbio.naive$naive &lt;- \"yes\"\n\nbio.vars &lt;- c(\"inflix\", \"ada\", \"goli\", \"vedo\", \"ust\")\n\nfor (i in 1:nrow(bio.naive)) {\n  temp.df &lt;- as.data.frame(subset(redcap, participantno == bio.naive[i, 1]))\n  temp.df &lt;- temp.df[, paste0(\"curr_on_\", bio.vars)]\n  temp.df &lt;- temp.df[, !is.na(temp.df[1, ])]\n\n  if (any(temp.df == 1)) {\n    bio.naive[i, \"naive\"] &lt;- \"no-using\"\n  } else if (any(temp.df == 2)) {\n    bio.naive[i, \"naive\"] &lt;- \"no-not-using\"\n  } # else naive\n}\n\ndrugs.eof &lt;- read_xlsx(paste0(prefix, \"EOF_drugs.xlsx\"))\nusing &lt;- subset(drugs.eof, AtRecruitmentYN == 1)\nbio.list &lt;- seq(4, 8)\nusing &lt;- subset(using, DrugType %in% bio.list)\nusing &lt;- subset(demo, ParticipantId %in% using$ParticipantId)\nusing &lt;- using[, c(\"ParticipantNo\", \"diagnosis\")]\nusing$naive &lt;- c(\"no-using\")\n\nbio.naive &lt;- rbind(bio.naive, using)\n\nfor (i in unique(bio.naive$ParticipantNo)) {\n  temp &lt;- subset(bio.naive, ParticipantNo == i)\n  # if \"no-using\" in either extract then report using\n  if (nrow(temp) &gt; 1) {\n    if (any(temp$naive == \"no-using\")) {\n      bio.naive &lt;- subset(bio.naive, ParticipantNo != i)\n      bio.naive &lt;- rbind(\n        bio.naive,\n        data.frame(\n          ParticipantNo = i,\n          diagnosis = temp[1, \"diagnosis\"],\n          naive = \"no-using\"\n        )\n      )\n    }\n  }\n}\n\nbio.naive &lt;- distinct(bio.naive, ParticipantNo, .keep_all = TRUE)\n\ndemo &lt;- merge(demo,\n  bio.naive[, c(1, 3)],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo$naive &lt;- factor(demo$naive,\n  levels = c(\"no-using\", \"no-not-using\", \"yes\"),\n  labels = c(\"Current\", \"Previously\", \"Never prescribed\")\n)\n\ncolnames(demo)[colnames(demo) == \"naive\"] &lt;- \"Biologic\"\n\n\nBio-naive status has been determined using REDCap and EoS data. As clinical teams were not explicitly asked if a subject was bio-naive, the subject is instead defined as being bio-naive if there are no recorded biologics for the subject (which may bias subjects with missing data towards incorrectly being reported as bio-naive). Non bio-naive subjects are categorised further into either “currently using” or “previously used”.\nBiologic treatments are defined as infliximab, adalimumab, golimumab, vedolizumab, and ustekinumab.\nSmall molecule treatments are not considered in this report due to their low prescribing rates during the recruitment period (which ended March 2020).\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Biologic, fill = Biologic, color = Biologic)) +\n  geom_bar() +\n  xlab(\"Biologic status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  scale_fill_manual(values = c(\"#CACF85\", \"#8CBA80\", \"#E58F65\")) +\n  scale_color_manual(values = c(\"#747825\", \"#4A6E3F\", \"#934D1B\")) +\n  guides(\n    fill = guide_legend(title = \"Biologic status\"),\n    color = guide_legend(title = \"Biologic status\")\n  ) +\n  facet_grid(rows = vars(diagnosis2))\n\n\n\n\n\n\nFigure 6: Bio-naivety in the FC cohort.\n\n\n\n\nBio-naive status was found to be associated with FC groups which may be due to patients with more active disease being more likely to be prescribed a biologic.\n\nCodepander(chisq.test(demo$Biologic, demo$cat))\n\n\nTable 8: Chi-squared test between bio-naive status and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Biologic and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n16.51\n4\n0.002406 * *",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#variables-only-relevant-to-crohns-disease-subjects",
    "href": "Baseline/IBD.html#variables-only-relevant-to-crohns-disease-subjects",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to Crohn’s disease subjects",
    "text": "Variables only relevant to Crohn’s disease subjects\n\nCodesmoking &lt;- read_xlsx(paste0(data.path, \"Baseline2022/lifestyle.xlsx\")) %&gt;%\n  select(ParticipantNo, Smoke, SmokedInPast)\nsmoking$Smoke &lt;- plyr::mapvalues(smoking$Smoke, from = 2, to = 3)\n\nfor (i in 1:nrow(smoking)) {\n  if ((!is.na(smoking[i, \"SmokedInPast\"]) & smoking[i, \"SmokedInPast\"] == 1) & (!is.na(smoking[i, \"Smoke\"]) & smoking[i, \"Smoke\"] == 3)) {\n    smoking[i, \"Smoke\"] &lt;- 2\n  }\n}\n\nsmoking$Smoke &lt;- factor(smoking$Smoke,\n  levels = seq(1, 3),\n  labels = c(\"Current\", \"Previous\", \"Never\")\n)\n\nsmoking &lt;- smoking[, -3]\n\n\ndemo &lt;- merge(demo,\n  smoking,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\nesmoking &lt;- read_xlsx(paste0(data.path, \"Baseline2022/lifestyle.xlsx\")) %&gt;%\n  select(ParticipantNo, ECigs, ECigsPast)\nesmoking$ECigs &lt;- plyr::mapvalues(esmoking$ECigs, from = 2, to = 3)\n\nfor (i in 1:nrow(esmoking)) {\n  if ((!is.na(esmoking[i, \"ECigsPast\"] == 1) & esmoking[i, \"ECigsPast\"] == 1) & (!is.na(esmoking[i, \"ECigs\"]) & esmoking[i, \"ECigs\"] == 3)) {\n    esmoking[i, \"ECigs\"] &lt;- 2\n  }\n}\n\nesmoking$ECigs &lt;- factor(esmoking$ECigs,\n  levels = seq(1, 3),\n  labels = c(\"Current\", \"Previous\", \"Never\")\n)\n\nesmoking &lt;- esmoking[, -3]\n\n\ndemo &lt;- merge(demo,\n  esmoking,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\n\nThis section looks at data only applicable to subjects with CD. The following variables are considered: surgery, Montreal location, Montreal behaviour, Harvey-Bradshaw index, and smoking.\nSmoking for CD and UC is considered separately as smoking is often reported to worsen outcomes in CD but may be protective in UC.\nSurgery\n\nCodepredicct.surgery &lt;- read_xlsx(paste0(\n  data.path,\n  \"Baseline2022/IBD.xlsx\"\n))[, c(\"ParticipantNo\", \"HadSurgeryForIBD\")]\ncolnames(predicct.surgery)[2] &lt;- \"Surgery\"\n\n\nredcap.surgery &lt;- redcap[, c(\"participantno\", \"surgery\")]\n\n\nnames(redcap.surgery) &lt;- c(\"ParticipantNo\", \"Surgery\")\n\nsurgery &lt;- rbind(redcap.surgery, predicct.surgery)\nsurgery &lt;- subset(surgery, !is.na(surgery$Surgery))\n\n# As REDCap is first, this will be prioritised over subject (if not NA)\nsurgery &lt;- distinct(surgery, ParticipantNo, .keep_all = TRUE)\n\ndemo.cd &lt;- subset(demo, diagnosis2 == \"CD\")\ndemo.cd &lt;- merge(demo.cd, surgery, all.x = TRUE, all.y = FALSE)\ndemo.cd$Surgery &lt;- factor(demo.cd$Surgery,\n  levels = c(1, 2),\n  labels = c(\"Yes\", \"No\")\n)\n\n\nSurgical data has been obtained from both REDCap and patient-completed questionnaires. Where data are available from both data sources, REDCap is the preferred data source.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Surgery, fill = Surgery, color = Surgery)) +\n  geom_bar() +\n  xlab(\"Previous surgery\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#F9B9B7\", \"#96C9DC\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#D06965\", \"#448CA2\"), na.value = \"#032B43\")\n\n\n\n\n\n\nFigure 7: Previous surgery for Crohn’s disease subjects in the FC cohort.\n\n\n\n\nFC at study recruitment is significantly associated with having previously undergone surgery for CD.\n\nCodepander(chisq.test(demo.cd$Surgery, demo.cd$cat))\n\n\nTable 9: Chi-squared test between previous surgery and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$Surgery and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n7.389\n2\n0.02486 *\n\n\n\n\n\n\n\nMontreal location\n\nCodemapping &lt;- data.frame(\n  code = seq(1, 6),\n  definition = c(\n    \"Oesophago-gastric\",\n    \"Duodenal\",\n    \"Jejunal\",\n    \"Ileal\",\n    \"Colonic\",\n    \"Rectal\"\n  )\n)\n\ncd.location &lt;- redcap[, c(\"participantno\", paste0(\"mac_extent___\", 1:6))]\nL4 &lt;- rep(0, nrow(cd.location))\nLocation &lt;- rep(NA, nrow(cd.location))\n\nfor (i in 1:nrow(cd.location)) {\n  # If Oesophago-gastric, Duodenal, Jejunal, then L4 is present\n  if (any(cd.location[i, 2:4] == 1)) L4[i] &lt;- 1\n  if (cd.location[i, 5] == 1 & cd.location[i, 6] == 1) {\n    Location[i] &lt;- 3 # Ileal-colonic\n  } else if (cd.location[i, 5] == 1 & cd.location[i, 6] == 0) {\n    Location[i] &lt;- 1 # Ileal only\n  } else if (cd.location[i, 5] == 0 & cd.location[i, 6] == 1) {\n    Location[i] &lt;- 2 # Colonic only\n  }\n  if (is.na(Location[i]) & L4[i] == 1) {\n    Location[i] &lt;- 4 # L4 Only\n  }\n}\n\nL4[is.na(Location) & L4 == 0] &lt;- NA\n\nmont.df &lt;- data.frame(\n  cd.location[, \"participantno\"],\n  Location,\n  L4\n)\ncolnames(mont.df)[1] &lt;- \"ParticipantNo\"\ndemo.cd &lt;- merge(demo.cd, mont.df,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.cd$Location &lt;- factor(demo.cd$Location,\n  levels = c(1, 2, 3, 4),\n  labels = c(\"L1\", \"L2\", \"L3\", \"L4 only\")\n)\n\ndemo.cd$L4 &lt;- factor(demo.cd$L4,\n  levels = c(0, 1),\n  labels = c(\"Not present\", \"Present\")\n)\n\n\nMontreal location has been obtained from REDcap data. Rather than being asked for Montreal location directly, clinical teams were asked to provide more granular detail by ticking boxes if inflammation was in any of the following areas Oesophago-gastric, Duodenal, Jejunal, Ileal, Colonic, Rectal. If only any of the first 3 were reported then the subject was assigned “L4 only”. L1-L3 were assigned as per convention (Silverberg et al. 2005). If no location was reported then location was assigned NA.\nAs can be seen in Figure 8, L3 is the most common Montreal location in this cohort with roughly an equal amount of subjects having either L1 or L2.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Location, fill = Location, color = Location)) +\n  geom_bar() +\n  xlab(\"Montreal location\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#33CA7F\", \"#96C9DC\", \"#C33C54\", \"#FCB97D\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#318859\", \"#448CA2\", \"#80333E\", \"#BD7700\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Montreal location\"),\n    color = guide_legend(title = \"Montreal location\")\n  )\n\n\n\n\n\n\nFigure 8: Montreal location for CD subjects in the FC cohort.\n\n\n\n\nDue to the low number of subjects with L4-only, Fisher’s exact test has been used to compare with FC.\n\nCodepander(fisher.test(demo.cd$Location, demo.cd$cat, workspace = 20000000))\n\n\nTable 10: Fisher’s exact test between Montreal location and FC groups.\n\n\n\nFisher’s Exact Test for Count Data: demo.cd$Location and demo.cd$cat\n\n\n\n\n\n\nP value\nAlternative hypothesis\n\n\n0.6059\ntwo.sided\n\n\n\n\n\n\n\nIn addition to L4-only being considered, we also investigate L4 as a modifier.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = L4, fill = L4, color = L4)) +\n  geom_bar() +\n  xlab(\"Presence of L4\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#51E5FF\", \"#EC368D\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#079DB1\", \"#AF0863\"), na.value = \"#032B43\") +\n  guides(\n    fill = guide_legend(title = \"Presence of L4\"),\n    color = guide_legend(title = \"Presence of L4\")\n  )\n\n\n\n\n\n\nFigure 9: L4 (upper GI involvement) in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo.cd$L4, demo.cd$cat))\n\n\nTable 11: Chi-squared test between L4 and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$L4 and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.611\n2\n0.06047\n\n\n\n\n\n\n\nMontreal behaviour\n\nCodecd.behaviour &lt;- redcap[, c(\"participantno\", \"behaviour\", \"perianal\")]\ncolnames(cd.behaviour) &lt;- c(\"ParticipantNo\", \"Behaviour\", \"Perianal\")\ncd.behaviour$Perianal[!is.na(cd.behaviour$Perianal) & cd.behaviour$Perianal == 3] &lt;- NA\n\n\ndemo.cd &lt;- merge(demo.cd,\n  cd.behaviour,\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.cd$Behaviour &lt;- factor(demo.cd$Behaviour,\n  levels = c(1, 2, 3),\n  labels = c(\"B1\", \"B2\", \"B3\")\n)\n\n\nMontreal behaviour has been obtained from REDCap data and was recorded conventionally. The majority of CD subjects have the B1 (inflammatory) phenotype.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Behaviour, fill = Behaviour, color = Behaviour)) +\n  geom_bar() +\n  xlab(\"Montreal behaviour\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#7AE7C7\", \"#440381\", \"#D64045\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#07A282\", \"#340165\", \"#942E31\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Montreal behaviour\"),\n    color = guide_legend(title = \"Montreal behaviour\")\n  )\n\n\n\n\n\n\nFigure 10: Montreal behaviour for CD subjects in the FC cohort.\n\n\n\n\nMontreal behaviour is not significantly associated with FC at recruitment.\n\nCodepander(chisq.test(demo.cd$Behaviour, demo.cd$cat))\n\n\nTable 12: Chi-squared test between Montreal behaviour and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$Behaviour and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.136\n4\n0.2736\n\n\n\n\n\n\n\nApproximately a third of CD subjects are reported to have perianal disease.\n\nCodedemo.cd$Perianal &lt;- factor(demo.cd$Perianal,\n  levels = c(1, 2),\n  labels = c(\"Yes\", \"No\")\n)\n\ndemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Perianal, fill = Perianal, color = Perianal)) +\n  geom_bar() +\n  xlab(\"Perianal disease\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#023C40\", \"#AF5B5B\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#002C30\", \"#754242\"), na.value = \"#032B43\") +\n  guides(\n    fill = guide_legend(title = \"Perianal disease\"),\n    color = guide_legend(title = \"Perianal disease\")\n  )\n\n\n\n\n\n\nFigure 11: Perianal disease for CD subjects in the FC cohort.\n\n\n\n\nPerianal disease is not associated with FC at recruitment.\n\nCodepander(chisq.test(demo.cd$Perianal, demo.cd$cat))\n\n\nTable 13: Chi-squared test between between perianal disease and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.cd$Perianal and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.305\n2\n0.5207\n\n\n\n\n\n\n\nHarvey-Bradshaw Index\n\nCodeHBI.df &lt;- redcap[, c(\"participantid\", \"current_hb\")]\ncolnames(HBI.df) &lt;- c(\"ParticipantId\", \"HBI\")\nHBI.df &lt;- subset(HBI.df, ParticipantId %in% demo.cd$ParticipantId)\n\ndemo.cd &lt;- merge(demo.cd, HBI.df, by = \"ParticipantId\", all.x = TRUE)\n\ntemp &lt;- demo.cd %&gt;%\n  drop_na(cat)\npercHBI &lt;- round(sum(is.na(temp$HBI)) / nrow(temp), 2) * 100\n\n\nWhilst HBI was collected via REDCap, substantial missingness is observed with 60% of CD subjects in the FC sub-cohort missing HBI.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = as.factor(HBI))) +\n  geom_bar(fill = \"#A167A5\", color = \"#4A306D\") +\n  theme_minimal() +\n  ylab(\"Frequency\") +\n  xlab(\"Harvey-Bradshaw index at time of recruitment\")\n\n\n\n\n\n\nFigure 12: Harvey-Bradshaw index for CD subjects in the FC cohort.\n\n\n\n\n\nCodepander(summary(aov(HBI ~ cat, data = demo.cd)))\n\n\nTable 14: ANOVA between between Harvey-Bradshaw index and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n13.1\n6.548\n1.174\n0.3102\n\n\nResiduals\n441\n2461\n5.579\nNA\nNA\n\n\n\n\n\n\n\n\nPRO-2 in Crohn’s disease\nSum of liquid stools per day and abdominal pain.\n\nCodePRO2 &lt;- redcap[, c(\"participantno\", \"liq_stool_day\", \"abdo_pain\")]\nPRO2$liq_stool_day &lt;- as.numeric(PRO2$liq_stool_day) # Drop ileostomies\n\nPRO2$PRO2 &lt;- with(PRO2, liq_stool_day + abdo_pain)\n\nPRO2$ParticipantNo &lt;- PRO2$participantno\ndemo.cd &lt;- merge(demo.cd,\n  PRO2[, c(\"ParticipantNo\", \"PRO2\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.cd %&gt;%\n  ggplot(aes(x = as.factor(PRO2))) +\n  geom_bar(fill = \"#FF8552\", color = \"#D2632A\") +\n  scale_fill_manual(na.value = \"#032B43\") +\n  scale_color_manual(na.value = \"#032B43\") +\n  theme_minimal()\n\n\n\n\n\n\n\nSmoking\n\nCodepercPrev &lt;- round(sum(temp$Smoke == \"Previous\", na.rm = TRUE) / nrow(temp), 2) * 100\n\n\nWe consider smoking for CD and UC separately as smoking is often reported to worsen outcomes in CD but is possibly protective in UC. Smoking status is self-reported by study participants.\nWhilst most subjects have never been a smoker, a substantial proportion of subjects (27%) have previously been smokers.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Smoke, fill = Smoke, color = Smoke)) +\n  geom_bar() +\n  xlab(\"Smoking status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Smoking status\"),\n    color = guide_legend(title = \"Smoking status\")\n  )\n\n\n\n\n\n\nFigure 13: Smoking status for CD subjects in the FC cohort.\n\n\n\n\nSmoking status is associated with FC at recruitment for CD subjects.\n\nCodepander(chisq.test(demo.cd$Smoke, demo.cd$cat))\n\n\nTable 15: Chi-squared test between between smoking status and FC groups for CD subjects.\n\n\n\nPearson’s Chi-squared test: demo.cd$Smoke and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n11.08\n4\n0.02572 *\n\n\n\n\n\n\n\nE-cigarette use\nThe vast majority of participants do not report using some form of e-cigarettes. It should be noted that as recruitment ended March 2020, these day may not reflect more modern trends.\n\nCodedemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = ECigs, fill = ECigs, color = ECigs)) +\n  geom_bar() +\n  xlab(\"E-cigarette status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"E-cigarette status\"),\n    color = guide_legend(title = \"E-cigarette status\")\n  )\n\n\n\n\n\n\nFigure 14: E-cigarette usage for CD subjects in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo.cd$ECigs, demo.cd$cat))\n\n\nTable 16: Chi-squared test between between E-cigarettte usage and FC groups for CD subjects.\n\n\n\nPearson’s Chi-squared test: demo.cd$ECigs and demo.cd$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n5.96\n4\n0.2022",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#variables-only-relevant-to-ulcerative-colitisibdu-subjects",
    "href": "Baseline/IBD.html#variables-only-relevant-to-ulcerative-colitisibdu-subjects",
    "title": "Inflammatory bowel disease",
    "section": "Variables only relevant to ulcerative colitis/IBDU subjects",
    "text": "Variables only relevant to ulcerative colitis/IBDU subjects\nThis section looks at variables only relevant to UC/IBDU subjects: Montreal extent, Mayo score, Smoking status and E-cigarette use.\nAs PREdiCCt required subjects to be able to flare, this effectively excluded UC subjects who had undergone a proctocolectomy. As such, previous surgery is not considered. Montreal severity was not collected by PREdiCCt.\nMontreal extent\n\nCodemapping &lt;- data.frame(\n  code = seq(1, 6),\n  definition = c(\n    \"Rectum\",\n    \"Recto-sigmoid\",\n    \"&lt; Splenic\",\n    \"&lt; Hepatic\",\n    \"Total\",\n    \"Unknown\"\n  ),\n  mont = c(1, 2, 2, 3, 3, NA)\n)\n\ndemo.uc &lt;- subset(demo, diagnosis2 == \"UC/IBDU\")\nredcap.uc &lt;- subset(redcap, participantno %in% demo.uc$ParticipantNo)\nnames(redcap.uc)[names(redcap.uc) == \"participantno\"] &lt;- \"ParticipantNo\"\nredcap.uc &lt;- redcap.uc[, c(\"ParticipantNo\", \"max_extent\")]\nredcap.uc$Extent &lt;- mapvalues(redcap.uc$max_extent,\n  from = mapping$code,\n  to = mapping$mont\n)\n\ndemo.uc &lt;- merge(demo.uc,\n  redcap.uc[, c(\"ParticipantNo\", \"Extent\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\ndemo.uc$Extent &lt;- factor(demo.uc$Extent,\n  levels = seq(1, 3),\n  labels = c(\"E1\", \"E2\", \"E3\")\n)\n\n\nMontreal extent has been obtained from REDCap. Similar to Montreal location, the extent of inflammation has been reported in more granular detail than is required for the Montreal classification. The below table shows how these definitions have been mapped to Montreal extent.\n\nCodekable(mapping,\n  col.names = c(\"Coding\", \"Definition\", \"Montreal extent\"),\n  align = c(\"l\", \"c\", \"c\")\n)\n\n\n\nCoding\nDefinition\nMontreal extent\n\n\n\n1\nRectum\n1\n\n\n2\nRecto-sigmoid\n2\n\n\n3\n&lt; Splenic\n2\n\n\n4\n&lt; Hepatic\n3\n\n\n5\nTotal\n3\n\n\n6\nUnknown\nNA\n\n\n\n\n\nAs can be seen in Figure 15 E2 is the most common Montreal extent classification.\n\nCodedemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Extent, fill = Extent, color = Extent)) +\n  geom_bar() +\n  xlab(\"Montreal extent\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#7AE7C7\", \"#440381\", \"#D64045\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#07A282\", \"#340165\", \"#942E31\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Montreal extent\"),\n    color = guide_legend(title = \"Montreal extent\")\n  )\n\n\n\n\n\n\nFigure 15: Montreal extent for UC/IBDU subjects in the FC cohort.\n\n\n\n\nMontreal extent is not associated with FC\n\nCodepander(chisq.test(demo.uc$Extent, demo.uc$cat))\n\n\nTable 17: Chi-squared test between Montreal extent and FC groups.\n\n\n\nPearson’s Chi-squared test: demo.uc$Extent and demo.uc$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.281\n4\n0.6842\n\n\n\n\n\n\n\nMayo score\nMayo score was collected via REDCap and is more complete than HBI.\n\nCodemayo.df &lt;- redcap[, c(\"participantid\", \"current_mayo\")]\ncolnames(mayo.df) &lt;- c(\"ParticipantId\", \"Mayo\")\nmayo.df &lt;- subset(mayo.df, ParticipantId %in% demo.uc$ParticipantId)\n\ndemo.uc &lt;- merge(demo.uc, mayo.df, by = \"ParticipantId\", all.x = TRUE)\ndemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = as.factor(Mayo))) +\n  geom_bar(fill = \"#284B63\", color = \"#153243\") +\n  theme_minimal() +\n  ylab(\"Frequency\") +\n  xlab(\"Mayo score at time of recruitment\")\n\n\n\n\n\n\nFigure 16\n\n\n\n\nMayo score is highly significantly associated with FC.\n\nCodepander(summary(aov(Mayo ~ cat, data = demo.uc)))\n\n\nTable 18: ANOVA between between Mayo score and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n25.2\n12.6\n8.212\n0.0002973\n\n\nResiduals\n732\n1123\n1.534\nNA\nNA\n\n\n\n\n\n\n\n\nPRO-2 in ulcerative colitis\nSum of stool frequency and rectal bleeding categories.\n\nCodePRO2 &lt;- redcap[, c(\"participantno\", \"stool_freq\", \"rectal_bleed\")]\n\nPRO2$PRO2 &lt;- with(PRO2, stool_freq + rectal_bleed)\n\nPRO2$ParticipantNo &lt;- PRO2$participantno\ndemo.uc &lt;- merge(demo.uc,\n  PRO2[, c(\"ParticipantNo\", \"PRO2\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo.uc %&gt;%\n  ggplot(aes(x = as.factor(PRO2), fill = diagnosis2, color = diagnosis2)) +\n  geom_bar() +\n  scale_fill_manual(values = \"#FF8552\", na.value = \"#032B43\") +\n  scale_color_manual(values = \"#D2632A\", na.value = \"#032B43\") +\n  theme_minimal() +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\nSmoking\nAs with CD subjects, smoking status for UC/IBDU subjects is self-reported.\n\nCodedemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Smoke, fill = Smoke, color = Smoke)) +\n  geom_bar() +\n  xlab(\"Smoking status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"Smoking status\"),\n    color = guide_legend(title = \"Smoking status\")\n  )\n\n\n\n\n\n\nFigure 17: Smoking status for UC/IBDU subjects in the FC cohort.\n\n\n\n\nAs with CD, smoking status is significantly associated with FC.\n\nCodepander(chisq.test(demo.uc$Smoke, demo.uc$cat))\n\n\nTable 19: Chi-squared test between between smoking status and FC groups for UC subjects.\n\n\n\nPearson’s Chi-squared test: demo.uc$Smoke and demo.uc$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n9.781\n4\n0.04427 *\n\n\n\n\n\n\n\nE-cigarette use\nSimilar to CD, very few subjects reported using E-cigarettes.\n\nCodedemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = ECigs, fill = ECigs, color = ECigs)) +\n  geom_bar() +\n  xlab(\"E-cigarette status\") +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(\n    values = c(\"#4E0250\", \"#517664\", \"#1C448E\"),\n    na.value = \"#032B43\"\n  ) +\n  scale_color_manual(\n    values = c(\"#3D003F\", \"#385245\", \"#033070\"),\n    na.value = \"#032B43\"\n  ) +\n  guides(\n    fill = guide_legend(title = \"E-cigarette status\"),\n    color = guide_legend(title = \"E-cigarette status\")\n  )\n\n\n\n\n\n\nFigure 18: E-cigarette usage for UC subjects in the FC cohort.\n\n\n\n\nE-cigarette use was found to significantly differ between FC groups in UC. However, the low number of subjects reported to use E-cigarettes (Figure 18) should be beared in mind when interpretting this finding.\n\nCodepander(fisher.test(demo.uc$ECigs, demo.uc$cat))\n\n\nTable 20: Chi-squared test between between E-cigarettte usage and FC groups for UC subjects.\n\n\n\nFisher’s Exact Test for Count Data: demo.uc$ECigs and demo.uc$cat\n\n\n\n\n\n\nP value\nAlternative hypothesis\n\n\n0.0196 *\ntwo.sided\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-IBD.RDS\"))\nsaveRDS(demo.cd, paste0(outdir, \"demo-cd.RDS\"))\nsaveRDS(demo.uc, paste0(outdir, \"demo-uc.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/IBD.html#reproducibility-reproduction",
    "href": "Baseline/IBD.html#reproducibility-reproduction",
    "title": "Inflammatory bowel disease",
    "section": "Reproducibility & reproduction",
    "text": "Reproducibility & reproduction\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): viridis(v.0.6.5), utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), gridExtra(v.2.3), fansi(v.1.0.6), viridisLite(v.0.4.2), scales(v.1.3.0), textshaping(v.0.4.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), ragg(v.1.3.2), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), systemfonts(v.1.1.0), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Inflammatory bowel disease"
    ]
  },
  {
    "objectID": "Baseline/Recruitment.html",
    "href": "Baseline/Recruitment.html",
    "title": "Study recruitment",
    "section": "",
    "text": "Codeset.seed(123)\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed\"\n  metadir &lt;- \"data/metadata/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n  metadir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/metadata/\"\n}\n\n# Demographic data as reported by subjects\ndemo &lt;- read_xlsx(paste0(data.path, \"Baseline2022/demographics.xlsx\"),\n  col_types = c(\n    \"text\",\n    \"text\",\n    \"text\",\n    \"text\",\n    \"numeric\",\n    \"numeric\",\n    \"text\",\n    \"text\",\n    \"date\",\n    \"numeric\",\n    \"text\"\n  )\n)",
    "crumbs": [
      "Study recruitment"
    ]
  },
  {
    "objectID": "Baseline/Recruitment.html#reproduction-and-reproducibility",
    "href": "Baseline/Recruitment.html#reproduction-and-reproducibility",
    "title": "Study recruitment",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1) and tidyverse(v.2.0.0)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), plyr(v.1.8.9), cellranger(v.1.1.0), jsonlite(v.1.8.8), pander(v.0.6.5), fansi(v.1.0.6), viridisLite(v.0.4.2), scales(v.1.3.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), xfun(v.0.44), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), knitr(v.1.47), farver(v.2.1.2), htmltools(v.0.5.8.1), rmarkdown(v.2.27), labeling(v.0.4.3) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Study recruitment"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About",
    "section": "",
    "text": "To-do\nThis work uses data provided by patients and collected by the NHS as part of their care and support. We are grateful to participants and their IBD care teams for their support.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "About",
    "section": "",
    "text": "To-do\nThis work uses data provided by patients and collected by the NHS as part of their care and support. We are grateful to participants and their IBD care teams for their support.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#using-this-website",
    "href": "index.html#using-this-website",
    "title": "About",
    "section": "Using this website",
    "text": "Using this website\nThe code button at the top of each page can be used to show all code blocks instead of clicking on the code buttons for each individual block of code. Moving the mouse pointer over any citations in a report will produce a pop up box with reference details. Clicking on the citation will link to the bibliography at the bottom of the page.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#software-versions",
    "href": "index.html#software-versions",
    "title": "About",
    "section": "Software versions",
    "text": "Software versions\nAll analyses have been generated using R version 4.4.0. Please see the Session Information sections at the bottom of each report to see the R packages used for that particular analysis and the respective package versions.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "index.html#section",
    "href": "index.html#section",
    "title": "About",
    "section": "",
    "text": "This website has been generated using the Quarto scientific publishing system built on pandoc.",
    "crumbs": [
      "About"
    ]
  },
  {
    "objectID": "Baseline/Introduction.html",
    "href": "Baseline/Introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "This section of the website explores the baseline data for the PREdiCCt study, generating inferences and producing display items for publication.\nFor all baseline reports, only the faecal calprotecin cohort, the sub-cohort defined as subjects with baseline faecal calprotecin available, are described (unless otherwise stated). For each variable considered, associations with faecal calprotectin categories (&lt;50, 50–250, &gt;250) are presented using chi-squared tests and ANOVA for categorical and continuous data respectively.\nThere are three main data sources for baseline demographic and phenotypic data in PREdiCCt:\n\nParticipant questionnaires.\nForms completed by a subject’s clinical team (via REDCap) during recruitment.\nData collected retrospectively during the end-of-study (EoS) phenotyping which was completed by a member of the subject’s IBD care team.\n\nAs all three are used, it will be made clear which source the data presented originate from.",
    "crumbs": [
      "Baseline Analyses",
      "Introduction"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html",
    "href": "Baseline/Demographics.html",
    "title": "Cohort demographics",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- read_xlsx(paste0(data.path, \"Baseline2022/demographics.xlsx\"),\n  col_types = c(\n    \"text\",\n    \"text\",\n    \"text\",\n    \"text\",\n    \"numeric\",\n    \"numeric\",\n    \"text\",\n    \"text\",\n    \"date\",\n    \"numeric\",\n    \"text\"\n  )\n)\n\nfcal &lt;- read_xlsx(paste0(data.path, \"Baseline2022/calprotectin.xlsx\"))\nfcal$Result &lt;- as.numeric(plyr::mapvalues(fcal$Result, from = \"&lt;20\", to = 20))\n\nfcal &lt;- fcal[, c(\"ParticipantNo\", \"Result\")]\n\nfcal.eof &lt;- read_xlsx(paste0(prefix, \"EOF_fcal.xlsx\"))\n\nfcal.eof &lt;- subset(fcal.eof, IsBaseline == 1)\nfcal.eof &lt;- subset(fcal.eof, FCALLevel != \".\")\nfcal.eof$FCALLevel &lt;- as.numeric(fcal.eof$FCALLevel)\nfcal.eof &lt;- fcal.eof[, c(\"ParticipantNo\", \"FCALLevel\")]\nnames(fcal.eof)[2] &lt;- \"Result\"\n\nfcal &lt;- rbind(fcal, fcal.eof)\nfcal &lt;- distinct(fcal, ParticipantNo, .keep_all = TRUE)\n\nfcal$cat &lt;- 0\nfor (i in 1:nrow(fcal)) {\n  if (fcal[i, \"Result\"] &lt; 50) fcal[i, \"cat\"] &lt;- 1\n  if ((fcal[i, \"Result\"] &gt;= 50) & (fcal[i, \"Result\"] &lt;= 250)) fcal[i, \"cat\"] &lt;- 2\n  if (fcal[i, \"Result\"] &gt; 250) fcal[i, \"cat\"] &lt;- 3\n}\n\n\ndemo &lt;- merge(demo, fcal[, c(\"ParticipantNo\", \"Result\", \"cat\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo$cat &lt;- factor(demo$cat,\n  levels = c(1, 2, 3),\n  labels = c(\"FC &lt; 50\", \"FC 50-250\", \"FC &gt; 250\")\n)\n\nnames(demo)[12] &lt;- \"FC\" # Result ~&gt; FC\n\n\nThis page describes key demographic data collected by the PREdiCCt study.",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#introduction",
    "href": "Baseline/Demographics.html#introduction",
    "title": "Cohort demographics",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- read_xlsx(paste0(data.path, \"Baseline2022/demographics.xlsx\"),\n  col_types = c(\n    \"text\",\n    \"text\",\n    \"text\",\n    \"text\",\n    \"numeric\",\n    \"numeric\",\n    \"text\",\n    \"text\",\n    \"date\",\n    \"numeric\",\n    \"text\"\n  )\n)\n\nfcal &lt;- read_xlsx(paste0(data.path, \"Baseline2022/calprotectin.xlsx\"))\nfcal$Result &lt;- as.numeric(plyr::mapvalues(fcal$Result, from = \"&lt;20\", to = 20))\n\nfcal &lt;- fcal[, c(\"ParticipantNo\", \"Result\")]\n\nfcal.eof &lt;- read_xlsx(paste0(prefix, \"EOF_fcal.xlsx\"))\n\nfcal.eof &lt;- subset(fcal.eof, IsBaseline == 1)\nfcal.eof &lt;- subset(fcal.eof, FCALLevel != \".\")\nfcal.eof$FCALLevel &lt;- as.numeric(fcal.eof$FCALLevel)\nfcal.eof &lt;- fcal.eof[, c(\"ParticipantNo\", \"FCALLevel\")]\nnames(fcal.eof)[2] &lt;- \"Result\"\n\nfcal &lt;- rbind(fcal, fcal.eof)\nfcal &lt;- distinct(fcal, ParticipantNo, .keep_all = TRUE)\n\nfcal$cat &lt;- 0\nfor (i in 1:nrow(fcal)) {\n  if (fcal[i, \"Result\"] &lt; 50) fcal[i, \"cat\"] &lt;- 1\n  if ((fcal[i, \"Result\"] &gt;= 50) & (fcal[i, \"Result\"] &lt;= 250)) fcal[i, \"cat\"] &lt;- 2\n  if (fcal[i, \"Result\"] &gt; 250) fcal[i, \"cat\"] &lt;- 3\n}\n\n\ndemo &lt;- merge(demo, fcal[, c(\"ParticipantNo\", \"Result\", \"cat\")],\n  by = \"ParticipantNo\",\n  all.x = TRUE,\n  all.y = FALSE\n)\n\ndemo$cat &lt;- factor(demo$cat,\n  levels = c(1, 2, 3),\n  labels = c(\"FC &lt; 50\", \"FC 50-250\", \"FC &gt; 250\")\n)\n\nnames(demo)[12] &lt;- \"FC\" # Result ~&gt; FC\n\n\nThis page describes key demographic data collected by the PREdiCCt study.",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#age",
    "href": "Baseline/Demographics.html#age",
    "title": "Cohort demographics",
    "section": "Age",
    "text": "Age\nThe distribution of age for the study cohort is approximately normally distributed.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = age)) +\n  geom_histogram(bins = 30, fill = \"#64c7ce\", color = \"#3B9EA4\") +\n  geom_density() +\n  theme_minimal() +\n  xlab(\"Age (years)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 1: Distribution of age in the FC cohort.\n\n\n\n\nAge is significantly associated with faecal calprotectin.\n\nCodepander(summary(aov(age ~ cat, data = demo)))\n\n\nTable 1: ANOVA between age and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n2739\n1370\n5.661\n0.003531\n\n\nResiduals\n2141\n518041\n242\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#sex",
    "href": "Baseline/Demographics.html#sex",
    "title": "Cohort demographics",
    "section": "Sex",
    "text": "Sex\nSex was self-reported via subject questionnaires. As can be seen in Figure 2, the PREdiCCt cohort is female by majority.\n\nCodedemo$Sex &lt;- factor(demo$Sex, levels = c(\"1\", \"2\"), labels = c(\"Male\", \"Female\"))\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Sex, fill = Sex, color = Sex)) +\n  geom_bar() +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#FCA17D\", \"#60D394\")) +\n  scale_color_manual(values = c(\"#B22A21\", \"#034C3C\"))\n\n\n\n\n\n\nFigure 2: Distribution of sex in the FC cohort.\n\n\n\n\nMoreover, the distribution of sex is significantly different between FCAL groups.\n\nCodepander(chisq.test(demo$Sex, demo$cat))\n\n\nTable 2: Chi-squared test between Sex and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Sex and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n14.2\n2\n0.0008269 * * *",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#bmi",
    "href": "Baseline/Demographics.html#bmi",
    "title": "Cohort demographics",
    "section": "BMI",
    "text": "BMI\nBody mass index is given by weight (in Kg) divided by height (in M) squared.\nAs thresholds differ in the paediatric population, and are dependent on both age and sex, BMI has not been calculated for those less than 18 years of age. BMI is first considered as a continuous variable.\n\nCodedemo$BMI &lt;- with(demo, Weight / ((Height / 100)^2))\ndemo[demo[, \"age\"] &lt; 18, \"BMI\"] &lt;- NA\np &lt;- demo %&gt;%\n  ggplot(aes(x = BMI)) +\n  geom_histogram(color = \"#AD013B\", fill = \"#F0386B\", bins = 30) +\n  theme_minimal() +\n  ylab(\"Frequency\")\n\nggsave(\"plots/BMI-full-cohort.png\",\n  p,\n  width = 9,\n  height = 6\n)\nggsave(\"plots/BMI-full-cohort.pdf\", p, width = 9, height = 6)\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = BMI)) +\n  geom_histogram(color = \"#AD013B\", fill = \"#F0386B\", bins = 30) +\n  theme_minimal() +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 3: Distribution of BMI in the FC cohort.\n\n\n\n\nBMI as a continuous variable is not associated with FC groups.\n\nCodepander(summary(aov(BMI ~ cat, data = demo)))\n\n\nTable 3: Fisher’s exact test between BMI and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n134.9\n67.45\n2.387\n0.09219\n\n\nResiduals\n2057\n58135\n28.26\nNA\nNA\n\n\n\n\n\n\n\n\nWe also consider BMI grouped into underweight, normal, overweight, and obese categories using the definitions used by the NIH and WHO (Weir and Jan 2024).\nA cut-off of 30 KgM^{-2} is used to denote obesity in adults without Asian/South Asian backgrounds. As data on Asian and South Asian ethnicity is not available (See Ethnicity), we are unable to adjust the threshold based on ethnicity. However, this is expected to be relevant to relatively few subjects.\n\nCodedemo$BMIcat &lt;- cut(demo$BMI,\n  c(0, 18.5, 25, 30, Inf),\n  include.lowest = TRUE,\n  right = FALSE,\n  labels = c(\"Underweight\", \"Normal\", \"Overweight\", \"Obese\")\n)\ndemo[demo[, \"age\"] &lt; 18, \"BMIcat\"] &lt;- NA\n\nplt.cols &lt;- c(\"#F6AE2D\", \"#C81D25\", \"#1481BA\", \"#7E1F86\")\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = BMIcat, color = BMIcat, fill = BMIcat)) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  scale_fill_manual(values = plt.cols, na.value = \"#032B43\") +\n  scale_color_manual(\n    values = colorspace::darken(plt.cols, 0.2),\n    na.value = \"#032B43\"\n  ) +\n  xlab(\"BMI category\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 4: Distribution of BMI categories in the FC cohort.\n\n\n\n\nBMI by category is not associated with FC groups.\n\nCodepander(chisq.test(demo$BMIcat, demo$cat))\n\n\nTable 4: Chi-squared test between BMI categories and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$BMIcat and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n7.169\n6\n0.3055",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#ethnicity",
    "href": "Baseline/Demographics.html#ethnicity",
    "title": "Cohort demographics",
    "section": "Ethnicity",
    "text": "Ethnicity\nDue to low counts for non-white ethnicities, we are only able to report frequencies of white and non-white ethnicities.\n\nCodedemo$ethnic_gp &lt;- factor(demo$ethnic_gp,\n  levels = c(\"1\", \"2\"),\n  labels = c(\"White\", \"Non-white\")\n)\ncolnames(demo)[10:11] &lt;- c(\"Age\", \"Ethnicity\")\n\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Ethnicity, fill = Ethnicity, color = Ethnicity)) +\n  geom_bar() +\n  ylab(\"Frequency\") +\n  theme_minimal() +\n  scale_fill_manual(values = c(\"#F24236\", \"#2E86AB\"), na.value = \"#032B43\") +\n  scale_color_manual(values = c(\"#C0362C\", \"#1E556C\"), na.value = \"#032B43\")\n\n\n\n\n\n\nFigure 5: Distribution of ethnicity in the FC cohort.\n\n\n\n\n\nCodepander(chisq.test(demo$Ethnicity, demo$cat))\n\n\nTable 5: Chi-squared test between ethnicity and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$Ethnicity and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.416\n2\n0.2989",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#index-of-multiple-deprivation",
    "href": "Baseline/Demographics.html#index-of-multiple-deprivation",
    "title": "Cohort demographics",
    "section": "Index of multiple deprivation",
    "text": "Index of multiple deprivation\nThe PREdiCCt SAP states the primary analyses will be controlled for by index of multiple deprivation (IMD). It should be noted that the PREdiCCt study recruited across the UK and there is no consistent measure of IMD across the whole of the UK. Instead, IMD measures are handled slightly differently by each constituent nation.\n\nCodeIMD &lt;- read_xlsx(paste0(redcap.path, \"/IMD.xlsx\"))\n\n\nIMD &lt;- as.data.frame(IMD)\nnames(IMD)[2] &lt;- \"IMD\"\ndemo &lt;- merge(demo, IMD, by = \"ParticipantNo\", all.x = TRUE, all.y = FALSE)\ndemo$IMD &lt;- as.factor(demo$IMD)\n\ncols &lt;- c(\"#A8F9FF\", \"#EF8275\", \"#6D326D\", \"#0B6E4F\", \"#F4D35E\")\n\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = IMD, color = as.factor(IMD), fill = as.factor(IMD))) +\n  geom_bar() +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  ylab(\"Frequency\") +\n  xlab(\"IMD (most deprived to least deprived)\") +\n  scale_fill_manual(values = cols) +\n  scale_color_manual(values = colorspace::darken(cols, amount = 0.3))\n\n\n\n\n\n\nFigure 6: Distribution of IMD.\n\n\n\n\n\nCodepander(chisq.test(demo$IMD, demo$cat))\n\n\nTable 6: CHI-squared test between IMD and FC groups.\n\n\n\nPearson’s Chi-squared test: demo$IMD and demo$cat\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n8.464\n8\n0.3895\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-demographics.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Demographics.html#reproduction-and-reproducibility",
    "href": "Baseline/Demographics.html#reproduction-and-reproducibility",
    "title": "Cohort demographics",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), textshaping(v.0.4.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), ragg(v.1.3.2), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), systemfonts(v.1.1.0), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Cohort demographics"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html",
    "href": "Baseline/Biochemistry.html",
    "title": "Biochemistry data",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-IBD.RDS\"))\n\nlabs &lt;- as.data.frame(read_xlsx(paste0(\n  data.path,\n  \"Baseline2022/bloodtestresults.xlsx\"\n)))\n\nlabs &lt;- labs %&gt;%\n  distinct(ParticipantNo, .keep_all = TRUE)\n\n\nlabs &lt;- labs[, c(\n  \"ParticipantNo\",\n  \"CReactiveProtein\",\n  \"Haemoglobin\",\n  \"HaemoglobinUnit\",\n  \"WCC\",\n  \"WCCUnit\",\n  \"Albumin\",\n  \"AlbuminUnit\"\n)]\ndemo &lt;- merge(demo, labs, by = \"ParticipantNo\", all.x = TRUE, all.y = FALSE)\n\n\nParticipants’ IBD care teams reported biochemistry results via REDCap. Whilst data from many types of blood tests were collected, only the most relevant tests are presented here. Where possible, reference levels have been denoted on plots via vertical lines.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#introduction",
    "href": "Baseline/Biochemistry.html#introduction",
    "title": "Biochemistry data",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-IBD.RDS\"))\n\nlabs &lt;- as.data.frame(read_xlsx(paste0(\n  data.path,\n  \"Baseline2022/bloodtestresults.xlsx\"\n)))\n\nlabs &lt;- labs %&gt;%\n  distinct(ParticipantNo, .keep_all = TRUE)\n\n\nlabs &lt;- labs[, c(\n  \"ParticipantNo\",\n  \"CReactiveProtein\",\n  \"Haemoglobin\",\n  \"HaemoglobinUnit\",\n  \"WCC\",\n  \"WCCUnit\",\n  \"Albumin\",\n  \"AlbuminUnit\"\n)]\ndemo &lt;- merge(demo, labs, by = \"ParticipantNo\", all.x = TRUE, all.y = FALSE)\n\n\nParticipants’ IBD care teams reported biochemistry results via REDCap. Whilst data from many types of blood tests were collected, only the most relevant tests are presented here. Where possible, reference levels have been denoted on plots via vertical lines.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#c-reactive-protein",
    "href": "Baseline/Biochemistry.html#c-reactive-protein",
    "title": "Biochemistry data",
    "section": "C-reactive protein",
    "text": "C-reactive protein\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(CReactiveProtein) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nAlongside FC, CRP is the most requested laboratory test for monitoring IBD disease activity. Unlike FC which acts as a proxy for gastrointestinal inflammation, CRP provides an indication of inflammation across the body. The reference level for CRP is considered to be &lt; 5 mg/L.\nCRP was generally well-completed with 76.4% of subjects having an associated CRP. As can be seen in Figure 1, there were some extreme, albeit physiologically plausible, values reported.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = CReactiveProtein)) +\n  geom_histogram(bins = 100, fill = \"#EB9486\", color = \"#BF7163\") +\n  theme_minimal() +\n  xlab(\"CRP (mg/L)\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 1: Distribution of CRP at recruitment for the FC cohort.\n\n\n\n\nAs should be expected, CRP was found to be associated with FC.\n\nCodepander(summary(aov(CReactiveProtein ~ cat, data = demo)))\n\n\nTable 1: ANOVA between CRP and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1949\n974.4\n7.98\n0.0003556\n\n\nResiduals\n1635\n199628\n122.1\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#haemoglobin",
    "href": "Baseline/Biochemistry.html#haemoglobin",
    "title": "Biochemistry data",
    "section": "Haemoglobin",
    "text": "Haemoglobin\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(Haemoglobin) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nHaemoglobin is a protein which facilitates the transport of oxygen in red blood cells. Haemoglobin has been reported for 83.07% of subjects in the FC cohort. Haemoglobin differs between sex and accordingly has sex-specific reference levels (130-170 g/L for men and 120-150g/L for women).\nWhilst a normal distribution for haemoglobin is observed overall (Figure 2), there appears to be some observations substantially lower than one would expect for this distribution. Investigating these observations suggests that these observations are likely to be in units of g/dL instead of the common g/L units (Table 2).\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Haemoglobin)) +\n  geom_histogram(bins = 100, fill = \"#76E5FC\", color = \"#2EB6CD\") +\n  theme_minimal() +\n  xlab(\"Haemoglobin\") +\n  ylab(\"Frequency\")\n\n\n\n\n\n\nFigure 2: Distribution of haemoglobin before processing.\n\n\n\n\n\nCodeknitr::kable(table(subset(demo, Haemoglobin &lt; 50)$HaemoglobinUnit),\n  col.names = c(\"Units\", \"Frequency\")\n)\n\n\nTable 2: Reported unit measurements for Haemoglobin reported less than 50.\n\n\n\n\nUnits\nFrequency\n\n\n\ng/dL\n6\n\n\ng/l\n1\n\n\ng/L\n5\n\n\nmmol/mol\n1\n\n\n\n\n\n\n\n\nHaving assumed any Haemoglobin &lt; 50 has been reported in g/dL, any Haemoglobin observations &lt;50 have been multiplied by 10 to be in g/L units. This results in the distribution seen in Figure 3.\n\nCodedemo &lt;- demo %&gt;%\n  mutate(Haemoglobin = if_else(Haemoglobin &lt; 50,\n    Haemoglobin * 10,\n    Haemoglobin\n  )) %&gt;%\n  select(-HaemoglobinUnit)\n\np1 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  filter(Sex == \"Female\") %&gt;%\n  ggplot(aes(x = Haemoglobin)) +\n  geom_histogram(bins = 100, fill = \"#8789C0\", color = \"#6A6B9C\") +\n  theme_minimal() +\n  xlab(\"Haemoglobin (g/L)\") +\n  ylab(\"Frequency\") +\n  xlim(0, 190) +\n  geom_vline(xintercept = c(120, 150), color = \"#93032E\") +\n  ggtitle(\"Female haemoglobin\")\n\n\n\np2 &lt;- demo %&gt;%\n  drop_na(cat) %&gt;%\n  filter(Sex == \"Male\") %&gt;%\n  ggplot(aes(x = Haemoglobin, fill = Sex, color = Sex)) +\n  geom_histogram(bins = 100, fill = \"#225560\", color = \"#044651\") +\n  theme_minimal() +\n  xlab(\"Haemoglobin (g/L)\") +\n  ylab(\"Frequency\") +\n  xlim(0, 190) +\n  geom_vline(xintercept = c(130, 170), color = \"#93032E\") +\n  ggtitle(\"Male haemoglobin\")\n\n(p1 / p2)\n\n\n\n\n\n\nFigure 3: Distribution of haemoglobin after processing.\n\n\n\n\nHaemoglobin was not found to be significantly associated with FC at a 5% significance level.\n\nCodepander(summary(aov(Haemoglobin ~ cat, data = demo)))\n\n\nTable 3: ANOVA between haemoglobin and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n940.6\n470.3\n2.539\n0.07921\n\n\nResiduals\n1778\n329292\n185.2\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#white-cell-count",
    "href": "Baseline/Biochemistry.html#white-cell-count",
    "title": "Biochemistry data",
    "section": "White cell count",
    "text": "White cell count\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(WCC) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nWhite cell count (WCC) is a measurement of all white blood cells (neutrophils, lymphocytes, monocytes, basophils and eosinophils) which help to fight infections. 83.02% of subjects have a WCC recorded.\nWhilst some extreme WCC values are observed, most observations fall within the reference range (4-11 (×10^9/L)) and a conventional bell curve is seen overall.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = WCC)) +\n  geom_histogram(bins = 100, fill = \"#7FD8BE\", color = \"#2D977E\") +\n  theme_minimal() +\n  xlab(\"White cell count (×10^9/L\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = c(4, 11), color = \"#FF686B\", alpha = 0.8)\n\n\n\n\n\n\nFigure 4: Distrbution of WCC for the FC cohort. Vertical lines indicate the reference range.\n\n\n\n\nWCC is reported to be associated with FC.\n\nCodepander(summary(aov(WCC ~ cat, data = demo)))\n\n\nTable 4: ANOVA between WCC and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n95.27\n47.63\n8.615\n0.0001891\n\n\nResiduals\n1777\n9826\n5.529\nNA\nNA",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#albumin",
    "href": "Baseline/Biochemistry.html#albumin",
    "title": "Biochemistry data",
    "section": "Albumin",
    "text": "Albumin\n\nCodeperc &lt;- (1 - demo %&gt;%\n  drop_na(cat) %&gt;%\n  select(Albumin) %&gt;%\n  is.na() %&gt;%\n  sum() /\n  demo %&gt;%\n    drop_na(cat) %&gt;%\n    nrow()) * 100\n\n\nAlbumin is globular protein made in the liver which carries hormones, vitamins, and enzymes. Albumin has a reference range of 35-50 (g/L). 79.1% of subjects in the FC cohort have a recorded Albumin result.\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Albumin)) +\n  geom_histogram(bins = 100, fill = \"#21D19F\", color = \"#26A37D\") +\n  theme_minimal() +\n  xlab(\"Albumin\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = c(35, 50), color = \"#FF686B\")\n\n\n\n\n\n\nFigure 5: Distribution of Albumin before processing.\n\n\n\n\nAs can be seen in Figure 5, a very extreme value has been reported. This has been assumed to have been off by a factor of 10. Adjusting this observation results in the distribution seen in Figure 6.\n\nCodedemo &lt;- demo %&gt;%\n  mutate(Albumin = if_else(Albumin &gt; 100, Albumin / 10, Albumin)) %&gt;%\n  select(-AlbuminUnit)\ndemo %&gt;%\n  drop_na(cat) %&gt;%\n  ggplot(aes(x = Albumin)) +\n  geom_histogram(bins = 40, fill = \"#21D19F\", color = \"#26A37D\") +\n  theme_minimal() +\n  xlab(\"Albumin (g/L)\") +\n  ylab(\"Frequency\") +\n  geom_vline(xintercept = c(35, 50), color = \"#FF686B\")\n\n\n\n\n\n\nFigure 6: Distribution of Albumin after processing.\n\n\n\n\nThere is strong evidence for an association between Albumin and FC.\n\nCodepander(summary(aov(Albumin ~ cat, data = demo)))\n\n\nTable 5: ANOVA between Albumin and FC groups.\n\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncat\n2\n1069\n534.5\n23.85\n6.098e-11\n\n\nResiduals\n1693\n37943\n22.41\nNA\nNA\n\n\n\n\n\n\n\n\n\nCodesaveRDS(demo, paste0(outdir, \"demo-biochem.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Biochemistry.html#reproduction-and-reproducibility",
    "href": "Baseline/Biochemistry.html#reproduction-and-reproducibility",
    "title": "Biochemistry data",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), xfun(v.0.44), tidyselect(v.1.2.1), farver(v.2.1.2), htmltools(v.0.5.8.1), labeling(v.0.4.3), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Biochemistry data"
    ]
  },
  {
    "objectID": "Baseline/Tables.html",
    "href": "Baseline/Tables.html",
    "title": "Overall tables",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-diet.RDS\"))\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\n\nOn this page, you will find key demographic/phenotypic tables for the cohorts. You will also find statistical tests exploring if participant characteristics differ across cohorts.\nIn addition to the FC cohort (PREdiCCt subjects with a baseline FC available), there is also the FFQ cohort which consists of subjects with analysed FFQs available. All subjects in the FFQ cohort also have a baseline FC available and are therefore also in the FC cohort.",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#introduction",
    "href": "Baseline/Tables.html#introduction",
    "title": "Overall tables",
    "section": "",
    "text": "Codeset.seed(123)\n\n##############\n## Packages ##\n##############\n\nlibrary(plyr) # Used for mapping values\nsuppressPackageStartupMessages(library(tidyverse)) # ggplot2, dplyr, and magrittr\nlibrary(readxl) # Read in Excel files\nlibrary(lubridate) # Handle dates\nlibrary(datefixR) # Standardise dates\nlibrary(patchwork) # Arrange ggplots\n\n# Generate tables\nsuppressPackageStartupMessages(library(table1))\nlibrary(knitr)\nlibrary(pander)\n\n# Generate flowchart of cohort derivation\nlibrary(DiagrammeR)\nlibrary(DiagrammeRsvg)\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-diet.RDS\"))\nFFQ &lt;- read_xlsx(paste0(\n  prefix,\n  \"predicct ffq_nutrientfood groupDQI all foods_data (n1092)Nov2022.xlsx\"\n))\n\n\nOn this page, you will find key demographic/phenotypic tables for the cohorts. You will also find statistical tests exploring if participant characteristics differ across cohorts.\nIn addition to the FC cohort (PREdiCCt subjects with a baseline FC available), there is also the FFQ cohort which consists of subjects with analysed FFQs available. All subjects in the FFQ cohort also have a baseline FC available and are therefore also in the FC cohort.",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-baseline-data-by-cohort",
    "href": "Baseline/Tables.html#table-of-baseline-data-by-cohort",
    "title": "Overall tables",
    "section": "Table of baseline data by cohort",
    "text": "Table of baseline data by cohort\n\nCodemy.render.cont &lt;- function(x) {\n  with(\n    stats.apply.rounding(stats.default(x),\n      digits = 3,\n      round.integers = FALSE\n    ),\n    c(\"\", \"Median (IQR)\" = sprintf(\"%s (%s - %s)\", MEDIAN, Q1, Q3))\n  )\n}\n\ndemo$control_8 &lt;- as.numeric(demo$control_8)\n\n\ncomp &lt;- demo\ncomp$cohort &lt;- \"All\"\n\ntemp &lt;- demo %&gt;%\n  drop_na(cat)\ntemp$cohort &lt;- \"FC\"\n\ncomp &lt;- rbind(comp, temp)\n\ntemp &lt;- subset(demo, ParticipantNo %in% FFQ$participantno)\ntemp$cohort &lt;- \"FFQ\"\n\ncomp &lt;- rbind(comp, temp)\n\ncomp$cohort &lt;- factor(comp$cohort,\n  levels = c(\"All\", \"FC\", \"FFQ\"),\n  labels = c(\"Full cohort\", \"FC cohort\", \"FFQ cohort\")\n)\n\ntable1(\n  ~ Age +\n    Sex +\n    Ethnicity +\n    BMIcat +\n    diagnosis +\n    `IBD Duration` +\n    IMD +\n    control_8 +\n    vas_control +\n    FC +\n    CReactiveProtein +\n    Haemoglobin +\n    WCC +\n    Albumin +\n    Meat_sum +\n    fibre +\n    PUFA_percEng +\n    NOVAScore_cat +\n    Biologic | cohort,\n  data = comp,\n  render.continuous = my.render.cont,\n  overall = FALSE\n)\n\n\n\n\n\n\n\n\n\n\n\n\nFull cohort(N=2629)\nFC cohort(N=2144)\nFFQ cohort(N=1091)\n\n\n\nAge\n\n\n\n\n\nMedian (IQR)\n44.0 (32.0 - 56.0)\n44.0 (32.0 - 57.0)\n47.0 (35.0 - 58.0)\n\n\nSex\n\n\n\n\n\nMale\n1207 (45.9%)\n966 (45.1%)\n476 (43.6%)\n\n\nFemale\n1422 (54.1%)\n1178 (54.9%)\n615 (56.4%)\n\n\nEthnicity\n\n\n\n\n\nWhite\n1862 (70.8%)\n1657 (77.3%)\n1039 (95.2%)\n\n\nNon-white\n71 (2.7%)\n57 (2.7%)\n24 (2.2%)\n\n\nMissing\n696 (26.5%)\n430 (20.1%)\n28 (2.6%)\n\n\nBMIcat\n\n\n\n\n\nUnderweight\n49 (1.9%)\n38 (1.8%)\n20 (1.8%)\n\n\nNormal\n1004 (38.2%)\n840 (39.2%)\n460 (42.2%)\n\n\nOverweight\n923 (35.1%)\n751 (35.0%)\n398 (36.5%)\n\n\nObese\n552 (21.0%)\n431 (20.1%)\n191 (17.5%)\n\n\nMissing\n101 (3.8%)\n84 (3.9%)\n22 (2.0%)\n\n\ndiagnosis\n\n\n\n\n\nCD\n1370 (52.1%)\n1118 (52.1%)\n530 (48.6%)\n\n\nUC\n1174 (44.7%)\n950 (44.3%)\n523 (47.9%)\n\n\nIBDU\n85 (3.2%)\n76 (3.5%)\n38 (3.5%)\n\n\nIBD Duration\n\n\n\n\n\nMedian (IQR)\n10.0 (4.73 - 18.6)\n9.80 (4.60 - 18.6)\n10.3 (4.92 - 20.1)\n\n\nMissing\n151 (5.7%)\n120 (5.6%)\n53 (4.9%)\n\n\nIMD\n\n\n\n\n\n1\n221 (8.4%)\n172 (8.0%)\n80 (7.3%)\n\n\n2\n449 (17.1%)\n372 (17.4%)\n158 (14.5%)\n\n\n3\n531 (20.2%)\n421 (19.6%)\n210 (19.2%)\n\n\n4\n586 (22.3%)\n488 (22.8%)\n249 (22.8%)\n\n\n5\n812 (30.9%)\n669 (31.2%)\n385 (35.3%)\n\n\nMissing\n30 (1.1%)\n22 (1.0%)\n9 (0.8%)\n\n\ncontrol_8\n\n\n\n\n\nMedian (IQR)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n\n\nMissing\n718 (27.3%)\n447 (20.8%)\n38 (3.5%)\n\n\nvas_control\n\n\n\n\n\n&lt;85\n628 (23.9%)\n569 (26.5%)\n320 (29.3%)\n\n\n85+\n1275 (48.5%)\n1121 (52.3%)\n730 (66.9%)\n\n\nMissing\n726 (27.6%)\n454 (21.2%)\n41 (3.8%)\n\n\nFC\n\n\n\n\n\nMedian (IQR)\n49.0 (20.0 - 161)\n49.0 (20.0 - 161)\n49.0 (20.0 - 161)\n\n\nMissing\n485 (18.4%)\n0 (0%)\n79 (7.2%)\n\n\nCReactiveProtein\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n\n\nMissing\n637 (24.2%)\n506 (23.6%)\n280 (25.7%)\n\n\nHaemoglobin\n\n\n\n\n\nMedian (IQR)\n139 (130 - 147)\n138 (129 - 147)\n139 (130 - 146)\n\n\nMissing\n469 (17.8%)\n363 (16.9%)\n195 (17.9%)\n\n\nWCC\n\n\n\n\n\nMedian (IQR)\n6.20 (5.10 - 7.60)\n6.20 (5.10 - 7.60)\n6.20 (5.10 - 7.46)\n\n\nMissing\n470 (17.9%)\n364 (17.0%)\n196 (18.0%)\n\n\nAlbumin\n\n\n\n\n\nMedian (IQR)\n41.0 (39.0 - 45.0)\n41.0 (39.0 - 45.0)\n41.0 (38.0 - 44.0)\n\n\nMissing\n572 (21.8%)\n448 (20.9%)\n250 (22.9%)\n\n\nMeat_sum\n\n\n\n\n\nMedian (IQR)\n35.8 (24.9 - 50.6)\n36.0 (25.3 - 50.5)\n35.8 (24.9 - 50.6)\n\n\nMissing\n1539 (58.5%)\n1132 (52.8%)\n1 (0.1%)\n\n\nfibre\n\n\n\n\n\nMedian (IQR)\n22.9 (17.0 - 29.4)\n22.8 (16.9 - 29.3)\n22.9 (17.0 - 29.4)\n\n\nMissing\n1539 (58.5%)\n1132 (52.8%)\n1 (0.1%)\n\n\nPUFA_percEng\n\n\n\n\n\nMedian (IQR)\n5.17 (4.54 - 5.92)\n5.17 (4.53 - 5.89)\n5.17 (4.54 - 5.92)\n\n\nMissing\n1539 (58.5%)\n1132 (52.8%)\n1 (0.1%)\n\n\nNOVAScore_cat\n\n\n\n\n\nUnprocessed\n273 (10.4%)\n252 (11.8%)\n273 (25.0%)\n\n\nProcessed culinary\n273 (10.4%)\n257 (12.0%)\n273 (25.0%)\n\n\nProcesed food\n274 (10.4%)\n255 (11.9%)\n274 (25.1%)\n\n\nUltra-processed\n271 (10.3%)\n248 (11.6%)\n271 (24.8%)\n\n\nMissing\n1538 (58.5%)\n1132 (52.8%)\n0 (0%)\n\n\nBiologic\n\n\n\n\n\nCurrent\n920 (35.0%)\n774 (36.1%)\n310 (28.4%)\n\n\nPreviously\n160 (6.1%)\n133 (6.2%)\n66 (6.0%)\n\n\nNever prescribed\n1549 (58.9%)\n1237 (57.7%)\n715 (65.5%)\n\n\n\n\n\n\n\nAssociations with cohort membership\nOnly age, biologic use, and albumin were found to be significantly different across cohorts.\nAge\nThere is a significant difference in age across cohorts with subjects in the FFQ sub-cohort being more likely to be older than the full or FC cohorts.\n\nCodepander(summary(aov(Age ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n4786\n2393\n10.08\n4.256e-05\n\n\nResiduals\n5861\n1391260\n237.4\nNA\nNA\n\n\n\n\n\nSex\n\nCodepander(chisq.test(comp$Sex, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Sex and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.639\n2\n0.4406\n\n\n\n\nBody mass index\n\nCodepander(summary(aov(BMI ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n111.4\n55.7\n1.95\n0.1424\n\n\nResiduals\n5654\n161505\n28.56\nNA\nNA\n\n\n\n\n\nEthnicity\n\nCodepander(chisq.test(comp$Ethnicity, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Ethnicity and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n4.482\n2\n0.1063\n\n\n\n\nIndex of multiple deprivation\n\nCodepander(chisq.test(comp$IMD, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$IMD and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n10.73\n8\n0.2172\n\n\n\n\nIBD type\n\nCodepander(chisq.test(comp$diagnosis2, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$diagnosis2 and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n4.474\n2\n0.1068\n\n\n\n\nDisease duration\n\nCodepander(summary(aov(`IBD Duration` ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n356.2\n178.1\n1.492\n0.225\n\n\nResiduals\n5537\n660933\n119.4\nNA\nNA\n\n\n\n\n\nIBD Control-8\n\nCodepander(summary(aov(control_8 ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n19.77\n9.884\n1.018\n0.3613\n\n\nResiduals\n4658\n45211\n9.706\nNA\nNA\n\n\n\n\n\nIBD visual analogue score\n\nCodepander(chisq.test(comp$vas_control, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$vas_control and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n3.158\n2\n0.2062\n\n\n\n\nFaecal calprotectin\nFC has been treated as a continuous variable for this test. FC has not been discretised.\n\nCodepander(summary(aov(FC ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n10042\n5021\n0.04235\n0.9585\n\n\nResiduals\n5297\n6.28e+08\n118564\nNA\nNA\n\n\n\n\n\nC-reactive protein\n\nCodepander(summary(aov(CReactiveProtein ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n12.36\n6.178\n0.05603\n0.9455\n\n\nResiduals\n4438\n489297\n110.3\nNA\nNA\n\n\n\n\n\nHaemoglobin\n\nCodepander(summary(aov(Haemoglobin ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n84.22\n42.11\n0.2276\n0.7965\n\n\nResiduals\n4834\n894479\n185\nNA\nNA\n\n\n\n\n\nWhite cell count\n\nCodepander(summary(aov(WCC ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n81.86\n40.93\n1.06\n0.3464\n\n\nResiduals\n4831\n186499\n38.6\nNA\nNA\n\n\n\n\n\nAlbumin\nThere is a significant difference in albumin across the cohorts. However, this difference appears to be negligible.\n\nCodepander(summary(aov(Albumin ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n320.6\n160.3\n6.931\n0.0009876\n\n\nResiduals\n4591\n106189\n23.13\nNA\nNA\n\n\n\n\n\nDietary data\nDietary data have not been compared across cohorts.\nBiologic usage\nThere is a significant difference in biologic usage across the cohorts with subjects in the FFQ sub-cohort being less likely to have been prescribed a biologic than the full cohort or the FC sub-cohort.\n\nCodepander(chisq.test(comp$Biologic, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Biologic and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n21.41\n4\n0.0002626 * * *",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-baseline-data-by-fc-groups",
    "href": "Baseline/Tables.html#table-of-baseline-data-by-fc-groups",
    "title": "Overall tables",
    "section": "Table of baseline data by FC groups",
    "text": "Table of baseline data by FC groups\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  table1(\n    x = ~ Age +\n    Sex +\n    Ethnicity +\n    BMIcat +\n    diagnosis +\n    `IBD Duration` +\n    IMD +\n    control_8 +\n    vas_control +\n    FC +\n    CReactiveProtein +\n    Haemoglobin +\n    WCC +\n    Albumin +\n    Meat_sum +\n    fibre +\n    PUFA_percEng +\n    NOVAScore_cat +\n    Biologic | cat,\n    render.continuous = my.render.cont\n  )\n\n\nTable 1: Baseline data by FC.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFC &lt; 50(N=1077)\nFC 50-250(N=683)\nFC &gt; 250(N=384)\nOverall(N=2144)\n\n\n\nAge\n\n\n\n\n\n\nMedian (IQR)\n44.0 (33.0 - 56.0)\n46.0 (33.0 - 59.5)\n42.5 (30.0 - 55.0)\n44.0 (32.0 - 57.0)\n\n\nSex\n\n\n\n\n\n\nMale\n442 (41.0%)\n333 (48.8%)\n191 (49.7%)\n966 (45.1%)\n\n\nFemale\n635 (59.0%)\n350 (51.2%)\n193 (50.3%)\n1178 (54.9%)\n\n\nEthnicity\n\n\n\n\n\n\nWhite\n834 (77.4%)\n540 (79.1%)\n283 (73.7%)\n1657 (77.3%)\n\n\nNon-white\n33 (3.1%)\n13 (1.9%)\n11 (2.9%)\n57 (2.7%)\n\n\nMissing\n210 (19.5%)\n130 (19.0%)\n90 (23.4%)\n430 (20.1%)\n\n\nBMIcat\n\n\n\n\n\n\nUnderweight\n19 (1.8%)\n12 (1.8%)\n7 (1.8%)\n38 (1.8%)\n\n\nNormal\n446 (41.4%)\n244 (35.7%)\n150 (39.1%)\n840 (39.2%)\n\n\nOverweight\n371 (34.4%)\n246 (36.0%)\n134 (34.9%)\n751 (35.0%)\n\n\nObese\n201 (18.7%)\n155 (22.7%)\n75 (19.5%)\n431 (20.1%)\n\n\nMissing\n40 (3.7%)\n26 (3.8%)\n18 (4.7%)\n84 (3.9%)\n\n\ndiagnosis\n\n\n\n\n\n\nCD\n533 (49.5%)\n381 (55.8%)\n204 (53.1%)\n1118 (52.1%)\n\n\nUC\n504 (46.8%)\n283 (41.4%)\n163 (42.4%)\n950 (44.3%)\n\n\nIBDU\n40 (3.7%)\n19 (2.8%)\n17 (4.4%)\n76 (3.5%)\n\n\nIBD Duration\n\n\n\n\n\n\nMedian (IQR)\n10.1 (4.62 - 19.4)\n9.66 (4.76 - 18.4)\n9.07 (4.42 - 16.5)\n9.80 (4.60 - 18.6)\n\n\nMissing\n60 (5.6%)\n38 (5.6%)\n22 (5.7%)\n120 (5.6%)\n\n\nIMD\n\n\n\n\n\n\n1\n71 (6.6%)\n60 (8.8%)\n41 (10.7%)\n172 (8.0%)\n\n\n2\n183 (17.0%)\n120 (17.6%)\n69 (18.0%)\n372 (17.4%)\n\n\n3\n222 (20.6%)\n132 (19.3%)\n67 (17.4%)\n421 (19.6%)\n\n\n4\n245 (22.7%)\n155 (22.7%)\n88 (22.9%)\n488 (22.8%)\n\n\n5\n341 (31.7%)\n212 (31.0%)\n116 (30.2%)\n669 (31.2%)\n\n\nMissing\n15 (1.4%)\n4 (0.6%)\n3 (0.8%)\n22 (1.0%)\n\n\ncontrol_8\n\n\n\n\n\n\nMedian (IQR)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n13.0 (9.00 - 15.0)\n13.0 (11.0 - 15.0)\n\n\nMissing\n218 (20.2%)\n136 (19.9%)\n93 (24.2%)\n447 (20.8%)\n\n\nvas_control\n\n\n\n\n\n\n&lt;85\n250 (23.2%)\n201 (29.4%)\n118 (30.7%)\n569 (26.5%)\n\n\n85+\n607 (56.4%)\n342 (50.1%)\n172 (44.8%)\n1121 (52.3%)\n\n\nMissing\n220 (20.4%)\n140 (20.5%)\n94 (24.5%)\n454 (21.2%)\n\n\nFC\n\n\n\n\n\n\nMedian (IQR)\n20.0 (20.0 - 29.0)\n104 (71.0 - 157)\n498 (347 - 780)\n49.0 (20.0 - 161)\n\n\nCReactiveProtein\n\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n4.00 (1.00 - 6.00)\n2.00 (1.00 - 5.00)\n\n\nMissing\n256 (23.8%)\n167 (24.5%)\n83 (21.6%)\n506 (23.6%)\n\n\nHaemoglobin\n\n\n\n\n\n\nMedian (IQR)\n139 (130 - 147)\n139 (130 - 148)\n137 (127 - 146)\n138 (129 - 147)\n\n\nMissing\n184 (17.1%)\n120 (17.6%)\n59 (15.4%)\n363 (16.9%)\n\n\nWCC\n\n\n\n\n\n\nMedian (IQR)\n6.10 (4.99 - 7.40)\n6.30 (5.30 - 7.69)\n6.60 (5.31 - 8.10)\n6.20 (5.10 - 7.60)\n\n\nMissing\n184 (17.1%)\n120 (17.6%)\n60 (15.6%)\n364 (17.0%)\n\n\nAlbumin\n\n\n\n\n\n\nMedian (IQR)\n42.0 (39.0 - 46.0)\n41.0 (38.0 - 44.0)\n40.0 (38.0 - 43.0)\n41.0 (39.0 - 45.0)\n\n\nMissing\n226 (21.0%)\n146 (21.4%)\n76 (19.8%)\n448 (20.9%)\n\n\nMeat_sum\n\n\n\n\n\n\nMedian (IQR)\n34.8 (24.6 - 48.1)\n37.5 (26.0 - 53.2)\n35.5 (25.2 - 51.4)\n36.0 (25.3 - 50.5)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nfibre\n\n\n\n\n\n\nMedian (IQR)\n23.5 (17.0 - 29.4)\n23.0 (16.9 - 29.5)\n21.7 (16.8 - 27.9)\n22.8 (16.9 - 29.3)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nPUFA_percEng\n\n\n\n\n\n\nMedian (IQR)\n5.15 (4.57 - 5.96)\n5.14 (4.37 - 5.82)\n5.33 (4.57 - 5.93)\n5.17 (4.53 - 5.89)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nNOVAScore_cat\n\n\n\n\n\n\nUnprocessed\n121 (11.2%)\n75 (11.0%)\n56 (14.6%)\n252 (11.8%)\n\n\nProcessed culinary\n138 (12.8%)\n74 (10.8%)\n45 (11.7%)\n257 (12.0%)\n\n\nProcesed food\n136 (12.6%)\n84 (12.3%)\n35 (9.1%)\n255 (11.9%)\n\n\nUltra-processed\n112 (10.4%)\n93 (13.6%)\n43 (11.2%)\n248 (11.6%)\n\n\nMissing\n570 (52.9%)\n357 (52.3%)\n205 (53.4%)\n1132 (52.8%)\n\n\nBiologic\n\n\n\n\n\n\nCurrent\n406 (37.7%)\n220 (32.2%)\n148 (38.5%)\n774 (36.1%)\n\n\nPreviously\n48 (4.5%)\n55 (8.1%)\n30 (7.8%)\n133 (6.2%)\n\n\nNever prescribed\n623 (57.8%)\n408 (59.7%)\n206 (53.6%)\n1237 (57.7%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-baseline-data-by-ibd-type",
    "href": "Baseline/Tables.html#table-of-baseline-data-by-ibd-type",
    "title": "Overall tables",
    "section": "Table of baseline data by IBD type",
    "text": "Table of baseline data by IBD type\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  table1::table1(\n    x = ~ Age +\n    Sex +\n    Ethnicity +\n    BMIcat +\n    diagnosis +\n    `IBD Duration` +\n    IMD +\n    control_8 +\n    vas_control +\n    FC +\n    CReactiveProtein +\n    Haemoglobin +\n    WCC +\n    Albumin +\n    Meat_sum +\n    fibre +\n    PUFA_percEng +\n    NOVAScore_cat +\n    Biologic |\n      diagnosis2,\n    render.continuous = my.render.cont\n  )\n\n\nTable 2: Baseline data by IBD type.\n\n\n\n\n\n\n\n\n\n\n\n\n\nCD(N=1118)\nUC/IBDU(N=1026)\nOverall(N=2144)\n\n\n\nAge\n\n\n\n\n\nMedian (IQR)\n41.5 (31.0 - 54.0)\n48.0 (36.0 - 59.0)\n44.0 (32.0 - 57.0)\n\n\nSex\n\n\n\n\n\nMale\n478 (42.8%)\n488 (47.6%)\n966 (45.1%)\n\n\nFemale\n640 (57.2%)\n538 (52.4%)\n1178 (54.9%)\n\n\nEthnicity\n\n\n\n\n\nWhite\n849 (75.9%)\n808 (78.8%)\n1657 (77.3%)\n\n\nNon-white\n31 (2.8%)\n26 (2.5%)\n57 (2.7%)\n\n\nMissing\n238 (21.3%)\n192 (18.7%)\n430 (20.1%)\n\n\nBMIcat\n\n\n\n\n\nUnderweight\n20 (1.8%)\n18 (1.8%)\n38 (1.8%)\n\n\nNormal\n451 (40.3%)\n389 (37.9%)\n840 (39.2%)\n\n\nOverweight\n379 (33.9%)\n372 (36.3%)\n751 (35.0%)\n\n\nObese\n215 (19.2%)\n216 (21.1%)\n431 (20.1%)\n\n\nMissing\n53 (4.7%)\n31 (3.0%)\n84 (3.9%)\n\n\ndiagnosis\n\n\n\n\n\nCD\n1118 (100%)\n0 (0%)\n1118 (52.1%)\n\n\nUC\n0 (0%)\n950 (92.6%)\n950 (44.3%)\n\n\nIBDU\n0 (0%)\n76 (7.4%)\n76 (3.5%)\n\n\nIBD Duration\n\n\n\n\n\nMedian (IQR)\n10.3 (5.04 - 20.2)\n9.28 (4.27 - 16.8)\n9.80 (4.60 - 18.6)\n\n\nMissing\n64 (5.7%)\n56 (5.5%)\n120 (5.6%)\n\n\nIMD\n\n\n\n\n\n1\n85 (7.6%)\n87 (8.5%)\n172 (8.0%)\n\n\n2\n211 (18.9%)\n161 (15.7%)\n372 (17.4%)\n\n\n3\n211 (18.9%)\n210 (20.5%)\n421 (19.6%)\n\n\n4\n248 (22.2%)\n240 (23.4%)\n488 (22.8%)\n\n\n5\n352 (31.5%)\n317 (30.9%)\n669 (31.2%)\n\n\nMissing\n11 (1.0%)\n11 (1.1%)\n22 (1.0%)\n\n\ncontrol_8\n\n\n\n\n\nMedian (IQR)\n13.0 (10.0 - 15.0)\n13.0 (11.0 - 15.0)\n13.0 (11.0 - 15.0)\n\n\nMissing\n248 (22.2%)\n199 (19.4%)\n447 (20.8%)\n\n\nvas_control\n\n\n\n\n\n&lt;85\n318 (28.4%)\n251 (24.5%)\n569 (26.5%)\n\n\n85+\n547 (48.9%)\n574 (55.9%)\n1121 (52.3%)\n\n\nMissing\n253 (22.6%)\n201 (19.6%)\n454 (21.2%)\n\n\nFC\n\n\n\n\n\nMedian (IQR)\n54.0 (20.0 - 167)\n43.0 (20.0 - 155)\n49.0 (20.0 - 161)\n\n\nCReactiveProtein\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n2.00 (1.00 - 5.00)\n\n\nMissing\n255 (22.8%)\n251 (24.5%)\n506 (23.6%)\n\n\nHaemoglobin\n\n\n\n\n\nMedian (IQR)\n137 (128 - 146)\n139 (132 - 148)\n138 (129 - 147)\n\n\nMissing\n164 (14.7%)\n199 (19.4%)\n363 (16.9%)\n\n\nWCC\n\n\n\n\n\nMedian (IQR)\n6.30 (5.20 - 7.60)\n6.20 (5.00 - 7.60)\n6.20 (5.10 - 7.60)\n\n\nMissing\n163 (14.6%)\n201 (19.6%)\n364 (17.0%)\n\n\nAlbumin\n\n\n\n\n\nMedian (IQR)\n41.0 (38.0 - 44.0)\n42.0 (39.0 - 45.0)\n41.0 (39.0 - 45.0)\n\n\nMissing\n209 (18.7%)\n239 (23.3%)\n448 (20.9%)\n\n\nMeat_sum\n\n\n\n\n\nMedian (IQR)\n35.8 (25.3 - 49.9)\n36.1 (25.1 - 50.9)\n36.0 (25.3 - 50.5)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nfibre\n\n\n\n\n\nMedian (IQR)\n22.1 (16.4 - 28.4)\n23.4 (17.8 - 29.9)\n22.8 (16.9 - 29.3)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nPUFA_percEng\n\n\n\n\n\nMedian (IQR)\n5.19 (4.53 - 5.97)\n5.15 (4.53 - 5.88)\n5.17 (4.53 - 5.89)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nNOVAScore_cat\n\n\n\n\n\nUnprocessed\n126 (11.3%)\n126 (12.3%)\n252 (11.8%)\n\n\nProcessed culinary\n128 (11.4%)\n129 (12.6%)\n257 (12.0%)\n\n\nProcesed food\n122 (10.9%)\n133 (13.0%)\n255 (11.9%)\n\n\nUltra-processed\n121 (10.8%)\n127 (12.4%)\n248 (11.6%)\n\n\nMissing\n621 (55.5%)\n511 (49.8%)\n1132 (52.8%)\n\n\nBiologic\n\n\n\n\n\nCurrent\n522 (46.7%)\n252 (24.6%)\n774 (36.1%)\n\n\nPreviously\n96 (8.6%)\n37 (3.6%)\n133 (6.2%)\n\n\nNever prescribed\n500 (44.7%)\n737 (71.8%)\n1237 (57.7%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-crohns-disease-variables",
    "href": "Baseline/Tables.html#table-of-crohns-disease-variables",
    "title": "Overall tables",
    "section": "Table of Crohn’s disease variables",
    "text": "Table of Crohn’s disease variables\n\nCodedemo.cd &lt;- readRDS(paste0(outdir, \"demo-cd.RDS\"))\ndemo.cd %&gt;%\n  drop_na(cat) %&gt;%\n  table1(\n    x = ~ Location +\n      L4 +\n      HBI +\n      PRO2 +\n      Behaviour +\n      Perianal +\n      Surgery +\n      Smoke +\n      ECigs |\n      cat,\n    render.continuous = my.render.cont\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\nFC &lt; 50(N=533)\nFC 50-250(N=381)\nFC &gt; 250(N=204)\nOverall(N=1118)\n\n\n\nLocation\n\n\n\n\n\n\nL1\n138 (25.9%)\n99 (26.0%)\n46 (22.5%)\n283 (25.3%)\n\n\nL2\n128 (24.0%)\n90 (23.6%)\n60 (29.4%)\n278 (24.9%)\n\n\nL3\n176 (33.0%)\n136 (35.7%)\n73 (35.8%)\n385 (34.4%)\n\n\nL4 only\n3 (0.6%)\n4 (1.0%)\n3 (1.5%)\n10 (0.9%)\n\n\nMissing\n88 (16.5%)\n52 (13.6%)\n22 (10.8%)\n162 (14.5%)\n\n\nL4\n\n\n\n\n\n\nNot present\n398 (74.7%)\n293 (76.9%)\n151 (74.0%)\n842 (75.3%)\n\n\nPresent\n47 (8.8%)\n36 (9.4%)\n31 (15.2%)\n114 (10.2%)\n\n\nMissing\n88 (16.5%)\n52 (13.6%)\n22 (10.8%)\n162 (14.5%)\n\n\nHBI\n\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 3.00)\n2.00 (1.00 - 4.00)\n\n\nMissing\n331 (62.1%)\n227 (59.6%)\n116 (56.9%)\n674 (60.3%)\n\n\nPRO2\n\n\n\n\n\n\nMedian (IQR)\n0 (0 - 2.00)\n0 (0 - 2.00)\n0 (0 - 1.00)\n0 (0 - 2.00)\n\n\nMissing\n242 (45.4%)\n135 (35.4%)\n69 (33.8%)\n446 (39.9%)\n\n\nBehaviour\n\n\n\n\n\n\nB1\n279 (52.3%)\n211 (55.4%)\n127 (62.3%)\n617 (55.2%)\n\n\nB2\n96 (18.0%)\n73 (19.2%)\n37 (18.1%)\n206 (18.4%)\n\n\nB3\n51 (9.6%)\n31 (8.1%)\n11 (5.4%)\n93 (8.3%)\n\n\nMissing\n107 (20.1%)\n66 (17.3%)\n29 (14.2%)\n202 (18.1%)\n\n\nPerianal\n\n\n\n\n\n\nYes\n149 (28.0%)\n106 (27.8%)\n66 (32.4%)\n321 (28.7%)\n\n\nNo\n283 (53.1%)\n224 (58.8%)\n112 (54.9%)\n619 (55.4%)\n\n\nMissing\n101 (18.9%)\n51 (13.4%)\n26 (12.7%)\n178 (15.9%)\n\n\nSurgery\n\n\n\n\n\n\nYes\n251 (47.1%)\n193 (50.7%)\n78 (38.2%)\n522 (46.7%)\n\n\nNo\n262 (49.2%)\n181 (47.5%)\n118 (57.8%)\n561 (50.2%)\n\n\nMissing\n20 (3.8%)\n7 (1.8%)\n8 (3.9%)\n35 (3.1%)\n\n\nSmoke\n\n\n\n\n\n\nCurrent\n32 (6.0%)\n26 (6.8%)\n5 (2.5%)\n63 (5.6%)\n\n\nPrevious\n153 (28.7%)\n108 (28.3%)\n41 (20.1%)\n302 (27.0%)\n\n\nNever\n234 (43.9%)\n169 (44.4%)\n105 (51.5%)\n508 (45.4%)\n\n\nMissing\n114 (21.4%)\n78 (20.5%)\n53 (26.0%)\n245 (21.9%)\n\n\nECigs\n\n\n\n\n\n\nCurrent\n19 (3.6%)\n18 (4.7%)\n2 (1.0%)\n39 (3.5%)\n\n\nPrevious\n16 (3.0%)\n13 (3.4%)\n4 (2.0%)\n33 (3.0%)\n\n\nNever\n382 (71.7%)\n272 (71.4%)\n145 (71.1%)\n799 (71.5%)\n\n\nMissing\n116 (21.8%)\n78 (20.5%)\n53 (26.0%)\n247 (22.1%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-crohns-disease-variables-by-cohort",
    "href": "Baseline/Tables.html#table-of-crohns-disease-variables-by-cohort",
    "title": "Overall tables",
    "section": "Table of Crohn’s disease variables by cohort",
    "text": "Table of Crohn’s disease variables by cohort\n\nCodecomp &lt;- demo.cd\ncomp$cohort &lt;- \"All\"\n\ntemp &lt;- demo.cd %&gt;%\n  drop_na(cat)\ntemp$cohort &lt;- \"FC\"\n\ncomp &lt;- rbind(comp, temp)\n\ntemp &lt;- subset(demo.cd, ParticipantNo %in% FFQ$participantno)\ntemp$cohort &lt;- \"FFQ\"\n\ncomp &lt;- rbind(comp, temp)\n\ncomp$cohort &lt;- factor(comp$cohort,\n  levels = c(\"All\", \"FC\", \"FFQ\"),\n  labels = c(\"Full cohort\", \"FC cohort\", \"FFQ cohort\")\n)\n\ntable1(\n  ~ Location +\n    L4 +\n    HBI +\n    PRO2 +\n    Behaviour +\n    Perianal +\n    Surgery +\n    Smoke +\n    ECigs |\n    cohort,\n  data = comp,\n  render.continuous = my.render.cont,\n  overall = FALSE\n)\n\n\n\n\n\n\n\n\n\n\n\n\nFull cohort(N=1370)\nFC cohort(N=1118)\nFFQ cohort(N=530)\n\n\n\nLocation\n\n\n\n\n\nL1\n362 (26.4%)\n283 (25.3%)\n149 (28.1%)\n\n\nL2\n333 (24.3%)\n278 (24.9%)\n141 (26.6%)\n\n\nL3\n454 (33.1%)\n385 (34.4%)\n160 (30.2%)\n\n\nL4 only\n14 (1.0%)\n10 (0.9%)\n6 (1.1%)\n\n\nMissing\n207 (15.1%)\n162 (14.5%)\n74 (14.0%)\n\n\nL4\n\n\n\n\n\nNot present\n1031 (75.3%)\n842 (75.3%)\n412 (77.7%)\n\n\nPresent\n132 (9.6%)\n114 (10.2%)\n44 (8.3%)\n\n\nMissing\n207 (15.1%)\n162 (14.5%)\n74 (14.0%)\n\n\nHBI\n\n\n\n\n\nMedian (IQR)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 4.00)\n2.00 (1.00 - 3.00)\n\n\nMissing\n833 (60.8%)\n674 (60.3%)\n287 (54.2%)\n\n\nPRO2\n\n\n\n\n\nMedian (IQR)\n0 (0 - 2.00)\n0 (0 - 2.00)\n1.00 (0 - 2.00)\n\n\nMissing\n555 (40.5%)\n446 (39.9%)\n179 (33.8%)\n\n\nBehaviour\n\n\n\n\n\nB1\n749 (54.7%)\n617 (55.2%)\n285 (53.8%)\n\n\nB2\n252 (18.4%)\n206 (18.4%)\n105 (19.8%)\n\n\nB3\n121 (8.8%)\n93 (8.3%)\n54 (10.2%)\n\n\nMissing\n248 (18.1%)\n202 (18.1%)\n86 (16.2%)\n\n\nPerianal\n\n\n\n\n\nYes\n397 (29.0%)\n321 (28.7%)\n151 (28.5%)\n\n\nNo\n746 (54.5%)\n619 (55.4%)\n299 (56.4%)\n\n\nMissing\n227 (16.6%)\n178 (15.9%)\n80 (15.1%)\n\n\nSurgery\n\n\n\n\n\nYes\n634 (46.3%)\n522 (46.7%)\n273 (51.5%)\n\n\nNo\n684 (49.9%)\n561 (50.2%)\n249 (47.0%)\n\n\nMissing\n52 (3.8%)\n35 (3.1%)\n8 (1.5%)\n\n\nSmoke\n\n\n\n\n\nCurrent\n73 (5.3%)\n63 (5.6%)\n32 (6.0%)\n\n\nPrevious\n343 (25.0%)\n302 (27.0%)\n186 (35.1%)\n\n\nNever\n562 (41.0%)\n508 (45.4%)\n299 (56.4%)\n\n\nMissing\n392 (28.6%)\n245 (21.9%)\n13 (2.5%)\n\n\nECigs\n\n\n\n\n\nCurrent\n45 (3.3%)\n39 (3.5%)\n17 (3.2%)\n\n\nPrevious\n39 (2.8%)\n33 (3.0%)\n14 (2.6%)\n\n\nNever\n892 (65.1%)\n799 (71.5%)\n486 (91.7%)\n\n\nMissing\n394 (28.8%)\n247 (22.1%)\n13 (2.5%)\n\n\n\n\n\n\n\nAssociations between Crohn’s Disease-only variables and cohort membership\nNone of the CD-only variables were found to significantly differ across cohorts.\nMontreal location\n\nCodepander(fisher.test(comp$Location, comp$cohort, workspace = 200000000))\n\n\nFisher’s Exact Test for Count Data: comp$Location and comp$cohort\n\n\n\n\n\n\nP value\nAlternative hypothesis\n\n\n0.659\ntwo.sided\n\n\n\n\nUpper gastrointestinal inflammation\n\nCodepander(chisq.test(comp$L4, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$L4 and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.616\n2\n0.4457\n\n\n\n\nHarvey-Bradshaw index\n\nCodepander(summary(aov(HBI ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n2.721\n1.36\n0.2382\n0.788\n\n\nResiduals\n1221\n6972\n5.71\nNA\nNA\n\n\n\n\n\nPRO2\n\nCodepander(summary(aov(PRO2 ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n0.6806\n0.3403\n0.08516\n0.9184\n\n\nResiduals\n1835\n7333\n3.996\nNA\nNA\n\n\n\n\n\nMontreal behaviour\n\nCodepander(chisq.test(comp$Behaviour, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Behaviour and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.81\n4\n0.7707\n\n\n\n\nPerianal disease\n\nCodepander(chisq.test(comp$Perianal, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Perianal and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.2153\n2\n0.898\n\n\n\n\nSurgery\n\nCodepander(chisq.test(comp$Surgery, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Surgery and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.961\n2\n0.2276\n\n\n\n\nSmoking status\n\nCodepander(chisq.test(comp$Smoke, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Smoke and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n1.023\n4\n0.9063\n\n\n\n\nE-cigarette use\n\nCodepander(chisq.test(comp$ECigs, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$ECigs and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n3.416\n4\n0.4908",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables",
    "href": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables",
    "title": "Overall tables",
    "section": "Table of ulcerative colitis/IBDU variables",
    "text": "Table of ulcerative colitis/IBDU variables\n\nCodedemo.uc &lt;- readRDS(paste0(outdir, \"demo-uc.RDS\"))\n\ndemo.uc %&gt;%\n  drop_na(cat) %&gt;%\n  table1(\n    x = ~ Extent + Mayo + PRO2 + Smoke + ECigs | cat,\n    render.continuous = my.render.cont\n  )\n\n\n\n\n\n\n\n\n\n\n\n\n\nFC &lt; 50(N=544)\nFC 50-250(N=302)\nFC &gt; 250(N=180)\nOverall(N=1026)\n\n\n\nExtent\n\n\n\n\n\n\nE1\n74 (13.6%)\n34 (11.3%)\n20 (11.1%)\n128 (12.5%)\n\n\nE2\n214 (39.3%)\n126 (41.7%)\n76 (42.2%)\n416 (40.5%)\n\n\nE3\n126 (23.2%)\n79 (26.2%)\n48 (26.7%)\n253 (24.7%)\n\n\nMissing\n130 (23.9%)\n63 (20.9%)\n36 (20.0%)\n229 (22.3%)\n\n\nMayo\n\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0.500 (0 - 2.00)\n0 (0 - 1.00)\n\n\nMissing\n171 (31.4%)\n62 (20.5%)\n58 (32.2%)\n291 (28.4%)\n\n\nPRO2\n\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n\n\nMissing\n172 (31.6%)\n64 (21.2%)\n59 (32.8%)\n295 (28.8%)\n\n\nSmoke\n\n\n\n\n\n\nCurrent\n32 (5.9%)\n10 (3.3%)\n4 (2.2%)\n46 (4.5%)\n\n\nPrevious\n156 (28.7%)\n105 (34.8%)\n64 (35.6%)\n325 (31.7%)\n\n\nNever\n253 (46.5%)\n131 (43.4%)\n73 (40.6%)\n457 (44.5%)\n\n\nMissing\n103 (18.9%)\n56 (18.5%)\n39 (21.7%)\n198 (19.3%)\n\n\nECigs\n\n\n\n\n\n\nCurrent\n9 (1.7%)\n15 (5.0%)\n7 (3.9%)\n31 (3.0%)\n\n\nPrevious\n15 (2.8%)\n3 (1.0%)\n2 (1.1%)\n20 (1.9%)\n\n\nNever\n417 (76.7%)\n228 (75.5%)\n131 (72.8%)\n776 (75.6%)\n\n\nMissing\n103 (18.9%)\n56 (18.5%)\n40 (22.2%)\n199 (19.4%)",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables-by-cohort",
    "href": "Baseline/Tables.html#table-of-ulcerative-colitisibdu-variables-by-cohort",
    "title": "Overall tables",
    "section": "Table of Ulcerative colitis/IBDU variables by cohort",
    "text": "Table of Ulcerative colitis/IBDU variables by cohort\n\nCodecomp &lt;- demo.uc\ncomp$cohort &lt;- \"All\"\n\ntemp &lt;- demo.uc %&gt;%\n  drop_na(cat)\ntemp$cohort &lt;- \"FC\"\n\ncomp &lt;- rbind(comp, temp)\n\ntemp &lt;- subset(demo.uc, ParticipantNo %in% FFQ$participantno)\ntemp$cohort &lt;- \"FFQ\"\n\ncomp &lt;- rbind(comp, temp)\n\ncomp$cohort &lt;- factor(comp$cohort,\n  levels = c(\"All\", \"FC\", \"FFQ\"),\n  labels = c(\"Full cohort\", \"FC cohort\", \"FFQ cohort\")\n)\n\n\ntable1(~ Extent + Mayo + PRO2 + Smoke + ECigs | cohort,\n  data = comp,\n  render.continuous = my.render.cont,\n  overall = FALSE\n)\n\n\n\n\n\n\n\n\n\n\n\n\nFull cohort(N=1259)\nFC cohort(N=1026)\nFFQ cohort(N=561)\n\n\n\nExtent\n\n\n\n\n\nE1\n166 (13.2%)\n128 (12.5%)\n81 (14.4%)\n\n\nE2\n503 (40.0%)\n416 (40.5%)\n250 (44.6%)\n\n\nE3\n318 (25.3%)\n253 (24.7%)\n130 (23.2%)\n\n\nMissing\n272 (21.6%)\n229 (22.3%)\n100 (17.8%)\n\n\nMayo\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n\n\nMissing\n366 (29.1%)\n291 (28.4%)\n136 (24.2%)\n\n\nPRO2\n\n\n\n\n\nMedian (IQR)\n0 (0 - 1.00)\n0 (0 - 1.00)\n0 (0 - 1.00)\n\n\nMissing\n372 (29.5%)\n295 (28.8%)\n136 (24.2%)\n\n\nSmoke\n\n\n\n\n\nCurrent\n49 (3.9%)\n46 (4.5%)\n31 (5.5%)\n\n\nPrevious\n378 (30.0%)\n325 (31.7%)\n213 (38.0%)\n\n\nNever\n509 (40.4%)\n457 (44.5%)\n298 (53.1%)\n\n\nMissing\n323 (25.7%)\n198 (19.3%)\n19 (3.4%)\n\n\nECigs\n\n\n\n\n\nCurrent\n35 (2.8%)\n31 (3.0%)\n21 (3.7%)\n\n\nPrevious\n22 (1.7%)\n20 (1.9%)\n13 (2.3%)\n\n\nNever\n878 (69.7%)\n776 (75.6%)\n508 (90.6%)\n\n\nMissing\n324 (25.7%)\n199 (19.4%)\n19 (3.4%)\n\n\n\n\n\n\n\nAssociations between Crohn’s Disease-only variables and cohort membership\nNone of the UC/IBDU-only variables were found to significantly differ across cohorts.\nMontreal extent\n\nCodepander(chisq.test(comp$Extent, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Extent and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n2.793\n4\n0.593\n\n\n\n\nMayo score\n\nCodepander(summary(aov(Mayo ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n5.821\n2.91\n1.794\n0.1665\n\n\nResiduals\n2050\n3325\n1.622\nNA\nNA\n\n\n\n\n\nPRO2\n\nCodepander(summary(aov(PRO2 ~ cohort, data = comp)))\n\n\nAnalysis of Variance Model\n\n\n\n\n\n\n\n\n\n \nDf\nSum Sq\nMean Sq\nF value\nPr(&gt;F)\n\n\n\ncohort\n2\n1.319\n0.6593\n0.8346\n0.4342\n\n\nResiduals\n2040\n1611\n0.7899\nNA\nNA\n\n\n\n\n\nSmoking status\n\nCodepander(chisq.test(comp$Smoke, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$Smoke and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.398\n4\n0.9826\n\n\n\n\nE-cigarette use\n\nCodepander(chisq.test(comp$ECigs, comp$cohort))\n\n\nPearson’s Chi-squared test: comp$ECigs and comp$cohort\n\n\n\n\n\n\n\nTest statistic\ndf\nP value\n\n\n0.02764\n4\n0.9999\n\n\n\n\n\nCodedemo %&gt;%\n  drop_na(cat) %&gt;%\n  saveRDS(paste0(outdir, \"demo.RDS\"))\n\ndemo %&gt;%\n  saveRDS(paste0(outdir, \"demo-full.RDS\"))\n\ndemo.cd %&gt;%\n  saveRDS(paste0(outdir, \"demo-cd.RDS\"))\n\ndemo.uc %&gt;%\n  saveRDS(paste0(outdir, \"demo-uc.RDS\"))",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Baseline/Tables.html#reproduction-and-reproducibility",
    "href": "Baseline/Tables.html#reproduction-and-reproducibility",
    "title": "Overall tables",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: DiagrammeRsvg(v.0.1), DiagrammeR(v.1.0.11), pander(v.0.6.5), knitr(v.1.47), table1(v.1.4.3), patchwork(v.1.2.0), datefixR(v.1.6.1), readxl(v.1.4.3), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and plyr(v.1.8.9)\nloaded via a namespace (and not attached): utf8(v.1.2.4), generics(v.0.1.3), stringi(v.1.8.4), hms(v.1.1.3), digest(v.0.6.35), magrittr(v.2.0.3), evaluate(v.0.23), grid(v.4.4.0), timechange(v.0.3.0), RColorBrewer(v.1.1-3), fastmap(v.1.2.0), cellranger(v.1.1.0), jsonlite(v.1.8.8), Formula(v.1.2-5), fansi(v.1.0.6), scales(v.1.3.0), codetools(v.0.2-20), cli(v.3.6.2), rlang(v.1.1.3), visNetwork(v.2.1.2), munsell(v.0.5.1), withr(v.3.0.0), yaml(v.2.3.8), tools(v.4.4.0), tzdb(v.0.4.0), colorspace(v.2.1-0), curl(v.5.2.1), vctrs(v.0.6.5), R6(v.2.5.1), lifecycle(v.1.0.4), V8(v.4.4.2), htmlwidgets(v.1.6.4), pkgconfig(v.2.0.3), pillar(v.1.9.0), gtable(v.0.3.5), glue(v.1.7.0), Rcpp(v.1.0.12), xfun(v.0.44), tidyselect(v.1.2.1), htmltools(v.0.5.8.1), rmarkdown(v.2.27) and compiler(v.4.4.0)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Baseline Analyses",
      "Overall tables"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html",
    "href": "Survival/Soft-hard-flares.html",
    "title": "Flare overview",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n  followup.dir &lt;- \"data/final/20240308/Followup/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n  followup.dir &lt;- paste0(\"/Volumes/igmm/cvallejo-predicct/predicct/final/\",\n                         \"20240308/Followup/\")\n}\n\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  cat(\"\\ \")\n  \n  cat(\"Diagnostics:\\ \")\n  \n  cat('::: {.panel-tabset group=\"diagnostics\"}\\ ')\n  \n  cat(\"###### Proportional hazards assumption test \\ \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"###### DF betas \\ \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"###### Martignale residuals \\n\")\n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\":::\")\n  return()\n}\n\n\nThis page explores soft and hard flares. Survival curves are compared across diseases, and soft and hard flares are compared directly.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#introduction",
    "href": "Survival/Soft-hard-flares.html#introduction",
    "title": "Flare overview",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n  followup.dir &lt;- \"data/final/20240308/Followup/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n  followup.dir &lt;- paste0(\"/Volumes/igmm/cvallejo-predicct/predicct/final/\",\n                         \"20240308/Followup/\")\n}\n\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  cat(\"\\ \")\n  \n  cat(\"Diagnostics:\\ \")\n  \n  cat('::: {.panel-tabset group=\"diagnostics\"}\\ ')\n  \n  cat(\"###### Proportional hazards assumption test \\ \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"###### DF betas \\ \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"###### Martignale residuals \\n\")\n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\":::\")\n  return()\n}\n\n\nThis page explores soft and hard flares. Survival curves are compared across diseases, and soft and hard flares are compared directly.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#primary-outcome-first-soft-flare",
    "href": "Survival/Soft-hard-flares.html#primary-outcome-first-soft-flare",
    "title": "Flare overview",
    "section": "Primary outcome: First soft flare",
    "text": "Primary outcome: First soft flare\n\nCodeflares &lt;- read_xlsx(\n  paste0(followup.dir, \"all-flares.xlsx\"\n  ),\n  na = \".\",\n  sheet = 1\n) %&gt;%\n  select(ParticipantNo, softflare, softflare_time, hardflare, hardflare_time)\n\nflare.df &lt;- merge(demo, flares, by = \"ParticipantNo\")\n\n\nFor soft flares, a soft flare is primarily defined by a subject reporting their disease as uncontrolled. The time of the flare is given by the date the subject reported their symptoms worsening.\nIf a date for when the symptoms worsened is given, but the subject did not answer if their disease was uncontrolled, it is assumed their disease is not controlled (in other words, it is assumed a soft flare occurred).\nIf a subject reported their disease as being uncontrolled, but did not give a date for the worsening of their symptoms, then the earliest date given for either an IBD outpatient appointment, emergency hospital admission, call with their IBD care team, or surgery in the questionnaire response was used. If none of these dates were provided then the date of the questionnaire response was used instead.\nIf a hard flare occurs prior to a soft flare then the soft flare is assumed to occur on the same date as the hard flare.\nA complete description of the steps taken to calculate soft flares is outlined in the below drop-down section.\n\nSteps for calculating soft flares\n\nIf date of flare is before date of entry to study, then delete flare date and recode diseasecontrolled as 1.\nIf flare date is after the questionnaire date (I.E in the future), reset flare date to questionnaire date.\nIf questionnaire completed after date of withdrawal, remove.\nIf date of flare is &gt;2 years after entry, censor soft flare at 2 years.\nTime is earliest of flare time or end of follow up, from entry date.\nAll data censored at 2 years.\nIncluding the hard flares (hard flare data are much more straightforward, flare=diseaseflareyn and flare date=firstflarestartdate from EOS data)\n\nIf both datasets say no flare, soft flare is no and follow up time from hard flare &lt;= 2 years, softflare time is longest of questionnaire and hard flare times\nIf both datasets say no flare, soft flare is no and follow up time from hard flare &gt; 2 years, softflare time is 2 years\nIf no flare in questionnaires, but hard flare reported before 2 years of follow up, take hard flare data\nIf no flare in questionnaires, but hard flare reported after 2 years, softflare is no and softflare time =2 years\nIf flare in questionnaire and no hard flare, softflare from questionnaire data\nIf flare in questionnaire and also hard flare, take the earliest time\nIf questionnaire data is missing and no hard flare, soft flare is no and time is earliest of hard flare follow up and 2 years\nIf questionnaire data is missing and hard flare reported within 2 years, softflare taken from hard flare data\nIf questionnaire data is missing and hard flare reported after 2 years then softflare is no and time is 2 years\nOtherwise if questionnaire data is not missing and hardflare is, then softflare taken from questionnaire data\n\n\n\nAll times are taken from the earliest reported flare.\n\nCodefit &lt;- flare.df %&gt;%\n  drop_na(cat) %&gt;%\n  survfit(Surv(softflare_time, softflare) ~ diagnosis2, data = .)\np &lt;- ggsurvplot(fit,\n  data = flare.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"IBD Type\",\n  legend.labs = c(\"Crohn's disease\", \"UC/IBDU\"),\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\"\n)\np\n\n\n\n\n\n\nFigure 1: Kaplan-Meier curves for soft flares stratified by IBD type.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#secondary-outcome-first-hard-flare",
    "href": "Survival/Soft-hard-flares.html#secondary-outcome-first-hard-flare",
    "title": "Flare overview",
    "section": "Secondary outcome: first hard flare",
    "text": "Secondary outcome: first hard flare\nDisease flares been reported by clinical care teams instead of being reported by subjects themselves.\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ diagnosis2, data = flare.df)\np &lt;- ggsurvplot(fit,\n  data = flare.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  palette = c(\"#00A6ED\", \"#F6511D\"),\n  xlab = \"Time from study recrutiment (days)\",\n  legend.title = \"Flare type\",\n  break.time.by = 400\n)\nprint(p)",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#comparison-of-hard-and-soft-flares",
    "href": "Survival/Soft-hard-flares.html#comparison-of-hard-and-soft-flares",
    "title": "Flare overview",
    "section": "Comparison of hard and soft flares",
    "text": "Comparison of hard and soft flares\n\nCodeflare.comb &lt;- rbind(\n  data.frame(ParticipantNo = flares$ParticipantNo,\n           Cens = flares$hardflare,\n           time = flares$hardflare_time,\n           type = \"hard flare\"),\n  data.frame(ParticipantNo = flares$ParticipantNo,\n             Cens = flares$softflare,\n             time = flares$softflare_time,\n             type = \"soft flare\")\n  )\n\nflare.comb &lt;- flare.comb %&gt;%\n  drop_na(Cens, time)\n\nflare.comb$type &lt;- as.factor(flare.comb$type)\n\n\nfit &lt;- survfit(Surv(time, Cens) ~ type, data = flare.comb)\n\n\np &lt;- ggsurvplot(fit,\n                data = flare.comb,\n                conf.int = TRUE,\n                pval = FALSE,\n                pval.method = FALSE,\n                ggtheme = theme_minimal(),\n                risk.table = TRUE,\n                palette = c(\"#4a938e\", \"#e493a3\"),\n                xlab = \"Time from study recrutiment (days)\",\n                legend.title = \"Flare type\",\n                tables.y.text = FALSE,\n                tables.col = \"strata\",\n                break.time.by = 300,\n                xlim = c(0, 2200)\n) \n\ncairo_pdf(\"plots/flare-comparison.pdf\", width = 7, height = 7)\np\ninvisible(dev.off())\nsaveRDS(p, paste0(outdir, \"flare-comparison.RDS\"))\n\np\n\n\n\n\n\n\nFigure 2: Survival curves for soft and hard flares.\n\n\n\n\n\nCodefit %&gt;%\n  tbl_survfit(\n    times = 365*2,\n    label = \"Flare type\",\n    statistic = \"{estimate} ({conf.low}, {conf.high})\",\n    label_header = \"**2-year survival (95% CI)**\"\n  )\n\n\n\n\n\n\n\n\n\n\nCharacteristic\n2-year survival (95% CI)\n\n\n\nFlare type\n\n\n\n    hard flare\n86% (85%, 88%)\n\n\n    soft flare\n69% (68%, 71%)\n\n\n\n\n\nSurvival rates after two years of follow-up.\n\n\n\nCodesaveRDS(flare.df, paste0(outdir, \"flares-overview.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Soft-hard-flares.html#reproduction-and-reproducibility",
    "href": "Survival/Soft-hard-flares.html#reproduction-and-reproducibility",
    "title": "Flare overview",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), sass(v.0.4.9), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Flare overview"
    ]
  },
  {
    "objectID": "Survival/Demographics.html",
    "href": "Survival/Demographics.html",
    "title": "Demographic data",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\nDiagnostics: \\\\newline\n\n\")\n\n  cat(\"\\\\newline\n\n::: {.panel-tabset}\n\n      \")\n\n  cat(\"\n\n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n\n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n\n  cat(\"\\\\newline\n\n###### Martingale residuals \\\\newline\n\n      \")\n\n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n\n  cat(\"\\\\newline\n\n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-contolled.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-controlled-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-controlled-uc.RDS\"))\n\n\nThis page describes associations between demographic data and time-to-flare.\nThe page describing demographic variables in a descriptive manner can be found here.",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#introduction",
    "href": "Survival/Demographics.html#introduction",
    "title": "Demographic data",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\nDiagnostics: \\\\newline\n\n\")\n\n  cat(\"\\\\newline\n\n::: {.panel-tabset}\n\n      \")\n\n  cat(\"\n\n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n\n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n\n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n\n  cat(\"\\\\newline\n\n###### Martingale residuals \\\\newline\n\n      \")\n\n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n\n  cat(\"\\\\newline\n\n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-contolled.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-controlled-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-controlled-uc.RDS\"))\n\n\nThis page describes associations between demographic data and time-to-flare.\nThe page describing demographic variables in a descriptive manner can be found here.",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#age",
    "href": "Survival/Demographics.html#age",
    "title": "Demographic data",
    "section": "Age",
    "text": "Age\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.cd.df$Agecat &lt;- cut(flare.cd.df$Age,\n  c(0, 18, 30, 45, 65, Inf),\n  labels = c(\"&lt; 18\", \"18-29\", \"30-44\", \"45-64\", \"&gt;=65\"),\n  right = FALSE\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Agecat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Age\",\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\", \"green\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/demographics/age.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/demographics/age.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9948\n1.5719\n2.5314\n0.0000\n\n\nIMD2\n0.9308\n0.5932\n1.4607\n0.7552\n\n\nIMD3\n0.8884\n0.5615\n1.4056\n0.6131\n\n\nIMD4\n0.9315\n0.5990\n1.4484\n0.7527\n\n\nIMD5\n0.9621\n0.6277\n1.4748\n0.8594\n\n\ncatFC 50-250\n1.5738\n1.2191\n2.0316\n0.0005\n\n\ncatFC &gt; 250\n2.4166\n1.8207\n3.2075\n0.0000\n\n\nAge\n1.0049\n0.9977\n1.0121\n0.1862\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2901\n0.9920\n0.5868\n\n\nIMD\n5.8012\n3.9466\n0.2090\n\n\ncat\n2.3892\n1.9800\n0.2989\n\n\nAge\n2.7170\n0.9659\n0.0948\n\n\nGLOBAL\n12.3923\n15.5406\n0.6865\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Agecat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Age\",\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\", \"green\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/demographics/age.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/demographics/age.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4100\n1.0742\n1.8506\n0.0133\n\n\nIMD2\n0.9220\n0.5371\n1.5828\n0.7684\n\n\nIMD3\n0.9333\n0.5377\n1.6200\n0.8061\n\n\nIMD4\n0.9037\n0.5282\n1.5462\n0.7117\n\n\nIMD5\n0.9530\n0.5672\n1.6014\n0.8559\n\n\ncatFC 50-250\n2.0702\n1.5083\n2.8414\n0.0000\n\n\ncatFC &gt; 250\n3.3191\n2.3583\n4.6712\n0.0000\n\n\nAge\n0.9865\n0.9779\n0.9953\n0.0026\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2070\n0.9856\n0.6432\n\n\nIMD\n4.3372\n3.9449\n0.3546\n\n\ncat\n8.6873\n1.9855\n0.0128\n\n\nAge\n3.3245\n0.9503\n0.0635\n\n\nGLOBAL\n16.4294\n18.2438\n0.5790\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$Agecat &lt;- cut(flare.uc.df$Age,\n  c(0, 18, 30, 45, 65, Inf),\n  labels = c(\"&lt; 18\", \"18-29\", \"30-44\", \"45-64\", \"&gt;=65\"),\n  right = FALSE\n)\n\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Agecat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Age\",\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\", \"green\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/demographics/age.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/demographics/age.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5135\n1.2220\n1.8747\n0.0001\n\n\nIMD2\n1.2074\n0.7621\n1.9129\n0.4220\n\n\nIMD3\n1.0923\n0.6966\n1.7126\n0.7006\n\n\nIMD4\n1.4407\n0.9378\n2.2131\n0.0955\n\n\nIMD5\n1.2134\n0.7953\n1.8512\n0.3695\n\n\ncatFC 50-250\n1.5856\n1.2399\n2.0277\n0.0002\n\n\ncatFC &gt; 250\n2.1185\n1.6228\n2.7658\n0.0000\n\n\nAge\n0.9928\n0.9857\n0.9998\n0.0449\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.2765\n0.9891\n0.2555\n\n\nIMD\n3.9850\n3.9439\n0.3998\n\n\ncat\n5.7478\n1.9712\n0.0549\n\n\nAge\n0.2636\n0.9656\n0.5931\n\n\nGLOBAL\n11.8199\n19.6624\n0.9132\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Agecat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Age\",\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\", \"green\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/demographics/age.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/demographics/age.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Age + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2937\n0.9958\n1.6807\n0.0538\n\n\nIMD2\n1.3555\n0.7565\n2.4289\n0.3067\n\n\nIMD3\n1.3777\n0.7842\n2.4203\n0.2650\n\n\nIMD4\n1.7536\n1.0168\n3.0242\n0.0434\n\n\nIMD5\n1.3509\n0.7875\n2.3173\n0.2747\n\n\ncatFC 50-250\n2.0872\n1.5288\n2.8495\n0.0000\n\n\ncatFC &gt; 250\n3.1867\n2.3015\n4.4124\n0.0000\n\n\nAge\n0.9882\n0.9794\n0.9971\n0.0094\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1150\n0.9847\n0.7285\n\n\nIMD\n2.7089\n3.9421\n0.5986\n\n\ncat\n4.0990\n1.9687\n0.1255\n\n\nAge\n0.3529\n0.9656\n0.5381\n\n\nGLOBAL\n7.4819\n23.1362\n0.9991\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#sex",
    "href": "Survival/Demographics.html#sex",
    "title": "Demographic data",
    "section": "Sex",
    "text": "Sex\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Sex,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/demographics/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/demographics/sex.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Sex + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.9989\n1.5753\n2.5364\n0.0000\n\n\nIMD2\n0.9364\n0.5970\n1.4686\n0.7746\n\n\nIMD3\n0.8868\n0.5609\n1.4021\n0.6074\n\n\nIMD4\n0.9417\n0.6062\n1.4631\n0.7894\n\n\nIMD5\n0.9857\n0.6443\n1.5078\n0.9469\n\n\ncatFC 50-250\n1.5844\n1.2278\n2.0445\n0.0004\n\n\ncatFC &gt; 250\n2.4138\n1.8192\n3.2028\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3091\n0.9923\n0.5750\n\n\nIMD\n5.8397\n3.9497\n0.2063\n\n\ncat\n2.3232\n1.9815\n0.3093\n\n\nGLOBAL\n8.4076\n13.9400\n0.8643\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Sex,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/demographics/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/demographics/sex.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Sex + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3887\n1.0579\n1.8227\n0.0180\n\n\nIMD2\n0.9220\n0.5365\n1.5844\n0.7688\n\n\nIMD3\n0.9675\n0.5566\n1.6817\n0.9068\n\n\nIMD4\n0.8950\n0.5222\n1.5338\n0.6864\n\n\nIMD5\n0.9035\n0.5370\n1.5199\n0.7021\n\n\ncatFC 50-250\n2.0217\n1.4730\n2.7750\n0.0000\n\n\ncatFC &gt; 250\n3.3366\n2.3693\n4.6989\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.2571\n0.9863\n0.6064\n\n\nIMD\n4.2174\n3.9407\n0.3689\n\n\ncat\n8.8712\n1.9847\n0.0116\n\n\nGLOBAL\n13.9394\n19.6668\n0.8190\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ Sex,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/demographics/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/demographics/sex.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Sex + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5438\n1.2475\n1.9104\n0.0001\n\n\nIMD2\n1.2433\n0.7856\n1.9678\n0.3525\n\n\nIMD3\n1.1010\n0.7025\n1.7255\n0.6748\n\n\nIMD4\n1.4420\n0.9388\n2.2151\n0.0946\n\n\nIMD5\n1.1988\n0.7858\n1.8290\n0.4002\n\n\ncatFC 50-250\n1.5688\n1.2269\n2.0058\n0.0003\n\n\ncatFC &gt; 250\n2.1447\n1.6433\n2.7991\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.3013\n0.9907\n0.2514\n\n\nIMD\n4.0189\n3.9418\n0.3949\n\n\ncat\n5.7453\n1.9706\n0.0550\n\n\nGLOBAL\n11.3236\n18.7016\n0.9037\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Sex,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Sex\",\n  palette = c(\"#1A8FE3\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/demographics/sex.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/demographics/sex.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Sex + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3259\n1.0208\n1.7221\n0.0345\n\n\nIMD2\n1.4092\n0.7861\n2.5260\n0.2494\n\n\nIMD3\n1.3774\n0.7835\n2.4213\n0.2659\n\n\nIMD4\n1.7484\n1.0130\n3.0174\n0.0448\n\n\nIMD5\n1.2989\n0.7566\n2.2298\n0.3430\n\n\ncatFC 50-250\n2.0322\n1.4885\n2.7744\n0.0000\n\n\ncatFC &gt; 250\n3.2203\n2.3245\n4.4614\n0.0000\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1461\n0.9849\n0.6962\n\n\nIMD\n2.6145\n3.9368\n0.6145\n\n\ncat\n4.3647\n1.9671\n0.1096\n\n\nGLOBAL\n7.4355\n23.5846\n0.9994\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#bmi",
    "href": "Survival/Demographics.html#bmi",
    "title": "Demographic data",
    "section": "BMI",
    "text": "BMI\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ BMIcat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"BMI\",\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/demographics/bmi.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/demographics/bmi.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.1473\n1.6736\n2.7550\n0.0000\n\n\nIMD2\n0.8998\n0.5671\n1.4279\n0.6542\n\n\nIMD3\n0.8895\n0.5555\n1.4243\n0.6258\n\n\nIMD4\n0.9343\n0.5951\n1.4667\n0.7676\n\n\nIMD5\n0.9772\n0.6332\n1.5081\n0.9171\n\n\ncatFC 50-250\n1.5540\n1.1972\n2.0170\n0.0009\n\n\ncatFC &gt; 250\n2.2569\n1.6787\n3.0342\n0.0000\n\n\nBMI\n1.0122\n0.9911\n1.0337\n0.2594\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1734\n0.9925\n0.6740\n\n\nIMD\n6.5777\n3.9477\n0.1556\n\n\ncat\n1.5900\n1.9797\n0.4468\n\n\nBMI\n2.3144\n0.9900\n0.1265\n\n\nGLOBAL\n10.2401\n14.8159\n0.7941\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ BMIcat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/demographics/bmi.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/demographics/bmi.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5011\n1.1295\n1.9950\n0.0051\n\n\nIMD2\n0.9513\n0.5451\n1.6599\n0.8604\n\n\nIMD3\n0.9658\n0.5454\n1.7103\n0.9050\n\n\nIMD4\n0.8451\n0.4830\n1.4788\n0.5556\n\n\nIMD5\n0.9334\n0.5478\n1.5906\n0.8001\n\n\ncatFC 50-250\n2.0103\n1.4508\n2.7857\n0.0000\n\n\ncatFC &gt; 250\n3.1451\n2.1945\n4.5074\n0.0000\n\n\nBMI\n1.0200\n0.9949\n1.0456\n0.1187\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.8263\n0.9880\n0.3591\n\n\nIMD\n3.6654\n3.9453\n0.4448\n\n\ncat\n7.2453\n1.9854\n0.0263\n\n\nBMI\n3.8299\n0.9886\n0.0495\n\n\nGLOBAL\n15.1563\n17.4781\n0.6169\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodefit &lt;- survfit(Surv(softflare_time, softflare) ~ BMIcat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/demographics/bmi.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/demographics/bmi.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5667\n1.2601\n1.9478\n0.0001\n\n\nIMD2\n1.2357\n0.7747\n1.9711\n0.3743\n\n\nIMD3\n1.0037\n0.6340\n1.5890\n0.9873\n\n\nIMD4\n1.4156\n0.9159\n2.1878\n0.1177\n\n\nIMD5\n1.1137\n0.7241\n1.7128\n0.6240\n\n\ncatFC 50-250\n1.6181\n1.2586\n2.0803\n0.0002\n\n\ncatFC &gt; 250\n2.1566\n1.6473\n2.8235\n0.0000\n\n\nBMI\n0.9686\n0.9481\n0.9896\n0.0035\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.3437\n0.9904\n0.2438\n\n\nIMD\n3.8474\n3.9456\n0.4189\n\n\ncat\n4.7128\n1.9726\n0.0925\n\n\nBMI\n0.4838\n0.9851\n0.4807\n\n\nGLOBAL\n10.4559\n17.3504\n0.8958\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ BMIcat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  palette = c(\"#1A8FE3\", \"#E76D83\", \"#5FB49C\", \"#FED766\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/demographics/bmi.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/demographics/bmi.png\",\n  width = 7,\n  height = 7,\n  units = \"in\",\n  res = 300\n)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + BMI + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3542\n1.0359\n1.7703\n0.0265\n\n\nIMD2\n1.4226\n0.7804\n2.5931\n0.2499\n\n\nIMD3\n1.3567\n0.7598\n2.4225\n0.3024\n\n\nIMD4\n1.7491\n0.9986\n3.0636\n0.0506\n\n\nIMD5\n1.2764\n0.7316\n2.2270\n0.3902\n\n\ncatFC 50-250\n2.0568\n1.4948\n2.8299\n0.0000\n\n\ncatFC &gt; 250\n3.2137\n2.3058\n4.4790\n0.0000\n\n\nBMI\n0.9808\n0.9558\n1.0065\n0.1415\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1486\n0.9850\n0.6938\n\n\nIMD\n2.5015\n3.9358\n0.6345\n\n\ncat\n3.5648\n1.9672\n0.1640\n\n\nBMI\n0.1512\n0.9853\n0.6915\n\n\nGLOBAL\n6.9035\n22.4944\n0.9993\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\n\nCodesaveRDS(flare.df, paste0(outdir, \"flares-demographics.RDS\"))\nsaveRDS(flare.cd.df, paste0(outdir, \"flares-demographics-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(outdir, \"flares-demographics-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Demographics.html#reproduction-and-reproducibility",
    "href": "Survival/Demographics.html#reproduction-and-reproducibility",
    "title": "Demographic data",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.",
    "crumbs": [
      "Time to flare",
      "Demographic data"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html",
    "href": "Survival/Biochemistry.html",
    "title": "Biochemistry",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n  \nDiagnostics: \\\\newline\n  \n\")\n  \n  cat('\\\\newline\n  \n::: {.panel-tabset} \n\n      ')\n  \n  cat(\"\n  \n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"\\\\newline \n  \n###### Martingale residuals \\\\newline\n      \n      \")\n  \n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\"\\\\newline\n  \n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-IBD.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-IBD-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-IBD-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#introduction",
    "href": "Survival/Biochemistry.html#introduction",
    "title": "Biochemistry",
    "section": "",
    "text": "Codelibrary(readxl)\nlibrary(tidyverse)\nlibrary(datefixR)\nlibrary(survival)\nlibrary(survminer)\nlibrary(pander)\nlibrary(coxme)\nlibrary(finalfit)\nlibrary(DescTools)\nlibrary(gtsummary)\n\n\n# paths to PREdiCCt data\nif (file.exists(\"/docker\")) { # If running in docker\n  data.path &lt;- \"data/final/20221004/\"\n  redcap.path &lt;- \"data/final/20231030/\"\n  prefix &lt;- \"data/end-of-follow-up/\"\n  outdir &lt;- \"data/processed/\"\n} else { # Run on OS directly\n  data.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/\"\n  redcap.path &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/\"\n  prefix &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/\"\n  outdir &lt;- \"/Volumes/igmm/cvallejo-predicct/predicct/processed/\"\n}\n\ndemo &lt;- readRDS(paste0(outdir, \"demo-full.RDS\"))\ndemo$FC &lt;- log(demo$FC)\n\ncox.summary &lt;- function(fit) {\n  cat(\"Cox model summary:\")\n  fit %&gt;%\n    finalfit::fit2df(condense = FALSE) %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"Variable\",\n        \"HR\",\n        \"Lower 95%\",\n        \"Upper 95%\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n  \nDiagnostics: \\\\newline\n  \n\")\n  \n  cat('\\\\newline\n  \n::: {.panel-tabset} \n\n      ')\n  \n  cat(\"\n  \n###### Proportional hazards assumption test \\\\newline\n\n  \")\n  cox.zph(fit)$table %&gt;%\n    knitr::kable(\n      col.names = c(\n        \"\",\n        \"Chi-squared statistic\",\n        \"DF\",\n        \"P-value\"\n      ),\n      digits = 4\n    ) %&gt;%\n    print()\n  \n  cat(\"\\\\newline\n\n###### DF betas \\\\newline\n\n  \")\n  \n  print(ggcoxdiagnostics(fit, type = \"dfbeta\"))\n  \n  cat(\"\\\\newline \n  \n###### Martingale residuals \\\\newline\n      \n      \")\n  \n  print(ggcoxdiagnostics(fit, type = \"martingale\", linear.predictions = TRUE))\n  \n  cat(\"\\\\newline\n  \n:::\n\n      \")\n  return()\n}\n\nflare.df &lt;- readRDS(paste0(outdir, \"flares-IBD.RDS\"))\nflare.cd.df &lt;- readRDS(paste0(outdir, \"flares-IBD-cd.RDS\"))\nflare.uc.df &lt;- readRDS(paste0(outdir, \"flares-IBD-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#c-reactive-protein",
    "href": "Survival/Biochemistry.html#c-reactive-protein",
    "title": "Biochemistry",
    "section": "C-reactive protein",
    "text": "C-reactive protein\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.cd.df$CReactiveProtein_cat &lt;- cut(flare.cd.df$CReactiveProtein, \n                                        c(0, 5, 10.0000001, Inf),\n                                        labels = c(\"CRP &lt; 5\",\n                                                   \"5 ≤ CRP ≤ 10\",\n                                                   \"CRP &gt; 10\"),\n                                        include.lowest = TRUE,\n                                        right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ CReactiveProtein_cat,\n               data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"CRP\",\n  legend.labs = levels(flare.cd.df$CReactiveProtein_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/biochem/crp.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/biochem/crp.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.5114\n1.9050\n3.3108\n0.0000\n\n\nIMD2\n1.2280\n0.7064\n2.1346\n0.4666\n\n\nIMD3\n1.0639\n0.6055\n1.8696\n0.8294\n\n\nIMD4\n1.2974\n0.7536\n2.2335\n0.3476\n\n\nIMD5\n1.1735\n0.6914\n1.9917\n0.5535\n\n\ncatFC 50-250\n1.5652\n1.1720\n2.0903\n0.0024\n\n\ncatFC &gt; 250\n2.4876\n1.8060\n3.4265\n0.0000\n\n\nCReactiveProtein\n1.0017\n0.9894\n1.0141\n0.7891\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1347\n0.9918\n0.7104\n\n\nIMD\n1.5655\n3.9514\n0.8093\n\n\ncat\n3.5876\n1.9800\n0.1637\n\n\nCReactiveProtein\n2.2628\n0.9912\n0.1310\n\n\nGLOBAL\n6.8886\n14.0404\n0.9400\n\n\n\n\n\nWarning: `gather_()` was deprecated in tidyr 1.2.0.\nℹ Please use `gather()` instead.\nℹ The deprecated feature was likely used in the survminer package.\n  Please report the issue at &lt;https://github.com/kassambara/survminer/issues&gt;.\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ CReactiveProtein_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"CRP\",\n  legend.labs = levels(flare.cd.df$CReactiveProtein_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\n\ncairo_pdf(\"plots/cd/hard-flare/biochem/crp.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/biochem/crp.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5403\n1.1285\n2.1022\n0.0065\n\n\nIMD2\n1.1741\n0.5904\n2.3348\n0.6472\n\n\nIMD3\n1.1512\n0.5724\n2.3152\n0.6929\n\n\nIMD4\n1.2896\n0.6580\n2.5274\n0.4587\n\n\nIMD5\n1.2097\n0.6295\n2.3247\n0.5678\n\n\ncatFC 50-250\n2.0009\n1.3908\n2.8786\n0.0002\n\n\ncatFC &gt; 250\n3.0710\n2.0784\n4.5375\n0.0000\n\n\nCReactiveProtein\n1.0088\n0.9995\n1.0181\n0.0635\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n3.3489\n0.9880\n0.0661\n\n\nIMD\n2.8908\n3.9532\n0.5689\n\n\ncat\n6.8059\n1.9875\n0.0329\n\n\nCReactiveProtein\n2.7995\n0.9941\n0.0935\n\n\nGLOBAL\n15.7224\n14.4155\n0.3594\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$CReactiveProtein_cat &lt;- cut(flare.uc.df$CReactiveProtein, \n                                        c(0, 5, 10.0000001, Inf),\n                                        labels = c(\"CRP &lt; 5\",\n                                                   \"5 ≤ CRP ≤ 10\",\n                                                   \"CRP &gt; 10\"),\n                                        include.lowest = TRUE,\n                                        right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ CReactiveProtein_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"CRP\",\n  legend.labs = levels(flare.uc.df$CReactiveProtein_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/biochem/crp.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/biochem/crp.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6446\n1.2924\n2.0926\n0.0001\n\n\nIMD2\n1.2409\n0.7406\n2.0790\n0.4124\n\n\nIMD3\n1.0484\n0.6261\n1.7557\n0.8573\n\n\nIMD4\n1.4396\n0.8833\n2.3463\n0.1437\n\n\nIMD5\n1.1606\n0.7198\n1.8712\n0.5412\n\n\ncatFC 50-250\n1.5937\n1.2038\n2.1098\n0.0011\n\n\ncatFC &gt; 250\n2.2826\n1.6943\n3.0753\n0.0000\n\n\nCReactiveProtein\n1.0018\n0.9860\n1.0179\n0.8258\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.0669\n0.9902\n0.1487\n\n\nIMD\n2.5721\n3.9299\n0.6209\n\n\ncat\n4.4034\n1.9631\n0.1072\n\n\nCReactiveProtein\n4.3050\n0.9837\n0.0371\n\n\nGLOBAL\n12.9174\n19.3120\n0.8555\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ CReactiveProtein_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"CRP\",\n  legend.labs = levels(flare.uc.df$CReactiveProtein_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/biochem/crp.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/biochem/crp.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + CReactiveProtein + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2811\n0.9631\n1.7040\n0.0888\n\n\nIMD2\n1.6713\n0.8545\n3.2688\n0.1335\n\n\nIMD3\n1.3587\n0.6949\n2.6563\n0.3702\n\n\nIMD4\n1.9141\n1.0067\n3.6396\n0.0477\n\n\nIMD5\n1.5133\n0.8053\n2.8437\n0.1981\n\n\ncatFC 50-250\n2.0323\n1.4449\n2.8585\n0.0000\n\n\ncatFC &gt; 250\n3.0334\n2.1208\n4.3386\n0.0000\n\n\nCReactiveProtein\n0.9953\n0.9739\n1.0170\n0.6666\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.4924\n0.9867\n0.4775\n\n\nIMD\n0.8766\n3.9347\n0.9236\n\n\ncat\n3.9346\n1.9653\n0.1359\n\n\nCReactiveProtein\n0.0770\n0.9850\n0.7758\n\n\nGLOBAL\n5.4018\n21.3499\n0.9998\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#haemoglobin",
    "href": "Survival/Biochemistry.html#haemoglobin",
    "title": "Biochemistry",
    "section": "Haemoglobin",
    "text": "Haemoglobin\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.cd.df$Haemoglobin_cat &lt;- cut(flare.cd.df$Haemoglobin,\n                                   quantile(flare.df$Haemoglobin,\n                                            na.rm = TRUE),\n                                   include.lowest = TRUE,\n                                   right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Haemoglobin_cat,\n               data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Haemoglobin\",\n  legend.labs = levels(flare.cd.df$Haemoglobin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/biochem/haemoglobin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/biochem/haemoglobin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.0755\n1.5455\n2.7872\n0.0000\n\n\nIMD2\n1.1381\n0.6728\n1.9251\n0.6296\n\n\nIMD3\n1.0670\n0.6274\n1.8145\n0.8109\n\n\nIMD4\n1.1227\n0.6698\n1.8817\n0.6605\n\n\nIMD5\n1.0728\n0.6506\n1.7690\n0.7830\n\n\ncatFC 50-250\n1.5963\n1.2125\n2.1017\n0.0009\n\n\ncatFC &gt; 250\n2.5652\n1.8900\n3.4818\n0.0000\n\n\nHaemoglobin\n0.9925\n0.9829\n1.0023\n0.1330\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3008\n0.9904\n0.5794\n\n\nIMD\n4.2401\n3.9529\n0.3678\n\n\ncat\n4.1442\n1.9827\n0.1241\n\n\nHaemoglobin\n1.2177\n0.9929\n0.2677\n\n\nGLOBAL\n9.2130\n13.9190\n0.8127\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Haemoglobin_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Haemoglobin\",\n  legend.labs = levels(flare.cd.df$Haemoglobin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/biochem/haemoglobin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/biochem/haemoglobin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3499\n0.9565\n1.9051\n0.0878\n\n\nIMD2\n1.0105\n0.5316\n1.9207\n0.9745\n\n\nIMD3\n1.1379\n0.5964\n2.1711\n0.6951\n\n\nIMD4\n1.0484\n0.5581\n1.9694\n0.8832\n\n\nIMD5\n0.9917\n0.5397\n1.8221\n0.9785\n\n\ncatFC 50-250\n2.0550\n1.4486\n2.9154\n0.0001\n\n\ncatFC &gt; 250\n3.5176\n2.4149\n5.1238\n0.0000\n\n\nHaemoglobin\n0.9956\n0.9841\n1.0072\n0.4523\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.8560\n0.9871\n0.0894\n\n\nIMD\n3.7488\n3.9454\n0.4328\n\n\ncat\n9.7005\n1.9849\n0.0077\n\n\nHaemoglobin\n6.8981\n0.9911\n0.0085\n\n\nGLOBAL\n20.8165\n18.9811\n0.3459\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$Haemoglobin_cat &lt;- cut(flare.uc.df$Haemoglobin,\n                                   quantile(flare.df$Haemoglobin,\n                                            na.rm = TRUE),\n                                   include.lowest = TRUE,\n                                   right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Haemoglobin_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Haemoglobin\",\n  legend.labs = levels(flare.uc.df$Haemoglobin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/biochem/haemoglobin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/biochem/haemoglobin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3056\n0.9811\n1.7374\n0.0674\n\n\nIMD2\n1.2309\n0.7538\n2.0100\n0.4064\n\n\nIMD3\n0.8915\n0.5417\n1.4672\n0.6515\n\n\nIMD4\n1.1646\n0.7272\n1.8651\n0.5261\n\n\nIMD5\n1.1289\n0.7162\n1.7792\n0.6016\n\n\ncatFC 50-250\n1.6837\n1.2762\n2.2213\n0.0002\n\n\ncatFC &gt; 250\n2.1975\n1.6335\n2.9564\n0.0000\n\n\nHaemoglobin\n0.9857\n0.9748\n0.9967\n0.0112\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.9971\n0.9836\n0.3127\n\n\nIMD\n3.7353\n3.9192\n0.4308\n\n\ncat\n5.1028\n1.9606\n0.0752\n\n\nHaemoglobin\n0.0154\n0.9753\n0.8949\n\n\nGLOBAL\n10.3959\n22.0376\n0.9826\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Haemoglobin_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Haemoglobin\",\n  legend.labs = levels(flare.uc.df$Haemoglobin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/biochem/haemoglobin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/biochem/haemoglobin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Haemoglobin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.2574\n0.8991\n1.7585\n0.1808\n\n\nIMD2\n1.3618\n0.7341\n2.5262\n0.3274\n\n\nIMD3\n1.0655\n0.5713\n1.9873\n0.8418\n\n\nIMD4\n1.4946\n0.8265\n2.7028\n0.1837\n\n\nIMD5\n1.2655\n0.7096\n2.2568\n0.4250\n\n\ncatFC 50-250\n1.9287\n1.3727\n2.7100\n0.0002\n\n\ncatFC &gt; 250\n2.9167\n2.0447\n4.1607\n0.0000\n\n\nHaemoglobin\n0.9932\n0.9804\n1.0062\n0.3018\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0292\n0.9843\n0.8597\n\n\nIMD\n1.7907\n3.9323\n0.7653\n\n\ncat\n5.0265\n1.9652\n0.0785\n\n\nHaemoglobin\n0.8658\n0.9821\n0.3459\n\n\nGLOBAL\n7.2975\n21.3166\n0.9979\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#white-cell-count",
    "href": "Survival/Biochemistry.html#white-cell-count",
    "title": "Biochemistry",
    "section": "White cell count",
    "text": "White cell count\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.cd.df$WCC_cat &lt;- cut(flare.cd.df$WCC,\n                                   quantile(flare.df$WCC,\n                                            na.rm = TRUE),\n                                   include.lowest = TRUE,\n                                   right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ WCC_cat,\n               data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"White cell count\",\n  legend.labs = levels(flare.cd.df$WCC_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/biochem/wcc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/biochem/wcc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.3006\n1.7747\n2.9823\n0.0000\n\n\nIMD2\n1.1384\n0.6732\n1.9253\n0.6287\n\n\nIMD3\n1.0421\n0.6124\n1.7731\n0.8792\n\n\nIMD4\n1.1244\n0.6710\n1.8841\n0.6561\n\n\nIMD5\n1.0864\n0.6591\n1.7906\n0.7452\n\n\ncatFC 50-250\n1.5984\n1.2140\n2.1045\n0.0008\n\n\ncatFC &gt; 250\n2.6410\n1.9506\n3.5758\n0.0000\n\n\nWCC\n1.0101\n0.9727\n1.0490\n0.6023\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.3188\n0.9923\n0.5691\n\n\nIMD\n4.2450\n3.9543\n0.3674\n\n\ncat\n4.1388\n1.9840\n0.1246\n\n\nWCC\n0.5574\n0.9899\n0.4513\n\n\nGLOBAL\n8.7191\n13.4184\n0.8182\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ WCC_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"White cell count\",\n  legend.labs = levels(flare.cd.df$WCC_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/biochem/wcc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/biochem/wcc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4211\n1.0561\n1.9123\n0.0203\n\n\nIMD2\n1.0084\n0.5306\n1.9167\n0.9795\n\n\nIMD3\n1.1067\n0.5800\n2.1115\n0.7585\n\n\nIMD4\n1.0548\n0.5616\n1.9811\n0.8682\n\n\nIMD5\n1.0054\n0.5472\n1.8474\n0.9861\n\n\ncatFC 50-250\n2.0582\n1.4509\n2.9199\n0.0001\n\n\ncatFC &gt; 250\n3.5382\n2.4336\n5.1442\n0.0000\n\n\nWCC\n1.0336\n0.9885\n1.0809\n0.1468\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.7970\n0.9858\n0.0926\n\n\nIMD\n3.6523\n3.9454\n0.4468\n\n\ncat\n9.7104\n1.9851\n0.0077\n\n\nWCC\n2.9462\n0.9726\n0.0829\n\n\nGLOBAL\n19.9546\n18.6478\n0.3752\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$WCC_cat &lt;- cut(flare.uc.df$WCC,\n                                   quantile(flare.df$WCC,\n                                            na.rm = TRUE),\n                                   include.lowest = TRUE,\n                                   right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ WCC_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"White cell count\",\n  legend.labs = levels(flare.uc.df$WCC_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/biochem/wcc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/biochem/wcc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.6030\n1.2625\n2.0353\n0.0001\n\n\nIMD2\n1.2114\n0.7424\n1.9766\n0.4427\n\n\nIMD3\n0.9092\n0.5532\n1.4945\n0.7075\n\n\nIMD4\n1.1339\n0.7087\n1.8142\n0.6002\n\n\nIMD5\n1.1158\n0.7084\n1.7576\n0.6364\n\n\ncatFC 50-250\n1.6685\n1.2628\n2.2047\n0.0003\n\n\ncatFC &gt; 250\n2.1548\n1.5941\n2.9127\n0.0000\n\n\nWCC\n1.0834\n1.0230\n1.1475\n0.0062\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n1.0472\n0.9870\n0.3020\n\n\nIMD\n3.5238\n3.9210\n0.4621\n\n\ncat\n4.8428\n1.9607\n0.0857\n\n\nWCC\n0.3476\n0.9723\n0.5439\n\n\nGLOBAL\n9.5136\n22.3170\n0.9916\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ WCC_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"White cell count\",\n  legend.labs = levels(flare.uc.df$WCC_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/biochem/wcc.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/biochem/wcc.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + WCC + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3848\n1.0406\n1.8428\n0.0256\n\n\nIMD2\n1.3707\n0.7387\n2.5434\n0.3174\n\n\nIMD3\n1.0676\n0.5725\n1.9910\n0.8370\n\n\nIMD4\n1.4771\n0.8170\n2.6706\n0.1967\n\n\nIMD5\n1.2764\n0.7159\n2.2756\n0.4082\n\n\ncatFC 50-250\n1.9211\n1.3662\n2.7012\n0.0002\n\n\ncatFC &gt; 250\n2.8875\n2.0164\n4.1351\n0.0000\n\n\nWCC\n1.0417\n0.9716\n1.1169\n0.2504\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.0397\n0.9850\n0.8373\n\n\nIMD\n1.7908\n3.9311\n0.7652\n\n\ncat\n5.0693\n1.9653\n0.0768\n\n\nWCC\n0.4463\n0.9791\n0.4955\n\n\nGLOBAL\n6.8088\n21.7201\n0.9990\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#albumin",
    "href": "Survival/Biochemistry.html#albumin",
    "title": "Biochemistry",
    "section": "Albumin",
    "text": "Albumin\nCrohn’s disease\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.cd.df$Albumin_cat &lt;- cut(flare.cd.df$Albumin,\n                                   quantile(flare.df$Albumin,\n                                            na.rm = TRUE),\n                                   include.lowest = TRUE,\n                                   right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Albumin_cat,\n               data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Albumin\",\n  legend.labs = levels(flare.cd.df$Albumin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/cd/soft-flare/biochem/albumin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/soft-flare/biochem/albumin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n2.2704\n1.7358\n2.9697\n0.0000\n\n\nIMD2\n1.1975\n0.7005\n2.0474\n0.5100\n\n\nIMD3\n1.1051\n0.6436\n1.8976\n0.7170\n\n\nIMD4\n1.1570\n0.6824\n1.9617\n0.5882\n\n\nIMD5\n1.1152\n0.6683\n1.8609\n0.6765\n\n\ncatFC 50-250\n1.6516\n1.2460\n2.1892\n0.0005\n\n\ncatFC &gt; 250\n2.4799\n1.8009\n3.4147\n0.0000\n\n\nAlbumin\n0.9835\n0.9596\n1.0081\n0.1877\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.5738\n0.9985\n0.4481\n\n\nIMD\n3.8357\n3.9888\n0.4270\n\n\ncat\n6.5059\n1.9965\n0.0385\n\n\nAlbumin\n0.1594\n0.9803\n0.6816\n\n\nGLOBAL\n10.7187\n8.8662\n0.2846\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Albumin_cat,\n  data = flare.cd.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.cd.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Albumin\",\n  legend.labs = levels(flare.cd.df$Albumin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/cd/hard-flare/biochem/albumin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/cd/hard-flare/biochem/albumin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.cd.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.4446\n1.0621\n1.9646\n0.0191\n\n\nIMD2\n0.9964\n0.5236\n1.8963\n0.9913\n\n\nIMD3\n1.0062\n0.5244\n1.9306\n0.9852\n\n\nIMD4\n0.9927\n0.5269\n1.8700\n0.9818\n\n\nIMD5\n0.9065\n0.4904\n1.6756\n0.7541\n\n\ncatFC 50-250\n2.1095\n1.4746\n3.0179\n0.0000\n\n\ncatFC &gt; 250\n3.2938\n2.2145\n4.8992\n0.0000\n\n\nAlbumin\n1.0071\n0.9709\n1.0446\n0.7043\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n2.5520\n0.9880\n0.1084\n\n\nIMD\n6.0553\n3.9539\n0.1906\n\n\ncat\n8.7501\n1.9867\n0.0124\n\n\nAlbumin\n2.6129\n0.9046\n0.0928\n\n\nGLOBAL\n19.4962\n16.0639\n0.2473\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nUlcerative colitis\n\n\nSoft flare\nHard flare\n\n\n\nCodeflare.uc.df$Albumin_cat &lt;- cut(flare.uc.df$Albumin,\n                                   quantile(flare.df$Albumin,\n                                            na.rm = TRUE),\n                                   include.lowest = TRUE,\n                                   right = FALSE)\n\nfit &lt;- survfit(Surv(softflare_time, softflare) ~ Albumin_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Albumin\",\n  legend.labs = levels(flare.uc.df$Albumin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to soft flare\",\n  break.time.by = 200\n)\n\ncairo_pdf(\"plots/uc/soft-flare/biochem/albumin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/soft-flare/biochem/albumin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(softflare_time, softflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.5516\n1.2175\n1.9773\n0.0004\n\n\nIMD2\n1.1036\n0.6697\n1.8185\n0.6990\n\n\nIMD3\n0.9271\n0.5653\n1.5205\n0.7644\n\n\nIMD4\n1.1778\n0.7403\n1.8739\n0.4897\n\n\nIMD5\n1.0943\n0.6955\n1.7218\n0.6966\n\n\ncatFC 50-250\n1.7423\n1.3140\n2.3103\n0.0001\n\n\ncatFC &gt; 250\n2.1971\n1.6288\n2.9637\n0.0000\n\n\nAlbumin\n0.9775\n0.9514\n1.0043\n0.0996\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.9351\n0.9883\n0.3296\n\n\nIMD\n5.0458\n3.9409\n0.2754\n\n\ncat\n4.4764\n1.9667\n0.1036\n\n\nAlbumin\n0.0124\n0.8768\n0.8787\n\n\nGLOBAL\n10.2249\n18.1402\n0.9279\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\nCodefit &lt;- survfit(Surv(hardflare_time, hardflare) ~ Albumin_cat,\n  data = flare.uc.df\n)\n\np &lt;- ggsurvplot(fit,\n  data = flare.uc.df,\n  conf.int = TRUE,\n  pval = TRUE,\n  pval.method = TRUE,\n  ggtheme = theme_minimal(),\n  risk.table = TRUE,\n  legend.title = \"Albumin\",\n  legend.labs = levels(flare.uc.df$Albumin_cat),\n  palette = c(\"#1A8FE3\", \"#FED766\", \"orange\", \"#E76D83\"),\n  xlab = \"Time from study recrutiment (days)\",\n  title = \"Time to hard flare\",\n  break.time.by = 500\n)\n\ncairo_pdf(\"plots/uc/hard-flare/biochem/albumin.pdf\")\np\ninvisible(dev.off())\n\npng(\"plots/uc/hard-flare/biochem/albumin.png\",\n    width = 7,\n    height = 7,\n    units = \"in\",\n    res = 300)\np\ninvisible(dev.off())\n\np\n\nCodefit.me &lt;- coxph(\n  Surv(hardflare_time, hardflare) ~\n    Sex + IMD + cat + Albumin + frailty(SiteNo),\n  control = coxph.control(outer.max = 20),\n  data = flare.uc.df\n)\ninvisible(cox.summary(fit.me))\nCox model summary:\n\n\nVariable\nHR\nLower 95%\nUpper 95%\nP-value\n\n\n\nSexFemale\n1.3243\n0.9879\n1.7754\n0.0603\n\n\nIMD2\n1.2614\n0.6707\n2.3723\n0.4711\n\n\nIMD3\n1.0544\n0.5654\n1.9662\n0.8678\n\n\nIMD4\n1.4427\n0.7995\n2.6033\n0.2236\n\n\nIMD5\n1.2662\n0.7108\n2.2558\n0.4230\n\n\ncatFC 50-250\n1.9480\n1.3707\n2.7685\n0.0002\n\n\ncatFC &gt; 250\n2.8956\n2.0192\n4.1525\n0.0000\n\n\nAlbumin\n0.9866\n0.9573\n1.0168\n0.3798\n\n\n\nDiagnostics: \n\n\nProportional hazards assumption test \nDF betas \nMartingale residuals \n\n\n\n\n\n\nChi-squared statistic\nDF\nP-value\n\n\n\nSex\n0.1590\n0.9858\n0.6843\n\n\nIMD\n1.5380\n3.9411\n0.8130\n\n\ncat\n4.2686\n1.9686\n0.1152\n\n\nAlbumin\n0.3438\n0.9039\n0.5165\n\n\nGLOBAL\n6.1498\n19.9849\n0.9987\n\n\n\n\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n`geom_smooth()` using formula = 'y ~ x'",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  },
  {
    "objectID": "Survival/Biochemistry.html#reproduction-and-reproducibility",
    "href": "Survival/Biochemistry.html#reproduction-and-reproducibility",
    "title": "Biochemistry",
    "section": "Reproduction and reproducibility",
    "text": "Reproduction and reproducibility\n\nSession info\n\n\nR version 4.4.0 (2024-04-24)\nPlatform: aarch64-unknown-linux-gnu\nlocale: LC_CTYPE=en_US.UTF-8, LC_NUMERIC=C, LC_TIME=en_US.UTF-8, LC_COLLATE=en_US.UTF-8, LC_MONETARY=en_US.UTF-8, LC_MESSAGES=en_US.UTF-8, LC_PAPER=en_US.UTF-8, LC_NAME=C, LC_ADDRESS=C, LC_TELEPHONE=C, LC_MEASUREMENT=en_US.UTF-8 and LC_IDENTIFICATION=C\nattached base packages: stats, graphics, grDevices, utils, datasets, methods and base\nother attached packages: gtsummary(v.1.7.2), DescTools(v.0.99.54), finalfit(v.1.0.7), coxme(v.2.2-20), bdsmatrix(v.1.3-7), pander(v.0.6.5), survminer(v.0.4.9), ggpubr(v.0.6.0), survival(v.3.5-8), datefixR(v.1.6.1), lubridate(v.1.9.3), forcats(v.1.0.0), stringr(v.1.5.1), dplyr(v.1.1.4), purrr(v.1.0.2), readr(v.2.1.5), tidyr(v.1.3.1), tibble(v.3.2.1), ggplot2(v.3.5.1), tidyverse(v.2.0.0) and readxl(v.1.4.3)\nloaded via a namespace (and not attached): gridExtra(v.2.3), gld(v.2.6.6), rlang(v.1.1.3), magrittr(v.2.0.3), e1071(v.1.7-14), compiler(v.4.4.0), mgcv(v.1.9-1), vctrs(v.0.6.5), pkgconfig(v.2.0.3), shape(v.1.4.6.1), fastmap(v.1.2.0), backports(v.1.5.0), labeling(v.0.4.3), KMsurv(v.0.1-5), utf8(v.1.2.4), rmarkdown(v.2.27), markdown(v.1.12), tzdb(v.0.4.0), nloptr(v.2.0.3), xfun(v.0.44), glmnet(v.4.1-8), jomo(v.2.7-6), jsonlite(v.1.8.8), pan(v.1.9), broom(v.1.0.6), R6(v.2.5.1), stringi(v.1.8.4), car(v.3.1-2), boot(v.1.3-30), rpart(v.4.1.23), cellranger(v.1.1.0), Rcpp(v.1.0.12), iterators(v.1.0.14), knitr(v.1.47), zoo(v.1.8-12), Matrix(v.1.7-0), splines(v.4.4.0), nnet(v.7.3-19), timechange(v.0.3.0), tidyselect(v.1.2.1), rstudioapi(v.0.16.0), abind(v.1.4-5), yaml(v.2.3.8), ggtext(v.0.1.2), codetools(v.0.2-20), lattice(v.0.22-6), withr(v.3.0.0), evaluate(v.0.23), proxy(v.0.4-27), xml2(v.1.3.6), survMisc(v.0.5.6), pillar(v.1.9.0), carData(v.3.0-5), mice(v.3.16.0), foreach(v.1.5.2), generics(v.0.1.3), hms(v.1.1.3), commonmark(v.1.9.1), munsell(v.0.5.1), scales(v.1.3.0), rootSolve(v.1.8.2.4), minqa(v.1.2.7), xtable(v.1.8-4), class(v.7.3-22), glue(v.1.7.0), lmom(v.3.0), tools(v.4.4.0), data.table(v.1.15.4), lme4(v.1.1-35.3), ggsignif(v.0.6.4), Exact(v.3.2), mvtnorm(v.1.2-5), grid(v.4.4.0), colorspace(v.2.1-0), nlme(v.3.1-164), cli(v.3.6.2), km.ci(v.0.5-6), fansi(v.1.0.6), expm(v.0.999-9), broom.helpers(v.1.15.0), gt(v.0.10.1), gtable(v.0.3.5), rstatix(v.0.7.2), digest(v.0.6.35), farver(v.2.1.2), htmlwidgets(v.1.6.4), htmltools(v.0.5.8.1), lifecycle(v.1.0.4), httr(v.1.4.7), mitml(v.0.4-5), gridtext(v.0.1.5) and MASS(v.7.3-60.2)\n\n\nLicensed by CC BY unless otherwise stated.\n\nCodesaveRDS(flare.df, paste0(outdir, \"flares-biochem.RDS\"))\nsaveRDS(flare.cd.df, paste0(outdir, \"flares-biochem-cd.RDS\"))\nsaveRDS(flare.uc.df, paste0(outdir, \"flares-biochem-uc.RDS\"))",
    "crumbs": [
      "Time to flare",
      "Biochemistry"
    ]
  }
]