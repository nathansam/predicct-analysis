<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Nathan Constantine-Cooke">
<meta name="author" content="Chiara Cotronei">
<meta name="dcterms.date" content="2024-11-27">
<title>PREdiCCt analyses - Inflammatory bowel disease</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../Baseline/Biochemistry.html" rel="next">
<link href="../Baseline/Demographics.html" rel="prev">
<link href="../../images/favicon.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script><script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script><script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">
<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
<meta property="og:title" content="PREdiCCt analyses - Inflammatory bowel disease">
<meta property="og:description" content="">
<meta property="og:site_name" content="PREdiCCt analyses">
<meta name="twitter:title" content="PREdiCCt analyses - Inflammatory bowel disease">
<meta name="twitter:description" content="">
<meta name="twitter:creator" content="@IBDNathan">
<meta name="twitter:site" content="@EdinUni_IGC">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="Inflammatory bowel disease">
<meta name="citation_author" content="Nathan Constantine-Cooke">
<meta name="citation_author" content="Chiara Cotronei">
<meta name="citation_publication_date" content="2024-11-27">
<meta name="citation_cover_date" content="2024-11-27">
<meta name="citation_year" content="2024">
<meta name="citation_online_date" content="2024-11-27">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=Location is important: Differentiation between ileal and colonic crohn’s disease;,citation_author=Raja Atreya;,citation_author=Britta Siegmund;,citation_publication_date=2021-03;,citation_cover_date=2021-03;,citation_year=2021;,citation_fulltext_html_url=http://dx.doi.org/10.1038/s41575-021-00424-6;,citation_issue=8;,citation_doi=10.1038/s41575-021-00424-6;,citation_issn=1759-5053;,citation_volume=18;,citation_journal_title=Nature Reviews Gastroenterology &amp;amp;amp; Hepatology;,citation_publisher=Springer Science; Business Media LLC;">
<meta name="citation_reference" content="citation_title=Between-assay variability of faecal calprotectin enzyme-linked immunosorbent assay kits;,citation_author=S J Whitehead;,citation_author=J French;,citation_author=M J Brookes;,citation_author=C Ford;,citation_author=R Gama;,citation_publication_date=2012-11;,citation_cover_date=2012-11;,citation_year=2012;,citation_fulltext_html_url=http://dx.doi.org/10.1258/acb.2012.011272;,citation_issue=1;,citation_doi=10.1258/acb.2012.011272;,citation_issn=1758-1001;,citation_volume=50;,citation_journal_title=Annals of Clinical Biochemistry: International Journal of Laboratory Medicine;,citation_publisher=SAGE Publications;">
<meta name="citation_reference" content="citation_title=IBD prevalence in lothian, scotland, derived by capture–recapture methodology;,citation_author=Gareth-Rhys Jones;,citation_author=Mathew Lyons;,citation_author=Nikolas Plevris;,citation_author=Philip W Jenkinson;,citation_author=Cathy Bisset;,citation_author=Christopher Burgess;,citation_author=Shahida Din;,citation_author=James Fulforth;,citation_author=Paul Henderson;,citation_author=Gwo-Tzer Ho;,citation_author=Kathryn Kirkwood;,citation_author=Colin Noble;,citation_author=Alan G Shand;,citation_author=David C Wilson;,citation_author=Ian DR Arnott;,citation_author=Charlie W Lees;,citation_publication_date=2019-07;,citation_cover_date=2019-07;,citation_year=2019;,citation_fulltext_html_url=http://dx.doi.org/10.1136/gutjnl-2019-318936;,citation_issue=11;,citation_doi=10.1136/gutjnl-2019-318936;,citation_issn=1468-3288;,citation_volume=68;,citation_journal_title=Gut;,citation_publisher=BMJ;">
<meta name="citation_reference" content="citation_title=Development and validation of a rapid, generic measure of disease control from the patient’s perspective: The IBD-control questionnaire;,citation_author=Keith Bodger;,citation_author=Clare Ormerod;,citation_author=Daniela Shackcloth;,citation_author=Melanie Harrison;,citation_publication_date=2013-10;,citation_cover_date=2013-10;,citation_year=2013;,citation_fulltext_html_url=http://dx.doi.org/10.1136/gutjnl-2013-305600;,citation_issue=7;,citation_doi=10.1136/gutjnl-2013-305600;,citation_issn=1468-3288;,citation_volume=63;,citation_journal_title=Gut;,citation_publisher=BMJ;">
<meta name="citation_reference" content="citation_title=The UN decade of nutrition, the NOVA food classification and the trouble with ultra-processing;,citation_author=Carlos Augusto Monteiro;,citation_author=Geoffrey Cannon;,citation_author=Jean-Claude Moubarac;,citation_author=Renata Bertazzi Levy;,citation_author=Maria Laura C Louzada;,citation_author=Patrícia Constante Jaime;,citation_publication_date=2017-03;,citation_cover_date=2017-03;,citation_year=2017;,citation_fulltext_html_url=http://dx.doi.org/10.1017/S1368980017000234;,citation_issue=1;,citation_doi=10.1017/s1368980017000234;,citation_issn=1475-2727;,citation_volume=21;,citation_journal_title=Public Health Nutrition;,citation_publisher=Cambridge University Press;">
<meta name="citation_reference" content="citation_title=A prospective study of long-term intake of dietary fiber and risk of Crohn’s disease and ulcerative colitis;,citation_author=Ashwin N. Ananthakrishnan;,citation_author=Hamed Khalili;,citation_author=Gauree G. Konijeti;,citation_author=Leslie M. Higuchi;,citation_author=Punyanganie Silva;,citation_author=Joshua R. Korzenik;,citation_author=Charles S. Fuchs;,citation_author=Walter C. Willett;,citation_author=James M. Richter;,citation_author=Andrew T. Chan;,citation_publication_date=2013-11;,citation_cover_date=2013-11;,citation_year=2013;,citation_issue=5;,citation_doi=10.1053/j.gastro.2013.07.050;,citation_volume=145;,citation_journal_title=Gastroenterology;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=Avoidance of fiber is associated with greater risk of Crohn’s disease flare in a 6-month period;,citation_author=Carol S. Brotherton;,citation_author=Christopher A. Martin;,citation_author=Millie D. Long;,citation_author=Michael D. Kappelman;,citation_author=Robert S. Sandler;,citation_publication_date=2016-08;,citation_cover_date=2016-08;,citation_year=2016;,citation_issue=8;,citation_doi=10.1016/j.cgh.2015.12.029;,citation_volume=14;,citation_journal_title=Clinical Gastroenterology and Hepatology;,citation_publisher=Elsevier BV;">
<meta name="citation_reference" content="citation_title=Polyunsaturated fatty acids in inflammatory bowel diseases: A reappraisal of effects and therapeutic approaches;,citation_author=Rachel Marion-Letellier;,citation_author=Guillaume Savoye;,citation_author=Beck Paul L.;,citation_author=Remo Panaccione;,citation_author=Subrata Ghosh;,citation_publication_date=2013-03;,citation_cover_date=2013-03;,citation_year=2013;,citation_fulltext_html_url=http://dx.doi.org/10.1097/MIB.0b013e3182810122;,citation_issue=3;,citation_doi=10.1097/mib.0b013e3182810122;,citation_issn=1078-0998;,citation_volume=19;,citation_journal_title=Inflammatory Bowel Diseases;,citation_publisher=Oxford University Press;">
<meta name="citation_reference" content="citation_title=Association of ultra-processed food intake with risk of inflammatory bowel disease: Prospective cohort study;,citation_author=Neeraj Narula;,citation_author=Emily C L Wong;,citation_author=Mahshid Dehghan;,citation_author=Andrew Mente;,citation_author=Sumathy Rangarajan;,citation_author=Fernando Lanas;,citation_author=Patricio Lopez-Jaramillo;,citation_author=Priyanka Rohatgi;,citation_author=P V M Lakshmi;,citation_author=Ravi Prasad Varma;,citation_author=Andres Orlandini;,citation_author=Alvaro Avezum;,citation_author=Andreas Wielgosz;,citation_author=Paul Poirier;,citation_author=Majid A Almadi;,citation_author=Yuksel Altuntas;,citation_author=Kien Keat Ng;,citation_author=Jephat Chifamba;,citation_author=Karen Yeates;,citation_author=Thandi Puoane;,citation_author=Rasha Khatib;,citation_author=Rita Yusuf;,citation_author=Kristina Bengtsson Boström;,citation_author=Katarzyna Zatonska;,citation_author=Romaina Iqbal;,citation_author=Liu Weida;,citation_author=Zhu Yibing;,citation_author=Li Sidong;,citation_author=Antonio Dans;,citation_author=Afzalhussein Yusufali;,citation_author=Noushin Mohammadifard;,citation_author=John K Marshall;,citation_author=Paul Moayyedi;,citation_author=Walter Reinisch;,citation_author=Salim Yusuf;,citation_publication_date=2021-07;,citation_cover_date=2021-07;,citation_year=2021;,citation_fulltext_html_url=http://dx.doi.org/10.1136/bmj.n1554;,citation_doi=10.1136/bmj.n1554;,citation_issn=1756-1833;,citation_journal_title=BMJ;,citation_publisher=BMJ;">
<meta name="citation_reference" content="citation_title=Toward an integrated clinical, molecular and serological classification of inflammatory bowel disease: Report of a working party of the 2005 Montreal World Congress of Gastroenterology;,citation_abstract=The discovery of a series of genetic and serological markers associated with disease susceptibility and phenotype in inflammatory bowel disease has led to the prospect of an integrated classification system involving clinical, serological and genetic parameters. The Working Party has reviewed current clinical classification systems in Crohn’s disease, ulcerative colitis and indeterminate colitis, and provided recommendations for clinical classification in practice. Progress with respect to integrating serological and genetic markers has been examined in detail, and the implications are discussed. While an integrated system is not proposed for clinical use at present, the introduction of a widely acceptable clinical subclassification is strongly advocated, which would allow detailed correlations among serotype, genotype and clinical phenotype to be examined and confirmed in independent cohorts of patients and, thereby, provide a vital foundation for future work.;,citation_author=Mark S. Silverberg;,citation_author=Jack Satsangi;,citation_author=Tariq Ahmad;,citation_author=Ian DR Arnott;,citation_author=Charles N. Bernstein;,citation_author=Steven R. Brant;,citation_author=Renzo Caprilli;,citation_author=Jean-Frédéric Colombel;,citation_author=Christoph Gasche;,citation_author=Karel Geboes;,citation_author=Derek P. Jewell;,citation_author=Amir Karban;,citation_author=Edward V. Loftus;,citation_author=A. Salvador Peña;,citation_author=Robert H. Riddell;,citation_author=David B. Sachar;,citation_author=Stefan Schreiber;,citation_author=A. Hillary Steinhart;,citation_author=Stephan R. Targan;,citation_author=Severine Vermeire;,citation_author=Bryan F. Warren;,citation_publication_date=2005-09;,citation_cover_date=2005-09;,citation_year=2005;,citation_doi=10.1155/2005/269076;,citation_issn=2291-2789;,citation_volume=19;,citation_language=en-US;,citation_journal_title=Canadian Journal of Gastroenterology and Hepatology;,citation_publisher=Hindawi;">
<meta name="citation_reference" content="citation_title=BMI classification percentile and cut off points;,citation_abstract=Body mass index or BMI is a statistical index using a person’s weight and height to provide an estimate of body fat in males and females of any age. It is calculated by taking a person’s weight, in kilograms, divided by their height, in meters squared, or BMI = weight (in kg)/ height^2 (in m^2). The number generated from this equation is then the individual’s BMI number. The National Institute of Health (NIH) now uses BMI to define a person as underweight, normal weight, overweight, or obese instead of traditional height vs. weight charts. These classifications for BMI are in use by the NIH and the World Health Organization (WHO) for White, Hispanic, and Black individuals. The cutoffs underestimate the obesity risk in the Asian and South Asian populations, so their classification has slight alterations. The BMI number and classifications are listed below. However, individual variations do exist, and BMI is insufficient as the sole means of classifying a person as obese or malnourished. In certain populations, like elite athletes and body-builders, an elevated BMI does not directly correlate to their health status due to their increased muscle mass and weight falsely increasing their BMI. Moreover, in the pediatric population, BMI allows comparison between children of the same sex and age. For children, a BMI that is less than the fifth percentile is underweight and above the 95th percentile is considered obese.;,citation_author=Connor B. Weir;,citation_author=Arif Jan;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_pmid=31082114;,citation_language=en-US;,citation_inbook_title=StatPearls;">
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Baseline/Introduction.html">Baseline Analyses</a></li><li class="breadcrumb-item"><a href="../Baseline/IBD.html">Inflammatory bowel disease</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../PREdiCCtlogo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none"></a>
      <div class="sidebar-tools-main">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
<li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/nathansam/predicct-analysis">
            Source Code
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://github.com/nathansam/predicct-analysis/issues">
            Report a Bug
            </a>
          </li>
      </ul>
</div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
 <span class="menu-text">index.qmd</span>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/Recruitment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Study recruitment</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Baseline Analyses</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/Demographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cohort demographics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/IBD.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Inflammatory bowel disease</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/Biochemistry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Biochemistry data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/Diet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diet</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Baseline/Tables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overall tables</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Time to flare</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/Introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/Soft-hard-flares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Flare overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/Controlled.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Controlled variables</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/Demographics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Demographic data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/IBD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inflammatory bowel disease</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/Biochemistry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Biochemistry</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../Survival/Diet.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Diet</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">On this page</h2>
   
  <ul>
<li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#ibd-type" id="toc-ibd-type" class="nav-link" data-scroll-target="#ibd-type">IBD type</a></li>
  <li><a href="#disease-duration" id="toc-disease-duration" class="nav-link" data-scroll-target="#disease-duration">Disease duration</a></li>
  <li><a href="#ibd-control" id="toc-ibd-control" class="nav-link" data-scroll-target="#ibd-control">IBD Control</a></li>
  <li>
<a href="#medication-use" id="toc-medication-use" class="nav-link" data-scroll-target="#medication-use">Medication use</a>
  <ul>
<li><a href="#ibd-treatment-strategy" id="toc-ibd-treatment-strategy" class="nav-link" data-scroll-target="#ibd-treatment-strategy">IBD treatment strategy</a></li>
  <li><a href="#bio-naive-status" id="toc-bio-naive-status" class="nav-link" data-scroll-target="#bio-naive-status">Bio-naive status</a></li>
  </ul>
</li>
  <li>
<a href="#variables-only-relevant-to-crohns-disease-subjects" id="toc-variables-only-relevant-to-crohns-disease-subjects" class="nav-link" data-scroll-target="#variables-only-relevant-to-crohns-disease-subjects">Variables only relevant to Crohn’s disease subjects</a>
  <ul>
<li><a href="#surgery" id="toc-surgery" class="nav-link" data-scroll-target="#surgery">Surgery</a></li>
  <li><a href="#montreal-location" id="toc-montreal-location" class="nav-link" data-scroll-target="#montreal-location">Montreal location</a></li>
  <li><a href="#montreal-behaviour" id="toc-montreal-behaviour" class="nav-link" data-scroll-target="#montreal-behaviour">Montreal behaviour</a></li>
  <li><a href="#harvey-bradshaw-index" id="toc-harvey-bradshaw-index" class="nav-link" data-scroll-target="#harvey-bradshaw-index">Harvey-Bradshaw Index</a></li>
  <li><a href="#pro-2-in-crohns-disease" id="toc-pro-2-in-crohns-disease" class="nav-link" data-scroll-target="#pro-2-in-crohns-disease">PRO-2 in Crohn’s disease</a></li>
  <li><a href="#smoking" id="toc-smoking" class="nav-link" data-scroll-target="#smoking">Smoking</a></li>
  <li><a href="#e-cigarette-use" id="toc-e-cigarette-use" class="nav-link" data-scroll-target="#e-cigarette-use">E-cigarette use</a></li>
  </ul>
</li>
  <li>
<a href="#variables-only-relevant-to-ulcerative-colitisibdu-subjects" id="toc-variables-only-relevant-to-ulcerative-colitisibdu-subjects" class="nav-link" data-scroll-target="#variables-only-relevant-to-ulcerative-colitisibdu-subjects">Variables only relevant to ulcerative colitis/IBDU subjects</a>
  <ul>
<li><a href="#montreal-extent" id="toc-montreal-extent" class="nav-link" data-scroll-target="#montreal-extent">Montreal extent</a></li>
  <li><a href="#mayo-score" id="toc-mayo-score" class="nav-link" data-scroll-target="#mayo-score">Mayo score</a></li>
  <li><a href="#pro-2-in-ulcerative-colitis" id="toc-pro-2-in-ulcerative-colitis" class="nav-link" data-scroll-target="#pro-2-in-ulcerative-colitis">PRO-2 in ulcerative colitis</a></li>
  <li><a href="#smoking-1" id="toc-smoking-1" class="nav-link" data-scroll-target="#smoking-1">Smoking</a></li>
  <li><a href="#e-cigarette-use-1" id="toc-e-cigarette-use-1" class="nav-link" data-scroll-target="#e-cigarette-use-1">E-cigarette use</a></li>
  </ul>
</li>
  
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/nathansam/predicct-analysis/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../Baseline/Introduction.html">Baseline Analyses</a></li><li class="breadcrumb-item"><a href="../Baseline/IBD.html">Inflammatory bowel disease</a></li></ol></nav><div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Inflammatory bowel disease</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://scholar.google.com/citations?user=2emHWR0AAAAJ&amp;hl=en&amp;oi=ao">Nathan Constantine-Cooke</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/centre-genomic-medicine">
            Centre for Genomic and Experimental Medicine
            </a>
          </p>
        <p class="affiliation">
            <a href="https://www.ed.ac.uk/mrc-human-genetics-unit">
            MRC Human Genetics Unit
            </a>
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author"><a href="https://www.research.ed.ac.uk/en/persons/chiara-cotronei">Chiara Cotronei</a> </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            <a href="https://services.nhslothian.scot">
            NHS Lothian
            </a>
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 27, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header><section id="introduction" class="level2"><h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co">##############</span></span>
<span><span class="co">## Packages ##</span></span>
<span><span class="co">##############</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr">plyr</a></span><span class="op">)</span> <span class="co"># Used for mapping values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span><span class="op">)</span> <span class="co"># ggplot2, dplyr, and magrittr</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span> <span class="co"># Read in Excel files</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span> <span class="co"># Handle dates</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/datefixR/">datefixR</a></span><span class="op">)</span> <span class="co"># Standardise dates</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span> <span class="co"># Arrange ggplots</span></span>
<span></span>
<span><span class="co"># Generate tables</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/benjaminrich/table1">table1</a></span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/">pander</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate flowchart of cohort derivation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rich-iannone.github.io/DiagrammeR/">DiagrammeR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rich-iannone/DiagrammeRsvg">DiagrammeRsvg</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># paths to PREdiCCt data</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html">file.exists</a></span><span class="op">(</span><span class="st">"/docker"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> <span class="co"># If running in docker</span></span>
<span>  <span class="va">data.path</span> <span class="op">&lt;-</span> <span class="st">"data/final/20221004/"</span></span>
<span>  <span class="va">redcap.path</span> <span class="op">&lt;-</span> <span class="st">"data/final/20231030/"</span></span>
<span>  <span class="va">prefix</span> <span class="op">&lt;-</span> <span class="st">"data/end-of-follow-up/"</span></span>
<span>  <span class="va">outdir</span> <span class="op">&lt;-</span> <span class="st">"data/processed/"</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span> <span class="co"># Run on OS directly</span></span>
<span>  <span class="va">data.path</span> <span class="op">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/"</span></span>
<span>  <span class="va">redcap.path</span> <span class="op">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/"</span></span>
<span>  <span class="va">prefix</span> <span class="op">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/"</span></span>
<span>  <span class="va">outdir</span> <span class="op">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/processed/"</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"demo-demographics.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"demo-cd.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">demo.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"demo-uc.RDS"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This page explores data which describes subjects’ IBD, primarily consisting of clinical data.</p>
</section><section id="ibd-type" class="level2"><h2 class="anchored" data-anchor-id="ibd-type">IBD type</h2>
<p>For this study, we have grouped ulcerative colitis (UC) and inflammatory bowel disease unclassified (IBDU) into one category. IBD type is self-reported.</p>
<p>Whilst PREdiCCt was designed to recruit an equal number of CD and UC/IBDU subjects, the COVID-19 pandemic halted recruitment which has resulted in there not being an equal balance of CD and UC/IBDU subjects.There are slightly more Crohn’s disease (CD) than UC/IBDU subjects in the FC cohort.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo</span><span class="op">$</span><span class="va">diagnosis2</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">diagnosis</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD"</span>, <span class="st">"UC/IBDU"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo</span><span class="op">$</span><span class="va">diagnosis</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">diagnosis</span>,</span>
<span>  from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span>levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CD"</span>, <span class="st">"UC"</span>, <span class="st">"IBDU"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">diagnosis2</span>, fill <span class="op">=</span> <span class="va">diagnosis2</span>, color <span class="op">=</span> <span class="va">diagnosis2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"IBD type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#2B2D42"</span>, <span class="st">"#92DCE5"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#1E203A"</span>, <span class="st">"#1D9BA5"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"IBD type"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"IBD type"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-IBD-dist" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-IBD-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-IBD-dist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-IBD-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Distribution of IBD type in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>IBD type is significantly associated with FC at recruitment.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">diagnosis2</span>, <span class="va">demo</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-IBD-fc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-IBD-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Chi-squared test between IBD type and FC groups.
</figcaption><div aria-describedby="tbl-IBD-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo$diagnosis2</code> and <code>demo$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">6.815</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.03313 *</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="disease-duration" class="level2"><h2 class="anchored" data-anchor-id="disease-duration">Disease duration</h2>
<p>Disease duration has been calculated by subtracting reported date of diagnosis from the date of entry into PREdiCCt. Date of diagnosis has been obtained via REDcap. Where only year was available, the <a href="https://docs.ropensci.org/datefixR/">datefixR R package</a> was used to impute the middle of the year. Any disease durations reported to be negative using this method were mapped to 0.</p>
<div class="cell" data-fig-caption="Distribution of disease duration at study recruitment stratified by IBD type.">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">redcap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">redcap.path</span>, <span class="st">"redcap_clean.xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">redcap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">redcap</span>, <span class="va">participantno</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">diag.date</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantno"</span>, <span class="st">"date_diag"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">diag.date</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ParticipantNo"</span></span>
<span><span class="va">diag.date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">diag.date</span>, <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">date_diag</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span><span class="op">(</span><span class="va">date_diag</span><span class="op">)</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>  <span class="va">date_diag</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">diag.date</span>,</span>
<span>  <span class="va">demo</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">duration</span>, <span class="va">ParticipantNo</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">duration</span>, <span class="fu"><a href="https://rdrr.io/r/base/chartr.html">tolower</a></span><span class="op">(</span><span class="va">date_diag</span><span class="op">)</span> <span class="op">!=</span> <span class="st">"unknown"</span><span class="op">)</span></span>
<span><span class="va">duration</span><span class="op">[</span><span class="va">duration</span><span class="op">[</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"16/032016"</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"16/03/2016"</span></span>
<span><span class="va">duration</span><span class="op">[</span><span class="va">duration</span><span class="op">[</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"19/04/2017P"</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"19/04/2017"</span></span>
<span><span class="va">duration</span><span class="op">[</span><span class="va">duration</span><span class="op">[</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"2007 APPROX"</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"2007"</span></span>
<span><span class="va">duration</span><span class="op">[</span><span class="va">duration</span><span class="op">[</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"approx 1988"</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"1988"</span></span>
<span><span class="va">duration</span><span class="op">[</span><span class="va">duration</span><span class="op">[</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">==</span> <span class="st">"?2014"</span>, <span class="st">"date_diag"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"2014"</span></span>
<span></span>
<span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://docs.ropensci.org/datefixR/reference/fix_date_df.html">fix_date_df</a></span><span class="op">(</span><span class="va">duration</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"entry_date"</span>, <span class="st">"date_diag"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">duration</span><span class="op">$</span><span class="va">duration</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span></span>
<span>  <span class="va">duration</span>,</span>
<span>  <span class="op">(</span><span class="va">entry_date</span> <span class="op">-</span> <span class="va">date_diag</span><span class="op">)</span> <span class="op">/</span> <span class="fl">365.25</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">duration</span><span class="op">[</span><span class="va">duration</span><span class="op">[</span>, <span class="st">"duration"</span><span class="op">]</span> <span class="op">&lt;</span> <span class="fl">0</span>, <span class="st">"duration"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span></span>
<span></span>
<span><span class="va">duration.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">duration</span>, <span class="va">diagnosis</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">duration.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">duration</span>, <span class="va">diagnosis</span> <span class="op">!=</span> <span class="st">"1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">duration</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">duration</span>, color <span class="op">=</span> <span class="va">diagnosis2</span>, fill <span class="op">=</span> <span class="va">diagnosis2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Duration (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"IBD type"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"IBD type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#CDEDF6"</span>, <span class="st">"#FF6B6B"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#5EB1BF"</span>, <span class="st">"#C24343"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"plots/Duration-full-cohort.png"</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">9</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">6</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"plots/Duration-full-cohort.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">9</span>, height <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">duration</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">duration</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">duration</span>, color <span class="op">=</span> <span class="va">diagnosis2</span>, fill <span class="op">=</span> <span class="va">diagnosis2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>bins <span class="op">=</span> <span class="fl">25</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Duration (years)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"IBD type"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"IBD type"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#CDEDF6"</span>, <span class="st">"#FF6B6B"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#5EB1BF"</span>, <span class="st">"#C24343"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-duration-hist" class="quarto-figure quarto-figure-center quarto-float anchored" width="672">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-duration-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-duration-hist-1.png" id="fig-duration-hist" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-duration-hist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2
</figcaption></figure>
</div>
</div>
</div>
<p>Whilst a low p-value was observed, disease duration was not significantly different between FC groups.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo</span>, <span class="va">duration</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"duration"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">demo</span><span class="op">)</span><span class="op">[</span><span class="fl">18</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"IBD Duration"</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">`IBD Duration`</span> <span class="op">~</span> <span class="va">cat</span>, data <span class="op">=</span> <span class="va">demo</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-duration-fc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-duration-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: ANOVA between IBD disease duration and FC groups.
</figcaption><div aria-describedby="tbl-duration-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Df</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cat</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">639.6</td>
<td style="text-align: center;">319.8</td>
<td style="text-align: center;">2.708</td>
<td style="text-align: center;">0.06691</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Residuals</strong></td>
<td style="text-align: center;">2021</td>
<td style="text-align: center;">238664</td>
<td style="text-align: center;">118.1</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="ibd-control" class="level2"><h2 class="anchored" data-anchor-id="ibd-control">IBD Control</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">data.path</span>, <span class="st">"Baseline2022/IBD.xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create flare_group in IBD_C and make into level</span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>flare_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">FlaresInPastYear</span> <span class="op">==</span> <span class="fl">0</span>,</span>
<span>    <span class="st">"No Flares"</span>,</span>
<span>    <span class="st">"1 or More Flares"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">IBD</span><span class="op">$</span><span class="va">flare_group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">IBD</span><span class="op">$</span><span class="va">flare_group</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"No Flares"</span>, <span class="st">"1 or More Flares"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">TreatmentUseful</span> <span class="op">==</span> <span class="fl">4</span>,</span>
<span>    <span class="st">"Not On Treatment"</span>,</span>
<span>    <span class="st">"On Treatment"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="va">IBD</span><span class="op">$</span><span class="va">treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">IBD</span><span class="op">$</span><span class="va">treatment</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Not On Treatment"</span>, <span class="st">"On Treatment"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># correcting scores where No is favourable and Yes is unfavourable outcomes</span></span>
<span><span class="co"># answer options were always YES/NO/Not sure</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">IBD</span><span class="op">$</span><span class="va">MissPlannedActivities</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="st">"MissPlannedActivities"</span><span class="op">:</span><span class="st">"NewSymptoms"</span><span class="op">)</span>,</span>
<span>      <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">.</span>, `3` <span class="op">=</span> <span class="fl">1</span>, `2` <span class="op">=</span> <span class="fl">2</span>, `1` <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># correct TreatmentUseful (Yes is favourable, No unfavourable)</span></span>
<span><span class="co"># not on treatment was assigned the value 1</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">IBD</span><span class="op">$</span><span class="va">TreatmentUseful</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span></span>
<span>      <span class="st">"TreatmentUseful"</span>,</span>
<span>      <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">.</span>, `4` <span class="op">=</span> <span class="fl">2</span>, `3` <span class="op">=</span> <span class="fl">1</span>, `2` <span class="op">=</span> <span class="fl">0</span>, `1` <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># exclude rows with missing data, 17 participants excluded for missing IBD-control questionnaire data</span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">17</span><span class="op">:</span><span class="fl">27</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># new column with total control score</span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>control_score <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html">rowSums</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">17</span><span class="op">:</span><span class="fl">27</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># new column with IBD-control-8 score</span></span>
<span><span class="co"># added 2 to make comparable to future scores where the first question is asked to make comparable to future and against the cut off of 13 which indicates remission</span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>control_8 <span class="op">=</span> <span class="va">TreatmentUseful</span> <span class="op">+</span></span>
<span>    <span class="va">MissPlannedActivities</span> <span class="op">+</span></span>
<span>    <span class="va">WakeUpAtNight</span> <span class="op">+</span></span>
<span>    <span class="va">SignificantPain</span> <span class="op">+</span></span>
<span>    <span class="va">OftenLackEnergy</span> <span class="op">+</span></span>
<span>    <span class="va">AnxiousDepressed</span> <span class="op">+</span></span>
<span>    <span class="va">NeedChangeTreatment</span> <span class="op">+</span></span>
<span>    <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create groups with cut off of IBD-control-8 scores quiescent (13 or above)/not quiescent</span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>control_grouped <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">control_8</span> <span class="op">&gt;=</span> <span class="fl">13</span>, <span class="st">"13-16"</span>, <span class="st">"0-12"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IBD</span><span class="op">$</span><span class="va">control_8</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">IBD</span><span class="op">$</span><span class="va">control_8</span><span class="op">)</span></span>
<span></span>
<span><span class="va">IBD</span> <span class="op">&lt;-</span> <span class="va">IBD</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span>vas_control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">OverallControl</span> <span class="op">&gt;=</span> <span class="fl">85</span>, <span class="st">"85+"</span>, <span class="st">"&lt;85"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo</span>, <span class="va">IBD</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"control_8"</span>, <span class="st">"OverallControl"</span>, <span class="st">"vas_control"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>IBD Control is a validated questionnaire designed to assess disease control from a patient’s perspective <span class="citation" data-cites="Bodger_2013">(<a href="#ref-Bodger_2013" role="doc-biblioref">Bodger et al. 2013</a>)</span>. We considered an eight question subset, IBD-Control-8 which ranges in potential scores from 0 to 16. We also consider the IBD-Control visual analogue scale (VAS). <span class="citation" data-cites="Bodger_2013">Bodger et al. (<a href="#ref-Bodger_2013" role="doc-biblioref">2013</a>)</span> found a cut-off of <span class="math inline">\geq 13</span> for IBD-Control-8 and a cut-off of <span class="math inline">\geq 85</span> for IBD-Control-VAS to be optimal for identifying quiescent disease.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="va">demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">control_8</span>, color <span class="op">=</span> <span class="va">control_8</span>, fill <span class="op">=</span> <span class="va">control_8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Control-8 Scores"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html">viridis</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">11.5</span>, color <span class="op">=</span> <span class="st">"#FF4B3E"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="va">demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">OverallControl</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth <span class="op">=</span> <span class="fl">5</span>, fill <span class="op">=</span> <span class="st">"#FFD23F"</span>, color <span class="op">=</span> <span class="st">"#947805"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"VAS Scores"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">85</span>, color <span class="op">=</span> <span class="st">"#FF4B3E"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p1</span> <span class="op">/</span> <span class="va">p2</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"A"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-IBD-control" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-IBD-control-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-IBD-control-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-IBD-control-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Distributiuon of IBD Control scores for (A) Control-8 and (B) Visual analogue scale. The vertical red lines denote the cut-offs for quiescent disease reported by <span class="citation" data-cites="Bodger_2013">Bodger et al. (<a href="#ref-Bodger_2013" role="doc-biblioref">2013</a>)</span>.
</figcaption></figure>
</div>
</div>
</div>
<p>IBD-Control-8 scores and VAS were both found to be significantly associated with FC.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">control_8</span><span class="op">)</span> <span class="op">~</span> <span class="va">cat</span>, data <span class="op">=</span> <span class="va">demo</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-control-8-fc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-control-8-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: ANOVA between control-8 and FC groups.
</figcaption><div aria-describedby="tbl-control-8-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Df</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cat</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">65.25</td>
<td style="text-align: center;">32.63</td>
<td style="text-align: center;">3.335</td>
<td style="text-align: center;">0.03586</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Residuals</strong></td>
<td style="text-align: center;">1694</td>
<td style="text-align: center;">16574</td>
<td style="text-align: center;">9.784</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">OverallControl</span> <span class="op">~</span> <span class="va">cat</span>, data <span class="op">=</span> <span class="va">demo</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-control-vas-fc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-control-vas-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: ANOVA between control VAS and FC groups.
</figcaption><div aria-describedby="tbl-control-vas-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Df</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cat</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">4692</td>
<td style="text-align: center;">2346</td>
<td style="text-align: center;">9.996</td>
<td style="text-align: center;">4.836e-05</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Residuals</strong></td>
<td style="text-align: center;">1687</td>
<td style="text-align: center;">395921</td>
<td style="text-align: center;">234.7</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Instead to treating VAS as a continuous value, going forward, VAS will be discretised into below 85 and 85 and above as a VAS of 85 was found by <span class="citation" data-cites="Bodger_2013">Bodger et al. (<a href="#ref-Bodger_2013" role="doc-biblioref">2013</a>)</span> to be predictive of quiescent disease.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="va">demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">OverallControl</span><span class="op">)</span></span>
<span><span class="va">demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">vas_control</span>, color <span class="op">=</span> <span class="va">vas_control</span>, fill <span class="op">=</span> <span class="va">vas_control</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Visual analogue scores"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D00000"</span>, <span class="st">"#447604"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D00000"</span>, <span class="st">"#447604"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-VAS-dist" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-VAS-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-VAS-dist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-VAS-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Distribution of discretised IBD-Control-VAS scores.
</figcaption></figure>
</div>
</div>
</div>
<p>The discretised VAS is continued to be significantly associated with FC.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">vas_control</span>, <span class="va">demo</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-vas-fc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vas-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Chi squared test between VAS and FC groups.
</figcaption><div aria-describedby="tbl-vas-fc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo$vas_control</code> and <code>demo$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 25%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">16.89</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.0002153 * * *</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="medication-use" class="level2"><h2 class="anchored" data-anchor-id="medication-use">Medication use</h2>
<p>This section is concerned with medication used by study participants. Current treatment strategy, bio-naive status and antibiotic use are considered.</p>
<section id="ibd-treatment-strategy" class="level3"><h3 class="anchored" data-anchor-id="ibd-treatment-strategy">IBD treatment strategy</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ParticipantNo <span class="op">=</span> <span class="va">demo</span><span class="op">$</span><span class="va">ParticipantNo</span><span class="op">)</span></span>
<span></span>
<span><span class="va">drugs</span><span class="op">$</span><span class="va">ASA</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">drugs</span><span class="op">$</span><span class="va">imm</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">drugs</span><span class="op">$</span><span class="va">bio</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span><span class="va">drugs</span><span class="op">$</span><span class="va">category</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">redcap</span> <span class="op">&lt;-</span> <span class="va">redcap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>  curr_on_mesa <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_mesa</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_mesa</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_aza <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_aza</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_aza</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_merc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_merc</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_merc</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_metho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_metho</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_metho</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_ciclo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_ciclo</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_ciclo</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_inflix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_inflix</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_inflix</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_ada <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_ada</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_ada</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_goli <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_goli</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_goli</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_vedo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_vedo</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_vedo</span></span>
<span>  <span class="op">)</span>,</span>
<span>  curr_on_ust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">curr_on_ust</span><span class="op">)</span>,</span>
<span>    <span class="fl">0</span>,</span>
<span>    <span class="va">curr_on_ust</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">drugs</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ParticipantNo"</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">redcap</span><span class="op">$</span><span class="va">participantno</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">subject.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">redcap</span>, <span class="va">participantno</span> <span class="op">==</span> <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ParticipantNo"</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_mesa</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ASA"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span></span>
<span>    <span class="co"># Immunosuppressants</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_aza</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_merc</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_metho</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_ciclo</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"imm"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="co"># Biologics</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_inflix</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_ada</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_goli</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_vedo</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">|</span></span>
<span>      <span class="va">subject.data</span><span class="op">$</span><span class="va">curr_on_ust</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"bio"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"imm"</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"bio"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"category"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"imm"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"category"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"bio"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"category"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ASA"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">drugs</span><span class="op">[</span><span class="va">i</span>, <span class="st">"category"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">drugs</span><span class="op">$</span><span class="va">category</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">drugs</span><span class="op">$</span><span class="va">category</span>,</span>
<span>  levels <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"5-ASA"</span>,</span>
<span>    <span class="st">"Mono immunotherapy"</span>,</span>
<span>    <span class="st">"Mono biologic"</span>,</span>
<span>    <span class="st">"Combo therapy"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">drugs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">drugs</span>, <span class="va">demo</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"cat"</span>, <span class="st">"diagnosis2"</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"ParticipantNo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">drugs</span><span class="op">)</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Treatment"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>For IBD treatment, subjects are categorised as being on either a 5-ASA, mono immunotherapy, mono biologic, or immuno-biologic combination treatment strategy based upon REDCap data provided by participants’ IBD care teams.</p>
<p>Treatments. in REDCap were selected via check boxes. As such, <code>NA</code> (unticked) is assumed to mean the participant is not on a given medication.</p>
<p>Immunosuppressants are defined as:</p>
<ul>
<li>Azathioprine</li>
<li>Mercaptopurine</li>
<li>Methotrexate</li>
<li>Ciclosporin</li>
</ul>
<p>Biologics are defined as:</p>
<ul>
<li>Infliximab</li>
<li>Adalimumab</li>
<li>Golimumab</li>
<li>Vedolizumab</li>
<li>Ustekinumab</li>
</ul>
<p>Patients are only categorised as receiving a 5-ASA treatment plan if 5-ASA is the only IBD treatment they are receiving (I.E no immunotherapy or biologics).</p>
<p>As should be expected given poor efficacy in CD, a 5-ASA treatment strategy is much more common for UC/IBDU participants (<a href="#fig-treatments" class="quarto-xref">Figure&nbsp;5</a>). Mono biologic therapy is the most common treatment strategy for CD subjects.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">plt.cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#52528C"</span>, <span class="st">"#DD6E42"</span>, <span class="st">"#048A81"</span>, <span class="st">"#C585B3"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">drugs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Treatment</span>, fill <span class="op">=</span> <span class="va">Treatment</span>, color <span class="op">=</span> <span class="va">Treatment</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Treatment strategy"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">plt.cols</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_colour_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu">colorspace</span><span class="fu">::</span><span class="fu"><a href="https://colorspace.R-Forge.R-project.org/reference/lighten.html">darken</a></span><span class="op">(</span><span class="va">plt.cols</span>, <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">diagnosis2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-treatments" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-treatments-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-treatments-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-treatments-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Reported treatment strategies for the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">drugs</span>, <span class="va">diagnosis2</span> <span class="op">==</span> <span class="st">"CD"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">Treatment</span>, <span class="va">cat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-treatments-cd" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-treatments-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Chi-squared test between treatment strategy and FC groups for participants with Crohn’s disease.
</figcaption><div aria-describedby="tbl-treatments-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>Treatment</code> and <code>cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">5.828</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.4427</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">drugs</span>, <span class="va">diagnosis2</span> <span class="op">==</span> <span class="st">"UC/IBDU"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">Treatment</span>, <span class="va">cat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-treatments-uc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-treatments-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Chi-squared test between treatment strategy and FC groups for participants with Ulcerative colitis/IBDU.
</figcaption><div aria-describedby="tbl-treatments-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>Treatment</code> and <code>cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">9.163</td>
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.1646</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="bio-naive-status" class="level3"><h3 class="anchored" data-anchor-id="bio-naive-status">Bio-naive status</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>ParticipantNo <span class="op">=</span> <span class="va">redcap</span><span class="op">$</span><span class="va">participantno</span><span class="op">)</span></span>
<span><span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">bio.naive</span>, <span class="va">ParticipantNo</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">demo</span><span class="op">$</span><span class="va">ParticipantNo</span><span class="op">)</span></span>
<span><span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">bio.naive</span>,</span>
<span>  <span class="va">demo</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"diagnosis"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">bio.naive</span>, <span class="va">ParticipantNo</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">bio.naive</span><span class="op">$</span><span class="va">naive</span> <span class="op">&lt;-</span> <span class="st">"yes"</span></span>
<span></span>
<span><span class="va">bio.vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"inflix"</span>, <span class="st">"ada"</span>, <span class="st">"goli"</span>, <span class="st">"vedo"</span>, <span class="st">"ust"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">bio.naive</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">redcap</span>, <span class="va">participantno</span> <span class="op">==</span> <span class="va">bio.naive</span><span class="op">[</span><span class="va">i</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">temp.df</span> <span class="op">&lt;-</span> <span class="va">temp.df</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"curr_on_"</span>, <span class="va">bio.vars</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">temp.df</span> <span class="op">&lt;-</span> <span class="va">temp.df</span><span class="op">[</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">temp.df</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">temp.df</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">bio.naive</span><span class="op">[</span><span class="va">i</span>, <span class="st">"naive"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"no-using"</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">temp.df</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">bio.naive</span><span class="op">[</span><span class="va">i</span>, <span class="st">"naive"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"no-not-using"</span></span>
<span>  <span class="op">}</span> <span class="co"># else naive</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">drugs.eof</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">prefix</span>, <span class="st">"EOF_drugs.xlsx"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">using</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">drugs.eof</span>, <span class="va">AtRecruitmentYN</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">bio.list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="va">using</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">using</span>, <span class="va">DrugType</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">bio.list</span><span class="op">)</span></span>
<span><span class="va">using</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demo</span>, <span class="va">ParticipantId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">using</span><span class="op">$</span><span class="va">ParticipantId</span><span class="op">)</span></span>
<span><span class="va">using</span> <span class="op">&lt;-</span> <span class="va">using</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"diagnosis"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">using</span><span class="op">$</span><span class="va">naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no-using"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">bio.naive</span>, <span class="va">using</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">bio.naive</span><span class="op">$</span><span class="va">ParticipantNo</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">bio.naive</span>, <span class="va">ParticipantNo</span> <span class="op">==</span> <span class="va">i</span><span class="op">)</span></span>
<span>  <span class="co"># if "no-using" in either extract then report using</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">naive</span> <span class="op">==</span> <span class="st">"no-using"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">bio.naive</span>, <span class="va">ParticipantNo</span> <span class="op">!=</span> <span class="va">i</span><span class="op">)</span></span>
<span>      <span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span></span>
<span>        <span class="va">bio.naive</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>          ParticipantNo <span class="op">=</span> <span class="va">i</span>,</span>
<span>          diagnosis <span class="op">=</span> <span class="va">temp</span><span class="op">[</span><span class="fl">1</span>, <span class="st">"diagnosis"</span><span class="op">]</span>,</span>
<span>          naive <span class="op">=</span> <span class="st">"no-using"</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">bio.naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">bio.naive</span>, <span class="va">ParticipantNo</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo</span>,</span>
<span>  <span class="va">bio.naive</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo</span><span class="op">$</span><span class="va">naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">naive</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"no-using"</span>, <span class="st">"no-not-using"</span>, <span class="st">"yes"</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Current"</span>, <span class="st">"Previously"</span>, <span class="st">"Never prescribed"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demo</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">demo</span><span class="op">)</span> <span class="op">==</span> <span class="st">"naive"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Biologic"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Bio-naive status has been determined using REDCap and EoS data. As clinical teams were not explicitly asked if a subject was bio-naive, the subject is instead defined as being bio-naive if there are no recorded biologics for the subject (which may bias subjects with missing data towards incorrectly being reported as bio-naive). Non bio-naive subjects are categorised further into either “currently using” or “previously used”.</p>
<p>Biologic treatments are defined as infliximab, adalimumab, golimumab, vedolizumab, and ustekinumab.</p>
<p>Small molecule treatments are not considered in this report due to their low prescribing rates during the recruitment period (which ended March 2020).</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Biologic</span>, fill <span class="op">=</span> <span class="va">Biologic</span>, color <span class="op">=</span> <span class="va">Biologic</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Biologic status"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#CACF85"</span>, <span class="st">"#8CBA80"</span>, <span class="st">"#E58F65"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#747825"</span>, <span class="st">"#4A6E3F"</span>, <span class="st">"#934D1B"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Biologic status"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Biologic status"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">diagnosis2</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-biologic-use" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-biologic-use-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-biologic-use-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-biologic-use-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Bio-naivety in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>Bio-naive status was found to be associated with FC groups which may be due to patients with more active disease being more likely to be prescribed a biologic.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo</span><span class="op">$</span><span class="va">Biologic</span>, <span class="va">demo</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-biologic" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-biologic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: Chi-squared test between bio-naive status and FC groups.
</figcaption><div aria-describedby="tbl-biologic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo$Biologic</code> and <code>demo$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 20%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">16.51</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.002406 * *</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section></section><section id="variables-only-relevant-to-crohns-disease-subjects" class="level2"><h2 class="anchored" data-anchor-id="variables-only-relevant-to-crohns-disease-subjects">Variables only relevant to Crohn’s disease subjects</h2>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">data.path</span>, <span class="st">"Baseline2022/lifestyle.xlsx"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ParticipantNo</span>, <span class="va">Smoke</span>, <span class="va">SmokedInPast</span><span class="op">)</span></span>
<span><span class="va">smoking</span><span class="op">$</span><span class="va">Smoke</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">smoking</span><span class="op">$</span><span class="va">Smoke</span>, from <span class="op">=</span> <span class="fl">2</span>, to <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">smoking</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">smoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"SmokedInPast"</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">smoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"SmokedInPast"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">smoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"Smoke"</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">smoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"Smoke"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">smoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"Smoke"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">smoking</span><span class="op">$</span><span class="va">Smoke</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">smoking</span><span class="op">$</span><span class="va">Smoke</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Current"</span>, <span class="st">"Previous"</span>, <span class="st">"Never"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">smoking</span> <span class="op">&lt;-</span> <span class="va">smoking</span><span class="op">[</span>, <span class="op">-</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo</span>,</span>
<span>  <span class="va">smoking</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">esmoking</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">data.path</span>, <span class="st">"Baseline2022/lifestyle.xlsx"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">ParticipantNo</span>, <span class="va">ECigs</span>, <span class="va">ECigsPast</span><span class="op">)</span></span>
<span><span class="va">esmoking</span><span class="op">$</span><span class="va">ECigs</span> <span class="op">&lt;-</span> <span class="fu">plyr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">esmoking</span><span class="op">$</span><span class="va">ECigs</span>, from <span class="op">=</span> <span class="fl">2</span>, to <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">esmoking</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">esmoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ECigsPast"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">esmoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ECigsPast"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">esmoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ECigs"</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">esmoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ECigs"</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">esmoking</span><span class="op">[</span><span class="va">i</span>, <span class="st">"ECigs"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">esmoking</span><span class="op">$</span><span class="va">ECigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">esmoking</span><span class="op">$</span><span class="va">ECigs</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Current"</span>, <span class="st">"Previous"</span>, <span class="st">"Never"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">esmoking</span> <span class="op">&lt;-</span> <span class="va">esmoking</span><span class="op">[</span>, <span class="op">-</span><span class="fl">3</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">demo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo</span>,</span>
<span>  <span class="va">esmoking</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This section looks at data only applicable to subjects with CD. The following variables are considered: surgery, Montreal location, Montreal behaviour, Harvey-Bradshaw index, and smoking.</p>
<p>Smoking for CD and UC is considered separately as smoking is often reported to worsen outcomes in CD but may be protective in UC.</p>
<section id="surgery" class="level3"><h3 class="anchored" data-anchor-id="surgery">Surgery</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">predicct.surgery</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_xlsx</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span></span>
<span>  <span class="va">data.path</span>,</span>
<span>  <span class="st">"Baseline2022/IBD.xlsx"</span></span>
<span><span class="op">)</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"HadSurgeryForIBD"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">predicct.surgery</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"Surgery"</span></span>
<span></span>
<span></span>
<span><span class="va">redcap.surgery</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantno"</span>, <span class="st">"surgery"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">redcap.surgery</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"Surgery"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">surgery</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span><span class="op">(</span><span class="va">redcap.surgery</span>, <span class="va">predicct.surgery</span><span class="op">)</span></span>
<span><span class="va">surgery</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">surgery</span>, <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">surgery</span><span class="op">$</span><span class="va">Surgery</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># As REDCap is first, this will be prioritised over subject (if not NA)</span></span>
<span><span class="va">surgery</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html">distinct</a></span><span class="op">(</span><span class="va">surgery</span>, <span class="va">ParticipantNo</span>, .keep_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demo</span>, <span class="va">diagnosis2</span> <span class="op">==</span> <span class="st">"CD"</span><span class="op">)</span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.cd</span>, <span class="va">surgery</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span>, all.y <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Surgery</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Surgery</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Surgical data has been obtained from both REDCap and patient-completed questionnaires. Where data are available from both data sources, REDCap is the preferred data source.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Surgery</span>, fill <span class="op">=</span> <span class="va">Surgery</span>, color <span class="op">=</span> <span class="va">Surgery</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Previous surgery"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#F9B9B7"</span>, <span class="st">"#96C9DC"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D06965"</span>, <span class="st">"#448CA2"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-surgery-dist" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-surgery-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-surgery-dist-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-surgery-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Previous surgery for Crohn’s disease subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>FC at study recruitment is significantly associated with having previously undergone surgery for CD.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Surgery</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-surgery" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-surgery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;9: Chi-squared test between previous surgery and FC groups.
</figcaption><div aria-describedby="tbl-surgery-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.cd$Surgery</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">7.389</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.02486 *</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="montreal-location" class="level3"><h3 class="anchored" data-anchor-id="montreal-location">Montreal location</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  definition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Oesophago-gastric"</span>,</span>
<span>    <span class="st">"Duodenal"</span>,</span>
<span>    <span class="st">"Jejunal"</span>,</span>
<span>    <span class="st">"Ileal"</span>,</span>
<span>    <span class="st">"Colonic"</span>,</span>
<span>    <span class="st">"Rectal"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">cd.location</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantno"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"mac_extent___"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">L4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cd.location</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cd.location</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">cd.location</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># If Oesophago-gastric, Duodenal, Jejunal, then L4 is present</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/any.html">any</a></span><span class="op">(</span><span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="va">L4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Location</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># Ileal-colonic</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Location</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Ileal only</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">cd.location</span><span class="op">[</span><span class="va">i</span>, <span class="fl">6</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Location</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Colonic only</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Location</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">L4</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">Location</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># L4 Only</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">L4</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">Location</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">L4</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">mont.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="va">cd.location</span><span class="op">[</span>, <span class="st">"participantno"</span><span class="op">]</span>,</span>
<span>  <span class="va">Location</span>,</span>
<span>  <span class="va">L4</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mont.df</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ParticipantNo"</span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.cd</span>, <span class="va">mont.df</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Location</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Location</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"L1"</span>, <span class="st">"L2"</span>, <span class="st">"L3"</span>, <span class="st">"L4 only"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span><span class="op">$</span><span class="va">L4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">L4</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Not present"</span>, <span class="st">"Present"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Montreal location has been obtained from REDcap data. Rather than being asked for Montreal location directly, clinical teams were asked to provide more granular detail by ticking boxes if inflammation was in any of the following areas Oesophago-gastric, Duodenal, Jejunal, Ileal, Colonic, Rectal. If only any of the first 3 were reported then the subject was assigned “L4 only”. L1-L3 were assigned as per convention <span class="citation" data-cites="silverbergIntegratedClinicalMolecular2005">(<a href="#ref-silverbergIntegratedClinicalMolecular2005" role="doc-biblioref">Silverberg et al. 2005</a>)</span>. If no location was reported then location was assigned <code>NA</code>.</p>
<p>As can be seen in <a href="#fig-location" class="quarto-xref">Figure&nbsp;8</a>, L3 is the most common Montreal location in this cohort with roughly an equal amount of subjects having either L1 or L2.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Location</span>, fill <span class="op">=</span> <span class="va">Location</span>, color <span class="op">=</span> <span class="va">Location</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Montreal location"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#33CA7F"</span>, <span class="st">"#96C9DC"</span>, <span class="st">"#C33C54"</span>, <span class="st">"#FCB97D"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#318859"</span>, <span class="st">"#448CA2"</span>, <span class="st">"#80333E"</span>, <span class="st">"#BD7700"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Montreal location"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Montreal location"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-location" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-location-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-location-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-location-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Montreal location for CD subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>Due to the low number of subjects with L4-only, Fisher’s exact test has been used to compare with FC.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Location</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span>, workspace <span class="op">=</span> <span class="fl">20000000</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-location" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-location-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;10: Fisher’s exact test between Montreal location and FC groups.
</figcaption><div aria-describedby="tbl-location-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Fisher’s Exact Test for Count Data: <code>demo.cd$Location</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 13%">
<col style="width: 34%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">P value</th>
<th style="text-align: center;">Alternative hypothesis</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">0.6059</td>
<td style="text-align: center;">two.sided</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In addition to L4-only being considered, we also investigate L4 as a modifier.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">L4</span>, fill <span class="op">=</span> <span class="va">L4</span>, color <span class="op">=</span> <span class="va">L4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Presence of L4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#51E5FF"</span>, <span class="st">"#EC368D"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#079DB1"</span>, <span class="st">"#AF0863"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Presence of L4"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Presence of L4"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-L4" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-L4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-L4-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-L4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: L4 (upper GI involvement) in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb27"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">L4</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-L4" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-L4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11: Chi-squared test between L4 and FC groups.
</figcaption><div aria-describedby="tbl-L4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.cd$L4</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">5.611</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.06047</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="montreal-behaviour" class="level3"><h3 class="anchored" data-anchor-id="montreal-behaviour">Montreal behaviour</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">cd.behaviour</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantno"</span>, <span class="st">"behaviour"</span>, <span class="st">"perianal"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">cd.behaviour</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"Behaviour"</span>, <span class="st">"Perianal"</span><span class="op">)</span></span>
<span><span class="va">cd.behaviour</span><span class="op">$</span><span class="va">Perianal</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">cd.behaviour</span><span class="op">$</span><span class="va">Perianal</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">cd.behaviour</span><span class="op">$</span><span class="va">Perianal</span> <span class="op">==</span> <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.cd</span>,</span>
<span>  <span class="va">cd.behaviour</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Behaviour</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Behaviour</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Montreal behaviour has been obtained from REDCap data and was recorded conventionally. The majority of CD subjects have the B1 (inflammatory) phenotype.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb29"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Behaviour</span>, fill <span class="op">=</span> <span class="va">Behaviour</span>, color <span class="op">=</span> <span class="va">Behaviour</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Montreal behaviour"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#7AE7C7"</span>, <span class="st">"#440381"</span>, <span class="st">"#D64045"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#07A282"</span>, <span class="st">"#340165"</span>, <span class="st">"#942E31"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Montreal behaviour"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Montreal behaviour"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-behaviour" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-behaviour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-behaviour-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-behaviour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: Montreal behaviour for CD subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>Montreal behaviour is not significantly associated with FC at recruitment.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Behaviour</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-behaviour" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-behaviour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;12: Chi-squared test between Montreal behaviour and FC groups.
</figcaption><div aria-describedby="tbl-behaviour-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.cd$Behaviour</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">5.136</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.2736</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Approximately a third of CD subjects are reported to have perianal disease.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb31"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Perianal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Perianal</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Perianal</span>, fill <span class="op">=</span> <span class="va">Perianal</span>, color <span class="op">=</span> <span class="va">Perianal</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Perianal disease"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#023C40"</span>, <span class="st">"#AF5B5B"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#002C30"</span>, <span class="st">"#754242"</span><span class="op">)</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Perianal disease"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Perianal disease"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-peri" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-peri-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-peri-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-peri-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: Perianal disease for CD subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>Perianal disease is not associated with FC at recruitment.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Perianal</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-peri" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-peri-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;13: Chi-squared test between between perianal disease and FC groups.
</figcaption><div aria-describedby="tbl-peri-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.cd$Perianal</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">1.305</td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.5207</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="harvey-bradshaw-index" class="level3"><h3 class="anchored" data-anchor-id="harvey-bradshaw-index">Harvey-Bradshaw Index</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">HBI.df</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantid"</span>, <span class="st">"current_hb"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">HBI.df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantId"</span>, <span class="st">"HBI"</span><span class="op">)</span></span>
<span><span class="va">HBI.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">HBI.df</span>, <span class="va">ParticipantId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">demo.cd</span><span class="op">$</span><span class="va">ParticipantId</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.cd</span>, <span class="va">HBI.df</span>, by <span class="op">=</span> <span class="st">"ParticipantId"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span></span>
<span><span class="va">percHBI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">HBI</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Whilst HBI was collected via REDCap, substantial missingness is observed with 60% of CD subjects in the FC sub-cohort missing HBI.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">HBI</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#A167A5"</span>, color <span class="op">=</span> <span class="st">"#4A306D"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Harvey-Bradshaw index at time of recruitment"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-hbi" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-hbi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-hbi-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hbi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: Harvey-Bradshaw index for CD subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">HBI</span> <span class="op">~</span> <span class="va">cat</span>, data <span class="op">=</span> <span class="va">demo.cd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-hbi" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-hbi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;14: ANOVA between between Harvey-Bradshaw index and FC groups.
</figcaption><div aria-describedby="tbl-hbi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Df</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cat</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">13.1</td>
<td style="text-align: center;">6.548</td>
<td style="text-align: center;">1.174</td>
<td style="text-align: center;">0.3102</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Residuals</strong></td>
<td style="text-align: center;">441</td>
<td style="text-align: center;">2461</td>
<td style="text-align: center;">5.579</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="pro-2-in-crohns-disease" class="level3"><h3 class="anchored" data-anchor-id="pro-2-in-crohns-disease">PRO-2 in Crohn’s disease</h3>
<p>Sum of liquid stools per day and abdominal pain.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PRO2</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantno"</span>, <span class="st">"liq_stool_day"</span>, <span class="st">"abdo_pain"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">PRO2</span><span class="op">$</span><span class="va">liq_stool_day</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">PRO2</span><span class="op">$</span><span class="va">liq_stool_day</span><span class="op">)</span> <span class="co"># Drop ileostomies</span></span>
<span></span>
<span><span class="va">PRO2</span><span class="op">$</span><span class="va">PRO2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">PRO2</span>, <span class="va">liq_stool_day</span> <span class="op">+</span> <span class="va">abdo_pain</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PRO2</span><span class="op">$</span><span class="va">ParticipantNo</span> <span class="op">&lt;-</span> <span class="va">PRO2</span><span class="op">$</span><span class="va">participantno</span></span>
<span><span class="va">demo.cd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.cd</span>,</span>
<span>  <span class="va">PRO2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"PRO2"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">PRO2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#FF8552"</span>, color <span class="op">=</span> <span class="st">"#D2632A"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="IBD_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="smoking" class="level3"><h3 class="anchored" data-anchor-id="smoking">Smoking</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">percPrev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">temp</span><span class="op">$</span><span class="va">Smoke</span> <span class="op">==</span> <span class="st">"Previous"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">temp</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We consider smoking for CD and UC separately as smoking is often reported to worsen outcomes in CD but is possibly protective in UC. Smoking status is self-reported by study participants.</p>
<p>Whilst most subjects have never been a smoker, a substantial proportion of subjects (27%) have previously been smokers.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Smoke</span>, fill <span class="op">=</span> <span class="va">Smoke</span>, color <span class="op">=</span> <span class="va">Smoke</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Smoking status"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Smoking status"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Smoking status"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-smoke-cd" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-smoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-smoke-cd-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Smoking status for CD subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>Smoking status is associated with FC at recruitment for CD subjects.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">Smoke</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-smoke-cd" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-smoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;15: Chi-squared test between between smoking status and FC groups for CD subjects.
</figcaption><div aria-describedby="tbl-smoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.cd$Smoke</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">11.08</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.02572 *</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="e-cigarette-use" class="level3"><h3 class="anchored" data-anchor-id="e-cigarette-use">E-cigarette use</h3>
<p>The vast majority of participants do not report using some form of e-cigarettes. It should be noted that as recruitment ended March 2020, these day may not reflect more modern trends.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.cd</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ECigs</span>, fill <span class="op">=</span> <span class="va">ECigs</span>, color <span class="op">=</span> <span class="va">ECigs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"E-cigarette status"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"E-cigarette status"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"E-cigarette status"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-esmoke-cd" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-esmoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-esmoke-cd-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-esmoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: E-cigarette usage for CD subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.cd</span><span class="op">$</span><span class="va">ECigs</span>, <span class="va">demo.cd</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-esmoke-cd" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-esmoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;16: Chi-squared test between between E-cigarettte usage and FC groups for CD subjects.
</figcaption><div aria-describedby="tbl-esmoke-cd-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.cd$ECigs</code> and <code>demo.cd$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">5.96</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.2022</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section></section><section id="variables-only-relevant-to-ulcerative-colitisibdu-subjects" class="level2"><h2 class="anchored" data-anchor-id="variables-only-relevant-to-ulcerative-colitisibdu-subjects">Variables only relevant to ulcerative colitis/IBDU subjects</h2>
<p>This section looks at variables only relevant to UC/IBDU subjects: Montreal extent, Mayo score, Smoking status and E-cigarette use.</p>
<p>As PREdiCCt required subjects to be able to flare, this effectively excluded UC subjects who had undergone a proctocolectomy. As such, previous surgery is not considered. Montreal severity was not collected by PREdiCCt.</p>
<section id="montreal-extent" class="level3"><h3 class="anchored" data-anchor-id="montreal-extent">Montreal extent</h3>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mapping</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>  definition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"Rectum"</span>,</span>
<span>    <span class="st">"Recto-sigmoid"</span>,</span>
<span>    <span class="st">"&lt; Splenic"</span>,</span>
<span>    <span class="st">"&lt; Hepatic"</span>,</span>
<span>    <span class="st">"Total"</span>,</span>
<span>    <span class="st">"Unknown"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  mont <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">demo</span>, <span class="va">diagnosis2</span> <span class="op">==</span> <span class="st">"UC/IBDU"</span><span class="op">)</span></span>
<span><span class="va">redcap.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">redcap</span>, <span class="va">participantno</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">demo.uc</span><span class="op">$</span><span class="va">ParticipantNo</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">redcap.uc</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">redcap.uc</span><span class="op">)</span> <span class="op">==</span> <span class="st">"participantno"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"ParticipantNo"</span></span>
<span><span class="va">redcap.uc</span> <span class="op">&lt;-</span> <span class="va">redcap.uc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"max_extent"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">redcap.uc</span><span class="op">$</span><span class="va">Extent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/mapvalues.html">mapvalues</a></span><span class="op">(</span><span class="va">redcap.uc</span><span class="op">$</span><span class="va">max_extent</span>,</span>
<span>  from <span class="op">=</span> <span class="va">mapping</span><span class="op">$</span><span class="va">code</span>,</span>
<span>  to <span class="op">=</span> <span class="va">mapping</span><span class="op">$</span><span class="va">mont</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.uc</span>,</span>
<span>  <span class="va">redcap.uc</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"Extent"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">demo.uc</span><span class="op">$</span><span class="va">Extent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">demo.uc</span><span class="op">$</span><span class="va">Extent</span>,</span>
<span>  levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"E1"</span>, <span class="st">"E2"</span>, <span class="st">"E3"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Montreal extent has been obtained from REDCap. Similar to Montreal location, the extent of inflammation has been reported in more granular detail than is required for the Montreal classification. The below table shows how these definitions have been mapped to Montreal extent.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span><span class="op">(</span><span class="va">mapping</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Coding"</span>, <span class="st">"Definition"</span>, <span class="st">"Montreal extent"</span><span class="op">)</span>,</span>
<span>  align <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Coding</th>
<th style="text-align: center;">Definition</th>
<th style="text-align: center;">Montreal extent</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: center;">Rectum</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: center;">Recto-sigmoid</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: center;">&lt; Splenic</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: center;">&lt; Hepatic</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: center;">Total</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: center;">Unknown</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As can be seen in <a href="#fig-extent" class="quarto-xref">Figure&nbsp;15</a> E2 is the most common Montreal extent classification.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.uc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Extent</span>, fill <span class="op">=</span> <span class="va">Extent</span>, color <span class="op">=</span> <span class="va">Extent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Montreal extent"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#7AE7C7"</span>, <span class="st">"#440381"</span>, <span class="st">"#D64045"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#07A282"</span>, <span class="st">"#340165"</span>, <span class="st">"#942E31"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Montreal extent"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Montreal extent"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-extent" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-extent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-extent-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-extent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: Montreal extent for UC/IBDU subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>Montreal extent is not associated with FC</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.uc</span><span class="op">$</span><span class="va">Extent</span>, <span class="va">demo.uc</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-extent" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-extent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;17: Chi-squared test between Montreal extent and FC groups.
</figcaption><div aria-describedby="tbl-extent-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.uc$Extent</code> and <code>demo.uc$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 13%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">2.281</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.6842</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="mayo-score" class="level3"><h3 class="anchored" data-anchor-id="mayo-score">Mayo score</h3>
<p>Mayo score was collected via REDCap and is more complete than HBI.</p>
<div class="cell" data-fig-caption="Mayo score for UC/IBDU subjects in the FC cohort.">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">mayo.df</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantid"</span>, <span class="st">"current_mayo"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">mayo.df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantId"</span>, <span class="st">"Mayo"</span><span class="op">)</span></span>
<span><span class="va">mayo.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">mayo.df</span>, <span class="va">ParticipantId</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="va">demo.uc</span><span class="op">$</span><span class="va">ParticipantId</span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.uc</span>, <span class="va">mayo.df</span>, by <span class="op">=</span> <span class="st">"ParticipantId"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">demo.uc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">Mayo</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"#284B63"</span>, color <span class="op">=</span> <span class="st">"#153243"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Mayo score at time of recruitment"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-mayo" class="quarto-figure quarto-figure-center quarto-float anchored" width="672">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mayo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-mayo-1.png" id="fig-mayo" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-mayo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16
</figcaption></figure>
</div>
</div>
</div>
<p>Mayo score is highly significantly associated with FC.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/aov.html">aov</a></span><span class="op">(</span><span class="va">Mayo</span> <span class="op">~</span> <span class="va">cat</span>, data <span class="op">=</span> <span class="va">demo.uc</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-mayo" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mayo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;18: ANOVA between between Mayo score and FC groups.
</figcaption><div aria-describedby="tbl-mayo-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Analysis of Variance Model</caption>
<colgroup>
<col style="width: 22%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Df</th>
<th style="text-align: center;">Sum Sq</th>
<th style="text-align: center;">Mean Sq</th>
<th style="text-align: center;">F value</th>
<th style="text-align: center;">Pr(&gt;F)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>cat</strong></td>
<td style="text-align: center;">2</td>
<td style="text-align: center;">25.2</td>
<td style="text-align: center;">12.6</td>
<td style="text-align: center;">8.212</td>
<td style="text-align: center;">0.0002973</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>Residuals</strong></td>
<td style="text-align: center;">732</td>
<td style="text-align: center;">1123</td>
<td style="text-align: center;">1.534</td>
<td style="text-align: center;">NA</td>
<td style="text-align: center;">NA</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="pro-2-in-ulcerative-colitis" class="level3"><h3 class="anchored" data-anchor-id="pro-2-in-ulcerative-colitis">PRO-2 in ulcerative colitis</h3>
<p>Sum of stool frequency and rectal bleeding categories.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">PRO2</span> <span class="op">&lt;-</span> <span class="va">redcap</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"participantno"</span>, <span class="st">"stool_freq"</span>, <span class="st">"rectal_bleed"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">PRO2</span><span class="op">$</span><span class="va">PRO2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html">with</a></span><span class="op">(</span><span class="va">PRO2</span>, <span class="va">stool_freq</span> <span class="op">+</span> <span class="va">rectal_bleed</span><span class="op">)</span></span>
<span></span>
<span><span class="va">PRO2</span><span class="op">$</span><span class="va">ParticipantNo</span> <span class="op">&lt;-</span> <span class="va">PRO2</span><span class="op">$</span><span class="va">participantno</span></span>
<span><span class="va">demo.uc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html">merge</a></span><span class="op">(</span><span class="va">demo.uc</span>,</span>
<span>  <span class="va">PRO2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"ParticipantNo"</span>, <span class="st">"PRO2"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>  by <span class="op">=</span> <span class="st">"ParticipantNo"</span>,</span>
<span>  all.x <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  all.y <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">demo.uc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span><span class="op">(</span><span class="va">PRO2</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">diagnosis2</span>, color <span class="op">=</span> <span class="va">diagnosis2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"#FF8552"</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="st">"#D2632A"</span>, na.value <span class="op">=</span> <span class="st">"#032B43"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div>
<figure class="figure"><p><img src="IBD_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section><section id="smoking-1" class="level3"><h3 class="anchored" data-anchor-id="smoking-1">Smoking</h3>
<p>As with CD subjects, smoking status for UC/IBDU subjects is self-reported.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.uc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Smoke</span>, fill <span class="op">=</span> <span class="va">Smoke</span>, color <span class="op">=</span> <span class="va">Smoke</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Smoking status"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Smoking status"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Smoking status"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-smoke-uc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-smoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-smoke-uc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-smoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: Smoking status for UC/IBDU subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>As with CD, smoking status is significantly associated with FC.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/chisq.test.html">chisq.test</a></span><span class="op">(</span><span class="va">demo.uc</span><span class="op">$</span><span class="va">Smoke</span>, <span class="va">demo.uc</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-smoke-uc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-smoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;19: Chi-squared test between between smoking status and FC groups for UC subjects.
</figcaption><div aria-describedby="tbl-smoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Pearson’s Chi-squared test: <code>demo.uc$Smoke</code> and <code>demo.uc$cat</code>
</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 6%">
<col style="width: 16%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">Test statistic</th>
<th style="text-align: center;">df</th>
<th style="text-align: center;">P value</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">9.781</td>
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.04427 *</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="e-cigarette-use-1" class="level3"><h3 class="anchored" data-anchor-id="e-cigarette-use-1">E-cigarette use</h3>
<p>Similar to CD, very few subjects reported using E-cigarettes.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb51"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">demo.uc</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="va">cat</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">ECigs</span>, fill <span class="op">=</span> <span class="va">ECigs</span>, color <span class="op">=</span> <span class="va">ECigs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"E-cigarette status"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Frequency"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span><span class="op">)</span>,</span>
<span>    na.value <span class="op">=</span> <span class="st">"#032B43"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"E-cigarette status"</span><span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"E-cigarette status"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<div id="fig-esmoke-uc" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-esmoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="IBD_files/figure-html/fig-esmoke-uc-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-esmoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: E-cigarette usage for UC subjects in the FC cohort.
</figcaption></figure>
</div>
</div>
</div>
<p>E-cigarette use was found to significantly differ between FC groups in UC. However, the low number of subjects reported to use E-cigarettes (<a href="#fig-esmoke-uc" class="quarto-xref">Figure&nbsp;18</a>) should be beared in mind when interpretting this finding.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pander/man/pander.html">pander</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/fisher.test.html">fisher.test</a></span><span class="op">(</span><span class="va">demo.uc</span><span class="op">$</span><span class="va">ECigs</span>, <span class="va">demo.uc</span><span class="op">$</span><span class="va">cat</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div id="tbl-esmoke-uc" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-esmoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;20: Chi-squared test between between E-cigarettte usage and FC groups for UC subjects.
</figcaption><div aria-describedby="tbl-esmoke-uc-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell table table-sm table-striped small">
<caption>Fisher’s Exact Test for Count Data: <code>demo.uc$ECigs</code> and <code>demo.uc$cat</code>
</caption>
<colgroup>
<col style="width: 15%">
<col style="width: 34%">
</colgroup>
<thead><tr class="header">
<th style="text-align: center;">P value</th>
<th style="text-align: center;">Alternative hypothesis</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: center;">0.0196 *</td>
<td style="text-align: center;">two.sided</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb53"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">demo</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"demo-IBD.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">demo.cd</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"demo-cd.RDS"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">demo.uc</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">outdir</span>, <span class="st">"demo-uc.RDS"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section></section><div id="quarto-appendix" class="default"><section id="reproducibility-reproduction" class="level2 appendix"><h2 class="anchored quarto-appendix-heading">Reproducibility &amp; reproduction</h2><div class="quarto-appendix-contents">
<details class="appendix"><summary>
Session info
</summary><div class="cell">
<div class="cell-output-display">
<p><strong>R version 4.4.0 (2024-04-24)</strong></p>
<p><strong>Platform:</strong> aarch64-unknown-linux-gnu</p>
<p><strong>locale:</strong> <em>LC_CTYPE=en_US.UTF-8</em>, <em>LC_NUMERIC=C</em>, <em>LC_TIME=en_US.UTF-8</em>, <em>LC_COLLATE=en_US.UTF-8</em>, <em>LC_MONETARY=en_US.UTF-8</em>, <em>LC_MESSAGES=en_US.UTF-8</em>, <em>LC_PAPER=en_US.UTF-8</em>, <em>LC_NAME=C</em>, <em>LC_ADDRESS=C</em>, <em>LC_TELEPHONE=C</em>, <em>LC_MEASUREMENT=en_US.UTF-8</em> and <em>LC_IDENTIFICATION=C</em></p>
<p><strong>attached base packages:</strong> <em>stats</em>, <em>graphics</em>, <em>grDevices</em>, <em>utils</em>, <em>datasets</em>, <em>methods</em> and <em>base</em></p>
<p><strong>other attached packages:</strong> <em>DiagrammeRsvg(v.0.1)</em>, <em>DiagrammeR(v.1.0.11)</em>, <em>pander(v.0.6.5)</em>, <em>knitr(v.1.47)</em>, <em>table1(v.1.4.3)</em>, <em>patchwork(v.1.2.0)</em>, <em>datefixR(v.1.6.1)</em>, <em>readxl(v.1.4.3)</em>, <em>lubridate(v.1.9.3)</em>, <em>forcats(v.1.0.0)</em>, <em>stringr(v.1.5.1)</em>, <em>dplyr(v.1.1.4)</em>, <em>purrr(v.1.0.2)</em>, <em>readr(v.2.1.5)</em>, <em>tidyr(v.1.3.1)</em>, <em>tibble(v.3.2.1)</em>, <em>ggplot2(v.3.5.1)</em>, <em>tidyverse(v.2.0.0)</em> and <em>plyr(v.1.8.9)</em></p>
<p><strong>loaded via a namespace (and not attached):</strong> <em>viridis(v.0.6.5)</em>, <em>utf8(v.1.2.4)</em>, <em>generics(v.0.1.3)</em>, <em>stringi(v.1.8.4)</em>, <em>hms(v.1.1.3)</em>, <em>digest(v.0.6.35)</em>, <em>magrittr(v.2.0.3)</em>, <em>evaluate(v.0.23)</em>, <em>grid(v.4.4.0)</em>, <em>timechange(v.0.3.0)</em>, <em>RColorBrewer(v.1.1-3)</em>, <em>fastmap(v.1.2.0)</em>, <em>cellranger(v.1.1.0)</em>, <em>jsonlite(v.1.8.8)</em>, <em>Formula(v.1.2-5)</em>, <em>gridExtra(v.2.3)</em>, <em>fansi(v.1.0.6)</em>, <em>viridisLite(v.0.4.2)</em>, <em>scales(v.1.3.0)</em>, <em>textshaping(v.0.4.0)</em>, <em>codetools(v.0.2-20)</em>, <em>cli(v.3.6.2)</em>, <em>rlang(v.1.1.3)</em>, <em>visNetwork(v.2.1.2)</em>, <em>munsell(v.0.5.1)</em>, <em>withr(v.3.0.0)</em>, <em>yaml(v.2.3.8)</em>, <em>tools(v.4.4.0)</em>, <em>tzdb(v.0.4.0)</em>, <em>colorspace(v.2.1-0)</em>, <em>curl(v.5.2.1)</em>, <em>vctrs(v.0.6.5)</em>, <em>R6(v.2.5.1)</em>, <em>lifecycle(v.1.0.4)</em>, <em>V8(v.4.4.2)</em>, <em>htmlwidgets(v.1.6.4)</em>, <em>ragg(v.1.3.2)</em>, <em>pkgconfig(v.2.0.3)</em>, <em>pillar(v.1.9.0)</em>, <em>gtable(v.0.3.5)</em>, <em>glue(v.1.7.0)</em>, <em>Rcpp(v.1.0.12)</em>, <em>systemfonts(v.1.1.0)</em>, <em>xfun(v.0.44)</em>, <em>tidyselect(v.1.2.1)</em>, <em>farver(v.2.1.2)</em>, <em>htmltools(v.0.5.8.1)</em>, <em>labeling(v.0.4.3)</em>, <em>rmarkdown(v.2.27)</em> and <em>compiler(v.4.4.0)</em></p>
</div>
</div>
</details><p>Licensed by <a href="https://creativecommons.org/licenses/by/4.0/">CC BY</a> unless otherwise stated.</p>


<!-- -->


</div></section><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bodger_2013" class="csl-entry" role="listitem">
Bodger, Keith, Clare Ormerod, Daniela Shackcloth, and Melanie Harrison. 2013. <span>“Development and Validation of a Rapid, Generic Measure of Disease Control from the Patient’s Perspective: The IBD-Control Questionnaire.”</span> <em>Gut</em> 63 (7): 1092–102. <a href="https://doi.org/10.1136/gutjnl-2013-305600">https://doi.org/10.1136/gutjnl-2013-305600</a>.
</div>
<div id="ref-silverbergIntegratedClinicalMolecular2005" class="csl-entry" role="listitem">
Silverberg, Mark S., Jack Satsangi, Tariq Ahmad, Ian DR Arnott, Charles N. Bernstein, Steven R. Brant, Renzo Caprilli, et al. 2005. <span>“Toward an Integrated Clinical, Molecular and Serological Classification of Inflammatory Bowel Disease: <span>Report</span> of a Working Party of the 2005 <span>Montreal World Congress</span> of <span>Gastroenterology</span>.”</span> <em>Canadian Journal of Gastroenterology and Hepatology</em> 19 (September): 5A–36A. <a href="https://doi.org/10.1155/2005/269076">https://doi.org/10.1155/2005/269076</a>.
</div>
</div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="../Baseline/Demographics.html" class="pagination-link" aria-label="Cohort demographics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Cohort demographics</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../Baseline/Biochemistry.html" class="pagination-link" aria-label="Biochemistry data">
        <span class="nav-page-text">Biochemistry data</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb54" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Inflammatory bowel disease"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Nathan Constantine-Cooke"</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">    corresponding: true</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://scholar.google.com/citations?user=2emHWR0AAAAJ&amp;hl=en&amp;oi=ao</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co">      - ref: CGEM</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">      - ref: HGU</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: "Chiara Cotronei"</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://www.research.ed.ac.uk/en/persons/chiara-cotronei</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliations:</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co">      - ref: Lothian</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> Baseline.bib   </span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Packages ##</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="do">##############</span></span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr) <span class="co"># Used for mapping values</span></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(tidyverse)) <span class="co"># ggplot2, dplyr, and magrittr</span></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl) <span class="co"># Read in Excel files</span></span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate) <span class="co"># Handle dates</span></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(datefixR) <span class="co"># Standardise dates</span></span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork) <span class="co"># Arrange ggplots</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate tables</span></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>(<span class="fu">library</span>(table1))</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate flowchart of cohort derivation</span></span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeRsvg)</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="co"># paths to PREdiCCt data</span></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">file.exists</span>(<span class="st">"/docker"</span>)) { <span class="co"># If running in docker</span></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>  data.path <span class="ot">&lt;-</span> <span class="st">"data/final/20221004/"</span></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>  redcap.path <span class="ot">&lt;-</span> <span class="st">"data/final/20231030/"</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>  prefix <span class="ot">&lt;-</span> <span class="st">"data/end-of-follow-up/"</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>  outdir <span class="ot">&lt;-</span> <span class="st">"data/processed/"</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> { <span class="co"># Run on OS directly</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a>  data.path <span class="ot">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/final/20221004/"</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>  redcap.path <span class="ot">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/final/20231030/"</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>  prefix <span class="ot">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/end-of-follow-up/"</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>  outdir <span class="ot">&lt;-</span> <span class="st">"/Volumes/igmm/cvallejo-predicct/predicct/processed/"</span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(outdir, <span class="st">"demo-demographics.RDS"</span>))</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(outdir, <span class="st">"demo-cd.RDS"</span>))</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="fu">paste0</span>(outdir, <span class="st">"demo-uc.RDS"</span>))</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>This page explores data which describes subjects' IBD, primarily consisting of </span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>clinical data. </span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="fu">## IBD type</span></span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>For this study, we have grouped ulcerative colitis (UC) and inflammatory bowel</span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>disease unclassified (IBDU) into one category. </span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>IBD type is self-reported.</span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>Whilst PREdiCCt was designed to recruit an equal number of CD and UC/IBDU</span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>subjects, the COVID-19 pandemic halted recruitment which has resulted in there</span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>not being an equal balance of CD and UC/IBDU subjects.There are slightly more</span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>Crohn's disease (CD) than UC/IBDU subjects in the FC cohort.</span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-IBD-dist</span></span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of IBD type in the FC cohort."</span></span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>demo<span class="sc">$</span>diagnosis2 <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(demo<span class="sc">$</span>diagnosis,</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CD"</span>, <span class="st">"UC/IBDU"</span>))</span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>demo<span class="sc">$</span>diagnosis <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(demo<span class="sc">$</span>diagnosis,</span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>),</span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(<span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>), <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"CD"</span>, <span class="st">"UC"</span>, <span class="st">"IBDU"</span>))</span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a>demo <span class="sc">%&gt;%</span></span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> diagnosis2, <span class="at">fill =</span> diagnosis2, <span class="at">color =</span> diagnosis2)) <span class="sc">+</span></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"IBD type"</span>) <span class="sc">+</span></span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#2B2D42"</span>, <span class="st">"#92DCE5"</span>)) <span class="sc">+</span></span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#1E203A"</span>, <span class="st">"#1D9BA5"</span>)) <span class="sc">+</span></span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-104"><a href="#cb54-104" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"IBD type"</span>),</span>
<span id="cb54-105"><a href="#cb54-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"IBD type"</span>)</span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a>IBD type is significantly associated with FC at recruitment. </span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-IBD-fc</span></span>
<span id="cb54-115"><a href="#cb54-115" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between IBD type and FC groups."</span></span>
<span id="cb54-116"><a href="#cb54-116" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo<span class="sc">$</span>diagnosis2, demo<span class="sc">$</span>cat))</span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a><span class="fu">##  Disease duration</span></span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-121"><a href="#cb54-121" aria-hidden="true" tabindex="-1"></a>Disease duration has been calculated by subtracting reported date of</span>
<span id="cb54-122"><a href="#cb54-122" aria-hidden="true" tabindex="-1"></a>diagnosis from the date of entry into PREdiCCt. Date of diagnosis has been</span>
<span id="cb54-123"><a href="#cb54-123" aria-hidden="true" tabindex="-1"></a>obtained via REDcap. Where only year was available, </span>
<span id="cb54-124"><a href="#cb54-124" aria-hidden="true" tabindex="-1"></a>the <span class="co">[</span><span class="ot">datefixR R package</span><span class="co">](https://docs.ropensci.org/datefixR/)</span> was used to impute</span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a>the middle of the year. Any disease durations reported to be negative using this</span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a>method were mapped to 0. </span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-130"><a href="#cb54-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb54-132"><a href="#cb54-132" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-duration-hist</span></span>
<span id="cb54-133"><a href="#cb54-133" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-caption: "Distribution of disease duration at study recruitment stratified by IBD type."</span></span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a>redcap <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(redcap.path, <span class="st">"redcap_clean.xlsx"</span>))</span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a>redcap <span class="ot">&lt;-</span> <span class="fu">distinct</span>(redcap, participantno, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-137"><a href="#cb54-137" aria-hidden="true" tabindex="-1"></a>diag.date <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantno"</span>, <span class="st">"date_diag"</span>)]</span>
<span id="cb54-138"><a href="#cb54-138" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(diag.date)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"ParticipantNo"</span></span>
<span id="cb54-139"><a href="#cb54-139" aria-hidden="true" tabindex="-1"></a>diag.date <span class="ot">&lt;-</span> <span class="fu">subset</span>(diag.date, (<span class="sc">!</span><span class="fu">is.na</span>(date_diag)) <span class="sc">&amp;</span></span>
<span id="cb54-140"><a href="#cb54-140" aria-hidden="true" tabindex="-1"></a>  (<span class="sc">!</span><span class="fu">is.null</span>(date_diag)) <span class="sc">&amp;</span></span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a>  date_diag <span class="sc">!=</span> <span class="st">""</span>)</span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> <span class="fu">merge</span>(diag.date,</span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a>  demo,</span>
<span id="cb54-144"><a href="#cb54-144" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-145"><a href="#cb54-145" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">FALSE</span>,</span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">TRUE</span></span>
<span id="cb54-147"><a href="#cb54-147" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-148"><a href="#cb54-148" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> <span class="fu">distinct</span>(duration, ParticipantNo, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> <span class="fu">subset</span>(duration, <span class="fu">tolower</span>(date_diag) <span class="sc">!=</span> <span class="st">"unknown"</span>)</span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a>duration[duration[, <span class="st">"date_diag"</span>] <span class="sc">==</span> <span class="st">"16/032016"</span>, <span class="st">"date_diag"</span>] <span class="ot">&lt;-</span> <span class="st">"16/03/2016"</span></span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a>duration[duration[, <span class="st">"date_diag"</span>] <span class="sc">==</span> <span class="st">"19/04/2017P"</span>, <span class="st">"date_diag"</span>] <span class="ot">&lt;-</span> <span class="st">"19/04/2017"</span></span>
<span id="cb54-153"><a href="#cb54-153" aria-hidden="true" tabindex="-1"></a>duration[duration[, <span class="st">"date_diag"</span>] <span class="sc">==</span> <span class="st">"2007 APPROX"</span>, <span class="st">"date_diag"</span>] <span class="ot">&lt;-</span> <span class="st">"2007"</span></span>
<span id="cb54-154"><a href="#cb54-154" aria-hidden="true" tabindex="-1"></a>duration[duration[, <span class="st">"date_diag"</span>] <span class="sc">==</span> <span class="st">"approx 1988"</span>, <span class="st">"date_diag"</span>] <span class="ot">&lt;-</span> <span class="st">"1988"</span></span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a>duration[duration[, <span class="st">"date_diag"</span>] <span class="sc">==</span> <span class="st">"?2014"</span>, <span class="st">"date_diag"</span>] <span class="ot">&lt;-</span> <span class="st">"2014"</span></span>
<span id="cb54-156"><a href="#cb54-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-157"><a href="#cb54-157" aria-hidden="true" tabindex="-1"></a>duration <span class="ot">&lt;-</span> <span class="fu">fix_date_df</span>(duration, <span class="fu">c</span>(<span class="st">"entry_date"</span>, <span class="st">"date_diag"</span>))</span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a>duration<span class="sc">$</span>duration <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">with</span>(</span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a>  duration,</span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a>  (entry_date <span class="sc">-</span> date_diag) <span class="sc">/</span> <span class="fl">365.25</span></span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-164"><a href="#cb54-164" aria-hidden="true" tabindex="-1"></a>duration[duration[, <span class="st">"duration"</span>] <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="st">"duration"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb54-165"><a href="#cb54-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>duration.cd <span class="ot">&lt;-</span> <span class="fu">subset</span>(duration, diagnosis <span class="sc">==</span> <span class="st">"1"</span>)</span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a>duration.uc <span class="ot">&lt;-</span> <span class="fu">subset</span>(duration, diagnosis <span class="sc">!=</span> <span class="st">"1"</span>)</span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> duration <span class="sc">%&gt;%</span></span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> duration, <span class="at">color =</span> diagnosis2, <span class="at">fill =</span> diagnosis2)) <span class="sc">+</span></span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-176"><a href="#cb54-176" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Duration (years)"</span>,</span>
<span id="cb54-177"><a href="#cb54-177" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"IBD type"</span>,</span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"IBD type"</span></span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#CDEDF6"</span>, <span class="st">"#FF6B6B"</span>)</span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-185"><a href="#cb54-185" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#5EB1BF"</span>, <span class="st">"#C24343"</span>)</span>
<span id="cb54-186"><a href="#cb54-186" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-187"><a href="#cb54-187" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"plots/Duration-full-cohort.png"</span>,</span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a>  p,</span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">9</span>,</span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">6</span></span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"plots/Duration-full-cohort.pdf"</span>, p, <span class="at">width =</span> <span class="dv">9</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-194"><a href="#cb54-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-195"><a href="#cb54-195" aria-hidden="true" tabindex="-1"></a>duration <span class="sc">%&gt;%</span></span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(duration) <span class="sc">%&gt;%</span></span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> duration, <span class="at">color =</span> diagnosis2, <span class="at">fill =</span> diagnosis2)) <span class="sc">+</span></span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">25</span>) <span class="sc">+</span></span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-200"><a href="#cb54-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb54-201"><a href="#cb54-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Duration (years)"</span>,</span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Frequency"</span>,</span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">"IBD type"</span>,</span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"IBD type"</span></span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-206"><a href="#cb54-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-207"><a href="#cb54-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#CDEDF6"</span>, <span class="st">"#FF6B6B"</span>)</span>
<span id="cb54-208"><a href="#cb54-208" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-209"><a href="#cb54-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-210"><a href="#cb54-210" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#5EB1BF"</span>, <span class="st">"#C24343"</span>)</span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a>Whilst a  low p-value was observed, disease duration was not significantly</span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a>different between FC groups.</span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-220"><a href="#cb54-220" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-duration-fc</span></span>
<span id="cb54-221"><a href="#cb54-221" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "ANOVA between IBD disease duration and FC groups."</span></span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo, duration[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"duration"</span>)],</span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-224"><a href="#cb54-224" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-225"><a href="#cb54-225" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-226"><a href="#cb54-226" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-227"><a href="#cb54-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(demo)[<span class="dv">18</span>] <span class="ot">&lt;-</span> <span class="st">"IBD Duration"</span></span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(<span class="fu">aov</span>(<span class="st">`</span><span class="at">IBD Duration</span><span class="st">`</span> <span class="sc">~</span> cat, <span class="at">data =</span> demo)))</span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-232"><a href="#cb54-232" aria-hidden="true" tabindex="-1"></a><span class="fu">## IBD Control</span></span>
<span id="cb54-233"><a href="#cb54-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-237"><a href="#cb54-237" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: control-8-dist</span></span>
<span id="cb54-238"><a href="#cb54-238" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of Control-8 scores (least to most controlled)."</span></span>
<span id="cb54-239"><a href="#cb54-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(data.path, <span class="st">"Baseline2022/IBD.xlsx"</span>))</span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a><span class="co"># create flare_group in IBD_C and make into level</span></span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-244"><a href="#cb54-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">flare_group =</span> <span class="fu">ifelse</span>(FlaresInPastYear <span class="sc">==</span> <span class="dv">0</span>,</span>
<span id="cb54-245"><a href="#cb54-245" aria-hidden="true" tabindex="-1"></a>    <span class="st">"No Flares"</span>,</span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1 or More Flares"</span></span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a>IBD<span class="sc">$</span>flare_group <span class="ot">&lt;-</span> <span class="fu">factor</span>(IBD<span class="sc">$</span>flare_group,</span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"No Flares"</span>, <span class="st">"1 or More Flares"</span>)</span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-251"><a href="#cb54-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-252"><a href="#cb54-252" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-253"><a href="#cb54-253" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">ifelse</span>(TreatmentUseful <span class="sc">==</span> <span class="dv">4</span>,</span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Not On Treatment"</span>,</span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"On Treatment"</span></span>
<span id="cb54-256"><a href="#cb54-256" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb54-257"><a href="#cb54-257" aria-hidden="true" tabindex="-1"></a>IBD<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(IBD<span class="sc">$</span>treatment,</span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Not On Treatment"</span>, <span class="st">"On Treatment"</span>)</span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a><span class="co"># correcting scores where No is favourable and Yes is unfavourable outcomes</span></span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a><span class="co"># answer options were always YES/NO/Not sure</span></span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(IBD<span class="sc">$</span>MissPlannedActivities <span class="sc">==</span> <span class="dv">3</span>)) {</span>
<span id="cb54-264"><a href="#cb54-264" aria-hidden="true" tabindex="-1"></a>  IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-265"><a href="#cb54-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(</span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a>      <span class="fu">vars</span>(<span class="st">"MissPlannedActivities"</span><span class="sc">:</span><span class="st">"NewSymptoms"</span>),</span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">recode</span>(., <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>)</span>
<span id="cb54-268"><a href="#cb54-268" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-269"><a href="#cb54-269" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-270"><a href="#cb54-270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-271"><a href="#cb54-271" aria-hidden="true" tabindex="-1"></a><span class="co"># correct TreatmentUseful (Yes is favourable, No unfavourable)</span></span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a><span class="co"># not on treatment was assigned the value 1</span></span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="fu">any</span>(IBD<span class="sc">$</span>TreatmentUseful <span class="sc">==</span> <span class="dv">3</span>)) {</span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a>  IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-275"><a href="#cb54-275" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_at</span>(</span>
<span id="cb54-276"><a href="#cb54-276" aria-hidden="true" tabindex="-1"></a>      <span class="st">"TreatmentUseful"</span>,</span>
<span id="cb54-277"><a href="#cb54-277" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> <span class="fu">recode</span>(., <span class="st">`</span><span class="at">4</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span>, <span class="st">`</span><span class="at">3</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">`</span><span class="at">2</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">0</span>, <span class="st">`</span><span class="at">1</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">2</span>)</span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a><span class="co"># exclude rows with missing data, 17 participants excluded for missing IBD-control questionnaire data</span></span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">rowSums</span>(<span class="fu">is.na</span>(<span class="fu">select</span>(., <span class="dv">17</span><span class="sc">:</span><span class="dv">27</span>))) <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a><span class="co"># new column with total control score</span></span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">control_score =</span> <span class="fu">rowSums</span>(<span class="fu">select</span>(., <span class="dv">17</span><span class="sc">:</span><span class="dv">27</span>), <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a><span class="co"># new column with IBD-control-8 score</span></span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a><span class="co"># added 2 to make comparable to future scores where the first question is asked to make comparable to future and against the cut off of 13 which indicates remission</span></span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-292"><a href="#cb54-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">control_8 =</span> TreatmentUseful <span class="sc">+</span></span>
<span id="cb54-293"><a href="#cb54-293" aria-hidden="true" tabindex="-1"></a>    MissPlannedActivities <span class="sc">+</span></span>
<span id="cb54-294"><a href="#cb54-294" aria-hidden="true" tabindex="-1"></a>    WakeUpAtNight <span class="sc">+</span></span>
<span id="cb54-295"><a href="#cb54-295" aria-hidden="true" tabindex="-1"></a>    SignificantPain <span class="sc">+</span></span>
<span id="cb54-296"><a href="#cb54-296" aria-hidden="true" tabindex="-1"></a>    OftenLackEnergy <span class="sc">+</span></span>
<span id="cb54-297"><a href="#cb54-297" aria-hidden="true" tabindex="-1"></a>    AnxiousDepressed <span class="sc">+</span></span>
<span id="cb54-298"><a href="#cb54-298" aria-hidden="true" tabindex="-1"></a>    NeedChangeTreatment <span class="sc">+</span></span>
<span id="cb54-299"><a href="#cb54-299" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>)</span>
<span id="cb54-300"><a href="#cb54-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-301"><a href="#cb54-301" aria-hidden="true" tabindex="-1"></a><span class="co"># create groups with cut off of IBD-control-8 scores quiescent (13 or above)/not quiescent</span></span>
<span id="cb54-302"><a href="#cb54-302" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-303"><a href="#cb54-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">control_grouped =</span> <span class="fu">ifelse</span>(control_8 <span class="sc">&gt;=</span> <span class="dv">13</span>, <span class="st">"13-16"</span>, <span class="st">"0-12"</span>))</span>
<span id="cb54-304"><a href="#cb54-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-305"><a href="#cb54-305" aria-hidden="true" tabindex="-1"></a>IBD<span class="sc">$</span>control_8 <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(IBD<span class="sc">$</span>control_8)</span>
<span id="cb54-306"><a href="#cb54-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-307"><a href="#cb54-307" aria-hidden="true" tabindex="-1"></a>IBD <span class="ot">&lt;-</span> IBD <span class="sc">%&gt;%</span></span>
<span id="cb54-308"><a href="#cb54-308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vas_control =</span> <span class="fu">ifelse</span>(OverallControl <span class="sc">&gt;=</span> <span class="dv">85</span>, <span class="st">"85+"</span>, <span class="st">"&lt;85"</span>))</span>
<span id="cb54-309"><a href="#cb54-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-310"><a href="#cb54-310" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo, IBD[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"control_8"</span>, <span class="st">"OverallControl"</span>, <span class="st">"vas_control"</span>)],</span>
<span id="cb54-311"><a href="#cb54-311" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-312"><a href="#cb54-312" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-313"><a href="#cb54-313" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-314"><a href="#cb54-314" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-315"><a href="#cb54-315" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-316"><a href="#cb54-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-317"><a href="#cb54-317" aria-hidden="true" tabindex="-1"></a>IBD Control is a validated questionnaire designed to assess disease control</span>
<span id="cb54-318"><a href="#cb54-318" aria-hidden="true" tabindex="-1"></a>from a patient's perspective <span class="co">[</span><span class="ot">@Bodger_2013</span><span class="co">]</span>. We considered an eight question</span>
<span id="cb54-319"><a href="#cb54-319" aria-hidden="true" tabindex="-1"></a>subset, IBD-Control-8 which ranges in potential scores from 0 to 16. We also</span>
<span id="cb54-320"><a href="#cb54-320" aria-hidden="true" tabindex="-1"></a>consider the IBD-Control visual analogue scale (VAS). @Bodger_2013 found a</span>
<span id="cb54-321"><a href="#cb54-321" aria-hidden="true" tabindex="-1"></a>cut-off of $\geq 13$ for IBD-Control-8 and a cut-off of $\geq 85$ for</span>
<span id="cb54-322"><a href="#cb54-322" aria-hidden="true" tabindex="-1"></a>IBD-Control-VAS to be optimal for identifying quiescent disease.</span>
<span id="cb54-323"><a href="#cb54-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-326"><a href="#cb54-326" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-327"><a href="#cb54-327" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-IBD-control</span></span>
<span id="cb54-328"><a href="#cb54-328" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distributiuon of IBD Control scores for (A) Control-8 and (B) Visual analogue scale. The vertical red lines denote the cut-offs for quiescent disease reported by @Bodger_2013."</span></span>
<span id="cb54-329"><a href="#cb54-329" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb54-330"><a href="#cb54-330" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb54-331"><a href="#cb54-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-332"><a href="#cb54-332" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> control_8, <span class="at">color =</span> control_8, <span class="at">fill =</span> control_8)) <span class="sc">+</span></span>
<span id="cb54-333"><a href="#cb54-333" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-334"><a href="#cb54-334" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-335"><a href="#cb54-335" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb54-336"><a href="#cb54-336" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Control-8 Scores"</span>) <span class="sc">+</span></span>
<span id="cb54-337"><a href="#cb54-337" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-338"><a href="#cb54-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">15</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-339"><a href="#cb54-339" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> viridis<span class="sc">::</span><span class="fu">viridis</span>(<span class="dv">15</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-340"><a href="#cb54-340" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">11.5</span>, <span class="at">color =</span> <span class="st">"#FF4B3E"</span>)</span>
<span id="cb54-341"><a href="#cb54-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-342"><a href="#cb54-342" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb54-343"><a href="#cb54-343" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-344"><a href="#cb54-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> OverallControl)) <span class="sc">+</span></span>
<span id="cb54-345"><a href="#cb54-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">"#FFD23F"</span>, <span class="at">color =</span> <span class="st">"#947805"</span>) <span class="sc">+</span></span>
<span id="cb54-346"><a href="#cb54-346" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-347"><a href="#cb54-347" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"VAS Scores"</span>) <span class="sc">+</span></span>
<span id="cb54-348"><a href="#cb54-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-349"><a href="#cb54-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">85</span>, <span class="at">color =</span> <span class="st">"#FF4B3E"</span>) <span class="sc">+</span></span>
<span id="cb54-350"><a href="#cb54-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">10</span>))</span>
<span id="cb54-351"><a href="#cb54-351" aria-hidden="true" tabindex="-1"></a>p1 <span class="sc">/</span> p2 <span class="sc">+</span> <span class="fu">plot_annotation</span>(<span class="at">tag_levels =</span> <span class="st">"A"</span>)</span>
<span id="cb54-352"><a href="#cb54-352" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-353"><a href="#cb54-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-354"><a href="#cb54-354" aria-hidden="true" tabindex="-1"></a>IBD-Control-8 scores and VAS were both found to be significantly associated with</span>
<span id="cb54-355"><a href="#cb54-355" aria-hidden="true" tabindex="-1"></a>FC.</span>
<span id="cb54-356"><a href="#cb54-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-359"><a href="#cb54-359" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-360"><a href="#cb54-360" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-control-8-fc</span></span>
<span id="cb54-361"><a href="#cb54-361" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "ANOVA between control-8 and FC groups."</span></span>
<span id="cb54-362"><a href="#cb54-362" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(<span class="fu">aov</span>(<span class="fu">as.numeric</span>(control_8) <span class="sc">~</span> cat, <span class="at">data =</span> demo)))</span>
<span id="cb54-363"><a href="#cb54-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-364"><a href="#cb54-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-365"><a href="#cb54-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-368"><a href="#cb54-368" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-369"><a href="#cb54-369" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-control-vas-fc</span></span>
<span id="cb54-370"><a href="#cb54-370" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "ANOVA between control VAS and FC groups."</span></span>
<span id="cb54-371"><a href="#cb54-371" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(<span class="fu">aov</span>(OverallControl <span class="sc">~</span> cat, <span class="at">data =</span> demo)))</span>
<span id="cb54-372"><a href="#cb54-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-373"><a href="#cb54-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-374"><a href="#cb54-374" aria-hidden="true" tabindex="-1"></a>Instead to treating VAS as a continuous value, going forward, VAS will be</span>
<span id="cb54-375"><a href="#cb54-375" aria-hidden="true" tabindex="-1"></a>discretised into  below 85 and 85 and above as a VAS of 85 was found by</span>
<span id="cb54-376"><a href="#cb54-376" aria-hidden="true" tabindex="-1"></a>@Bodger_2013 to be predictive of quiescent disease.</span>
<span id="cb54-377"><a href="#cb54-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-380"><a href="#cb54-380" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-381"><a href="#cb54-381" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-VAS-dist</span></span>
<span id="cb54-382"><a href="#cb54-382" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Distribution of discretised IBD-Control-VAS scores."</span></span>
<span id="cb54-383"><a href="#cb54-383" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> demo <span class="sc">%&gt;%</span></span>
<span id="cb54-384"><a href="#cb54-384" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>OverallControl)</span>
<span id="cb54-385"><a href="#cb54-385" aria-hidden="true" tabindex="-1"></a>demo <span class="sc">%&gt;%</span></span>
<span id="cb54-386"><a href="#cb54-386" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-387"><a href="#cb54-387" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> vas_control, <span class="at">color =</span> vas_control, <span class="at">fill =</span> vas_control)) <span class="sc">+</span></span>
<span id="cb54-388"><a href="#cb54-388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-389"><a href="#cb54-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-390"><a href="#cb54-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb54-391"><a href="#cb54-391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Visual analogue scores"</span>) <span class="sc">+</span></span>
<span id="cb54-392"><a href="#cb54-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-393"><a href="#cb54-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#D00000"</span>, <span class="st">"#447604"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-394"><a href="#cb54-394" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#D00000"</span>, <span class="st">"#447604"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>)</span>
<span id="cb54-395"><a href="#cb54-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-396"><a href="#cb54-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-397"><a href="#cb54-397" aria-hidden="true" tabindex="-1"></a>The discretised VAS is continued to be significantly associated with FC. </span>
<span id="cb54-398"><a href="#cb54-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-401"><a href="#cb54-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-402"><a href="#cb54-402" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-vas-fc</span></span>
<span id="cb54-403"><a href="#cb54-403" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi squared test between VAS and FC groups."</span></span>
<span id="cb54-404"><a href="#cb54-404" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo<span class="sc">$</span>vas_control, demo<span class="sc">$</span>cat))</span>
<span id="cb54-405"><a href="#cb54-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-406"><a href="#cb54-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-407"><a href="#cb54-407" aria-hidden="true" tabindex="-1"></a><span class="fu">## Medication use</span></span>
<span id="cb54-408"><a href="#cb54-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-409"><a href="#cb54-409" aria-hidden="true" tabindex="-1"></a>This section is concerned with medication used by study participants. Current</span>
<span id="cb54-410"><a href="#cb54-410" aria-hidden="true" tabindex="-1"></a>treatment strategy, bio-naive status and antibiotic use are considered. </span>
<span id="cb54-411"><a href="#cb54-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-412"><a href="#cb54-412" aria-hidden="true" tabindex="-1"></a><span class="fu">### IBD treatment strategy</span></span>
<span id="cb54-413"><a href="#cb54-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-416"><a href="#cb54-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-417"><a href="#cb54-417" aria-hidden="true" tabindex="-1"></a>drugs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ParticipantNo =</span> demo<span class="sc">$</span>ParticipantNo)</span>
<span id="cb54-418"><a href="#cb54-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-419"><a href="#cb54-419" aria-hidden="true" tabindex="-1"></a>drugs<span class="sc">$</span>ASA <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb54-420"><a href="#cb54-420" aria-hidden="true" tabindex="-1"></a>drugs<span class="sc">$</span>imm <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb54-421"><a href="#cb54-421" aria-hidden="true" tabindex="-1"></a>drugs<span class="sc">$</span>bio <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb54-422"><a href="#cb54-422" aria-hidden="true" tabindex="-1"></a>drugs<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb54-423"><a href="#cb54-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-424"><a href="#cb54-424" aria-hidden="true" tabindex="-1"></a>redcap <span class="ot">&lt;-</span> redcap <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(</span>
<span id="cb54-425"><a href="#cb54-425" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_mesa =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_mesa),</span>
<span id="cb54-426"><a href="#cb54-426" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-427"><a href="#cb54-427" aria-hidden="true" tabindex="-1"></a>    curr_on_mesa</span>
<span id="cb54-428"><a href="#cb54-428" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-429"><a href="#cb54-429" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_aza =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_aza),</span>
<span id="cb54-430"><a href="#cb54-430" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-431"><a href="#cb54-431" aria-hidden="true" tabindex="-1"></a>    curr_on_aza</span>
<span id="cb54-432"><a href="#cb54-432" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-433"><a href="#cb54-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_merc =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_merc),</span>
<span id="cb54-434"><a href="#cb54-434" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-435"><a href="#cb54-435" aria-hidden="true" tabindex="-1"></a>    curr_on_merc</span>
<span id="cb54-436"><a href="#cb54-436" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-437"><a href="#cb54-437" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_metho =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_metho),</span>
<span id="cb54-438"><a href="#cb54-438" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-439"><a href="#cb54-439" aria-hidden="true" tabindex="-1"></a>    curr_on_metho</span>
<span id="cb54-440"><a href="#cb54-440" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-441"><a href="#cb54-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_ciclo =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_ciclo),</span>
<span id="cb54-442"><a href="#cb54-442" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-443"><a href="#cb54-443" aria-hidden="true" tabindex="-1"></a>    curr_on_ciclo</span>
<span id="cb54-444"><a href="#cb54-444" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-445"><a href="#cb54-445" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_inflix =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_inflix),</span>
<span id="cb54-446"><a href="#cb54-446" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-447"><a href="#cb54-447" aria-hidden="true" tabindex="-1"></a>    curr_on_inflix</span>
<span id="cb54-448"><a href="#cb54-448" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-449"><a href="#cb54-449" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_ada =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_ada),</span>
<span id="cb54-450"><a href="#cb54-450" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-451"><a href="#cb54-451" aria-hidden="true" tabindex="-1"></a>    curr_on_ada</span>
<span id="cb54-452"><a href="#cb54-452" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-453"><a href="#cb54-453" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_goli =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_goli),</span>
<span id="cb54-454"><a href="#cb54-454" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-455"><a href="#cb54-455" aria-hidden="true" tabindex="-1"></a>    curr_on_goli</span>
<span id="cb54-456"><a href="#cb54-456" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-457"><a href="#cb54-457" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_vedo =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_vedo),</span>
<span id="cb54-458"><a href="#cb54-458" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-459"><a href="#cb54-459" aria-hidden="true" tabindex="-1"></a>    curr_on_vedo</span>
<span id="cb54-460"><a href="#cb54-460" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-461"><a href="#cb54-461" aria-hidden="true" tabindex="-1"></a>  <span class="at">curr_on_ust =</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(curr_on_ust),</span>
<span id="cb54-462"><a href="#cb54-462" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>,</span>
<span id="cb54-463"><a href="#cb54-463" aria-hidden="true" tabindex="-1"></a>    curr_on_ust</span>
<span id="cb54-464"><a href="#cb54-464" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-465"><a href="#cb54-465" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-466"><a href="#cb54-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-467"><a href="#cb54-467" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(drugs)) {</span>
<span id="cb54-468"><a href="#cb54-468" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (drugs[i, <span class="st">"ParticipantNo"</span>] <span class="sc">%in%</span> redcap<span class="sc">$</span>participantno) {</span>
<span id="cb54-469"><a href="#cb54-469" aria-hidden="true" tabindex="-1"></a>    subject.data <span class="ot">&lt;-</span> <span class="fu">subset</span>(redcap, participantno <span class="sc">==</span> drugs[i, <span class="st">"ParticipantNo"</span>])[<span class="dv">1</span>, ]</span>
<span id="cb54-470"><a href="#cb54-470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subject.data<span class="sc">$</span>curr_on_mesa <span class="sc">==</span> <span class="dv">1</span>) drugs[i, <span class="st">"ASA"</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb54-471"><a href="#cb54-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-472"><a href="#cb54-472" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Immunosuppressants</span></span>
<span id="cb54-473"><a href="#cb54-473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subject.data<span class="sc">$</span>curr_on_aza <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-474"><a href="#cb54-474" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_merc <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-475"><a href="#cb54-475" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_metho <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-476"><a href="#cb54-476" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_ciclo <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb54-477"><a href="#cb54-477" aria-hidden="true" tabindex="-1"></a>      drugs[i, <span class="st">"imm"</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb54-478"><a href="#cb54-478" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-479"><a href="#cb54-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-480"><a href="#cb54-480" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Biologics</span></span>
<span id="cb54-481"><a href="#cb54-481" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (subject.data<span class="sc">$</span>curr_on_inflix <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-482"><a href="#cb54-482" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_ada <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-483"><a href="#cb54-483" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_goli <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-484"><a href="#cb54-484" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_vedo <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span></span>
<span id="cb54-485"><a href="#cb54-485" aria-hidden="true" tabindex="-1"></a>      subject.data<span class="sc">$</span>curr_on_ust <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb54-486"><a href="#cb54-486" aria-hidden="true" tabindex="-1"></a>      drugs[i, <span class="st">"bio"</span>] <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb54-487"><a href="#cb54-487" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-488"><a href="#cb54-488" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (drugs[i, <span class="st">"imm"</span>] <span class="sc">&amp;</span> drugs[i, <span class="st">"bio"</span>]) {</span>
<span id="cb54-489"><a href="#cb54-489" aria-hidden="true" tabindex="-1"></a>      drugs[i, <span class="st">"category"</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb54-490"><a href="#cb54-490" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (drugs[i, <span class="st">"imm"</span>]) {</span>
<span id="cb54-491"><a href="#cb54-491" aria-hidden="true" tabindex="-1"></a>      drugs[i, <span class="st">"category"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb54-492"><a href="#cb54-492" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (drugs[i, <span class="st">"bio"</span>]) {</span>
<span id="cb54-493"><a href="#cb54-493" aria-hidden="true" tabindex="-1"></a>      drugs[i, <span class="st">"category"</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb54-494"><a href="#cb54-494" aria-hidden="true" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (drugs[i, <span class="st">"ASA"</span>]) {</span>
<span id="cb54-495"><a href="#cb54-495" aria-hidden="true" tabindex="-1"></a>      drugs[i, <span class="st">"category"</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-496"><a href="#cb54-496" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-497"><a href="#cb54-497" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-498"><a href="#cb54-498" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-499"><a href="#cb54-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-500"><a href="#cb54-500" aria-hidden="true" tabindex="-1"></a>drugs<span class="sc">$</span>category <span class="ot">&lt;-</span> <span class="fu">factor</span>(drugs<span class="sc">$</span>category,</span>
<span id="cb54-501"><a href="#cb54-501" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>,</span>
<span id="cb54-502"><a href="#cb54-502" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(</span>
<span id="cb54-503"><a href="#cb54-503" aria-hidden="true" tabindex="-1"></a>    <span class="st">"5-ASA"</span>,</span>
<span id="cb54-504"><a href="#cb54-504" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mono immunotherapy"</span>,</span>
<span id="cb54-505"><a href="#cb54-505" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Mono biologic"</span>,</span>
<span id="cb54-506"><a href="#cb54-506" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Combo therapy"</span></span>
<span id="cb54-507"><a href="#cb54-507" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-508"><a href="#cb54-508" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-509"><a href="#cb54-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-510"><a href="#cb54-510" aria-hidden="true" tabindex="-1"></a>drugs <span class="ot">&lt;-</span> <span class="fu">merge</span>(drugs, demo[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"cat"</span>, <span class="st">"diagnosis2"</span>)], <span class="at">by =</span> <span class="st">"ParticipantNo"</span>)</span>
<span id="cb54-511"><a href="#cb54-511" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(drugs)[<span class="dv">5</span>] <span class="ot">&lt;-</span> <span class="st">"Treatment"</span></span>
<span id="cb54-512"><a href="#cb54-512" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-513"><a href="#cb54-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-514"><a href="#cb54-514" aria-hidden="true" tabindex="-1"></a>For IBD treatment, subjects are categorised as being on either a 5-ASA, mono</span>
<span id="cb54-515"><a href="#cb54-515" aria-hidden="true" tabindex="-1"></a>immunotherapy, mono biologic, or immuno-biologic combination treatment strategy</span>
<span id="cb54-516"><a href="#cb54-516" aria-hidden="true" tabindex="-1"></a>based upon REDCap data provided by participants' IBD care teams. </span>
<span id="cb54-517"><a href="#cb54-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-518"><a href="#cb54-518" aria-hidden="true" tabindex="-1"></a>Treatments. in REDCap were selected via check boxes. As such, <span class="in">`NA`</span> (unticked) is</span>
<span id="cb54-519"><a href="#cb54-519" aria-hidden="true" tabindex="-1"></a>assumed to mean the participant is not on a given medication. </span>
<span id="cb54-520"><a href="#cb54-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-521"><a href="#cb54-521" aria-hidden="true" tabindex="-1"></a>Immunosuppressants are defined as:</span>
<span id="cb54-522"><a href="#cb54-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-523"><a href="#cb54-523" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Azathioprine</span>
<span id="cb54-524"><a href="#cb54-524" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Mercaptopurine</span>
<span id="cb54-525"><a href="#cb54-525" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Methotrexate</span>
<span id="cb54-526"><a href="#cb54-526" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Ciclosporin</span>
<span id="cb54-527"><a href="#cb54-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-528"><a href="#cb54-528" aria-hidden="true" tabindex="-1"></a>Biologics are defined as:</span>
<span id="cb54-529"><a href="#cb54-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-530"><a href="#cb54-530" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Infliximab</span>
<span id="cb54-531"><a href="#cb54-531" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Adalimumab </span>
<span id="cb54-532"><a href="#cb54-532" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Golimumab</span>
<span id="cb54-533"><a href="#cb54-533" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Vedolizumab</span>
<span id="cb54-534"><a href="#cb54-534" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Ustekinumab</span>
<span id="cb54-535"><a href="#cb54-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-536"><a href="#cb54-536" aria-hidden="true" tabindex="-1"></a>Patients are only categorised as receiving a 5-ASA treatment plan if 5-ASA is the</span>
<span id="cb54-537"><a href="#cb54-537" aria-hidden="true" tabindex="-1"></a>only IBD treatment they are receiving (I.E no immunotherapy or biologics).</span>
<span id="cb54-538"><a href="#cb54-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-539"><a href="#cb54-539" aria-hidden="true" tabindex="-1"></a>As should be expected given poor efficacy in CD, a 5-ASA treatment strategy is</span>
<span id="cb54-540"><a href="#cb54-540" aria-hidden="true" tabindex="-1"></a>much more common for UC/IBDU participants (@fig-treatments). Mono biologic</span>
<span id="cb54-541"><a href="#cb54-541" aria-hidden="true" tabindex="-1"></a>therapy is the most common treatment strategy for CD subjects.</span>
<span id="cb54-542"><a href="#cb54-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-545"><a href="#cb54-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-546"><a href="#cb54-546" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-treatments</span></span>
<span id="cb54-547"><a href="#cb54-547" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Reported treatment strategies for the FC cohort."</span></span>
<span id="cb54-548"><a href="#cb54-548" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 8</span></span>
<span id="cb54-549"><a href="#cb54-549" aria-hidden="true" tabindex="-1"></a>plt.cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#52528C"</span>, <span class="st">"#DD6E42"</span>, <span class="st">"#048A81"</span>, <span class="st">"#C585B3"</span>)</span>
<span id="cb54-550"><a href="#cb54-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-551"><a href="#cb54-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-552"><a href="#cb54-552" aria-hidden="true" tabindex="-1"></a>drugs <span class="sc">%&gt;%</span></span>
<span id="cb54-553"><a href="#cb54-553" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-554"><a href="#cb54-554" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Treatment, <span class="at">fill =</span> Treatment, <span class="at">color =</span> Treatment)) <span class="sc">+</span></span>
<span id="cb54-555"><a href="#cb54-555" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-556"><a href="#cb54-556" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-557"><a href="#cb54-557" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb54-558"><a href="#cb54-558" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Treatment strategy"</span>) <span class="sc">+</span></span>
<span id="cb54-559"><a href="#cb54-559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-560"><a href="#cb54-560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> plt.cols, <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-561"><a href="#cb54-561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(</span>
<span id="cb54-562"><a href="#cb54-562" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> colorspace<span class="sc">::</span><span class="fu">darken</span>(plt.cols, <span class="fl">0.3</span>),</span>
<span id="cb54-563"><a href="#cb54-563" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-564"><a href="#cb54-564" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-565"><a href="#cb54-565" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(diagnosis2))</span>
<span id="cb54-566"><a href="#cb54-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-567"><a href="#cb54-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-570"><a href="#cb54-570" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-571"><a href="#cb54-571" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-treatments-cd</span></span>
<span id="cb54-572"><a href="#cb54-572" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between treatment strategy and FC groups for participants with Crohn's disease."</span></span>
<span id="cb54-573"><a href="#cb54-573" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">with</span>(<span class="fu">subset</span>(drugs, diagnosis2 <span class="sc">==</span> <span class="st">"CD"</span>), <span class="fu">chisq.test</span>(Treatment, cat)))</span>
<span id="cb54-574"><a href="#cb54-574" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-575"><a href="#cb54-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-578"><a href="#cb54-578" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-579"><a href="#cb54-579" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-treatments-uc</span></span>
<span id="cb54-580"><a href="#cb54-580" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between treatment strategy and FC groups for participants with Ulcerative colitis/IBDU."</span></span>
<span id="cb54-581"><a href="#cb54-581" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">with</span>(<span class="fu">subset</span>(drugs, diagnosis2 <span class="sc">==</span> <span class="st">"UC/IBDU"</span>), <span class="fu">chisq.test</span>(Treatment, cat)))</span>
<span id="cb54-582"><a href="#cb54-582" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-583"><a href="#cb54-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-584"><a href="#cb54-584" aria-hidden="true" tabindex="-1"></a><span class="fu">### Bio-naive status</span></span>
<span id="cb54-585"><a href="#cb54-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-588"><a href="#cb54-588" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-589"><a href="#cb54-589" aria-hidden="true" tabindex="-1"></a>bio.naive <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ParticipantNo =</span> redcap<span class="sc">$</span>participantno)</span>
<span id="cb54-590"><a href="#cb54-590" aria-hidden="true" tabindex="-1"></a>bio.naive <span class="ot">&lt;-</span> <span class="fu">subset</span>(bio.naive, ParticipantNo <span class="sc">%in%</span> demo<span class="sc">$</span>ParticipantNo)</span>
<span id="cb54-591"><a href="#cb54-591" aria-hidden="true" tabindex="-1"></a>bio.naive <span class="ot">&lt;-</span> <span class="fu">merge</span>(bio.naive,</span>
<span id="cb54-592"><a href="#cb54-592" aria-hidden="true" tabindex="-1"></a>  demo[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"diagnosis"</span>)],</span>
<span id="cb54-593"><a href="#cb54-593" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-594"><a href="#cb54-594" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">FALSE</span></span>
<span id="cb54-595"><a href="#cb54-595" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-596"><a href="#cb54-596" aria-hidden="true" tabindex="-1"></a>bio.naive <span class="ot">&lt;-</span> <span class="fu">distinct</span>(bio.naive, ParticipantNo, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-597"><a href="#cb54-597" aria-hidden="true" tabindex="-1"></a>bio.naive<span class="sc">$</span>naive <span class="ot">&lt;-</span> <span class="st">"yes"</span></span>
<span id="cb54-598"><a href="#cb54-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-599"><a href="#cb54-599" aria-hidden="true" tabindex="-1"></a>bio.vars <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"inflix"</span>, <span class="st">"ada"</span>, <span class="st">"goli"</span>, <span class="st">"vedo"</span>, <span class="st">"ust"</span>)</span>
<span id="cb54-600"><a href="#cb54-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-601"><a href="#cb54-601" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(bio.naive)) {</span>
<span id="cb54-602"><a href="#cb54-602" aria-hidden="true" tabindex="-1"></a>  temp.df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">subset</span>(redcap, participantno <span class="sc">==</span> bio.naive[i, <span class="dv">1</span>]))</span>
<span id="cb54-603"><a href="#cb54-603" aria-hidden="true" tabindex="-1"></a>  temp.df <span class="ot">&lt;-</span> temp.df[, <span class="fu">paste0</span>(<span class="st">"curr_on_"</span>, bio.vars)]</span>
<span id="cb54-604"><a href="#cb54-604" aria-hidden="true" tabindex="-1"></a>  temp.df <span class="ot">&lt;-</span> temp.df[, <span class="sc">!</span><span class="fu">is.na</span>(temp.df[<span class="dv">1</span>, ])]</span>
<span id="cb54-605"><a href="#cb54-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-606"><a href="#cb54-606" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(temp.df <span class="sc">==</span> <span class="dv">1</span>)) {</span>
<span id="cb54-607"><a href="#cb54-607" aria-hidden="true" tabindex="-1"></a>    bio.naive[i, <span class="st">"naive"</span>] <span class="ot">&lt;-</span> <span class="st">"no-using"</span></span>
<span id="cb54-608"><a href="#cb54-608" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">any</span>(temp.df <span class="sc">==</span> <span class="dv">2</span>)) {</span>
<span id="cb54-609"><a href="#cb54-609" aria-hidden="true" tabindex="-1"></a>    bio.naive[i, <span class="st">"naive"</span>] <span class="ot">&lt;-</span> <span class="st">"no-not-using"</span></span>
<span id="cb54-610"><a href="#cb54-610" aria-hidden="true" tabindex="-1"></a>  } <span class="co"># else naive</span></span>
<span id="cb54-611"><a href="#cb54-611" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-612"><a href="#cb54-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-613"><a href="#cb54-613" aria-hidden="true" tabindex="-1"></a>drugs.eof <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(prefix, <span class="st">"EOF_drugs.xlsx"</span>))</span>
<span id="cb54-614"><a href="#cb54-614" aria-hidden="true" tabindex="-1"></a>using <span class="ot">&lt;-</span> <span class="fu">subset</span>(drugs.eof, AtRecruitmentYN <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb54-615"><a href="#cb54-615" aria-hidden="true" tabindex="-1"></a>bio.list <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">4</span>, <span class="dv">8</span>)</span>
<span id="cb54-616"><a href="#cb54-616" aria-hidden="true" tabindex="-1"></a>using <span class="ot">&lt;-</span> <span class="fu">subset</span>(using, DrugType <span class="sc">%in%</span> bio.list)</span>
<span id="cb54-617"><a href="#cb54-617" aria-hidden="true" tabindex="-1"></a>using <span class="ot">&lt;-</span> <span class="fu">subset</span>(demo, ParticipantId <span class="sc">%in%</span> using<span class="sc">$</span>ParticipantId)</span>
<span id="cb54-618"><a href="#cb54-618" aria-hidden="true" tabindex="-1"></a>using <span class="ot">&lt;-</span> using[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"diagnosis"</span>)]</span>
<span id="cb54-619"><a href="#cb54-619" aria-hidden="true" tabindex="-1"></a>using<span class="sc">$</span>naive <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"no-using"</span>)</span>
<span id="cb54-620"><a href="#cb54-620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-621"><a href="#cb54-621" aria-hidden="true" tabindex="-1"></a>bio.naive <span class="ot">&lt;-</span> <span class="fu">rbind</span>(bio.naive, using)</span>
<span id="cb54-622"><a href="#cb54-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-623"><a href="#cb54-623" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">unique</span>(bio.naive<span class="sc">$</span>ParticipantNo)) {</span>
<span id="cb54-624"><a href="#cb54-624" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">subset</span>(bio.naive, ParticipantNo <span class="sc">==</span> i)</span>
<span id="cb54-625"><a href="#cb54-625" aria-hidden="true" tabindex="-1"></a>  <span class="co"># if "no-using" in either extract then report using</span></span>
<span id="cb54-626"><a href="#cb54-626" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">nrow</span>(temp) <span class="sc">&gt;</span> <span class="dv">1</span>) {</span>
<span id="cb54-627"><a href="#cb54-627" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">any</span>(temp<span class="sc">$</span>naive <span class="sc">==</span> <span class="st">"no-using"</span>)) {</span>
<span id="cb54-628"><a href="#cb54-628" aria-hidden="true" tabindex="-1"></a>      bio.naive <span class="ot">&lt;-</span> <span class="fu">subset</span>(bio.naive, ParticipantNo <span class="sc">!=</span> i)</span>
<span id="cb54-629"><a href="#cb54-629" aria-hidden="true" tabindex="-1"></a>      bio.naive <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb54-630"><a href="#cb54-630" aria-hidden="true" tabindex="-1"></a>        bio.naive,</span>
<span id="cb54-631"><a href="#cb54-631" aria-hidden="true" tabindex="-1"></a>        <span class="fu">data.frame</span>(</span>
<span id="cb54-632"><a href="#cb54-632" aria-hidden="true" tabindex="-1"></a>          <span class="at">ParticipantNo =</span> i,</span>
<span id="cb54-633"><a href="#cb54-633" aria-hidden="true" tabindex="-1"></a>          <span class="at">diagnosis =</span> temp[<span class="dv">1</span>, <span class="st">"diagnosis"</span>],</span>
<span id="cb54-634"><a href="#cb54-634" aria-hidden="true" tabindex="-1"></a>          <span class="at">naive =</span> <span class="st">"no-using"</span></span>
<span id="cb54-635"><a href="#cb54-635" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb54-636"><a href="#cb54-636" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb54-637"><a href="#cb54-637" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-638"><a href="#cb54-638" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-639"><a href="#cb54-639" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-640"><a href="#cb54-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-641"><a href="#cb54-641" aria-hidden="true" tabindex="-1"></a>bio.naive <span class="ot">&lt;-</span> <span class="fu">distinct</span>(bio.naive, ParticipantNo, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-642"><a href="#cb54-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-643"><a href="#cb54-643" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo,</span>
<span id="cb54-644"><a href="#cb54-644" aria-hidden="true" tabindex="-1"></a>  bio.naive[, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>)],</span>
<span id="cb54-645"><a href="#cb54-645" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-646"><a href="#cb54-646" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-647"><a href="#cb54-647" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-648"><a href="#cb54-648" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-649"><a href="#cb54-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-650"><a href="#cb54-650" aria-hidden="true" tabindex="-1"></a>demo<span class="sc">$</span>naive <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo<span class="sc">$</span>naive,</span>
<span id="cb54-651"><a href="#cb54-651" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"no-using"</span>, <span class="st">"no-not-using"</span>, <span class="st">"yes"</span>),</span>
<span id="cb54-652"><a href="#cb54-652" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Current"</span>, <span class="st">"Previously"</span>, <span class="st">"Never prescribed"</span>)</span>
<span id="cb54-653"><a href="#cb54-653" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-654"><a href="#cb54-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-655"><a href="#cb54-655" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(demo)[<span class="fu">colnames</span>(demo) <span class="sc">==</span> <span class="st">"naive"</span>] <span class="ot">&lt;-</span> <span class="st">"Biologic"</span></span>
<span id="cb54-656"><a href="#cb54-656" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-657"><a href="#cb54-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-658"><a href="#cb54-658" aria-hidden="true" tabindex="-1"></a>Bio-naive status has been determined using REDCap and EoS data. As clinical</span>
<span id="cb54-659"><a href="#cb54-659" aria-hidden="true" tabindex="-1"></a>teams were not explicitly asked if a subject was bio-naive, the subject is</span>
<span id="cb54-660"><a href="#cb54-660" aria-hidden="true" tabindex="-1"></a>instead defined as being bio-naive if there are no recorded biologics for the</span>
<span id="cb54-661"><a href="#cb54-661" aria-hidden="true" tabindex="-1"></a>subject (which may bias subjects with missing data towards incorrectly being</span>
<span id="cb54-662"><a href="#cb54-662" aria-hidden="true" tabindex="-1"></a>reported as bio-naive). Non bio-naive subjects are categorised further into</span>
<span id="cb54-663"><a href="#cb54-663" aria-hidden="true" tabindex="-1"></a>either "currently using" or "previously used". </span>
<span id="cb54-664"><a href="#cb54-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-665"><a href="#cb54-665" aria-hidden="true" tabindex="-1"></a>Biologic treatments are defined as infliximab, adalimumab, golimumab,</span>
<span id="cb54-666"><a href="#cb54-666" aria-hidden="true" tabindex="-1"></a>vedolizumab, and ustekinumab.</span>
<span id="cb54-667"><a href="#cb54-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-668"><a href="#cb54-668" aria-hidden="true" tabindex="-1"></a>Small molecule treatments are not considered in this report due to their</span>
<span id="cb54-669"><a href="#cb54-669" aria-hidden="true" tabindex="-1"></a>low prescribing rates during the recruitment period (which ended March 2020).</span>
<span id="cb54-670"><a href="#cb54-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-673"><a href="#cb54-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-674"><a href="#cb54-674" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-biologic-use</span></span>
<span id="cb54-675"><a href="#cb54-675" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Bio-naivety in the FC cohort."</span></span>
<span id="cb54-676"><a href="#cb54-676" aria-hidden="true" tabindex="-1"></a>demo <span class="sc">%&gt;%</span></span>
<span id="cb54-677"><a href="#cb54-677" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-678"><a href="#cb54-678" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Biologic, <span class="at">fill =</span> Biologic, <span class="at">color =</span> Biologic)) <span class="sc">+</span></span>
<span id="cb54-679"><a href="#cb54-679" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-680"><a href="#cb54-680" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Biologic status"</span>) <span class="sc">+</span></span>
<span id="cb54-681"><a href="#cb54-681" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-682"><a href="#cb54-682" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-683"><a href="#cb54-683" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb54-684"><a href="#cb54-684" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#CACF85"</span>, <span class="st">"#8CBA80"</span>, <span class="st">"#E58F65"</span>)) <span class="sc">+</span></span>
<span id="cb54-685"><a href="#cb54-685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#747825"</span>, <span class="st">"#4A6E3F"</span>, <span class="st">"#934D1B"</span>)) <span class="sc">+</span></span>
<span id="cb54-686"><a href="#cb54-686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-687"><a href="#cb54-687" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Biologic status"</span>),</span>
<span id="cb54-688"><a href="#cb54-688" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Biologic status"</span>)</span>
<span id="cb54-689"><a href="#cb54-689" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-690"><a href="#cb54-690" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(diagnosis2))</span>
<span id="cb54-691"><a href="#cb54-691" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-692"><a href="#cb54-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-693"><a href="#cb54-693" aria-hidden="true" tabindex="-1"></a>Bio-naive status was found to be associated with FC groups which may be due to </span>
<span id="cb54-694"><a href="#cb54-694" aria-hidden="true" tabindex="-1"></a>patients with more active disease being more likely to be prescribed a biologic. </span>
<span id="cb54-695"><a href="#cb54-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-698"><a href="#cb54-698" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-699"><a href="#cb54-699" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-biologic</span></span>
<span id="cb54-700"><a href="#cb54-700" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between bio-naive status and FC groups."</span></span>
<span id="cb54-701"><a href="#cb54-701" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo<span class="sc">$</span>Biologic, demo<span class="sc">$</span>cat))</span>
<span id="cb54-702"><a href="#cb54-702" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-703"><a href="#cb54-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-704"><a href="#cb54-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-705"><a href="#cb54-705" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables only relevant to Crohn's disease subjects</span></span>
<span id="cb54-706"><a href="#cb54-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-709"><a href="#cb54-709" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-710"><a href="#cb54-710" aria-hidden="true" tabindex="-1"></a>smoking <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(data.path, <span class="st">"Baseline2022/lifestyle.xlsx"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-711"><a href="#cb54-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ParticipantNo, Smoke, SmokedInPast)</span>
<span id="cb54-712"><a href="#cb54-712" aria-hidden="true" tabindex="-1"></a>smoking<span class="sc">$</span>Smoke <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(smoking<span class="sc">$</span>Smoke, <span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">3</span>)</span>
<span id="cb54-713"><a href="#cb54-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-714"><a href="#cb54-714" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(smoking)) {</span>
<span id="cb54-715"><a href="#cb54-715" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="sc">!</span><span class="fu">is.na</span>(smoking[i, <span class="st">"SmokedInPast"</span>]) <span class="sc">&amp;</span> smoking[i, <span class="st">"SmokedInPast"</span>] <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">is.na</span>(smoking[i, <span class="st">"Smoke"</span>]) <span class="sc">&amp;</span> smoking[i, <span class="st">"Smoke"</span>] <span class="sc">==</span> <span class="dv">3</span>)) {</span>
<span id="cb54-716"><a href="#cb54-716" aria-hidden="true" tabindex="-1"></a>    smoking[i, <span class="st">"Smoke"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb54-717"><a href="#cb54-717" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-718"><a href="#cb54-718" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-719"><a href="#cb54-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-720"><a href="#cb54-720" aria-hidden="true" tabindex="-1"></a>smoking<span class="sc">$</span>Smoke <span class="ot">&lt;-</span> <span class="fu">factor</span>(smoking<span class="sc">$</span>Smoke,</span>
<span id="cb54-721"><a href="#cb54-721" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb54-722"><a href="#cb54-722" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Current"</span>, <span class="st">"Previous"</span>, <span class="st">"Never"</span>)</span>
<span id="cb54-723"><a href="#cb54-723" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-724"><a href="#cb54-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-725"><a href="#cb54-725" aria-hidden="true" tabindex="-1"></a>smoking <span class="ot">&lt;-</span> smoking[, <span class="sc">-</span><span class="dv">3</span>]</span>
<span id="cb54-726"><a href="#cb54-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-727"><a href="#cb54-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-728"><a href="#cb54-728" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo,</span>
<span id="cb54-729"><a href="#cb54-729" aria-hidden="true" tabindex="-1"></a>  smoking,</span>
<span id="cb54-730"><a href="#cb54-730" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-731"><a href="#cb54-731" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-732"><a href="#cb54-732" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-733"><a href="#cb54-733" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-734"><a href="#cb54-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-735"><a href="#cb54-735" aria-hidden="true" tabindex="-1"></a>esmoking <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(data.path, <span class="st">"Baseline2022/lifestyle.xlsx"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb54-736"><a href="#cb54-736" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ParticipantNo, ECigs, ECigsPast)</span>
<span id="cb54-737"><a href="#cb54-737" aria-hidden="true" tabindex="-1"></a>esmoking<span class="sc">$</span>ECigs <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">mapvalues</span>(esmoking<span class="sc">$</span>ECigs, <span class="at">from =</span> <span class="dv">2</span>, <span class="at">to =</span> <span class="dv">3</span>)</span>
<span id="cb54-738"><a href="#cb54-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-739"><a href="#cb54-739" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(esmoking)) {</span>
<span id="cb54-740"><a href="#cb54-740" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="sc">!</span><span class="fu">is.na</span>(esmoking[i, <span class="st">"ECigsPast"</span>] <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> esmoking[i, <span class="st">"ECigsPast"</span>] <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">&amp;</span> (<span class="sc">!</span><span class="fu">is.na</span>(esmoking[i, <span class="st">"ECigs"</span>]) <span class="sc">&amp;</span> esmoking[i, <span class="st">"ECigs"</span>] <span class="sc">==</span> <span class="dv">3</span>)) {</span>
<span id="cb54-741"><a href="#cb54-741" aria-hidden="true" tabindex="-1"></a>    esmoking[i, <span class="st">"ECigs"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb54-742"><a href="#cb54-742" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-743"><a href="#cb54-743" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-744"><a href="#cb54-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-745"><a href="#cb54-745" aria-hidden="true" tabindex="-1"></a>esmoking<span class="sc">$</span>ECigs <span class="ot">&lt;-</span> <span class="fu">factor</span>(esmoking<span class="sc">$</span>ECigs,</span>
<span id="cb54-746"><a href="#cb54-746" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb54-747"><a href="#cb54-747" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Current"</span>, <span class="st">"Previous"</span>, <span class="st">"Never"</span>)</span>
<span id="cb54-748"><a href="#cb54-748" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-749"><a href="#cb54-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-750"><a href="#cb54-750" aria-hidden="true" tabindex="-1"></a>esmoking <span class="ot">&lt;-</span> esmoking[, <span class="sc">-</span><span class="dv">3</span>]</span>
<span id="cb54-751"><a href="#cb54-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-752"><a href="#cb54-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-753"><a href="#cb54-753" aria-hidden="true" tabindex="-1"></a>demo <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo,</span>
<span id="cb54-754"><a href="#cb54-754" aria-hidden="true" tabindex="-1"></a>  esmoking,</span>
<span id="cb54-755"><a href="#cb54-755" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-756"><a href="#cb54-756" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-757"><a href="#cb54-757" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-758"><a href="#cb54-758" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-759"><a href="#cb54-759" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-760"><a href="#cb54-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-761"><a href="#cb54-761" aria-hidden="true" tabindex="-1"></a>This section looks at data only applicable to subjects with CD. The following </span>
<span id="cb54-762"><a href="#cb54-762" aria-hidden="true" tabindex="-1"></a>variables are considered: surgery, Montreal location, Montreal behaviour,</span>
<span id="cb54-763"><a href="#cb54-763" aria-hidden="true" tabindex="-1"></a>Harvey-Bradshaw index, and smoking. </span>
<span id="cb54-764"><a href="#cb54-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-765"><a href="#cb54-765" aria-hidden="true" tabindex="-1"></a>Smoking for CD and UC is considered separately as smoking is often reported to</span>
<span id="cb54-766"><a href="#cb54-766" aria-hidden="true" tabindex="-1"></a>worsen outcomes in CD but may be protective in UC. </span>
<span id="cb54-767"><a href="#cb54-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-768"><a href="#cb54-768" aria-hidden="true" tabindex="-1"></a><span class="fu">### Surgery</span></span>
<span id="cb54-769"><a href="#cb54-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-772"><a href="#cb54-772" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-773"><a href="#cb54-773" aria-hidden="true" tabindex="-1"></a>predicct.surgery <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="fu">paste0</span>(</span>
<span id="cb54-774"><a href="#cb54-774" aria-hidden="true" tabindex="-1"></a>  data.path,</span>
<span id="cb54-775"><a href="#cb54-775" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Baseline2022/IBD.xlsx"</span></span>
<span id="cb54-776"><a href="#cb54-776" aria-hidden="true" tabindex="-1"></a>))[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"HadSurgeryForIBD"</span>)]</span>
<span id="cb54-777"><a href="#cb54-777" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predicct.surgery)[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">"Surgery"</span></span>
<span id="cb54-778"><a href="#cb54-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-779"><a href="#cb54-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-780"><a href="#cb54-780" aria-hidden="true" tabindex="-1"></a>redcap.surgery <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantno"</span>, <span class="st">"surgery"</span>)]</span>
<span id="cb54-781"><a href="#cb54-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-782"><a href="#cb54-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-783"><a href="#cb54-783" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(redcap.surgery) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"Surgery"</span>)</span>
<span id="cb54-784"><a href="#cb54-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-785"><a href="#cb54-785" aria-hidden="true" tabindex="-1"></a>surgery <span class="ot">&lt;-</span> <span class="fu">rbind</span>(redcap.surgery, predicct.surgery)</span>
<span id="cb54-786"><a href="#cb54-786" aria-hidden="true" tabindex="-1"></a>surgery <span class="ot">&lt;-</span> <span class="fu">subset</span>(surgery, <span class="sc">!</span><span class="fu">is.na</span>(surgery<span class="sc">$</span>Surgery))</span>
<span id="cb54-787"><a href="#cb54-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-788"><a href="#cb54-788" aria-hidden="true" tabindex="-1"></a><span class="co"># As REDCap is first, this will be prioritised over subject (if not NA)</span></span>
<span id="cb54-789"><a href="#cb54-789" aria-hidden="true" tabindex="-1"></a>surgery <span class="ot">&lt;-</span> <span class="fu">distinct</span>(surgery, ParticipantNo, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-790"><a href="#cb54-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-791"><a href="#cb54-791" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">subset</span>(demo, diagnosis2 <span class="sc">==</span> <span class="st">"CD"</span>)</span>
<span id="cb54-792"><a href="#cb54-792" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.cd, surgery, <span class="at">all.x =</span> <span class="cn">TRUE</span>, <span class="at">all.y =</span> <span class="cn">FALSE</span>)</span>
<span id="cb54-793"><a href="#cb54-793" aria-hidden="true" tabindex="-1"></a>demo.cd<span class="sc">$</span>Surgery <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo.cd<span class="sc">$</span>Surgery,</span>
<span id="cb54-794"><a href="#cb54-794" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb54-795"><a href="#cb54-795" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb54-796"><a href="#cb54-796" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-797"><a href="#cb54-797" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-798"><a href="#cb54-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-799"><a href="#cb54-799" aria-hidden="true" tabindex="-1"></a>Surgical data has been obtained from both REDCap and patient-completed</span>
<span id="cb54-800"><a href="#cb54-800" aria-hidden="true" tabindex="-1"></a>questionnaires. Where data are available from both data sources, REDCap is</span>
<span id="cb54-801"><a href="#cb54-801" aria-hidden="true" tabindex="-1"></a>the preferred data source. </span>
<span id="cb54-802"><a href="#cb54-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-803"><a href="#cb54-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-806"><a href="#cb54-806" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-807"><a href="#cb54-807" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-surgery-dist</span></span>
<span id="cb54-808"><a href="#cb54-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Previous surgery for Crohn's disease subjects in the FC cohort."</span></span>
<span id="cb54-809"><a href="#cb54-809" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-810"><a href="#cb54-810" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-811"><a href="#cb54-811" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Surgery, <span class="at">fill =</span> Surgery, <span class="at">color =</span> Surgery)) <span class="sc">+</span></span>
<span id="cb54-812"><a href="#cb54-812" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-813"><a href="#cb54-813" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Previous surgery"</span>) <span class="sc">+</span></span>
<span id="cb54-814"><a href="#cb54-814" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-815"><a href="#cb54-815" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-816"><a href="#cb54-816" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#F9B9B7"</span>, <span class="st">"#96C9DC"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-817"><a href="#cb54-817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#D06965"</span>, <span class="st">"#448CA2"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>)</span>
<span id="cb54-818"><a href="#cb54-818" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-819"><a href="#cb54-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-820"><a href="#cb54-820" aria-hidden="true" tabindex="-1"></a>FC at study recruitment is significantly associated with having previously</span>
<span id="cb54-821"><a href="#cb54-821" aria-hidden="true" tabindex="-1"></a>undergone surgery for CD.</span>
<span id="cb54-822"><a href="#cb54-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-825"><a href="#cb54-825" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-826"><a href="#cb54-826" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-surgery</span></span>
<span id="cb54-827"><a href="#cb54-827" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between previous surgery and FC groups."</span></span>
<span id="cb54-828"><a href="#cb54-828" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.cd<span class="sc">$</span>Surgery, demo.cd<span class="sc">$</span>cat))</span>
<span id="cb54-829"><a href="#cb54-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-830"><a href="#cb54-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-831"><a href="#cb54-831" aria-hidden="true" tabindex="-1"></a><span class="fu">### Montreal location</span></span>
<span id="cb54-832"><a href="#cb54-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-835"><a href="#cb54-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-836"><a href="#cb54-836" aria-hidden="true" tabindex="-1"></a>mapping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-837"><a href="#cb54-837" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>),</span>
<span id="cb54-838"><a href="#cb54-838" aria-hidden="true" tabindex="-1"></a>  <span class="at">definition =</span> <span class="fu">c</span>(</span>
<span id="cb54-839"><a href="#cb54-839" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Oesophago-gastric"</span>,</span>
<span id="cb54-840"><a href="#cb54-840" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Duodenal"</span>,</span>
<span id="cb54-841"><a href="#cb54-841" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Jejunal"</span>,</span>
<span id="cb54-842"><a href="#cb54-842" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Ileal"</span>,</span>
<span id="cb54-843"><a href="#cb54-843" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Colonic"</span>,</span>
<span id="cb54-844"><a href="#cb54-844" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rectal"</span></span>
<span id="cb54-845"><a href="#cb54-845" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-846"><a href="#cb54-846" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-847"><a href="#cb54-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-848"><a href="#cb54-848" aria-hidden="true" tabindex="-1"></a>cd.location <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantno"</span>, <span class="fu">paste0</span>(<span class="st">"mac_extent___"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>))]</span>
<span id="cb54-849"><a href="#cb54-849" aria-hidden="true" tabindex="-1"></a>L4 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">nrow</span>(cd.location))</span>
<span id="cb54-850"><a href="#cb54-850" aria-hidden="true" tabindex="-1"></a>Location <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">nrow</span>(cd.location))</span>
<span id="cb54-851"><a href="#cb54-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-852"><a href="#cb54-852" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(cd.location)) {</span>
<span id="cb54-853"><a href="#cb54-853" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If Oesophago-gastric, Duodenal, Jejunal, then L4 is present</span></span>
<span id="cb54-854"><a href="#cb54-854" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(cd.location[i, <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>] <span class="sc">==</span> <span class="dv">1</span>)) L4[i] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb54-855"><a href="#cb54-855" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (cd.location[i, <span class="dv">5</span>] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> cd.location[i, <span class="dv">6</span>] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb54-856"><a href="#cb54-856" aria-hidden="true" tabindex="-1"></a>    Location[i] <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Ileal-colonic</span></span>
<span id="cb54-857"><a href="#cb54-857" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cd.location[i, <span class="dv">5</span>] <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> cd.location[i, <span class="dv">6</span>] <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb54-858"><a href="#cb54-858" aria-hidden="true" tabindex="-1"></a>    Location[i] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Ileal only</span></span>
<span id="cb54-859"><a href="#cb54-859" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (cd.location[i, <span class="dv">5</span>] <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> cd.location[i, <span class="dv">6</span>] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb54-860"><a href="#cb54-860" aria-hidden="true" tabindex="-1"></a>    Location[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># Colonic only</span></span>
<span id="cb54-861"><a href="#cb54-861" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-862"><a href="#cb54-862" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.na</span>(Location[i]) <span class="sc">&amp;</span> L4[i] <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb54-863"><a href="#cb54-863" aria-hidden="true" tabindex="-1"></a>    Location[i] <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># L4 Only</span></span>
<span id="cb54-864"><a href="#cb54-864" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-865"><a href="#cb54-865" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb54-866"><a href="#cb54-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-867"><a href="#cb54-867" aria-hidden="true" tabindex="-1"></a>L4[<span class="fu">is.na</span>(Location) <span class="sc">&amp;</span> L4 <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb54-868"><a href="#cb54-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-869"><a href="#cb54-869" aria-hidden="true" tabindex="-1"></a>mont.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-870"><a href="#cb54-870" aria-hidden="true" tabindex="-1"></a>  cd.location[, <span class="st">"participantno"</span>],</span>
<span id="cb54-871"><a href="#cb54-871" aria-hidden="true" tabindex="-1"></a>  Location,</span>
<span id="cb54-872"><a href="#cb54-872" aria-hidden="true" tabindex="-1"></a>  L4</span>
<span id="cb54-873"><a href="#cb54-873" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-874"><a href="#cb54-874" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mont.df)[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">"ParticipantNo"</span></span>
<span id="cb54-875"><a href="#cb54-875" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.cd, mont.df,</span>
<span id="cb54-876"><a href="#cb54-876" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-877"><a href="#cb54-877" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-878"><a href="#cb54-878" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-879"><a href="#cb54-879" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-880"><a href="#cb54-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-881"><a href="#cb54-881" aria-hidden="true" tabindex="-1"></a>demo.cd<span class="sc">$</span>Location <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo.cd<span class="sc">$</span>Location,</span>
<span id="cb54-882"><a href="#cb54-882" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb54-883"><a href="#cb54-883" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"L1"</span>, <span class="st">"L2"</span>, <span class="st">"L3"</span>, <span class="st">"L4 only"</span>)</span>
<span id="cb54-884"><a href="#cb54-884" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-885"><a href="#cb54-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-886"><a href="#cb54-886" aria-hidden="true" tabindex="-1"></a>demo.cd<span class="sc">$</span>L4 <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo.cd<span class="sc">$</span>L4,</span>
<span id="cb54-887"><a href="#cb54-887" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb54-888"><a href="#cb54-888" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Not present"</span>, <span class="st">"Present"</span>)</span>
<span id="cb54-889"><a href="#cb54-889" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-890"><a href="#cb54-890" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-891"><a href="#cb54-891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-892"><a href="#cb54-892" aria-hidden="true" tabindex="-1"></a>Montreal location has been obtained from REDcap data. Rather than being asked</span>
<span id="cb54-893"><a href="#cb54-893" aria-hidden="true" tabindex="-1"></a>for Montreal location directly, clinical teams were asked to provide more</span>
<span id="cb54-894"><a href="#cb54-894" aria-hidden="true" tabindex="-1"></a>granular detail by ticking boxes if inflammation was in any of the following</span>
<span id="cb54-895"><a href="#cb54-895" aria-hidden="true" tabindex="-1"></a>areas <span class="in">`r mapping$definition`</span>. If only any of the first 3 were reported then</span>
<span id="cb54-896"><a href="#cb54-896" aria-hidden="true" tabindex="-1"></a>the subject was assigned "L4 only". L1-L3 were assigned as per convention </span>
<span id="cb54-897"><a href="#cb54-897" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">@silverbergIntegratedClinicalMolecular2005</span><span class="co">]</span>. If no location was reported then</span>
<span id="cb54-898"><a href="#cb54-898" aria-hidden="true" tabindex="-1"></a>location was assigned <span class="in">`NA`</span>. </span>
<span id="cb54-899"><a href="#cb54-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-900"><a href="#cb54-900" aria-hidden="true" tabindex="-1"></a>As can be seen in @fig-location, L3 is the most common Montreal location in this</span>
<span id="cb54-901"><a href="#cb54-901" aria-hidden="true" tabindex="-1"></a>cohort with  roughly an equal amount of subjects having either L1 or L2. </span>
<span id="cb54-902"><a href="#cb54-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-905"><a href="#cb54-905" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-906"><a href="#cb54-906" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-location</span></span>
<span id="cb54-907"><a href="#cb54-907" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Montreal location for CD subjects in the FC cohort."</span></span>
<span id="cb54-908"><a href="#cb54-908" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-909"><a href="#cb54-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-910"><a href="#cb54-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Location, <span class="at">fill =</span> Location, <span class="at">color =</span> Location)) <span class="sc">+</span></span>
<span id="cb54-911"><a href="#cb54-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-912"><a href="#cb54-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Montreal location"</span>) <span class="sc">+</span></span>
<span id="cb54-913"><a href="#cb54-913" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-914"><a href="#cb54-914" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-915"><a href="#cb54-915" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-916"><a href="#cb54-916" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#33CA7F"</span>, <span class="st">"#96C9DC"</span>, <span class="st">"#C33C54"</span>, <span class="st">"#FCB97D"</span>),</span>
<span id="cb54-917"><a href="#cb54-917" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-918"><a href="#cb54-918" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-919"><a href="#cb54-919" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-920"><a href="#cb54-920" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#318859"</span>, <span class="st">"#448CA2"</span>, <span class="st">"#80333E"</span>, <span class="st">"#BD7700"</span>),</span>
<span id="cb54-921"><a href="#cb54-921" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-922"><a href="#cb54-922" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-923"><a href="#cb54-923" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-924"><a href="#cb54-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Montreal location"</span>),</span>
<span id="cb54-925"><a href="#cb54-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Montreal location"</span>)</span>
<span id="cb54-926"><a href="#cb54-926" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-927"><a href="#cb54-927" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-928"><a href="#cb54-928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-929"><a href="#cb54-929" aria-hidden="true" tabindex="-1"></a>Due to the low number of subjects with L4-only, Fisher's exact test has been</span>
<span id="cb54-930"><a href="#cb54-930" aria-hidden="true" tabindex="-1"></a>used to compare with FC.  </span>
<span id="cb54-931"><a href="#cb54-931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-934"><a href="#cb54-934" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-935"><a href="#cb54-935" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-location</span></span>
<span id="cb54-936"><a href="#cb54-936" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Fisher's exact test between Montreal location and FC groups."</span></span>
<span id="cb54-937"><a href="#cb54-937" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">fisher.test</span>(demo.cd<span class="sc">$</span>Location, demo.cd<span class="sc">$</span>cat, <span class="at">workspace =</span> <span class="dv">20000000</span>))</span>
<span id="cb54-938"><a href="#cb54-938" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-939"><a href="#cb54-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-940"><a href="#cb54-940" aria-hidden="true" tabindex="-1"></a>In addition to L4-only being considered, we also investigate L4 as a modifier. </span>
<span id="cb54-941"><a href="#cb54-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-944"><a href="#cb54-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-945"><a href="#cb54-945" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-L4</span></span>
<span id="cb54-946"><a href="#cb54-946" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "L4 (upper GI involvement) in the FC cohort."</span></span>
<span id="cb54-947"><a href="#cb54-947" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-948"><a href="#cb54-948" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-949"><a href="#cb54-949" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> L4, <span class="at">fill =</span> L4, <span class="at">color =</span> L4)) <span class="sc">+</span></span>
<span id="cb54-950"><a href="#cb54-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-951"><a href="#cb54-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Presence of L4"</span>) <span class="sc">+</span></span>
<span id="cb54-952"><a href="#cb54-952" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-953"><a href="#cb54-953" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-954"><a href="#cb54-954" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#51E5FF"</span>, <span class="st">"#EC368D"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-955"><a href="#cb54-955" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#079DB1"</span>, <span class="st">"#AF0863"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-956"><a href="#cb54-956" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-957"><a href="#cb54-957" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Presence of L4"</span>),</span>
<span id="cb54-958"><a href="#cb54-958" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Presence of L4"</span>)</span>
<span id="cb54-959"><a href="#cb54-959" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-960"><a href="#cb54-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-961"><a href="#cb54-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-964"><a href="#cb54-964" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-965"><a href="#cb54-965" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-L4</span></span>
<span id="cb54-966"><a href="#cb54-966" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between L4 and FC groups."</span></span>
<span id="cb54-967"><a href="#cb54-967" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.cd<span class="sc">$</span>L4, demo.cd<span class="sc">$</span>cat))</span>
<span id="cb54-968"><a href="#cb54-968" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-969"><a href="#cb54-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-970"><a href="#cb54-970" aria-hidden="true" tabindex="-1"></a><span class="fu">### Montreal behaviour</span></span>
<span id="cb54-971"><a href="#cb54-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-974"><a href="#cb54-974" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-975"><a href="#cb54-975" aria-hidden="true" tabindex="-1"></a>cd.behaviour <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantno"</span>, <span class="st">"behaviour"</span>, <span class="st">"perianal"</span>)]</span>
<span id="cb54-976"><a href="#cb54-976" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(cd.behaviour) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"Behaviour"</span>, <span class="st">"Perianal"</span>)</span>
<span id="cb54-977"><a href="#cb54-977" aria-hidden="true" tabindex="-1"></a>cd.behaviour<span class="sc">$</span>Perianal[<span class="sc">!</span><span class="fu">is.na</span>(cd.behaviour<span class="sc">$</span>Perianal) <span class="sc">&amp;</span> cd.behaviour<span class="sc">$</span>Perianal <span class="sc">==</span> <span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb54-978"><a href="#cb54-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-979"><a href="#cb54-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-980"><a href="#cb54-980" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.cd,</span>
<span id="cb54-981"><a href="#cb54-981" aria-hidden="true" tabindex="-1"></a>  cd.behaviour,</span>
<span id="cb54-982"><a href="#cb54-982" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-983"><a href="#cb54-983" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-984"><a href="#cb54-984" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-985"><a href="#cb54-985" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-986"><a href="#cb54-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-987"><a href="#cb54-987" aria-hidden="true" tabindex="-1"></a>demo.cd<span class="sc">$</span>Behaviour <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo.cd<span class="sc">$</span>Behaviour,</span>
<span id="cb54-988"><a href="#cb54-988" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb54-989"><a href="#cb54-989" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"B1"</span>, <span class="st">"B2"</span>, <span class="st">"B3"</span>)</span>
<span id="cb54-990"><a href="#cb54-990" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-991"><a href="#cb54-991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-992"><a href="#cb54-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-993"><a href="#cb54-993" aria-hidden="true" tabindex="-1"></a>Montreal behaviour has been obtained from REDCap data and was recorded</span>
<span id="cb54-994"><a href="#cb54-994" aria-hidden="true" tabindex="-1"></a>conventionally. The majority of CD subjects have the B1 (inflammatory)</span>
<span id="cb54-995"><a href="#cb54-995" aria-hidden="true" tabindex="-1"></a>phenotype.</span>
<span id="cb54-996"><a href="#cb54-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-999"><a href="#cb54-999" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1000"><a href="#cb54-1000" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-behaviour</span></span>
<span id="cb54-1001"><a href="#cb54-1001" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Montreal behaviour for CD subjects in the FC cohort."</span></span>
<span id="cb54-1002"><a href="#cb54-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1003"><a href="#cb54-1003" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1004"><a href="#cb54-1004" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1005"><a href="#cb54-1005" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Behaviour, <span class="at">fill =</span> Behaviour, <span class="at">color =</span> Behaviour)) <span class="sc">+</span></span>
<span id="cb54-1006"><a href="#cb54-1006" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1007"><a href="#cb54-1007" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Montreal behaviour"</span>) <span class="sc">+</span></span>
<span id="cb54-1008"><a href="#cb54-1008" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1009"><a href="#cb54-1009" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1010"><a href="#cb54-1010" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-1011"><a href="#cb54-1011" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7AE7C7"</span>, <span class="st">"#440381"</span>, <span class="st">"#D64045"</span>),</span>
<span id="cb54-1012"><a href="#cb54-1012" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1013"><a href="#cb54-1013" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1014"><a href="#cb54-1014" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-1015"><a href="#cb54-1015" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#07A282"</span>, <span class="st">"#340165"</span>, <span class="st">"#942E31"</span>),</span>
<span id="cb54-1016"><a href="#cb54-1016" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1017"><a href="#cb54-1017" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1018"><a href="#cb54-1018" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1019"><a href="#cb54-1019" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Montreal behaviour"</span>),</span>
<span id="cb54-1020"><a href="#cb54-1020" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Montreal behaviour"</span>)</span>
<span id="cb54-1021"><a href="#cb54-1021" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1022"><a href="#cb54-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1023"><a href="#cb54-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1024"><a href="#cb54-1024" aria-hidden="true" tabindex="-1"></a>Montreal behaviour is not significantly associated with FC at recruitment.</span>
<span id="cb54-1025"><a href="#cb54-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1028"><a href="#cb54-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1029"><a href="#cb54-1029" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-behaviour</span></span>
<span id="cb54-1030"><a href="#cb54-1030" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between Montreal behaviour and FC groups."</span></span>
<span id="cb54-1031"><a href="#cb54-1031" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.cd<span class="sc">$</span>Behaviour, demo.cd<span class="sc">$</span>cat))</span>
<span id="cb54-1032"><a href="#cb54-1032" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1033"><a href="#cb54-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1034"><a href="#cb54-1034" aria-hidden="true" tabindex="-1"></a>Approximately a third of CD subjects are reported to have perianal disease.</span>
<span id="cb54-1035"><a href="#cb54-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1038"><a href="#cb54-1038" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1039"><a href="#cb54-1039" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-peri</span></span>
<span id="cb54-1040"><a href="#cb54-1040" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Perianal disease for CD subjects in the FC cohort."</span></span>
<span id="cb54-1041"><a href="#cb54-1041" aria-hidden="true" tabindex="-1"></a>demo.cd<span class="sc">$</span>Perianal <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo.cd<span class="sc">$</span>Perianal,</span>
<span id="cb54-1042"><a href="#cb54-1042" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb54-1043"><a href="#cb54-1043" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"No"</span>)</span>
<span id="cb54-1044"><a href="#cb54-1044" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1045"><a href="#cb54-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1046"><a href="#cb54-1046" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1047"><a href="#cb54-1047" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1048"><a href="#cb54-1048" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Perianal, <span class="at">fill =</span> Perianal, <span class="at">color =</span> Perianal)) <span class="sc">+</span></span>
<span id="cb54-1049"><a href="#cb54-1049" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1050"><a href="#cb54-1050" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Perianal disease"</span>) <span class="sc">+</span></span>
<span id="cb54-1051"><a href="#cb54-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1052"><a href="#cb54-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1053"><a href="#cb54-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#023C40"</span>, <span class="st">"#AF5B5B"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-1054"><a href="#cb54-1054" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#002C30"</span>, <span class="st">"#754242"</span>), <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-1055"><a href="#cb54-1055" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1056"><a href="#cb54-1056" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Perianal disease"</span>),</span>
<span id="cb54-1057"><a href="#cb54-1057" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Perianal disease"</span>)</span>
<span id="cb54-1058"><a href="#cb54-1058" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1059"><a href="#cb54-1059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1060"><a href="#cb54-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1061"><a href="#cb54-1061" aria-hidden="true" tabindex="-1"></a>Perianal disease is not associated with FC at recruitment. </span>
<span id="cb54-1062"><a href="#cb54-1062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1065"><a href="#cb54-1065" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1066"><a href="#cb54-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-peri</span></span>
<span id="cb54-1067"><a href="#cb54-1067" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between between perianal disease and FC groups."</span></span>
<span id="cb54-1068"><a href="#cb54-1068" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.cd<span class="sc">$</span>Perianal, demo.cd<span class="sc">$</span>cat))</span>
<span id="cb54-1069"><a href="#cb54-1069" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1070"><a href="#cb54-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1071"><a href="#cb54-1071" aria-hidden="true" tabindex="-1"></a><span class="fu">### Harvey-Bradshaw Index</span></span>
<span id="cb54-1072"><a href="#cb54-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1075"><a href="#cb54-1075" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1076"><a href="#cb54-1076" aria-hidden="true" tabindex="-1"></a>HBI.df <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantid"</span>, <span class="st">"current_hb"</span>)]</span>
<span id="cb54-1077"><a href="#cb54-1077" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(HBI.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ParticipantId"</span>, <span class="st">"HBI"</span>)</span>
<span id="cb54-1078"><a href="#cb54-1078" aria-hidden="true" tabindex="-1"></a>HBI.df <span class="ot">&lt;-</span> <span class="fu">subset</span>(HBI.df, ParticipantId <span class="sc">%in%</span> demo.cd<span class="sc">$</span>ParticipantId)</span>
<span id="cb54-1079"><a href="#cb54-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1080"><a href="#cb54-1080" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.cd, HBI.df, <span class="at">by =</span> <span class="st">"ParticipantId"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-1081"><a href="#cb54-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1082"><a href="#cb54-1082" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1083"><a href="#cb54-1083" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat)</span>
<span id="cb54-1084"><a href="#cb54-1084" aria-hidden="true" tabindex="-1"></a>percHBI <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sum</span>(<span class="fu">is.na</span>(temp<span class="sc">$</span>HBI)) <span class="sc">/</span> <span class="fu">nrow</span>(temp), <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb54-1085"><a href="#cb54-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1086"><a href="#cb54-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1087"><a href="#cb54-1087" aria-hidden="true" tabindex="-1"></a>Whilst HBI was collected via REDCap, substantial missingness is observed with</span>
<span id="cb54-1088"><a href="#cb54-1088" aria-hidden="true" tabindex="-1"></a><span class="in">`r percHBI`</span>% of CD subjects in the FC sub-cohort missing HBI.</span>
<span id="cb54-1089"><a href="#cb54-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1092"><a href="#cb54-1092" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1093"><a href="#cb54-1093" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hbi</span></span>
<span id="cb54-1094"><a href="#cb54-1094" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Harvey-Bradshaw index for CD subjects in the FC cohort."</span></span>
<span id="cb54-1095"><a href="#cb54-1095" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1096"><a href="#cb54-1096" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1097"><a href="#cb54-1097" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(HBI))) <span class="sc">+</span></span>
<span id="cb54-1098"><a href="#cb54-1098" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#A167A5"</span>, <span class="at">color =</span> <span class="st">"#4A306D"</span>) <span class="sc">+</span></span>
<span id="cb54-1099"><a href="#cb54-1099" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1100"><a href="#cb54-1100" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1101"><a href="#cb54-1101" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Harvey-Bradshaw index at time of recruitment"</span>)</span>
<span id="cb54-1102"><a href="#cb54-1102" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1103"><a href="#cb54-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1106"><a href="#cb54-1106" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1107"><a href="#cb54-1107" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-hbi</span></span>
<span id="cb54-1108"><a href="#cb54-1108" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "ANOVA between between Harvey-Bradshaw index and FC groups."</span></span>
<span id="cb54-1109"><a href="#cb54-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(<span class="fu">aov</span>(HBI <span class="sc">~</span> cat, <span class="at">data =</span> demo.cd)))</span>
<span id="cb54-1110"><a href="#cb54-1110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1111"><a href="#cb54-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1112"><a href="#cb54-1112" aria-hidden="true" tabindex="-1"></a><span class="fu">### PRO-2 in Crohn's disease</span></span>
<span id="cb54-1113"><a href="#cb54-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1114"><a href="#cb54-1114" aria-hidden="true" tabindex="-1"></a>Sum of liquid stools per day and abdominal pain. </span>
<span id="cb54-1115"><a href="#cb54-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1118"><a href="#cb54-1118" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1119"><a href="#cb54-1119" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb54-1120"><a href="#cb54-1120" aria-hidden="true" tabindex="-1"></a>PRO2 <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantno"</span>, <span class="st">"liq_stool_day"</span>, <span class="st">"abdo_pain"</span>)]</span>
<span id="cb54-1121"><a href="#cb54-1121" aria-hidden="true" tabindex="-1"></a>PRO2<span class="sc">$</span>liq_stool_day <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(PRO2<span class="sc">$</span>liq_stool_day) <span class="co"># Drop ileostomies</span></span>
<span id="cb54-1122"><a href="#cb54-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1123"><a href="#cb54-1123" aria-hidden="true" tabindex="-1"></a>PRO2<span class="sc">$</span>PRO2 <span class="ot">&lt;-</span> <span class="fu">with</span>(PRO2, liq_stool_day <span class="sc">+</span> abdo_pain)</span>
<span id="cb54-1124"><a href="#cb54-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1125"><a href="#cb54-1125" aria-hidden="true" tabindex="-1"></a>PRO2<span class="sc">$</span>ParticipantNo <span class="ot">&lt;-</span> PRO2<span class="sc">$</span>participantno</span>
<span id="cb54-1126"><a href="#cb54-1126" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.cd,</span>
<span id="cb54-1127"><a href="#cb54-1127" aria-hidden="true" tabindex="-1"></a>  PRO2[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"PRO2"</span>)],</span>
<span id="cb54-1128"><a href="#cb54-1128" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-1129"><a href="#cb54-1129" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-1130"><a href="#cb54-1130" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-1131"><a href="#cb54-1131" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1132"><a href="#cb54-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1133"><a href="#cb54-1133" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1134"><a href="#cb54-1134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(PRO2))) <span class="sc">+</span></span>
<span id="cb54-1135"><a href="#cb54-1135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#FF8552"</span>, <span class="at">color =</span> <span class="st">"#D2632A"</span>) <span class="sc">+</span></span>
<span id="cb54-1136"><a href="#cb54-1136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-1137"><a href="#cb54-1137" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-1138"><a href="#cb54-1138" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb54-1139"><a href="#cb54-1139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1140"><a href="#cb54-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1141"><a href="#cb54-1141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1142"><a href="#cb54-1142" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoking</span></span>
<span id="cb54-1143"><a href="#cb54-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1146"><a href="#cb54-1146" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1147"><a href="#cb54-1147" aria-hidden="true" tabindex="-1"></a>percPrev <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">sum</span>(temp<span class="sc">$</span>Smoke <span class="sc">==</span> <span class="st">"Previous"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">nrow</span>(temp), <span class="dv">2</span>) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb54-1148"><a href="#cb54-1148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1149"><a href="#cb54-1149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1150"><a href="#cb54-1150" aria-hidden="true" tabindex="-1"></a>We consider smoking for CD and UC separately as smoking is often reported to</span>
<span id="cb54-1151"><a href="#cb54-1151" aria-hidden="true" tabindex="-1"></a>worsen outcomes in CD but is possibly protective in UC. Smoking status is</span>
<span id="cb54-1152"><a href="#cb54-1152" aria-hidden="true" tabindex="-1"></a>self-reported by study participants. </span>
<span id="cb54-1153"><a href="#cb54-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1154"><a href="#cb54-1154" aria-hidden="true" tabindex="-1"></a>Whilst most subjects have never been a smoker, a substantial proportion of</span>
<span id="cb54-1155"><a href="#cb54-1155" aria-hidden="true" tabindex="-1"></a>subjects (<span class="in">`r percPrev`</span>%) have previously been smokers. </span>
<span id="cb54-1156"><a href="#cb54-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1159"><a href="#cb54-1159" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1160"><a href="#cb54-1160" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-smoke-cd</span></span>
<span id="cb54-1161"><a href="#cb54-1161" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Smoking status for CD subjects in the FC cohort."</span></span>
<span id="cb54-1162"><a href="#cb54-1162" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1163"><a href="#cb54-1163" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1164"><a href="#cb54-1164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Smoke, <span class="at">fill =</span> Smoke, <span class="at">color =</span> Smoke)) <span class="sc">+</span></span>
<span id="cb54-1165"><a href="#cb54-1165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1166"><a href="#cb54-1166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Smoking status"</span>) <span class="sc">+</span></span>
<span id="cb54-1167"><a href="#cb54-1167" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1168"><a href="#cb54-1168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1169"><a href="#cb54-1169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-1170"><a href="#cb54-1170" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span>),</span>
<span id="cb54-1171"><a href="#cb54-1171" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1172"><a href="#cb54-1172" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1173"><a href="#cb54-1173" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-1174"><a href="#cb54-1174" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span>),</span>
<span id="cb54-1175"><a href="#cb54-1175" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1176"><a href="#cb54-1176" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1177"><a href="#cb54-1177" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1178"><a href="#cb54-1178" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Smoking status"</span>),</span>
<span id="cb54-1179"><a href="#cb54-1179" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Smoking status"</span>)</span>
<span id="cb54-1180"><a href="#cb54-1180" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1181"><a href="#cb54-1181" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1182"><a href="#cb54-1182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1183"><a href="#cb54-1183" aria-hidden="true" tabindex="-1"></a>Smoking status is associated with FC at recruitment for CD subjects. </span>
<span id="cb54-1184"><a href="#cb54-1184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1187"><a href="#cb54-1187" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1188"><a href="#cb54-1188" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-smoke-cd</span></span>
<span id="cb54-1189"><a href="#cb54-1189" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between between smoking status and FC groups for CD subjects."</span></span>
<span id="cb54-1190"><a href="#cb54-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.cd<span class="sc">$</span>Smoke, demo.cd<span class="sc">$</span>cat))</span>
<span id="cb54-1191"><a href="#cb54-1191" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1192"><a href="#cb54-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1193"><a href="#cb54-1193" aria-hidden="true" tabindex="-1"></a><span class="fu">### E-cigarette use</span></span>
<span id="cb54-1194"><a href="#cb54-1194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1195"><a href="#cb54-1195" aria-hidden="true" tabindex="-1"></a>The vast majority of participants do not report using some form of e-cigarettes.</span>
<span id="cb54-1196"><a href="#cb54-1196" aria-hidden="true" tabindex="-1"></a>It should be noted that as recruitment ended March 2020, these day may not</span>
<span id="cb54-1197"><a href="#cb54-1197" aria-hidden="true" tabindex="-1"></a>reflect more modern trends. </span>
<span id="cb54-1198"><a href="#cb54-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1201"><a href="#cb54-1201" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1202"><a href="#cb54-1202" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-esmoke-cd</span></span>
<span id="cb54-1203"><a href="#cb54-1203" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "E-cigarette usage for CD subjects in the FC cohort."</span></span>
<span id="cb54-1204"><a href="#cb54-1204" aria-hidden="true" tabindex="-1"></a>demo.cd <span class="sc">%&gt;%</span></span>
<span id="cb54-1205"><a href="#cb54-1205" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1206"><a href="#cb54-1206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ECigs, <span class="at">fill =</span> ECigs, <span class="at">color =</span> ECigs)) <span class="sc">+</span></span>
<span id="cb54-1207"><a href="#cb54-1207" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1208"><a href="#cb54-1208" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"E-cigarette status"</span>) <span class="sc">+</span></span>
<span id="cb54-1209"><a href="#cb54-1209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1210"><a href="#cb54-1210" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1211"><a href="#cb54-1211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-1212"><a href="#cb54-1212" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span>),</span>
<span id="cb54-1213"><a href="#cb54-1213" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1214"><a href="#cb54-1214" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1215"><a href="#cb54-1215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-1216"><a href="#cb54-1216" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span>),</span>
<span id="cb54-1217"><a href="#cb54-1217" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1218"><a href="#cb54-1218" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1219"><a href="#cb54-1219" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1220"><a href="#cb54-1220" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"E-cigarette status"</span>),</span>
<span id="cb54-1221"><a href="#cb54-1221" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"E-cigarette status"</span>)</span>
<span id="cb54-1222"><a href="#cb54-1222" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1223"><a href="#cb54-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1224"><a href="#cb54-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1227"><a href="#cb54-1227" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1228"><a href="#cb54-1228" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-esmoke-cd</span></span>
<span id="cb54-1229"><a href="#cb54-1229" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between between E-cigarettte usage and FC groups for CD subjects."</span></span>
<span id="cb54-1230"><a href="#cb54-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.cd<span class="sc">$</span>ECigs, demo.cd<span class="sc">$</span>cat))</span>
<span id="cb54-1231"><a href="#cb54-1231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1232"><a href="#cb54-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1233"><a href="#cb54-1233" aria-hidden="true" tabindex="-1"></a><span class="fu">## Variables only relevant to ulcerative colitis/IBDU subjects</span></span>
<span id="cb54-1234"><a href="#cb54-1234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1235"><a href="#cb54-1235" aria-hidden="true" tabindex="-1"></a>This section looks at variables only relevant to UC/IBDU subjects: Montreal</span>
<span id="cb54-1236"><a href="#cb54-1236" aria-hidden="true" tabindex="-1"></a>extent, Mayo score, Smoking status and E-cigarette use. </span>
<span id="cb54-1237"><a href="#cb54-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1238"><a href="#cb54-1238" aria-hidden="true" tabindex="-1"></a>As PREdiCCt required subjects to be able to flare, this effectively excluded UC</span>
<span id="cb54-1239"><a href="#cb54-1239" aria-hidden="true" tabindex="-1"></a>subjects who had undergone a proctocolectomy. As such, previous surgery is not</span>
<span id="cb54-1240"><a href="#cb54-1240" aria-hidden="true" tabindex="-1"></a>considered. Montreal severity was not collected by PREdiCCt.</span>
<span id="cb54-1241"><a href="#cb54-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1242"><a href="#cb54-1242" aria-hidden="true" tabindex="-1"></a><span class="fu">### Montreal extent</span></span>
<span id="cb54-1243"><a href="#cb54-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1246"><a href="#cb54-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1247"><a href="#cb54-1247" aria-hidden="true" tabindex="-1"></a>mapping <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb54-1248"><a href="#cb54-1248" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">6</span>),</span>
<span id="cb54-1249"><a href="#cb54-1249" aria-hidden="true" tabindex="-1"></a>  <span class="at">definition =</span> <span class="fu">c</span>(</span>
<span id="cb54-1250"><a href="#cb54-1250" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Rectum"</span>,</span>
<span id="cb54-1251"><a href="#cb54-1251" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Recto-sigmoid"</span>,</span>
<span id="cb54-1252"><a href="#cb54-1252" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt; Splenic"</span>,</span>
<span id="cb54-1253"><a href="#cb54-1253" aria-hidden="true" tabindex="-1"></a>    <span class="st">"&lt; Hepatic"</span>,</span>
<span id="cb54-1254"><a href="#cb54-1254" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Total"</span>,</span>
<span id="cb54-1255"><a href="#cb54-1255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Unknown"</span></span>
<span id="cb54-1256"><a href="#cb54-1256" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb54-1257"><a href="#cb54-1257" aria-hidden="true" tabindex="-1"></a>  <span class="at">mont =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="cn">NA</span>)</span>
<span id="cb54-1258"><a href="#cb54-1258" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1259"><a href="#cb54-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1260"><a href="#cb54-1260" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="ot">&lt;-</span> <span class="fu">subset</span>(demo, diagnosis2 <span class="sc">==</span> <span class="st">"UC/IBDU"</span>)</span>
<span id="cb54-1261"><a href="#cb54-1261" aria-hidden="true" tabindex="-1"></a>redcap.uc <span class="ot">&lt;-</span> <span class="fu">subset</span>(redcap, participantno <span class="sc">%in%</span> demo.uc<span class="sc">$</span>ParticipantNo)</span>
<span id="cb54-1262"><a href="#cb54-1262" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(redcap.uc)[<span class="fu">names</span>(redcap.uc) <span class="sc">==</span> <span class="st">"participantno"</span>] <span class="ot">&lt;-</span> <span class="st">"ParticipantNo"</span></span>
<span id="cb54-1263"><a href="#cb54-1263" aria-hidden="true" tabindex="-1"></a>redcap.uc <span class="ot">&lt;-</span> redcap.uc[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"max_extent"</span>)]</span>
<span id="cb54-1264"><a href="#cb54-1264" aria-hidden="true" tabindex="-1"></a>redcap.uc<span class="sc">$</span>Extent <span class="ot">&lt;-</span> <span class="fu">mapvalues</span>(redcap.uc<span class="sc">$</span>max_extent,</span>
<span id="cb54-1265"><a href="#cb54-1265" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> mapping<span class="sc">$</span>code,</span>
<span id="cb54-1266"><a href="#cb54-1266" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> mapping<span class="sc">$</span>mont</span>
<span id="cb54-1267"><a href="#cb54-1267" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1268"><a href="#cb54-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1269"><a href="#cb54-1269" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.uc,</span>
<span id="cb54-1270"><a href="#cb54-1270" aria-hidden="true" tabindex="-1"></a>  redcap.uc[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"Extent"</span>)],</span>
<span id="cb54-1271"><a href="#cb54-1271" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-1272"><a href="#cb54-1272" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-1273"><a href="#cb54-1273" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-1274"><a href="#cb54-1274" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1275"><a href="#cb54-1275" aria-hidden="true" tabindex="-1"></a>demo.uc<span class="sc">$</span>Extent <span class="ot">&lt;-</span> <span class="fu">factor</span>(demo.uc<span class="sc">$</span>Extent,</span>
<span id="cb54-1276"><a href="#cb54-1276" aria-hidden="true" tabindex="-1"></a>  <span class="at">levels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb54-1277"><a href="#cb54-1277" aria-hidden="true" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"E1"</span>, <span class="st">"E2"</span>, <span class="st">"E3"</span>)</span>
<span id="cb54-1278"><a href="#cb54-1278" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1279"><a href="#cb54-1279" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1280"><a href="#cb54-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1281"><a href="#cb54-1281" aria-hidden="true" tabindex="-1"></a>Montreal extent has been obtained from REDCap. Similar to Montreal location,</span>
<span id="cb54-1282"><a href="#cb54-1282" aria-hidden="true" tabindex="-1"></a>the extent of inflammation has been reported in more granular detail than is</span>
<span id="cb54-1283"><a href="#cb54-1283" aria-hidden="true" tabindex="-1"></a>required for the Montreal classification. The below table shows how these</span>
<span id="cb54-1284"><a href="#cb54-1284" aria-hidden="true" tabindex="-1"></a>definitions have been mapped to Montreal extent. </span>
<span id="cb54-1285"><a href="#cb54-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1288"><a href="#cb54-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1289"><a href="#cb54-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(mapping,</span>
<span id="cb54-1290"><a href="#cb54-1290" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Coding"</span>, <span class="st">"Definition"</span>, <span class="st">"Montreal extent"</span>),</span>
<span id="cb54-1291"><a href="#cb54-1291" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>)</span>
<span id="cb54-1292"><a href="#cb54-1292" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1293"><a href="#cb54-1293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1294"><a href="#cb54-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1295"><a href="#cb54-1295" aria-hidden="true" tabindex="-1"></a>As can be seen in @fig-extent E2 is the most common Montreal extent</span>
<span id="cb54-1296"><a href="#cb54-1296" aria-hidden="true" tabindex="-1"></a>classification.</span>
<span id="cb54-1297"><a href="#cb54-1297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1300"><a href="#cb54-1300" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1301"><a href="#cb54-1301" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-extent</span></span>
<span id="cb54-1302"><a href="#cb54-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Montreal extent for UC/IBDU subjects in the FC cohort."</span></span>
<span id="cb54-1303"><a href="#cb54-1303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1304"><a href="#cb54-1304" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="sc">%&gt;%</span></span>
<span id="cb54-1305"><a href="#cb54-1305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1306"><a href="#cb54-1306" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Extent, <span class="at">fill =</span> Extent, <span class="at">color =</span> Extent)) <span class="sc">+</span></span>
<span id="cb54-1307"><a href="#cb54-1307" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1308"><a href="#cb54-1308" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Montreal extent"</span>) <span class="sc">+</span></span>
<span id="cb54-1309"><a href="#cb54-1309" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1310"><a href="#cb54-1310" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1311"><a href="#cb54-1311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-1312"><a href="#cb54-1312" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#7AE7C7"</span>, <span class="st">"#440381"</span>, <span class="st">"#D64045"</span>),</span>
<span id="cb54-1313"><a href="#cb54-1313" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1314"><a href="#cb54-1314" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1315"><a href="#cb54-1315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-1316"><a href="#cb54-1316" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#07A282"</span>, <span class="st">"#340165"</span>, <span class="st">"#942E31"</span>),</span>
<span id="cb54-1317"><a href="#cb54-1317" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1318"><a href="#cb54-1318" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1319"><a href="#cb54-1319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1320"><a href="#cb54-1320" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Montreal extent"</span>),</span>
<span id="cb54-1321"><a href="#cb54-1321" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Montreal extent"</span>)</span>
<span id="cb54-1322"><a href="#cb54-1322" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1323"><a href="#cb54-1323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1324"><a href="#cb54-1324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1325"><a href="#cb54-1325" aria-hidden="true" tabindex="-1"></a>Montreal extent is not associated with FC</span>
<span id="cb54-1326"><a href="#cb54-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1329"><a href="#cb54-1329" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1330"><a href="#cb54-1330" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-extent</span></span>
<span id="cb54-1331"><a href="#cb54-1331" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between Montreal extent and FC groups."</span></span>
<span id="cb54-1332"><a href="#cb54-1332" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.uc<span class="sc">$</span>Extent, demo.uc<span class="sc">$</span>cat))</span>
<span id="cb54-1333"><a href="#cb54-1333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1334"><a href="#cb54-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1335"><a href="#cb54-1335" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mayo score</span></span>
<span id="cb54-1336"><a href="#cb54-1336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1337"><a href="#cb54-1337" aria-hidden="true" tabindex="-1"></a>Mayo score was collected via REDCap and is more complete than HBI. </span>
<span id="cb54-1338"><a href="#cb54-1338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1341"><a href="#cb54-1341" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1342"><a href="#cb54-1342" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-mayo</span></span>
<span id="cb54-1343"><a href="#cb54-1343" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-caption: "Mayo score for UC/IBDU subjects in the FC cohort."</span></span>
<span id="cb54-1344"><a href="#cb54-1344" aria-hidden="true" tabindex="-1"></a>mayo.df <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantid"</span>, <span class="st">"current_mayo"</span>)]</span>
<span id="cb54-1345"><a href="#cb54-1345" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mayo.df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"ParticipantId"</span>, <span class="st">"Mayo"</span>)</span>
<span id="cb54-1346"><a href="#cb54-1346" aria-hidden="true" tabindex="-1"></a>mayo.df <span class="ot">&lt;-</span> <span class="fu">subset</span>(mayo.df, ParticipantId <span class="sc">%in%</span> demo.uc<span class="sc">$</span>ParticipantId)</span>
<span id="cb54-1347"><a href="#cb54-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1348"><a href="#cb54-1348" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.uc, mayo.df, <span class="at">by =</span> <span class="st">"ParticipantId"</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-1349"><a href="#cb54-1349" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="sc">%&gt;%</span></span>
<span id="cb54-1350"><a href="#cb54-1350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1351"><a href="#cb54-1351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(Mayo))) <span class="sc">+</span></span>
<span id="cb54-1352"><a href="#cb54-1352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"#284B63"</span>, <span class="at">color =</span> <span class="st">"#153243"</span>) <span class="sc">+</span></span>
<span id="cb54-1353"><a href="#cb54-1353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1354"><a href="#cb54-1354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1355"><a href="#cb54-1355" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Mayo score at time of recruitment"</span>)</span>
<span id="cb54-1356"><a href="#cb54-1356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1357"><a href="#cb54-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1358"><a href="#cb54-1358" aria-hidden="true" tabindex="-1"></a>Mayo score is highly significantly associated with FC. </span>
<span id="cb54-1359"><a href="#cb54-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1362"><a href="#cb54-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1363"><a href="#cb54-1363" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-mayo</span></span>
<span id="cb54-1364"><a href="#cb54-1364" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "ANOVA between between Mayo score and FC groups."</span></span>
<span id="cb54-1365"><a href="#cb54-1365" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">summary</span>(<span class="fu">aov</span>(Mayo <span class="sc">~</span> cat, <span class="at">data =</span> demo.uc)))</span>
<span id="cb54-1366"><a href="#cb54-1366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1367"><a href="#cb54-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1368"><a href="#cb54-1368" aria-hidden="true" tabindex="-1"></a><span class="fu">### PRO-2 in ulcerative colitis</span></span>
<span id="cb54-1369"><a href="#cb54-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1370"><a href="#cb54-1370" aria-hidden="true" tabindex="-1"></a>Sum of stool frequency and rectal bleeding categories. </span>
<span id="cb54-1371"><a href="#cb54-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1374"><a href="#cb54-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1375"><a href="#cb54-1375" aria-hidden="true" tabindex="-1"></a>PRO2 <span class="ot">&lt;-</span> redcap[, <span class="fu">c</span>(<span class="st">"participantno"</span>, <span class="st">"stool_freq"</span>, <span class="st">"rectal_bleed"</span>)]</span>
<span id="cb54-1376"><a href="#cb54-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1377"><a href="#cb54-1377" aria-hidden="true" tabindex="-1"></a>PRO2<span class="sc">$</span>PRO2 <span class="ot">&lt;-</span> <span class="fu">with</span>(PRO2, stool_freq <span class="sc">+</span> rectal_bleed)</span>
<span id="cb54-1378"><a href="#cb54-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1379"><a href="#cb54-1379" aria-hidden="true" tabindex="-1"></a>PRO2<span class="sc">$</span>ParticipantNo <span class="ot">&lt;-</span> PRO2<span class="sc">$</span>participantno</span>
<span id="cb54-1380"><a href="#cb54-1380" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="ot">&lt;-</span> <span class="fu">merge</span>(demo.uc,</span>
<span id="cb54-1381"><a href="#cb54-1381" aria-hidden="true" tabindex="-1"></a>  PRO2[, <span class="fu">c</span>(<span class="st">"ParticipantNo"</span>, <span class="st">"PRO2"</span>)],</span>
<span id="cb54-1382"><a href="#cb54-1382" aria-hidden="true" tabindex="-1"></a>  <span class="at">by =</span> <span class="st">"ParticipantNo"</span>,</span>
<span id="cb54-1383"><a href="#cb54-1383" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.x =</span> <span class="cn">TRUE</span>,</span>
<span id="cb54-1384"><a href="#cb54-1384" aria-hidden="true" tabindex="-1"></a>  <span class="at">all.y =</span> <span class="cn">FALSE</span></span>
<span id="cb54-1385"><a href="#cb54-1385" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-1386"><a href="#cb54-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1387"><a href="#cb54-1387" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="sc">%&gt;%</span></span>
<span id="cb54-1388"><a href="#cb54-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(PRO2), <span class="at">fill =</span> diagnosis2, <span class="at">color =</span> diagnosis2)) <span class="sc">+</span></span>
<span id="cb54-1389"><a href="#cb54-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1390"><a href="#cb54-1390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="st">"#FF8552"</span>, <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-1391"><a href="#cb54-1391" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="st">"#D2632A"</span>, <span class="at">na.value =</span> <span class="st">"#032B43"</span>) <span class="sc">+</span></span>
<span id="cb54-1392"><a href="#cb54-1392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1393"><a href="#cb54-1393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb54-1394"><a href="#cb54-1394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1395"><a href="#cb54-1395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1396"><a href="#cb54-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1397"><a href="#cb54-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">### Smoking</span></span>
<span id="cb54-1398"><a href="#cb54-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1399"><a href="#cb54-1399" aria-hidden="true" tabindex="-1"></a>As with CD subjects, smoking status for UC/IBDU subjects is self-reported. </span>
<span id="cb54-1400"><a href="#cb54-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1403"><a href="#cb54-1403" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1404"><a href="#cb54-1404" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-smoke-uc</span></span>
<span id="cb54-1405"><a href="#cb54-1405" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Smoking status for UC/IBDU subjects in the FC cohort."</span></span>
<span id="cb54-1406"><a href="#cb54-1406" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="sc">%&gt;%</span></span>
<span id="cb54-1407"><a href="#cb54-1407" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1408"><a href="#cb54-1408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Smoke, <span class="at">fill =</span> Smoke, <span class="at">color =</span> Smoke)) <span class="sc">+</span></span>
<span id="cb54-1409"><a href="#cb54-1409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1410"><a href="#cb54-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Smoking status"</span>) <span class="sc">+</span></span>
<span id="cb54-1411"><a href="#cb54-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1412"><a href="#cb54-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1413"><a href="#cb54-1413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-1414"><a href="#cb54-1414" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span>),</span>
<span id="cb54-1415"><a href="#cb54-1415" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1416"><a href="#cb54-1416" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1417"><a href="#cb54-1417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-1418"><a href="#cb54-1418" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span>),</span>
<span id="cb54-1419"><a href="#cb54-1419" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1420"><a href="#cb54-1420" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1421"><a href="#cb54-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1422"><a href="#cb54-1422" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Smoking status"</span>),</span>
<span id="cb54-1423"><a href="#cb54-1423" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"Smoking status"</span>)</span>
<span id="cb54-1424"><a href="#cb54-1424" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1425"><a href="#cb54-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1426"><a href="#cb54-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1427"><a href="#cb54-1427" aria-hidden="true" tabindex="-1"></a>As with CD, smoking status is significantly associated with FC. </span>
<span id="cb54-1428"><a href="#cb54-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1431"><a href="#cb54-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1432"><a href="#cb54-1432" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-smoke-uc</span></span>
<span id="cb54-1433"><a href="#cb54-1433" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between between smoking status and FC groups for UC subjects."</span></span>
<span id="cb54-1434"><a href="#cb54-1434" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">chisq.test</span>(demo.uc<span class="sc">$</span>Smoke, demo.uc<span class="sc">$</span>cat))</span>
<span id="cb54-1435"><a href="#cb54-1435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1436"><a href="#cb54-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1437"><a href="#cb54-1437" aria-hidden="true" tabindex="-1"></a><span class="fu">### E-cigarette use</span></span>
<span id="cb54-1438"><a href="#cb54-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1439"><a href="#cb54-1439" aria-hidden="true" tabindex="-1"></a>Similar to CD, very few subjects reported using E-cigarettes. </span>
<span id="cb54-1440"><a href="#cb54-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1443"><a href="#cb54-1443" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1444"><a href="#cb54-1444" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-esmoke-uc</span></span>
<span id="cb54-1445"><a href="#cb54-1445" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "E-cigarette usage for UC subjects in the FC cohort."</span></span>
<span id="cb54-1446"><a href="#cb54-1446" aria-hidden="true" tabindex="-1"></a>demo.uc <span class="sc">%&gt;%</span></span>
<span id="cb54-1447"><a href="#cb54-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>(cat) <span class="sc">%&gt;%</span></span>
<span id="cb54-1448"><a href="#cb54-1448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> ECigs, <span class="at">fill =</span> ECigs, <span class="at">color =</span> ECigs)) <span class="sc">+</span></span>
<span id="cb54-1449"><a href="#cb54-1449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb54-1450"><a href="#cb54-1450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"E-cigarette status"</span>) <span class="sc">+</span></span>
<span id="cb54-1451"><a href="#cb54-1451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Frequency"</span>) <span class="sc">+</span></span>
<span id="cb54-1452"><a href="#cb54-1452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb54-1453"><a href="#cb54-1453" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(</span>
<span id="cb54-1454"><a href="#cb54-1454" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#4E0250"</span>, <span class="st">"#517664"</span>, <span class="st">"#1C448E"</span>),</span>
<span id="cb54-1455"><a href="#cb54-1455" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1456"><a href="#cb54-1456" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1457"><a href="#cb54-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(</span>
<span id="cb54-1458"><a href="#cb54-1458" aria-hidden="true" tabindex="-1"></a>    <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3D003F"</span>, <span class="st">"#385245"</span>, <span class="st">"#033070"</span>),</span>
<span id="cb54-1459"><a href="#cb54-1459" aria-hidden="true" tabindex="-1"></a>    <span class="at">na.value =</span> <span class="st">"#032B43"</span></span>
<span id="cb54-1460"><a href="#cb54-1460" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb54-1461"><a href="#cb54-1461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(</span>
<span id="cb54-1462"><a href="#cb54-1462" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"E-cigarette status"</span>),</span>
<span id="cb54-1463"><a href="#cb54-1463" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">title =</span> <span class="st">"E-cigarette status"</span>)</span>
<span id="cb54-1464"><a href="#cb54-1464" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb54-1465"><a href="#cb54-1465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1466"><a href="#cb54-1466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1467"><a href="#cb54-1467" aria-hidden="true" tabindex="-1"></a>E-cigarette use was found to significantly differ between FC groups in UC.</span>
<span id="cb54-1468"><a href="#cb54-1468" aria-hidden="true" tabindex="-1"></a>However, the low number of subjects reported to use E-cigarettes</span>
<span id="cb54-1469"><a href="#cb54-1469" aria-hidden="true" tabindex="-1"></a>(@fig-esmoke-uc) should be beared in mind when interpretting this finding. </span>
<span id="cb54-1470"><a href="#cb54-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1473"><a href="#cb54-1473" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1474"><a href="#cb54-1474" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: tbl-esmoke-uc</span></span>
<span id="cb54-1475"><a href="#cb54-1475" aria-hidden="true" tabindex="-1"></a><span class="co">#| tbl-cap: "Chi-squared test between between E-cigarettte usage and FC groups for UC subjects."</span></span>
<span id="cb54-1476"><a href="#cb54-1476" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(<span class="fu">fisher.test</span>(demo.uc<span class="sc">$</span>ECigs, demo.uc<span class="sc">$</span>cat))</span>
<span id="cb54-1477"><a href="#cb54-1477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1478"><a href="#cb54-1478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1479"><a href="#cb54-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1482"><a href="#cb54-1482" aria-hidden="true" tabindex="-1"></a><span class="in">```{R}</span></span>
<span id="cb54-1483"><a href="#cb54-1483" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(demo, <span class="fu">paste0</span>(outdir, <span class="st">"demo-IBD.RDS"</span>))</span>
<span id="cb54-1484"><a href="#cb54-1484" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(demo.cd, <span class="fu">paste0</span>(outdir, <span class="st">"demo-cd.RDS"</span>))</span>
<span id="cb54-1485"><a href="#cb54-1485" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(demo.uc, <span class="fu">paste0</span>(outdir, <span class="st">"demo-uc.RDS"</span>))</span>
<span id="cb54-1486"><a href="#cb54-1486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1487"><a href="#cb54-1487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1488"><a href="#cb54-1488" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reproducibility &amp; reproduction {.appendix}</span></span>
<span id="cb54-1489"><a href="#cb54-1489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1490"><a href="#cb54-1490" aria-hidden="true" tabindex="-1"></a>&lt;details class = "appendix"&gt;</span>
<span id="cb54-1491"><a href="#cb54-1491" aria-hidden="true" tabindex="-1"></a>  &lt;summary&gt; Session info &lt;/summary&gt;</span>
<span id="cb54-1492"><a href="#cb54-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1493"><a href="#cb54-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```{R Session info}</span></span>
<span id="cb54-1494"><a href="#cb54-1494" aria-hidden="true" tabindex="-1"></a><span class="in">#| echo: false</span></span>
<span id="cb54-1495"><a href="#cb54-1495" aria-hidden="true" tabindex="-1"></a><span class="in">pander::pander(sessionInfo())</span></span>
<span id="cb54-1496"><a href="#cb54-1496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-1497"><a href="#cb54-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1498"><a href="#cb54-1498" aria-hidden="true" tabindex="-1"></a>&lt;/details&gt;</span>
<span id="cb54-1499"><a href="#cb54-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-1500"><a href="#cb54-1500" aria-hidden="true" tabindex="-1"></a>Licensed by </span>
<span id="cb54-1501"><a href="#cb54-1501" aria-hidden="true" tabindex="-1"></a>&lt;a href="https://creativecommons.org/licenses/by/4.0/"&gt;CC BY&lt;/a&gt;</span>
<span id="cb54-1502"><a href="#cb54-1502" aria-hidden="true" tabindex="-1"></a> unless otherwise stated.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024, The Authors</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/nathansam/predicct-analysis/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
<li class="nav-item compact">
    <a class="nav-link active" href="https://github.com/nathansam/predicct-analysis" aria-current="page">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/IBDNathan">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
</div>
  </div>
</footer>


</body></html>